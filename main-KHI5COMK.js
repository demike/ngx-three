import{a as ae,b as jt,d as X4,f as Wt}from"./chunk-EQVTEUXC.js";var LR;function h0(){return LR}function Aa(i){let e=LR;return LR=i,e}var JF=Symbol("NotFound"),Vm=class extends Error{name="\u0275NotFound";constructor(e){super(e)}};function zu(i){return i===JF||i?.name==="\u0275NotFound"}function Hm(i,e){return Object.is(i,e)}var fr=null,f0=!1,kR=1,Z4=null,Zi=Symbol("SIGNAL");function Lt(i){let e=fr;return fr=i,e}function p0(){return fr}var Mc={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Sc(i){if(f0)throw new Error("");if(fr===null)return;fr.consumerOnSignalRead(i);let e=fr.nextProducerIndex++;if(g0(fr),e<fr.producerNode.length&&fr.producerNode[e]!==i&&zm(fr)){let t=fr.producerNode[e];m0(t,fr.producerIndexOfThis[e])}fr.producerNode[e]!==i&&(fr.producerNode[e]=i,fr.producerIndexOfThis[e]=zm(fr)?tN(i,fr,e):0),fr.producerLastReadVersion[e]=i.version}function eN(){kR++}function Gu(i){if(!(zm(i)&&!i.dirty)&&!(!i.dirty&&i.lastCleanEpoch===kR)){if(!i.producerMustRecompute(i)&&!Wu(i)){zh(i);return}i.producerRecomputeValue(i),zh(i)}}function BR(i){if(i.liveConsumerNode===void 0)return;let e=f0;f0=!0;try{for(let t of i.liveConsumerNode)t.dirty||Y4(t)}finally{f0=e}}function UR(){return fr?.consumerAllowSignalWrites!==!1}function Y4(i){i.dirty=!0,BR(i),i.consumerMarkedDirty?.(i)}function zh(i){i.dirty=!1,i.lastCleanEpoch=kR}function Pa(i){return i&&(i.nextProducerIndex=0),Lt(i)}function Rc(i,e){if(Lt(e),!(!i||i.producerNode===void 0||i.producerIndexOfThis===void 0||i.producerLastReadVersion===void 0)){if(zm(i))for(let t=i.nextProducerIndex;t<i.producerNode.length;t++)m0(i.producerNode[t],i.producerIndexOfThis[t]);for(;i.producerNode.length>i.nextProducerIndex;)i.producerNode.pop(),i.producerLastReadVersion.pop(),i.producerIndexOfThis.pop()}}function Wu(i){g0(i);for(let e=0;e<i.producerNode.length;e++){let t=i.producerNode[e],n=i.producerLastReadVersion[e];if(n!==t.version||(Gu(t),n!==t.version))return!0}return!1}function Hh(i){if(g0(i),zm(i))for(let e=0;e<i.producerNode.length;e++)m0(i.producerNode[e],i.producerIndexOfThis[e]);i.producerNode.length=i.producerLastReadVersion.length=i.producerIndexOfThis.length=0,i.liveConsumerNode&&(i.liveConsumerNode.length=i.liveConsumerIndexOfThis.length=0)}function tN(i,e,t){if(nN(i),i.liveConsumerNode.length===0&&iN(i))for(let n=0;n<i.producerNode.length;n++)i.producerIndexOfThis[n]=tN(i.producerNode[n],i,n);return i.liveConsumerIndexOfThis.push(t),i.liveConsumerNode.push(e)-1}function m0(i,e){if(nN(i),i.liveConsumerNode.length===1&&iN(i))for(let n=0;n<i.producerNode.length;n++)m0(i.producerNode[n],i.producerIndexOfThis[n]);let t=i.liveConsumerNode.length-1;if(i.liveConsumerNode[e]=i.liveConsumerNode[t],i.liveConsumerIndexOfThis[e]=i.liveConsumerIndexOfThis[t],i.liveConsumerNode.length--,i.liveConsumerIndexOfThis.length--,e<i.liveConsumerNode.length){let n=i.liveConsumerIndexOfThis[e],r=i.liveConsumerNode[e];g0(r),r.producerIndexOfThis[n]=e}}function zm(i){return i.consumerIsAlwaysLive||(i?.liveConsumerNode?.length??0)>0}function g0(i){i.producerNode??=[],i.producerIndexOfThis??=[],i.producerLastReadVersion??=[]}function nN(i){i.liveConsumerNode??=[],i.liveConsumerIndexOfThis??=[]}function iN(i){return i.producerNode!==void 0}function Gm(i){Z4?.(i)}function _0(i,e){let t=Object.create(Q4);t.computation=i,e!==void 0&&(t.equal=e);let n=()=>{if(Gu(t),Sc(t),t.value===wc)throw t.error;return t.value};return n[Zi]=t,Gm(t),n}var Sl=Symbol("UNSET"),Hu=Symbol("COMPUTING"),wc=Symbol("ERRORED"),Q4=jt(ae({},Mc),{value:Sl,dirty:!0,error:null,equal:Hm,kind:"computed",producerMustRecompute(i){return i.value===Sl||i.value===Hu},producerRecomputeValue(i){if(i.value===Hu)throw new Error("");let e=i.value;i.value=Hu;let t=Pa(i),n,r=!1;try{n=i.computation(),Lt(null),r=e!==Sl&&e!==wc&&n!==wc&&i.equal(e,n)}catch(o){n=wc,i.error=o}finally{Rc(i,t)}if(r){i.value=e;return}i.value=n,i.version++}});function K4(){throw new Error}var rN=K4;function oN(i){rN(i)}function VR(i){rN=i}var J4=null;function zR(i,e){let t=Object.create(Wm);t.value=i,e!==void 0&&(t.equal=e);let n=()=>sN(t);return n[Zi]=t,Gm(t),[n,s=>Rl(t,s),s=>b0(t,s)]}function sN(i){return Sc(i),i.value}function Rl(i,e){UR()||oN(i),i.equal(i.value,e)||(i.value=e,eG(i))}function b0(i,e){UR()||oN(i),Rl(i,e(i.value))}var Wm=jt(ae({},Mc),{equal:Hm,value:void 0,kind:"signal"});function eG(i){i.version++,eN(),BR(i),J4?.(i)}function Pt(i){return typeof i=="function"}function Gh(i){let t=i(n=>{Error.call(n),n.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var v0=Gh(i=>function(t){i(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((n,r)=>`${r+1}) ${n.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function $u(i,e){if(i){let t=i.indexOf(e);0<=t&&i.splice(t,1)}}var Rn=class i{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:n}=this;if(Pt(n))try{n()}catch(o){e=o instanceof v0?o.errors:[o]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let o of r)try{aN(o)}catch(s){e=e??[],s instanceof v0?e=[...e,...s.errors]:e.push(s)}}if(e)throw new v0(e)}}add(e){var t;if(e&&e!==this)if(this.closed)aN(e);else{if(e instanceof i){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&$u(t,e)}remove(e){let{_finalizers:t}=this;t&&$u(t,e),e instanceof i&&e._removeParent(this)}};Rn.EMPTY=(()=>{let i=new Rn;return i.closed=!0,i})();var HR=Rn.EMPTY;function y0(i){return i instanceof Rn||i&&"closed"in i&&Pt(i.remove)&&Pt(i.add)&&Pt(i.unsubscribe)}function aN(i){Pt(i)?i():i.unsubscribe()}var Ls={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Wh={setTimeout(i,e,...t){let{delegate:n}=Wh;return n?.setTimeout?n.setTimeout(i,e,...t):setTimeout(i,e,...t)},clearTimeout(i){let{delegate:e}=Wh;return(e?.clearTimeout||clearTimeout)(i)},delegate:void 0};function x0(i){Wh.setTimeout(()=>{let{onUnhandledError:e}=Ls;if(e)e(i);else throw i})}function $m(){}var cN=GR("C",void 0,void 0);function lN(i){return GR("E",void 0,i)}function uN(i){return GR("N",i,void 0)}function GR(i,e,t){return{kind:i,value:e,error:t}}var qu=null;function $h(i){if(Ls.useDeprecatedSynchronousErrorHandling){let e=!qu;if(e&&(qu={errorThrown:!1,error:null}),i(),e){let{errorThrown:t,error:n}=qu;if(qu=null,t)throw n}}else i()}function dN(i){Ls.useDeprecatedSynchronousErrorHandling&&qu&&(qu.errorThrown=!0,qu.error=i)}var Xu=class extends Rn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,y0(e)&&e.add(this)):this.destination=iG}static create(e,t,n){return new ks(e,t,n)}next(e){this.isStopped?$R(uN(e),this):this._next(e)}error(e){this.isStopped?$R(lN(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?$R(cN,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},tG=Function.prototype.bind;function WR(i,e){return tG.call(i,e)}var qR=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){w0(n)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){w0(n)}else w0(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){w0(t)}}},ks=class extends Xu{constructor(e,t,n){super();let r;if(Pt(e)||!e)r={next:e??void 0,error:t??void 0,complete:n??void 0};else{let o;this&&Ls.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&WR(e.next,o),error:e.error&&WR(e.error,o),complete:e.complete&&WR(e.complete,o)}):r=e}this.destination=new qR(r)}};function w0(i){Ls.useDeprecatedSynchronousErrorHandling?dN(i):x0(i)}function nG(i){throw i}function $R(i,e){let{onStoppedNotification:t}=Ls;t&&Wh.setTimeout(()=>t(i,e))}var iG={closed:!0,next:$m,error:nG,complete:$m};var qh=typeof Symbol=="function"&&Symbol.observable||"@@observable";function to(i){return i}function XR(...i){return ZR(i)}function ZR(i){return i.length===0?to:i.length===1?i[0]:function(t){return i.reduce((n,r)=>r(n),t)}}var It=(()=>{class i{constructor(t){t&&(this._subscribe=t)}lift(t){let n=new i;return n.source=this,n.operator=t,n}subscribe(t,n,r){let o=oG(t)?t:new ks(t,n,r);return $h(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return n=hN(n),new n((r,o)=>{let s=new ks({next:a=>{try{t(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)}[qh](){return this}pipe(...t){return ZR(t)(this)}toPromise(t){return t=hN(t),new t((n,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>n(o))})}}return i.create=e=>new i(e),i})();function hN(i){var e;return(e=i??Ls.Promise)!==null&&e!==void 0?e:Promise}function rG(i){return i&&Pt(i.next)&&Pt(i.error)&&Pt(i.complete)}function oG(i){return i&&i instanceof Xu||rG(i)&&y0(i)}function YR(i){return Pt(i?.lift)}function on(i){return e=>{if(YR(e))return e.lift(function(t){try{return i(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function Jt(i,e,t,n,r){return new QR(i,e,t,n,r)}var QR=class extends Xu{constructor(e,t,n,r,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Xh(){return on((i,e)=>{let t=null;i._refCount++;let n=Jt(e,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount){t=null;return}let r=i._connection,o=t;t=null,r&&(!o||r===o)&&r.unsubscribe(),e.unsubscribe()});i.subscribe(n),n.closed||(t=i.connect())})}var Zh=class extends It{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,YR(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Rn;let t=this.getSubject();e.add(this.source.subscribe(Jt(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Rn.EMPTY)}return e}refCount(){return Xh()(this)}};var fN=Gh(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var lt=(()=>{class i extends It{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let n=new M0(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new fN}next(t){$h(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let n of this.currentObservers)n.next(t)}})}error(t){$h(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){$h(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:n,isStopped:r,observers:o}=this;return n||r?HR:(this.currentObservers=null,o.push(t),new Rn(()=>{this.currentObservers=null,$u(o,t)}))}_checkFinalizedStatuses(t){let{hasError:n,thrownError:r,isStopped:o}=this;n?t.error(r):o&&t.complete()}asObservable(){let t=new It;return t.source=this,t}}return i.create=(e,t)=>new M0(e,t),i})(),M0=class extends lt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.next)===null||n===void 0||n.call(t,e)}error(e){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.error)===null||n===void 0||n.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,n;return(n=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&n!==void 0?n:HR}};var Bi=class extends lt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}};var qm={now(){return(qm.delegate||Date).now()},delegate:void 0};var Zu=class extends lt{constructor(e=1/0,t=1/0,n=qm){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:n,_infiniteTimeWindow:r,_timestampProvider:o,_windowTime:s}=this;t||(n.push(e),!r&&n.push(o.now()+s)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:r}=this,o=r.slice();for(let s=0;s<o.length&&!e.closed;s+=n?1:2)e.next(o[s]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:r}=this,o=(r?1:2)*e;if(e<1/0&&o<n.length&&n.splice(0,n.length-o),!r){let s=t.now(),a=0;for(let c=1;c<n.length&&n[c]<=s;c+=2)a=c;a&&n.splice(0,a+1)}}};var S0=class extends Rn{constructor(e,t){super()}schedule(e,t=0){return this}};var Xm={setInterval(i,e,...t){let{delegate:n}=Xm;return n?.setInterval?n.setInterval(i,e,...t):setInterval(i,e,...t)},clearInterval(i){let{delegate:e}=Xm;return(e?.clearInterval||clearInterval)(i)},delegate:void 0};var R0=class extends S0{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var n;if(this.closed)return this;this.state=e;let r=this.id,o=this.scheduler;return r!=null&&(this.id=this.recycleAsyncId(o,r,t)),this.pending=!0,this.delay=t,this.id=(n=this.id)!==null&&n!==void 0?n:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,n=0){return Xm.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(n!=null&&this.delay===n&&this.pending===!1)return t;t!=null&&Xm.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let n=this._execute(e,t);if(n)return n;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let n=!1,r;try{this.work(e)}catch(o){n=!0,r=o||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,$u(n,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Yh=class i{constructor(e,t=i.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}};Yh.now=qm.now;var T0=class extends Yh{constructor(e,t=Yh.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let n;this._active=!0;do if(n=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}};var Zm=new T0(R0),pN=Zm;var Ti=new It(i=>i.complete());function C0(i){return i&&Pt(i.schedule)}function KR(i){return i[i.length-1]}function E0(i){return Pt(KR(i))?i.pop():void 0}function Fa(i){return C0(KR(i))?i.pop():void 0}function mN(i,e){return typeof KR(i)=="number"?i.pop():e}function _N(i,e,t,n){function r(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{l(n.next(u))}catch(d){s(d)}}function c(u){try{l(n.throw(u))}catch(d){s(d)}}function l(u){u.done?o(u.value):r(u.value).then(a,c)}l((n=n.apply(i,e||[])).next())})}function gN(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Yu(i){return this instanceof Yu?(this.v=i,this):new Yu(i)}function bN(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(i,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),r[Symbol.asyncIterator]=function(){return this},r;function s(f){return function(g){return Promise.resolve(g).then(f,d)}}function a(f,g){n[f]&&(r[f]=function(_){return new Promise(function(m,p){o.push([f,_,m,p])>1||c(f,_)})},g&&(r[f]=g(r[f])))}function c(f,g){try{l(n[f](g))}catch(_){h(o[0][3],_)}}function l(f){f.value instanceof Yu?Promise.resolve(f.value.v).then(u,d):h(o[0][2],f)}function u(f){c("next",f)}function d(f){c("throw",f)}function h(f,g){f(g),o.shift(),o.length&&c(o[0][0],o[0][1])}}function vN(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof gN=="function"?gN(i):i[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(o){t[o]=i[o]&&function(s){return new Promise(function(a,c){s=i[o](s),r(a,c,s.done,s.value)})}}function r(o,s,a,c){Promise.resolve(c).then(function(l){o({value:l,done:a})},s)}}var Qh=i=>i&&typeof i.length=="number"&&typeof i!="function";function D0(i){return Pt(i?.then)}function I0(i){return Pt(i[qh])}function A0(i){return Symbol.asyncIterator&&Pt(i?.[Symbol.asyncIterator])}function P0(i){return new TypeError(`You provided ${i!==null&&typeof i=="object"?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function sG(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var F0=sG();function N0(i){return Pt(i?.[F0])}function j0(i){return bN(this,arguments,function*(){let t=i.getReader();try{for(;;){let{value:n,done:r}=yield Yu(t.read());if(r)return yield Yu(void 0);yield yield Yu(n)}}finally{t.releaseLock()}})}function O0(i){return Pt(i?.getReader)}function $n(i){if(i instanceof It)return i;if(i!=null){if(I0(i))return aG(i);if(Qh(i))return cG(i);if(D0(i))return lG(i);if(A0(i))return yN(i);if(N0(i))return uG(i);if(O0(i))return dG(i)}throw P0(i)}function aG(i){return new It(e=>{let t=i[qh]();if(Pt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function cG(i){return new It(e=>{for(let t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()})}function lG(i){return new It(e=>{i.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,x0)})}function uG(i){return new It(e=>{for(let t of i)if(e.next(t),e.closed)return;e.complete()})}function yN(i){return new It(e=>{hG(i,e).catch(t=>e.error(t))})}function dG(i){return yN(j0(i))}function hG(i,e){var t,n,r,o;return _N(this,void 0,void 0,function*(){try{for(t=vN(i);n=yield t.next(),!n.done;){let s=n.value;if(e.next(s),e.closed)return}}catch(s){r={error:s}}finally{try{n&&!n.done&&(o=t.return)&&(yield o.call(t))}finally{if(r)throw r.error}}e.complete()})}function Mo(i,e,t,n=0,r=!1){let o=e.schedule(function(){t(),r?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(o),!r)return o}function L0(i,e=0){return on((t,n)=>{t.subscribe(Jt(n,r=>Mo(n,i,()=>n.next(r),e),()=>Mo(n,i,()=>n.complete(),e),r=>Mo(n,i,()=>n.error(r),e)))})}function k0(i,e=0){return on((t,n)=>{n.add(i.schedule(()=>t.subscribe(n),e))})}function xN(i,e){return $n(i).pipe(k0(e),L0(e))}function wN(i,e){return $n(i).pipe(k0(e),L0(e))}function MN(i,e){return new It(t=>{let n=0;return e.schedule(function(){n===i.length?t.complete():(t.next(i[n++]),t.closed||this.schedule())})})}function SN(i,e){return new It(t=>{let n;return Mo(t,e,()=>{n=i[F0](),Mo(t,e,()=>{let r,o;try{({value:r,done:o}=n.next())}catch(s){t.error(s);return}o?t.complete():t.next(r)},0,!0)}),()=>Pt(n?.return)&&n.return()})}function B0(i,e){if(!i)throw new Error("Iterable cannot be null");return new It(t=>{Mo(t,e,()=>{let n=i[Symbol.asyncIterator]();Mo(t,e,()=>{n.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function RN(i,e){return B0(j0(i),e)}function TN(i,e){if(i!=null){if(I0(i))return xN(i,e);if(Qh(i))return MN(i,e);if(D0(i))return wN(i,e);if(A0(i))return B0(i,e);if(N0(i))return SN(i,e);if(O0(i))return RN(i,e)}throw P0(i)}function qn(i,e){return e?TN(i,e):$n(i)}function ut(...i){let e=Fa(i);return qn(i,e)}function So(i,e){let t=Pt(i)?i:()=>i,n=r=>r.error(t());return new It(e?r=>e.schedule(n,0,r):n)}function U0(i){return!!i&&(i instanceof It||Pt(i.lift)&&Pt(i.subscribe))}var Bs=Gh(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});function JR(i,e){let t=typeof e=="object";return new Promise((n,r)=>{let o=new ks({next:s=>{n(s),o.unsubscribe()},error:r,complete:()=>{t?n(e.defaultValue):r(new Bs)}});i.subscribe(o)})}function CN(i){return i instanceof Date&&!isNaN(i)}function tt(i,e){return on((t,n)=>{let r=0;t.subscribe(Jt(n,o=>{n.next(i.call(e,o,r++))}))})}var{isArray:fG}=Array;function pG(i,e){return fG(e)?i(...e):i(e)}function Kh(i){return tt(e=>pG(i,e))}var{isArray:mG}=Array,{getPrototypeOf:gG,prototype:_G,keys:bG}=Object;function V0(i){if(i.length===1){let e=i[0];if(mG(e))return{args:e,keys:null};if(vG(e)){let t=bG(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:i,keys:null}}function vG(i){return i&&typeof i=="object"&&gG(i)===_G}function z0(i,e){return i.reduce((t,n,r)=>(t[n]=e[r],t),{})}function Qu(...i){let e=Fa(i),t=E0(i),{args:n,keys:r}=V0(i);if(n.length===0)return qn([],e);let o=new It(yG(n,e,r?s=>z0(r,s):to));return t?o.pipe(Kh(t)):o}function yG(i,e,t=to){return n=>{EN(e,()=>{let{length:r}=i,o=new Array(r),s=r,a=r;for(let c=0;c<r;c++)EN(e,()=>{let l=qn(i[c],e),u=!1;l.subscribe(Jt(n,d=>{o[c]=d,u||(u=!0,a--),a||n.next(t(o.slice()))},()=>{--s||n.complete()}))},n)},n)}}function EN(i,e,t){i?Mo(t,i,e):e()}function DN(i,e,t,n,r,o,s,a){let c=[],l=0,u=0,d=!1,h=()=>{d&&!c.length&&!l&&e.complete()},f=_=>l<n?g(_):c.push(_),g=_=>{o&&e.next(_),l++;let m=!1;$n(t(_,u++)).subscribe(Jt(e,p=>{r?.(p),o?f(p):e.next(p)},()=>{m=!0},void 0,()=>{if(m)try{for(l--;c.length&&l<n;){let p=c.shift();s?Mo(e,s,()=>g(p)):g(p)}h()}catch(p){e.error(p)}}))};return i.subscribe(Jt(e,f,()=>{d=!0,h()})),()=>{a?.()}}function Pi(i,e,t=1/0){return Pt(e)?Pi((n,r)=>tt((o,s)=>e(n,o,r,s))($n(i(n,r))),t):(typeof e=="number"&&(t=e),on((n,r)=>DN(n,r,i,t)))}function Tl(i=1/0){return Pi(to,i)}function IN(){return Tl(1)}function Cl(...i){return IN()(qn(i,Fa(i)))}function Ym(i){return new It(e=>{$n(i()).subscribe(e)})}function Ku(...i){let e=E0(i),{args:t,keys:n}=V0(i),r=new It(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),c=s,l=s;for(let u=0;u<s;u++){let d=!1;$n(t[u]).subscribe(Jt(o,h=>{d||(d=!0,l--),a[u]=h},()=>c--,void 0,()=>{(!c||!d)&&(l||o.next(n?z0(n,a):a),o.complete())}))}});return e?r.pipe(Kh(e)):r}var xG=["addListener","removeListener"],wG=["addEventListener","removeEventListener"],MG=["on","off"];function Qm(i,e,t,n){if(Pt(t)&&(n=t,t=void 0),n)return Qm(i,e,t).pipe(Kh(n));let[r,o]=TG(i)?wG.map(s=>a=>i[s](e,a,t)):SG(i)?xG.map(AN(i,e)):RG(i)?MG.map(AN(i,e)):[];if(!r&&Qh(i))return Pi(s=>Qm(s,e,t))($n(i));if(!r)throw new TypeError("Invalid event target");return new It(s=>{let a=(...c)=>s.next(1<c.length?c:c[0]);return r(a),()=>o(a)})}function AN(i,e){return t=>n=>i[t](e,n)}function SG(i){return Pt(i.addListener)&&Pt(i.removeListener)}function RG(i){return Pt(i.on)&&Pt(i.off)}function TG(i){return Pt(i.addEventListener)&&Pt(i.removeEventListener)}function Km(i=0,e,t=pN){let n=-1;return e!=null&&(C0(e)?t=e:n=e),new It(r=>{let o=CN(i)?+i-t.now():i;o<0&&(o=0);let s=0;return t.schedule(function(){r.closed||(r.next(s++),0<=n?this.schedule(void 0,n):r.complete())},o)})}function Tc(...i){let e=Fa(i),t=mN(i,1/0),n=i;return n.length?n.length===1?$n(n[0]):Tl(t)(qn(n,e)):Ti}function vn(i,e){return on((t,n)=>{let r=0;t.subscribe(Jt(n,o=>i.call(e,o,r++)&&n.next(o)))})}function PN(i){return on((e,t)=>{let n=!1,r=null,o=null,s=!1,a=()=>{if(o?.unsubscribe(),o=null,n){n=!1;let l=r;r=null,t.next(l)}s&&t.complete()},c=()=>{o=null,s&&t.complete()};e.subscribe(Jt(t,l=>{n=!0,r=l,o||$n(i(l)).subscribe(o=Jt(t,a,c))},()=>{s=!0,(!n||!o||o.closed)&&t.complete()}))})}function H0(i,e=Zm){return PN(()=>Km(i,e))}function Br(i){return on((e,t)=>{let n=null,r=!1,o;n=e.subscribe(Jt(t,void 0,void 0,s=>{o=$n(i(s,Br(i)(e))),n?(n.unsubscribe(),n=null,o.subscribe(t)):r=!0})),r&&(n.unsubscribe(),n=null,o.subscribe(t))})}function FN(i,e,t,n,r){return(o,s)=>{let a=t,c=e,l=0;o.subscribe(Jt(s,u=>{let d=l++;c=a?i(c,u,d):(a=!0,u),n&&s.next(c)},r&&(()=>{a&&s.next(c),s.complete()})))}}function Na(i,e){return Pt(e)?Pi(i,e,1):Pi(i,1)}function Us(i,e=Zm){return on((t,n)=>{let r=null,o=null,s=null,a=()=>{if(r){r.unsubscribe(),r=null;let l=o;o=null,n.next(l)}};function c(){let l=s+i,u=e.now();if(u<l){r=this.schedule(void 0,l-u),n.add(r);return}a()}t.subscribe(Jt(n,l=>{o=l,s=e.now(),r||(r=e.schedule(c,i),n.add(r))},()=>{a(),n.complete()},void 0,()=>{o=r=null}))})}function El(i){return on((e,t)=>{let n=!1;e.subscribe(Jt(t,r=>{n=!0,t.next(r)},()=>{n||t.next(i),t.complete()}))})}function no(i){return i<=0?()=>Ti:on((e,t)=>{let n=0;e.subscribe(Jt(t,r=>{++n<=i&&(t.next(r),i<=n&&t.complete())}))})}function G0(i){return tt(()=>i)}function W0(i,e=to){return i=i??CG,on((t,n)=>{let r,o=!0;t.subscribe(Jt(n,s=>{let a=e(s);(o||!i(r,a))&&(o=!1,r=a,n.next(s))}))})}function CG(i,e){return i===e}function $0(i=EG){return on((e,t)=>{let n=!1;e.subscribe(Jt(t,r=>{n=!0,t.next(r)},()=>n?t.complete():t.error(i())))})}function EG(){return new Bs}function ja(i){return on((e,t)=>{try{e.subscribe(t)}finally{t.add(i)}})}function Cc(i,e){let t=arguments.length>=2;return n=>n.pipe(i?vn((r,o)=>i(r,o,n)):to,no(1),t?El(e):$0(()=>new Bs))}function Jh(i){return i<=0?()=>Ti:on((e,t)=>{let n=[];e.subscribe(Jt(t,r=>{n.push(r),i<n.length&&n.shift()},()=>{for(let r of n)t.next(r);t.complete()},void 0,()=>{n=null}))})}function eT(i,e){let t=arguments.length>=2;return n=>n.pipe(i?vn((r,o)=>i(r,o,n)):to,Jh(1),t?El(e):$0(()=>new Bs))}function tT(i,e){return on(FN(i,e,arguments.length>=2,!0))}function Jm(i={}){let{connector:e=()=>new lt,resetOnError:t=!0,resetOnComplete:n=!0,resetOnRefCountZero:r=!0}=i;return o=>{let s,a,c,l=0,u=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),s=c=void 0,u=d=!1},g=()=>{let _=s;f(),_?.unsubscribe()};return on((_,m)=>{l++,!d&&!u&&h();let p=c=c??e();m.add(()=>{l--,l===0&&!d&&!u&&(a=nT(g,r))}),p.subscribe(m),!s&&l>0&&(s=new ks({next:b=>p.next(b),error:b=>{d=!0,h(),a=nT(f,t,b),p.error(b)},complete:()=>{u=!0,h(),a=nT(f,n),p.complete()}}),$n(_).subscribe(s))})(o)}}function nT(i,e,...t){if(e===!0){i();return}if(e===!1)return;let n=new ks({next:()=>{n.unsubscribe(),i()}});return $n(e(...t)).subscribe(n)}function Ec(i,e,t){let n,r=!1;return i&&typeof i=="object"?{bufferSize:n=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:t}=i:n=i??1/0,Jm({connector:()=>new Zu(n,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}function Ju(i){return vn((e,t)=>i<=t)}function Uo(...i){let e=Fa(i);return on((t,n)=>{(e?Cl(i,t,e):Cl(i,t)).subscribe(n)})}function Ui(i,e){return on((t,n)=>{let r=null,o=0,s=!1,a=()=>s&&!r&&n.complete();t.subscribe(Jt(n,c=>{r?.unsubscribe();let l=0,u=o++;$n(i(c,u)).subscribe(r=Jt(n,d=>n.next(e?e(c,d,u,l++):d),()=>{r=null,a()}))},()=>{s=!0,a()}))})}function Pn(i){return on((e,t)=>{$n(i).subscribe(Jt(t,()=>t.complete(),$m)),!t.closed&&e.subscribe(t)})}function Kn(i,e,t){let n=Pt(i)||e||t?{next:i,error:e,complete:t}:i;return n?on((r,o)=>{var s;(s=n.subscribe)===null||s===void 0||s.call(n);let a=!0;r.subscribe(Jt(o,c=>{var l;(l=n.next)===null||l===void 0||l.call(n,c),o.next(c)},()=>{var c;a=!1,(c=n.complete)===null||c===void 0||c.call(n),o.complete()},c=>{var l;a=!1,(l=n.error)===null||l===void 0||l.call(n,c),o.error(c)},()=>{var c,l;a&&((c=n.unsubscribe)===null||c===void 0||c.call(n)),(l=n.finalize)===null||l===void 0||l.call(n)}))}):to}function iT(i,e,t){let n=Object.create(DG);n.source=i,n.computation=e,t!=null&&(n.equal=t);let o=()=>{if(Gu(n),Sc(n),n.value===wc)throw n.error;return n.value};return o[Zi]=n,Gm(n),o}function NN(i,e){Gu(i),Rl(i,e),zh(i)}function jN(i,e){Gu(i),b0(i,e),zh(i)}var DG=jt(ae({},Mc),{value:Sl,dirty:!0,error:null,equal:Hm,kind:"linkedSignal",producerMustRecompute(i){return i.value===Sl||i.value===Hu},producerRecomputeValue(i){if(i.value===Hu)throw new Error("");let e=i.value;i.value=Hu;let t=Pa(i),n;try{let r=i.source(),o=e===Sl||e===wc?void 0:{source:i.sourceValue,value:e};n=i.computation(r,o),i.sourceValue=r}catch(r){n=wc,i.error=r}finally{Rc(i,t)}if(e!==Sl&&n!==wc&&i.equal(e,n)){i.value=e;return}i.value=n,i.version++}});function ON(i){let e=Lt(null);try{return i()}finally{Lt(e)}}var Q0="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",Xe=class extends Error{code;constructor(e,t){super(Oa(e,t)),this.code=e}};function IG(i){return`NG0${Math.abs(i)}`}function Oa(i,e){return`${IG(i)}${e?": "+e:""}`}var Al=globalThis;function Ci(i){for(let e in i)if(i[e]===Ci)return e;throw Error("")}function UN(i,e){for(let t in e)e.hasOwnProperty(t)&&!i.hasOwnProperty(t)&&(i[t]=e[t])}function Ro(i){if(typeof i=="string")return i;if(Array.isArray(i))return`[${i.map(Ro).join(", ")}]`;if(i==null)return""+i;let e=i.overriddenName||i.name;if(e)return`${e}`;let t=i.toString();if(t==null)return""+t;let n=t.indexOf(`
`);return n>=0?t.slice(0,n):t}function K0(i,e){return i?e?`${i} ${e}`:i:e||""}var AG=Ci({__forward_ref__:Ci});function he(i){return i.__forward_ref__=he,i.toString=function(){return Ro(this())},i}function Fr(i){return pT(i)?i():i}function pT(i){return typeof i=="function"&&i.hasOwnProperty(AG)&&i.__forward_ref__===he}function VN(i,e,t,n){throw new Error(`ASSERTION ERROR: ${i}`+(n==null?"":` [Expected=> ${t} ${n} ${e} <=Actual]`))}function ge(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function xn(i){return{providers:i.providers||[],imports:i.imports||[]}}function rg(i){return PG(i,J0)}function mT(i){return rg(i)!==null}function PG(i,e){return i.hasOwnProperty(e)&&i[e]||null}function FG(i){let e=i?.[J0]??null;return e||null}function oT(i){return i&&i.hasOwnProperty(X0)?i[X0]:null}var J0=Ci({\u0275prov:Ci}),X0=Ci({\u0275inj:Ci}),me=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=ge({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function gT(i){return i&&!!i.\u0275providers}var _T=Ci({\u0275cmp:Ci}),bT=Ci({\u0275dir:Ci}),vT=Ci({\u0275pipe:Ci}),yT=Ci({\u0275mod:Ci}),tg=Ci({\u0275fac:Ci}),rd=Ci({__NG_ELEMENT_ID__:Ci}),LN=Ci({__NG_ENV_ID__:Ci});function og(i){return typeof i=="string"?i:i==null?"":String(i)}function zN(i){return typeof i=="function"?i.name||i.toString():typeof i=="object"&&i!=null&&typeof i.type=="function"?i.type.name||i.type.toString():og(i)}function xT(i,e){throw new Xe(-200,i)}function ey(i,e){throw new Xe(-201,!1)}var sT;function HN(){return sT}function io(i){let e=sT;return sT=i,e}function wT(i,e,t){let n=rg(i);if(n&&n.providedIn=="root")return n.value===void 0?n.value=n.factory():n.value;if(t&8)return null;if(e!==void 0)return e;ey(i,"Injector")}var NG={},ed=NG,jG="__NG_DI_FLAG__",aT=class{injector;constructor(e){this.injector=e}retrieve(e,t){let n=td(t)||0;try{return this.injector.get(e,n&8?null:ed,n)}catch(r){if(zu(r))return r;throw r}}},Z0="ngTempTokenPath",OG="ngTokenPath",LG=/\n/gm,kG="\u0275",kN="__source";function BG(i,e=0){let t=h0();if(t===void 0)throw new Xe(-203,!1);if(t===null)return wT(i,void 0,e);{let n=UG(e),r=t.retrieve(i,n);if(zu(r)){if(n.optional)return null;throw r}return r}}function ht(i,e=0){return(HN()||BG)(Fr(i),e)}function S(i,e){return ht(i,td(e))}function td(i){return typeof i>"u"||typeof i=="number"?i:0|(i.optional&&8)|(i.host&&1)|(i.self&&2)|(i.skipSelf&&4)}function UG(i){return{optional:!!(i&8),host:!!(i&1),self:!!(i&2),skipSelf:!!(i&4)}}function cT(i){let e=[];for(let t=0;t<i.length;t++){let n=Fr(i[t]);if(Array.isArray(n)){if(n.length===0)throw new Xe(900,!1);let r,o=0;for(let s=0;s<n.length;s++){let a=n[s],c=VG(a);typeof c=="number"?c===-1?r=a.token:o|=c:r=a}e.push(ht(r,o))}else e.push(ht(n))}return e}function VG(i){return i[jG]}function zG(i,e,t,n){let r=i[Z0];throw e[kN]&&r.unshift(e[kN]),i.message=HG(`
`+i.message,r,t,n),i[OG]=r,i[Z0]=null,i}function HG(i,e,t,n=null){i=i&&i.charAt(0)===`
`&&i.charAt(1)==kG?i.slice(2):i;let r=Ro(e);if(Array.isArray(e))r=e.map(Ro).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):Ro(a)))}r=`{${o.join(", ")}}`}return`${t}${n?"("+n+")":""}[${r}]: ${i.replace(LG,`
  `)}`}function Dl(i,e){let t=i.hasOwnProperty(tg);return t?i[tg]:null}function GN(i,e,t){if(i.length!==e.length)return!1;for(let n=0;n<i.length;n++){let r=i[n],o=e[n];if(t&&(r=t(r),o=t(o)),o!==r)return!1}return!0}function WN(i){return i.flat(Number.POSITIVE_INFINITY)}function ty(i,e){i.forEach(t=>Array.isArray(t)?ty(t,e):e(t))}function MT(i,e,t){e>=i.length?i.push(t):i.splice(e,0,t)}function sg(i,e){return e>=i.length-1?i.pop():i.splice(e,1)[0]}function $N(i,e){let t=[];for(let n=0;n<i;n++)t.push(e);return t}function qN(i,e,t,n){let r=i.length;if(r==e)i.push(t,n);else if(r===1)i.push(n,i[0]),i[0]=t;else{for(r--,i.push(i[r-1],i[r]);r>e;){let o=r-2;i[r]=i[o],r--}i[e]=t,i[e+1]=n}}function ag(i,e,t){let n=tf(i,e);return n>=0?i[n|1]=t:(n=~n,qN(i,n,e,t)),n}function ny(i,e){let t=tf(i,e);if(t>=0)return i[t|1]}function tf(i,e){return GG(i,e,1)}function GG(i,e,t){let n=0,r=i.length>>t;for(;r!==n;){let o=n+(r-n>>1),s=i[o<<t];if(e===s)return o<<t;s>e?r=o:n=o+1}return~(r<<t)}var Pl={},ro=[],Ic=new me(""),ST=new me("",-1),RT=new me(""),ng=class{get(e,t=ed){if(t===ed)throw new Vm(`NullInjectorError: No provider for ${Ro(e)}!`);return t}};function TT(i){return i[yT]||null}function La(i){return i[_T]||null}function CT(i){return i[bT]||null}function XN(i){return i[vT]||null}function Vs(i){return{\u0275providers:i}}function ZN(...i){return{\u0275providers:ET(!0,i),\u0275fromNgModule:!0}}function ET(i,...e){let t=[],n=new Set,r,o=s=>{t.push(s)};return ty(e,s=>{let a=s;Y0(a,o,[],n)&&(r||=[],r.push(a))}),r!==void 0&&YN(r,o),t}function YN(i,e){for(let t=0;t<i.length;t++){let{ngModule:n,providers:r}=i[t];DT(r,o=>{e(o,n)})}}function Y0(i,e,t,n){if(i=Fr(i),!i)return!1;let r=null,o=oT(i),s=!o&&La(i);if(!o&&!s){let c=i.ngModule;if(o=oT(c),o)r=c;else return!1}else{if(s&&!s.standalone)return!1;r=i}let a=n.has(r);if(s){if(a)return!1;if(n.add(r),s.dependencies){let c=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let l of c)Y0(l,e,t,n)}}else if(o){if(o.imports!=null&&!a){n.add(r);let l;try{ty(o.imports,u=>{Y0(u,e,t,n)&&(l||=[],l.push(u))})}finally{}l!==void 0&&YN(l,e)}if(!a){let l=Dl(r)||(()=>new r);e({provide:r,useFactory:l,deps:ro},r),e({provide:RT,useValue:r,multi:!0},r),e({provide:Ic,useValue:()=>ht(r),multi:!0},r)}let c=o.providers;if(c!=null&&!a){let l=i;DT(c,u=>{e(u,l)})}}else return!1;return r!==i&&i.providers!==void 0}function DT(i,e){for(let t of i)gT(t)&&(t=t.\u0275providers),Array.isArray(t)?DT(t,e):e(t)}var WG=Ci({provide:String,useValue:Ci});function QN(i){return i!==null&&typeof i=="object"&&WG in i}function $G(i){return!!(i&&i.useExisting)}function qG(i){return!!(i&&i.useFactory)}function nd(i){return typeof i=="function"}function KN(i){return!!i.useClass}var cg=new me(""),q0={},BN={},rT;function nf(){return rT===void 0&&(rT=new ng),rT}var Ei=class{},id=class extends Ei{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,n,r){super(),this.parent=t,this.source=n,this.scopes=r,uT(e,s=>this.processProvider(s)),this.records.set(ST,ef(void 0,this)),r.has("environment")&&this.records.set(Ei,ef(void 0,this));let o=this.records.get(cg);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(RT,ro,{self:!0}))}retrieve(e,t){let n=td(t)||0;try{return this.get(e,ed,n)}catch(r){if(zu(r))return r;throw r}}destroy(){eg(this),this._destroyed=!0;let e=Lt(null);try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of t)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Lt(e)}}onDestroy(e){return eg(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){eg(this);let t=Aa(this),n=io(void 0),r;try{return e()}finally{Aa(t),io(n)}}get(e,t=ed,n){if(eg(this),e.hasOwnProperty(LN))return e[LN](this);let r=td(n),o,s=Aa(this),a=io(void 0);try{if(!(r&4)){let l=this.records.get(e);if(l===void 0){let u=KG(e)&&rg(e);u&&this.injectableDefInScope(u)?l=ef(lT(e),q0):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l,r)}let c=r&2?nf():this.parent;return t=r&8&&t===ed?null:t,c.get(e,t)}catch(c){if(zu(c)){if((c[Z0]=c[Z0]||[]).unshift(Ro(e)),s)throw c;return zG(c,e,"R3InjectorError",this.source)}else throw c}finally{io(a),Aa(s)}}resolveInjectorInitializers(){let e=Lt(null),t=Aa(this),n=io(void 0),r;try{let o=this.get(Ic,ro,{self:!0});for(let s of o)s()}finally{Aa(t),io(n),Lt(e)}}toString(){let e=[],t=this.records;for(let n of t.keys())e.push(Ro(n));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=Fr(e);let t=nd(e)?e:Fr(e&&e.provide),n=ZG(e);if(!nd(e)&&e.multi===!0){let r=this.records.get(t);r||(r=ef(void 0,q0,!0),r.factory=()=>cT(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,n)}hydrate(e,t,n){let r=Lt(null);try{return t.value===BN?xT(Ro(e)):t.value===q0&&(t.value=BN,t.value=t.factory(void 0,n)),typeof t.value=="object"&&t.value&&QG(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Lt(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Fr(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function lT(i){let e=rg(i),t=e!==null?e.factory:Dl(i);if(t!==null)return t;if(i instanceof me)throw new Xe(204,!1);if(i instanceof Function)return XG(i);throw new Xe(204,!1)}function XG(i){if(i.length>0)throw new Xe(204,!1);let t=FG(i);return t!==null?()=>t.factory(i):()=>new i}function ZG(i){if(QN(i))return ef(void 0,i.useValue);{let e=IT(i);return ef(e,q0)}}function IT(i,e,t){let n;if(nd(i)){let r=Fr(i);return Dl(r)||lT(r)}else if(QN(i))n=()=>Fr(i.useValue);else if(qG(i))n=()=>i.useFactory(...cT(i.deps||[]));else if($G(i))n=(r,o)=>ht(Fr(i.useExisting),o!==void 0&&o&8?8:void 0);else{let r=Fr(i&&(i.useClass||i.provide));if(YG(i))n=()=>new r(...cT(i.deps));else return Dl(r)||lT(r)}return n}function eg(i){if(i.destroyed)throw new Xe(205,!1)}function ef(i,e,t=!1){return{factory:i,value:e,multi:t?[]:void 0}}function YG(i){return!!i.deps}function QG(i){return i!==null&&typeof i=="object"&&typeof i.ngOnDestroy=="function"}function KG(i){return typeof i=="function"||typeof i=="object"&&i.ngMetadataName==="InjectionToken"}function uT(i,e){for(let t of i)Array.isArray(t)?uT(t,e):t&&gT(t)?uT(t.\u0275providers,e):e(t)}function Sr(i,e){let t;i instanceof id?(eg(i),t=i):t=new aT(i);let n,r=Aa(t),o=io(void 0);try{return e()}finally{Aa(r),io(o)}}function JN(){return HN()!==void 0||h0()!=null}var zs=0,Rt=1,Ht=2,pr=3,cs=4,oo=5,od=6,rf=7,Wi=8,sd=9,ka=10,fi=11,of=12,AT=13,ad=14,so=15,Fl=16,cd=17,Ba=18,lg=19,PT=20,Dc=21,iy=22,Ac=23,zo=24,ld=25,ri=26,ej=1,FT=6,Nl=7,ug=8,ud=9,Rr=10;function Ua(i){return Array.isArray(i)&&typeof i[ej]=="object"}function Hs(i){return Array.isArray(i)&&i[ej]===!0}function NT(i){return(i.flags&4)!==0}function jl(i){return i.componentOffset>-1}function sf(i){return(i.flags&1)===1}function Va(i){return!!i.template}function af(i){return(i[Ht]&512)!==0}function dd(i){return(i[Ht]&256)===256}var tj="svg",nj="math";function ls(i){for(;Array.isArray(i);)i=i[zs];return i}function jT(i,e){return ls(e[i])}function Gs(i,e){return ls(e[i.index])}function dg(i,e){return i.data[e]}function hg(i,e){return i[e]}function fg(i,e,t,n){t>=i.data.length&&(i.data[t]=null,i.blueprint[t]=null),e[t]=n}function us(i,e){let t=e[i];return Ua(t)?t:t[zs]}function ij(i){return(i[Ht]&4)===4}function ry(i){return(i[Ht]&128)===128}function rj(i){return Hs(i[pr])}function Ho(i,e){return e==null?null:i[e]}function OT(i){i[cd]=0}function LT(i){i[Ht]&1024||(i[Ht]|=1024,ry(i)&&Ol(i))}function oj(i,e){for(;i>0;)e=e[ad],i--;return e}function pg(i){return!!(i[Ht]&9216||i[zo]?.dirty)}function oy(i){i[ka].changeDetectionScheduler?.notify(8),i[Ht]&64&&(i[Ht]|=1024),pg(i)&&Ol(i)}function Ol(i){i[ka].changeDetectionScheduler?.notify(0);let e=Il(i);for(;e!==null&&!(e[Ht]&8192||(e[Ht]|=8192,!ry(e)));)e=Il(e)}function kT(i,e){if(dd(i))throw new Xe(911,!1);i[Dc]===null&&(i[Dc]=[]),i[Dc].push(e)}function sj(i,e){if(i[Dc]===null)return;let t=i[Dc].indexOf(e);t!==-1&&i[Dc].splice(t,1)}function Il(i){let e=i[pr];return Hs(e)?e[pr]:e}function BT(i){return i[rf]??=[]}function UT(i){return i.cleanup??=[]}function aj(i,e,t,n){let r=BT(e);r.push(t),i.firstCreatePass&&UT(i).push(n,r.length-1)}var mn={lFrame:_j(null),bindingsEnabled:!0,skipHydrationRootTNode:null},mg=function(i){return i[i.Off=0]="Off",i[i.Exhaustive=1]="Exhaustive",i[i.OnlyDirtyViews=2]="OnlyDirtyViews",i}(mg||{}),JG=0,dT=!1;function cj(){return mn.lFrame.elementDepthCount}function lj(){mn.lFrame.elementDepthCount++}function VT(){mn.lFrame.elementDepthCount--}function sy(){return mn.bindingsEnabled}function zT(){return mn.skipHydrationRootTNode!==null}function HT(i){return mn.skipHydrationRootTNode===i}function GT(){mn.skipHydrationRootTNode=null}function Tt(){return mn.lFrame.lView}function pi(){return mn.lFrame.tView}function rt(i){return mn.lFrame.contextLView=i,i[Wi]}function ot(i){return mn.lFrame.contextLView=null,i}function mr(){let i=WT();for(;i!==null&&i.type===64;)i=i.parent;return i}function WT(){return mn.lFrame.currentTNode}function uj(){let i=mn.lFrame,e=i.currentTNode;return i.isParent?e:e.parent}function hd(i,e){let t=mn.lFrame;t.currentTNode=i,t.isParent=e}function $T(){return mn.lFrame.isParent}function qT(){mn.lFrame.isParent=!1}function XT(){return mn.lFrame.contextLView}function ZT(i){VN("Must never be called in production mode"),JG=i}function YT(){return dT}function cf(i){let e=dT;return dT=i,e}function Ll(){let i=mn.lFrame,e=i.bindingRootIndex;return e===-1&&(e=i.bindingRootIndex=i.tView.bindingStartIndex),e}function dj(i){return mn.lFrame.bindingIndex=i}function fd(){return mn.lFrame.bindingIndex++}function QT(i){let e=mn.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+i,t}function hj(){return mn.lFrame.inI18n}function fj(i,e){let t=mn.lFrame;t.bindingIndex=t.bindingRootIndex=i,ay(e)}function pj(){return mn.lFrame.currentDirectiveIndex}function ay(i){mn.lFrame.currentDirectiveIndex=i}function mj(i){let e=mn.lFrame.currentDirectiveIndex;return e===-1?null:i[e]}function KT(){return mn.lFrame.currentQueryIndex}function cy(i){mn.lFrame.currentQueryIndex=i}function e5(i){let e=i[Rt];return e.type===2?e.declTNode:e.type===1?i[oo]:null}function JT(i,e,t){if(t&4){let r=e,o=i;for(;r=r.parent,r===null&&!(t&1);)if(r=e5(o),r===null||(o=o[ad],r.type&10))break;if(r===null)return!1;e=r,i=o}let n=mn.lFrame=gj();return n.currentTNode=e,n.lView=i,!0}function ly(i){let e=gj(),t=i[Rt];mn.lFrame=e,e.currentTNode=t.firstChild,e.lView=i,e.tView=t,e.contextLView=i,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function gj(){let i=mn.lFrame,e=i===null?null:i.child;return e===null?_j(i):e}function _j(i){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return i!==null&&(i.child=e),e}function bj(){let i=mn.lFrame;return mn.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}var eC=bj;function uy(){let i=bj();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function vj(i){return(mn.lFrame.contextLView=oj(i,mn.lFrame.contextLView))[Wi]}function za(){return mn.lFrame.selectedIndex}function kl(i){mn.lFrame.selectedIndex=i}function dy(){let i=mn.lFrame;return dg(i.tView,i.selectedIndex)}function yj(){return mn.lFrame.currentNamespace}var xj=!0;function hy(){return xj}function gg(i){xj=i}function hT(i,e=null,t=null,n){let r=tC(i,e,t,n);return r.resolveInjectorInitializers(),r}function tC(i,e=null,t=null,n,r=new Set){let o=[t||ro,ZN(i)];return n=n||(typeof i=="object"?void 0:Ro(i)),new id(o,e||nf(),n||null,r)}var yn=class i{static THROW_IF_NOT_FOUND=ed;static NULL=new ng;static create(e,t){if(Array.isArray(e))return hT({name:""},t,e,"");{let n=e.name??"";return hT({name:n},e.parent,e.providers,n)}}static \u0275prov=ge({token:i,providedIn:"any",factory:()=>ht(ST)});static __NG_ELEMENT_ID__=-1},kt=new me(""),Nr=(()=>{class i{static __NG_ELEMENT_ID__=t5;static __NG_ENV_ID__=t=>t}return i})(),ig=class extends Nr{_lView;constructor(e){super(),this._lView=e}get destroyed(){return dd(this._lView)}onDestroy(e){let t=this._lView;return kT(t,e),()=>sj(t,e)}};function t5(){return new ig(Tt())}var Mr=class{_console=console;handleError(e){this._console.error("ERROR",e)}},ao=new me("",{providedIn:"root",factory:()=>{let i=S(Ei),e;return t=>{i.destroyed&&!e?setTimeout(()=>{throw t}):(e??=i.get(Mr),e.handleError(t))}}}),wj={provide:Ic,useValue:()=>void S(Mr),multi:!0};function lf(i){return typeof i=="function"&&i[Zi]!==void 0}function Vn(i,e){let[t,n,r]=zR(i,e?.equal),o=t,s=o[Zi];return o.set=n,o.update=r,o.asReadonly=uf.bind(o),o}function uf(){let i=this[Zi];if(i.readonlyFn===void 0){let e=()=>this();e[Zi]=i,i.readonlyFn=e}return i.readonlyFn}function nC(i){return lf(i)&&typeof i.set=="function"}var Vo=class{},df=new me("",{providedIn:"root",factory:()=>!1});var iC=new me(""),fy=new me("");var pd=(()=>{class i{view;node;constructor(t,n){this.view=t,this.node=n}static __NG_ELEMENT_ID__=n5}return i})();function n5(){return new pd(Tt(),mr())}var Pc=(()=>{class i{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new Bi(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new It(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=ge({token:i,providedIn:"root",factory:()=>new i})}return i})(),md=(()=>{class i{internalPendingTasks=S(Pc);scheduler=S(Vo);errorHandler=S(ao);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let n=this.add();t().catch(this.errorHandler).finally(n)}static \u0275prov=ge({token:i,providedIn:"root",factory:()=>new i})}return i})();function gd(...i){}var _g=(()=>{class i{static \u0275prov=ge({token:i,providedIn:"root",factory:()=>new fT})}return i})(),fT=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,n=this.queues.get(t);n.has(e)&&(n.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let n=this.queues.get(t);n.has(e)||n.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,n]of this.queues)t===null?e||=this.flushQueue(n):e||=t.run(()=>this.flushQueue(n));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let n of e)n.dirty&&(this.dirtyEffectCount--,t=!0,n.run());return t}};function Eg(i){return{toString:i}.toString()}function c5(i){return typeof i=="function"}var wy=class{previousValue;currentValue;firstChange;constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}};function oO(i,e,t,n){e!==null?e.applyValueToInputSignal(e,n):i[t]=n}var $i=(()=>{let i=()=>sO;return i.ngInherit=!0,i})();function sO(i){return i.type.prototype.ngOnChanges&&(i.setInput=u5),l5}function l5(){let i=cO(this),e=i?.current;if(e){let t=i.previous;if(t===Pl)i.previous=e;else for(let n in e)t[n]=e[n];i.current=null,this.ngOnChanges(e)}}function u5(i,e,t,n,r){let o=this.declaredInputs[n],s=cO(i)||d5(i,{previous:Pl,current:null}),a=s.current||(s.current={}),c=s.previous,l=c[o];a[o]=new wy(l&&l.currentValue,t,c===Pl),oO(i,e,r,t)}var aO="__ngSimpleChanges__";function cO(i){return i[aO]||null}function d5(i,e){return i[aO]=e}var Mj=[];var Xn=function(i,e=null,t){for(let n=0;n<Mj.length;n++){let r=Mj[n];r(i,e,t)}};function h5(i,e,t){let{ngOnChanges:n,ngOnInit:r,ngDoCheck:o}=e.type.prototype;if(n){let s=sO(e);(t.preOrderHooks??=[]).push(i,s),(t.preOrderCheckHooks??=[]).push(i,s)}r&&(t.preOrderHooks??=[]).push(0-i,r),o&&((t.preOrderHooks??=[]).push(i,o),(t.preOrderCheckHooks??=[]).push(i,o))}function lO(i,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){let o=i.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=o;s&&(i.contentHooks??=[]).push(-t,s),a&&((i.contentHooks??=[]).push(t,a),(i.contentCheckHooks??=[]).push(t,a)),c&&(i.viewHooks??=[]).push(-t,c),l&&((i.viewHooks??=[]).push(t,l),(i.viewCheckHooks??=[]).push(t,l)),u!=null&&(i.destroyHooks??=[]).push(t,u)}}function by(i,e,t){uO(i,e,3,t)}function vy(i,e,t,n){(i[Ht]&3)===t&&uO(i,e,t,n)}function rC(i,e){let t=i[Ht];(t&3)===e&&(t&=16383,t+=1,i[Ht]=t)}function uO(i,e,t,n){let r=n!==void 0?i[cd]&65535:0,o=n??-1,s=e.length-1,a=0;for(let c=r;c<s;c++)if(typeof e[c+1]=="number"){if(a=e[c],n!=null&&a>=n)break}else e[c]<0&&(i[cd]+=65536),(a<o||o==-1)&&(f5(i,t,e,c),i[cd]=(i[cd]&4294901760)+c+2),c++}function Sj(i,e){Xn(4,i,e);let t=Lt(null);try{e.call(i)}finally{Lt(t),Xn(5,i,e)}}function f5(i,e,t,n){let r=t[n]<0,o=t[n+1],s=r?-t[n]:t[n],a=i[s];r?i[Ht]>>14<i[cd]>>16&&(i[Ht]&3)===e&&(i[Ht]+=16384,Sj(a,o)):Sj(a,o)}var ff=-1,bd=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,n){this.factory=e,this.canSeeViewProviders=t,this.injectImpl=n}};function p5(i){return(i.flags&8)!==0}function m5(i){return(i.flags&16)!==0}function g5(i,e,t){let n=0;for(;n<t.length;){let r=t[n];if(typeof r=="number"){if(r!==0)break;n++;let o=t[n++],s=t[n++],a=t[n++];i.setAttribute(e,s,a,o)}else{let o=r,s=t[++n];_5(o)?i.setProperty(e,o,s):i.setAttribute(e,o,s),n++}}return n}function dO(i){return i===3||i===4||i===6}function _5(i){return i.charCodeAt(0)===64}function pf(i,e){if(!(e===null||e.length===0))if(i===null||i.length===0)i=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){let r=e[n];typeof r=="number"?t=r:t===0||(t===-1||t===2?Rj(i,t,r,null,e[++n]):Rj(i,t,r,null,null))}}return i}function Rj(i,e,t,n,r){let o=0,s=i.length;if(e===-1)s=-1;else for(;o<i.length;){let a=i[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<i.length;){let a=i[o];if(typeof a=="number")break;if(a===t){r!==null&&(i[o+1]=r);return}o++,r!==null&&o++}s!==-1&&(i.splice(s,0,e),o=s+1),i.splice(o++,0,t),r!==null&&i.splice(o++,0,r)}function hO(i){return i!==ff}function My(i){return i&32767}function b5(i){return i>>16}function Sy(i,e){let t=b5(i),n=e;for(;t>0;)n=n[ad],t--;return n}var mC=!0;function Ry(i){let e=mC;return mC=i,e}var v5=256,fO=v5-1,pO=5,y5=0,Ha={};function x5(i,e,t){let n;typeof t=="string"?n=t.charCodeAt(0)||0:t.hasOwnProperty(rd)&&(n=t[rd]),n==null&&(n=t[rd]=y5++);let r=n&fO,o=1<<r;e.data[i+(r>>pO)]|=o}function Ty(i,e){let t=mO(i,e);if(t!==-1)return t;let n=e[Rt];n.firstCreatePass&&(i.injectorIndex=e.length,oC(n.data,i),oC(e,null),oC(n.blueprint,null));let r=JC(i,e),o=i.injectorIndex;if(hO(r)){let s=My(r),a=Sy(r,e),c=a[Rt].data;for(let l=0;l<8;l++)e[o+l]=a[s+l]|c[s+l]}return e[o+8]=r,o}function oC(i,e){i.push(0,0,0,0,0,0,0,0,e)}function mO(i,e){return i.injectorIndex===-1||i.parent&&i.parent.injectorIndex===i.injectorIndex||e[i.injectorIndex+8]===null?-1:i.injectorIndex}function JC(i,e){if(i.parent&&i.parent.injectorIndex!==-1)return i.parent.injectorIndex;let t=0,n=null,r=e;for(;r!==null;){if(n=yO(r),n===null)return ff;if(t++,r=r[ad],n.injectorIndex!==-1)return n.injectorIndex|t<<16}return ff}function gC(i,e,t){x5(i,e,t)}function w5(i,e){if(e==="class")return i.classes;if(e==="style")return i.styles;let t=i.attrs;if(t){let n=t.length,r=0;for(;r<n;){let o=t[r];if(dO(o))break;if(o===0)r=r+2;else if(typeof o=="number")for(r++;r<n&&typeof t[r]=="string";)r++;else{if(o===e)return t[r+1];r=r+2}}}return null}function gO(i,e,t){if(t&8||i!==void 0)return i;ey(e,"NodeInjector")}function _O(i,e,t,n){if(t&8&&n===void 0&&(n=null),(t&3)===0){let r=i[sd],o=io(void 0);try{return r?r.get(e,n,t&8):wT(e,n,t&8)}finally{io(o)}}return gO(n,e,t)}function bO(i,e,t,n=0,r){if(i!==null){if(e[Ht]&2048&&!(n&2)){let s=T5(i,e,t,n,Ha);if(s!==Ha)return s}let o=vO(i,e,t,n,Ha);if(o!==Ha)return o}return _O(e,t,n,r)}function vO(i,e,t,n,r){let o=S5(t);if(typeof o=="function"){if(!JT(e,i,n))return n&1?gO(r,t,n):_O(e,t,n,r);try{let s;if(s=o(n),s==null&&!(n&8))ey(t);else return s}finally{eC()}}else if(typeof o=="number"){let s=null,a=mO(i,e),c=ff,l=n&1?e[so][oo]:null;for((a===-1||n&4)&&(c=a===-1?JC(i,e):e[a+8],c===ff||!Cj(n,!1)?a=-1:(s=e[Rt],a=My(c),e=Sy(c,e)));a!==-1;){let u=e[Rt];if(Tj(o,a,u.data)){let d=M5(a,e,t,s,n,l);if(d!==Ha)return d}c=e[a+8],c!==ff&&Cj(n,e[Rt].data[a+8]===l)&&Tj(o,a,e)?(s=u,a=My(c),e=Sy(c,e)):a=-1}}return r}function M5(i,e,t,n,r,o){let s=e[Rt],a=s.data[i+8],c=n==null?jl(a)&&mC:n!=s&&(a.type&3)!==0,l=r&1&&o===a,u=yy(a,s,t,c,l);return u!==null?yg(e,s,u,a,r):Ha}function yy(i,e,t,n,r){let o=i.providerIndexes,s=e.data,a=o&1048575,c=i.directiveStart,l=i.directiveEnd,u=o>>20,d=n?a:a+u,h=r?a+u:l;for(let f=d;f<h;f++){let g=s[f];if(f<c&&t===g||f>=c&&g.type===t)return f}if(r){let f=s[c];if(f&&Va(f)&&f.type===t)return c}return null}function yg(i,e,t,n,r){let o=i[t],s=e.data;if(o instanceof bd){let a=o;a.resolving&&xT(zN(s[t]));let c=Ry(a.canSeeViewProviders);a.resolving=!0;let l=s[t].type||s[t],u,d=a.injectImpl?io(a.injectImpl):null,h=JT(i,n,0);try{o=i[t]=a.factory(void 0,r,s,i,n),e.firstCreatePass&&t>=n.directiveStart&&h5(t,s[t],e)}finally{d!==null&&io(d),Ry(c),a.resolving=!1,eC()}}return o}function S5(i){if(typeof i=="string")return i.charCodeAt(0)||0;let e=i.hasOwnProperty(rd)?i[rd]:void 0;return typeof e=="number"?e>=0?e&fO:R5:e}function Tj(i,e,t){let n=1<<i;return!!(t[e+(i>>pO)]&n)}function Cj(i,e){return!(i&2)&&!(i&1&&e)}var _d=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return bO(this._tNode,this._lView,e,td(n),t)}};function R5(){return new _d(mr(),Tt())}function q(i){return Eg(()=>{let e=i.prototype.constructor,t=e[tg]||_C(e),n=Object.prototype,r=Object.getPrototypeOf(i.prototype).constructor;for(;r&&r!==n;){let o=r[tg]||_C(r);if(o&&o!==t)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function _C(i){return pT(i)?()=>{let e=_C(Fr(i));return e&&e()}:Dl(i)}function T5(i,e,t,n,r){let o=i,s=e;for(;o!==null&&s!==null&&s[Ht]&2048&&!af(s);){let a=vO(o,s,t,n|2,Ha);if(a!==Ha)return a;let c=o.parent;if(!c){let l=s[PT];if(l){let u=l.get(t,Ha,n);if(u!==Ha)return u}c=yO(s),s=s[ad]}o=c}return r}function yO(i){let e=i[Rt],t=e.type;return t===2?e.declTNode:t===1?i[oo]:null}function Dg(i){return w5(mr(),i)}function C5(){return yf(mr(),Tt())}function yf(i,e){return new vt(Gs(i,e))}var vt=(()=>{class i{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=C5}return i})();function E5(i){return i instanceof vt?i.nativeElement:i}function D5(){return this._results[Symbol.iterator]()}var $s=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new lt}constructor(e=!1){this._emitDistinctChangesOnly=e}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let n=WN(e);(this._changesDetected=!GN(this._results,n,t))&&(this._results=n,this.length=n.length,this.last=n[this.length-1],this.first=n[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=D5};function xO(i){return(i.flags&128)===128}var eE=function(i){return i[i.OnPush=0]="OnPush",i[i.Default=1]="Default",i}(eE||{}),wO=new Map,I5=0;function A5(){return I5++}function P5(i){wO.set(i[lg],i)}function bC(i){wO.delete(i[lg])}var Ej="__ngContext__";function mf(i,e){Ua(e)?(i[Ej]=e[lg],P5(e)):i[Ej]=e}function MO(i){return RO(i[of])}function SO(i){return RO(i[cs])}function RO(i){for(;i!==null&&!Hs(i);)i=i[cs];return i}var vC;function tE(i){vC=i}function TO(){if(vC!==void 0)return vC;if(typeof document<"u")return document;throw new Xe(210,!1)}var xf=new me("",{providedIn:"root",factory:()=>F5}),F5="ng",Uy=new me(""),$a=new me("",{providedIn:"platform",factory:()=>"unknown"});var nE=new me(""),wf=new me("",{providedIn:"root",factory:()=>TO().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var N5="h",j5="b";var CO="r";var EO="di";var DO=!1,IO=new me("",{providedIn:"root",factory:()=>DO});var O5=(i,e,t,n)=>{};function L5(i,e,t,n){O5(i,e,t,n)}function Vy(i){return(i.flags&32)===32}var k5=()=>null;function AO(i,e,t=!1){return k5(i,e,t)}function PO(i,e){let t=i.contentQueries;if(t!==null){let n=Lt(null);try{for(let r=0;r<t.length;r+=2){let o=t[r],s=t[r+1];if(s!==-1){let a=i.data[s];cy(o),a.contentQueries(2,e[s],s)}}}finally{Lt(n)}}}function yC(i,e,t){cy(0);let n=Lt(null);try{e(i,t)}finally{Lt(n)}}function iE(i,e,t){if(NT(e)){let n=Lt(null);try{let r=e.directiveStart,o=e.directiveEnd;for(let s=r;s<o;s++){let a=i.data[s];if(a.contentQueries){let c=t[s];a.contentQueries(1,c,s)}}}finally{Lt(n)}}}var Fc=function(i){return i[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",i}(Fc||{}),py;function FO(){if(py===void 0&&(py=null,Al.trustedTypes))try{py=Al.trustedTypes.createPolicy("angular",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch{}return py}function zy(i){return FO()?.createHTML(i)||i}function B5(i){return FO()?.createScriptURL(i)||i}var my;function U5(){if(my===void 0&&(my=null,Al.trustedTypes))try{my=Al.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:i=>i,createScript:i=>i,createScriptURL:i=>i})}catch{}return my}function Dj(i){return U5()?.createScriptURL(i)||i}var Nc=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Q0})`}},xC=class extends Nc{getTypeName(){return"HTML"}},wC=class extends Nc{getTypeName(){return"Style"}},MC=class extends Nc{getTypeName(){return"Script"}},SC=class extends Nc{getTypeName(){return"URL"}},RC=class extends Nc{getTypeName(){return"ResourceURL"}};function Go(i){return i instanceof Nc?i.changingThisBreaksApplicationSecurity:i}function jc(i,e){let t=NO(i);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${Q0})`)}return t===e}function NO(i){return i instanceof Nc&&i.getTypeName()||null}function rE(i){return new xC(i)}function oE(i){return new wC(i)}function sE(i){return new MC(i)}function aE(i){return new SC(i)}function cE(i){return new RC(i)}function V5(i){let e=new CC(i);return z5()?new TC(e):e}var TC=class{inertDocumentHelper;constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{let t=new window.DOMParser().parseFromString(zy(e),"text/html").body;return t===null?this.inertDocumentHelper.getInertBodyElement(e):(t.firstChild?.remove(),t)}catch{return null}}},CC=class{defaultDoc;inertDocument;constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){let t=this.inertDocument.createElement("template");return t.innerHTML=zy(e),t}};function z5(){try{return!!new window.DOMParser().parseFromString(zy(""),"text/html")}catch{return!1}}var H5=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Ig(i){return i=String(i),i.match(H5)?i:"unsafe:"+i}function Oc(i){let e={};for(let t of i.split(","))e[t]=!0;return e}function Ag(...i){let e={};for(let t of i)for(let n in t)t.hasOwnProperty(n)&&(e[n]=!0);return e}var jO=Oc("area,br,col,hr,img,wbr"),OO=Oc("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),LO=Oc("rp,rt"),G5=Ag(LO,OO),W5=Ag(OO,Oc("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),$5=Ag(LO,Oc("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Ij=Ag(jO,W5,$5,G5),kO=Oc("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),q5=Oc("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),X5=Oc("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext"),Z5=Ag(kO,q5,X5),Y5=Oc("script,style,template"),EC=class{sanitizedSomething=!1;buf=[];sanitizeChildren(e){let t=e.firstChild,n=!0,r=[];for(;t;){if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild){r.push(t),t=J5(t);continue}for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let o=K5(t);if(o){t=o;break}t=r.pop()}}return this.buf.join("")}startElement(e){let t=Aj(e).toLowerCase();if(!Ij.hasOwnProperty(t))return this.sanitizedSomething=!0,!Y5.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);let n=e.attributes;for(let r=0;r<n.length;r++){let o=n.item(r),s=o.name,a=s.toLowerCase();if(!Z5.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let c=o.value;kO[a]&&(c=Ig(c)),this.buf.push(" ",s,'="',Pj(c),'"')}return this.buf.push(">"),!0}endElement(e){let t=Aj(e).toLowerCase();Ij.hasOwnProperty(t)&&!jO.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(Pj(e))}};function Q5(i,e){return(i.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}function K5(i){let e=i.nextSibling;if(e&&i!==e.previousSibling)throw BO(e);return e}function J5(i){let e=i.firstChild;if(e&&Q5(i,e))throw BO(e);return e}function Aj(i){let e=i.nodeName;return typeof e=="string"?e:"FORM"}function BO(i){return new Error(`Failed to sanitize html because the element is clobbered: ${i.outerHTML}`)}var eW=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,tW=/([^\#-~ |!])/g;function Pj(i){return i.replace(/&/g,"&amp;").replace(eW,function(e){let t=e.charCodeAt(0),n=e.charCodeAt(1);return"&#"+((t-55296)*1024+(n-56320)+65536)+";"}).replace(tW,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var gy;function lE(i,e){let t=null;try{gy=gy||V5(i);let n=e?String(e):"";t=gy.getInertBodyElement(n);let r=5,o=n;do{if(r===0)throw new Error("Failed to sanitize html because the input is unstable");r--,n=o,o=t.innerHTML,t=gy.getInertBodyElement(n)}while(n!==o);let a=new EC().sanitizeChildren(Fj(t)||t);return zy(a)}finally{if(t){let n=Fj(t)||t;for(;n.firstChild;)n.firstChild.remove()}}}function Fj(i){return"content"in i&&nW(i)?i.content:null}function nW(i){return i.nodeType===Node.ELEMENT_NODE&&i.nodeName==="TEMPLATE"}var _r=function(i){return i[i.NONE=0]="NONE",i[i.HTML=1]="HTML",i[i.STYLE=2]="STYLE",i[i.SCRIPT=3]="SCRIPT",i[i.URL=4]="URL",i[i.RESOURCE_URL=5]="RESOURCE_URL",i}(_r||{});function UO(i){let e=zO();return e?e.sanitize(_r.URL,i)||"":jc(i,"URL")?Go(i):Ig(og(i))}function VO(i){let e=zO();if(e)return Dj(e.sanitize(_r.RESOURCE_URL,i)||"");if(jc(i,"ResourceURL"))return Dj(Go(i));throw new Xe(904,!1)}function Pg(i){return B5(i[0])}function iW(i,e){return e==="src"&&(i==="embed"||i==="frame"||i==="iframe"||i==="media"||i==="script")||e==="href"&&(i==="base"||i==="link")?VO:UO}function uE(i,e,t){return iW(e,t)(i)}function zO(){let i=Tt();return i&&i[ka].sanitizer}var rW=/^>|^->|<!--|-->|--!>|<!-$/g,oW=/(<|>)/g,sW="\u200B$1\u200B";function aW(i){return i.replace(rW,e=>e.replace(oW,sW))}function Hy(i){return i.ownerDocument.defaultView}function yd(i){return i.ownerDocument}function HO(i){return i instanceof Function?i():i}function cW(i,e,t){let n=i.length;for(;;){let r=i.indexOf(e,t);if(r===-1)return r;if(r===0||i.charCodeAt(r-1)<=32){let o=e.length;if(r+o===n||i.charCodeAt(r+o)<=32)return r}t=r+1}}var GO="ng-template";function lW(i,e,t,n){let r=0;if(n){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&cW(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(dE(i))return!1;if(r=e.indexOf(1,r),r>-1){let o;for(;++r<e.length&&typeof(o=e[r])=="string";)if(o.toLowerCase()===t)return!0}return!1}function dE(i){return i.type===4&&i.value!==GO}function uW(i,e,t){let n=i.type===4&&!t?GO:i.value;return e===n}function dW(i,e,t){let n=4,r=i.attrs,o=r!==null?pW(r):0,s=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!s&&!Ws(n)&&!Ws(c))return!1;if(s&&Ws(c))continue;s=!1,n=c|n&1;continue}if(!s)if(n&4){if(n=2|n&1,c!==""&&!uW(i,c,t)||c===""&&e.length===1){if(Ws(n))return!1;s=!0}}else if(n&8){if(r===null||!lW(i,r,c,t)){if(Ws(n))return!1;s=!0}}else{let l=e[++a],u=hW(c,r,dE(i),t);if(u===-1){if(Ws(n))return!1;s=!0;continue}if(l!==""){let d;if(u>o?d="":d=r[u+1].toLowerCase(),n&2&&l!==d){if(Ws(n))return!1;s=!0}}}}return Ws(n)||s}function Ws(i){return(i&1)===0}function hW(i,e,t,n){if(e===null)return-1;let r=0;if(n||!t){let o=!1;for(;r<e.length;){let s=e[r];if(s===i)return r;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(s===4)break;if(s===0){r+=4;continue}}r+=o?1:2}return-1}else return mW(e,i)}function WO(i,e,t=!1){for(let n=0;n<e.length;n++)if(dW(i,e[n],t))return!0;return!1}function fW(i){let e=i.attrs;if(e!=null){let t=e.indexOf(5);if((t&1)===0)return e[t+1]}return null}function pW(i){for(let e=0;e<i.length;e++){let t=i[e];if(dO(t))return e}return i.length}function mW(i,e){let t=i.indexOf(4);if(t>-1)for(t++;t<i.length;){let n=i[t];if(typeof n=="number")return-1;if(n===e)return t;t++}return-1}function gW(i,e){e:for(let t=0;t<e.length;t++){let n=e[t];if(i.length===n.length){for(let r=0;r<i.length;r++)if(i[r]!==n[r])continue e;return!0}}return!1}function Nj(i,e){return i?":not("+e.trim()+")":e}function _W(i){let e=i[0],t=1,n=2,r="",o=!1;for(;t<i.length;){let s=i[t];if(typeof s=="string")if(n&2){let a=i[++t];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else n&8?r+="."+s:n&4&&(r+=" "+s);else r!==""&&!Ws(s)&&(e+=Nj(o,r),r=""),n=s,o=o||!Ws(n);t++}return r!==""&&(e+=Nj(o,r)),e}function bW(i){return i.map(_W).join(",")}function vW(i){let e=[],t=[],n=1,r=2;for(;n<i.length;){let o=i[n];if(typeof o=="string")r===2?o!==""&&e.push(o,i[++n]):r===8&&t.push(o);else{if(!Ws(r))break;r=o}n++}return t.length&&e.push(1,...t),e}var Wo={};function yW(i,e){return i.createText(e)}function xW(i,e,t){i.setValue(e,t)}function wW(i,e){return i.createComment(aW(e))}function $O(i,e,t){return i.createElement(e,t)}function Cy(i,e,t,n,r){i.insertBefore(e,t,n,r)}function qO(i,e,t){i.appendChild(e,t)}function jj(i,e,t,n,r){n!==null?Cy(i,e,t,n,r):qO(i,e,t)}function XO(i,e,t){i.removeChild(null,e,t)}function MW(i,e,t){i.setAttribute(e,"style",t)}function SW(i,e,t){t===""?i.removeAttribute(e,"class"):i.setAttribute(e,"class",t)}function ZO(i,e,t){let{mergedAttrs:n,classes:r,styles:o}=t;n!==null&&g5(i,e,n),r!==null&&SW(i,e,r),o!==null&&MW(i,e,o)}function hE(i,e,t,n,r,o,s,a,c,l,u){let d=ri+n,h=d+r,f=RW(d,h),g=typeof l=="function"?l():l;return f[Rt]={type:i,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:c,consts:g,incompleteFirstPass:!1,ssrId:u}}function RW(i,e){let t=[];for(let n=0;n<e;n++)t.push(n<i?null:Wo);return t}function TW(i){let e=i.tView;return e===null||e.incompleteFirstPass?i.tView=hE(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts,i.id):e}function fE(i,e,t,n,r,o,s,a,c,l,u){let d=e.blueprint.slice();return d[zs]=r,d[Ht]=n|4|128|8|64|1024,(l!==null||i&&i[Ht]&2048)&&(d[Ht]|=2048),OT(d),d[pr]=d[ad]=i,d[Wi]=t,d[ka]=s||i&&i[ka],d[fi]=a||i&&i[fi],d[sd]=c||i&&i[sd]||null,d[oo]=o,d[lg]=A5(),d[od]=u,d[PT]=l,d[so]=e.type==2?i[so]:d,d}function CW(i,e,t){let n=Gs(e,i),r=TW(t),o=i[ka].rendererFactory,s=pE(i,fE(i,r,null,YO(t),n,e,null,o.createRenderer(n,t),null,null,null));return i[e.index]=s}function YO(i){let e=16;return i.signals?e=4096:i.onPush&&(e=64),e}function QO(i,e,t,n){if(t===0)return-1;let r=e.length;for(let o=0;o<t;o++)e.push(n),i.blueprint.push(n),i.data.push(null);return r}function pE(i,e){return i[of]?i[AT][cs]=e:i[of]=e,i[AT]=e,e}function F(i=1){KO(pi(),Tt(),za()+i,!1)}function KO(i,e,t,n){if(!n)if((e[Ht]&3)===3){let o=i.preOrderCheckHooks;o!==null&&by(e,o,t)}else{let o=i.preOrderHooks;o!==null&&vy(e,o,0,t)}kl(t)}var Gy=function(i){return i[i.None=0]="None",i[i.SignalBased=1]="SignalBased",i[i.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",i}(Gy||{});function DC(i,e,t,n){let r=Lt(null);try{let[o,s,a]=i.inputs[t],c=null;(s&Gy.SignalBased)!==0&&(c=e[o][Zi]),c!==null&&c.transformFn!==void 0?n=c.transformFn(n):a!==null&&(n=a.call(e,n)),i.setInput!==null?i.setInput(e,c,n,t,o):oO(e,c,o,n)}finally{Lt(r)}}var Ga=function(i){return i[i.Important=1]="Important",i[i.DashCase=2]="DashCase",i}(Ga||{}),EW;function mE(i,e){return EW(i,e)}function hf(i,e,t,n,r){if(n!=null){let o,s=!1;Hs(n)?o=n:Ua(n)&&(s=!0,n=n[zs]);let a=ls(n);i===0&&t!==null?r==null?qO(e,t,a):Cy(e,t,a,r||null,!0):i===1&&t!==null?Cy(e,t,a,r||null,!0):i===2?XO(e,a,s):i===3&&e.destroyNode(a),o!=null&&kW(e,i,o,t,r)}}function DW(i,e){JO(i,e),e[zs]=null,e[oo]=null}function IW(i,e,t,n,r,o){n[zs]=r,n[oo]=e,$y(i,n,t,1,r,o)}function JO(i,e){e[ka].changeDetectionScheduler?.notify(9),$y(i,e,e[fi],2,null,null)}function AW(i){let e=i[of];if(!e)return sC(i[Rt],i);for(;e;){let t=null;if(Ua(e))t=e[of];else{let n=e[Rr];n&&(t=n)}if(!t){for(;e&&!e[cs]&&e!==i;)Ua(e)&&sC(e[Rt],e),e=e[pr];e===null&&(e=i),Ua(e)&&sC(e[Rt],e),t=e&&e[cs]}e=t}}function gE(i,e){let t=i[ud],n=t.indexOf(e);t.splice(n,1)}function Wy(i,e){if(dd(e))return;let t=e[fi];t.destroyNode&&$y(i,e,t,3,null,null),AW(e)}function sC(i,e){if(dd(e))return;let t=Lt(null);try{e[Ht]&=-129,e[Ht]|=256,e[zo]&&Hh(e[zo]),FW(i,e),PW(i,e),e[Rt].type===1&&e[fi].destroy();let n=e[Fl];if(n!==null&&Hs(e[pr])){n!==e[pr]&&gE(n,e);let r=e[Ba];r!==null&&r.detachView(i)}bC(e)}finally{Lt(t)}}function PW(i,e){let t=i.cleanup,n=e[rf];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?n[a]():n[-a].unsubscribe(),s+=2}else{let a=n[t[s+1]];t[s].call(a)}n!==null&&(e[rf]=null);let r=e[Dc];if(r!==null){e[Dc]=null;for(let s=0;s<r.length;s++){let a=r[s];a()}}let o=e[Ac];if(o!==null){e[Ac]=null;for(let s of o)s.destroy()}}function FW(i,e){let t;if(i!=null&&(t=i.destroyHooks)!=null)for(let n=0;n<t.length;n+=2){let r=e[t[n]];if(!(r instanceof bd)){let o=t[n+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=r[o[s]],c=o[s+1];Xn(4,a,c);try{c.call(a)}finally{Xn(5,a,c)}}else{Xn(4,r,o);try{o.call(r)}finally{Xn(5,r,o)}}}}}function eL(i,e,t){return NW(i,e.parent,t)}function NW(i,e,t){let n=e;for(;n!==null&&n.type&168;)e=n,n=e.parent;if(n===null)return t[zs];if(jl(n)){let{encapsulation:r}=i.data[n.directiveStart+n.componentOffset];if(r===Fc.None||r===Fc.Emulated)return null}return Gs(n,t)}function tL(i,e,t){return OW(i,e,t)}function jW(i,e,t){return i.type&40?Gs(i,t):null}var OW=jW,Oj;function _E(i,e,t,n){let r=eL(i,n,e),o=e[fi],s=n.parent||e[oo],a=tL(s,n,e);if(r!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)jj(o,r,t[c],a,!1);else jj(o,r,t,a,!1);Oj!==void 0&&Oj(o,n,e,t,r)}function bg(i,e){if(e!==null){let t=e.type;if(t&3)return Gs(e,i);if(t&4)return IC(-1,i[e.index]);if(t&8){let n=e.child;if(n!==null)return bg(i,n);{let r=i[e.index];return Hs(r)?IC(-1,r):ls(r)}}else{if(t&128)return bg(i,e.next);if(t&32)return mE(e,i)()||ls(i[e.index]);{let n=nL(i,e);if(n!==null){if(Array.isArray(n))return n[0];let r=Il(i[so]);return bg(r,n)}else return bg(i,e.next)}}}return null}function nL(i,e){if(e!==null){let n=i[so][oo],r=e.projection;return n.projection[r]}return null}function IC(i,e){let t=Rr+i+1;if(t<e.length){let n=e[t],r=n[Rt].firstChild;if(r!==null)return bg(n,r)}return e[Nl]}function bE(i,e,t,n,r,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=n[t.index],c=t.type;if(s&&e===0&&(a&&mf(ls(a),n),t.flags|=2),!Vy(t))if(c&8)bE(i,e,t.child,n,r,o,!1),hf(e,i,r,a,o);else if(c&32){let l=mE(t,n),u;for(;u=l();)hf(e,i,r,u,o);hf(e,i,r,a,o)}else c&16?iL(i,e,n,t,r,o):hf(e,i,r,a,o);t=s?t.projectionNext:t.next}}function $y(i,e,t,n,r,o){bE(t,n,i.firstChild,e,r,o,!1)}function LW(i,e,t){let n=e[fi],r=eL(i,t,e),o=t.parent||e[oo],s=tL(o,t,e);iL(n,0,e,t,r,s)}function iL(i,e,t,n,r,o){let s=t[so],c=s[oo].projection[n.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let u=c[l];hf(e,i,r,u,o)}else{let l=c,u=s[pr];xO(n)&&(l.flags|=128),bE(i,e,l,u,r,o,!0)}}function kW(i,e,t,n,r){let o=t[Nl],s=ls(t);o!==s&&hf(e,i,n,o,r);for(let a=Rr;a<t.length;a++){let c=t[a];$y(c[Rt],c,i,e,n,o)}}function BW(i,e,t,n,r){if(e)r?i.addClass(t,n):i.removeClass(t,n);else{let o=n.indexOf("-")===-1?void 0:Ga.DashCase;r==null?i.removeStyle(t,n,o):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=Ga.Important),i.setStyle(t,n,r,o))}}function rL(i,e,t,n,r){let o=za(),s=n&2;try{kl(-1),s&&e.length>ri&&KO(i,e,ri,!1),Xn(s?2:0,r,t),t(n,r)}finally{kl(o),Xn(s?3:1,r,t)}}function qy(i,e,t){$W(i,e,t),(t.flags&64)===64&&qW(i,e,t)}function Fg(i,e,t=Gs){let n=e.localNames;if(n!==null){let r=e.index+1;for(let o=0;o<n.length;o+=2){let s=n[o+1],a=s===-1?t(e,i):i[s];i[r++]=a}}}function UW(i,e,t,n){let o=n.get(IO,DO)||t===Fc.ShadowDom,s=i.selectRootElement(e,o);return VW(s),s}function VW(i){zW(i)}var zW=()=>null;function HW(i){return i==="class"?"className":i==="for"?"htmlFor":i==="formaction"?"formAction":i==="innerHtml"?"innerHTML":i==="readonly"?"readOnly":i==="tabindex"?"tabIndex":i}function oL(i,e,t,n,r,o){let s=e[Rt];if(wE(i,s,e,t,n)){jl(i)&&WW(e,i.index);return}i.type&3&&(t=HW(t)),GW(i,e,t,n,r,o)}function GW(i,e,t,n,r,o){if(i.type&3){let s=Gs(i,e);n=o!=null?o(n,i.value||"",t):n,r.setProperty(s,t,n)}else i.type&12}function WW(i,e){let t=us(e,i);t[Ht]&16||(t[Ht]|=64)}function $W(i,e,t){let n=t.directiveStart,r=t.directiveEnd;jl(t)&&CW(e,t,i.data[n+t.componentOffset]),i.firstCreatePass||Ty(t,e);let o=t.initialInputs;for(let s=n;s<r;s++){let a=i.data[s],c=yg(e,i,s,t);if(mf(c,e),o!==null&&QW(e,s-n,c,a,t,o),Va(a)){let l=us(t.index,e);l[Wi]=yg(e,i,s,t)}}}function qW(i,e,t){let n=t.directiveStart,r=t.directiveEnd,o=t.index,s=pj();try{kl(o);for(let a=n;a<r;a++){let c=i.data[a],l=e[a];ay(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&XW(c,l)}}finally{kl(-1),ay(s)}}function XW(i,e){i.hostBindings!==null&&i.hostBindings(1,e)}function vE(i,e){let t=i.directiveRegistry,n=null;if(t)for(let r=0;r<t.length;r++){let o=t[r];WO(e,o.selectors,!1)&&(n??=[],Va(o)?n.unshift(o):n.push(o))}return n}function ZW(i,e,t,n,r,o){let s=Gs(i,e);YW(e[fi],s,o,i.value,t,n,r)}function YW(i,e,t,n,r,o,s){if(o==null)i.removeAttribute(e,r,t);else{let a=s==null?og(o):s(o,n||"",r);i.setAttribute(e,r,a,t)}}function QW(i,e,t,n,r,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;a+=2){let c=s[a],l=s[a+1];DC(n,t,c,l)}}function yE(i,e,t,n,r){let o=ri+t,s=e[Rt],a=r(s,e,i,n,t);e[o]=a,hd(i,!0);let c=i.type===2;return c?(ZO(e[fi],a,i),(cj()===0||sf(i))&&mf(a,e),lj()):mf(a,e),hy()&&(!c||!Vy(i))&&_E(s,e,a,i),i}function xE(i){let e=i;return $T()?qT():(e=e.parent,hd(e,!1)),e}function KW(i,e){let t=i[sd];if(!t)return;t.get(ao,null)?.(e)}function wE(i,e,t,n,r){let o=i.inputs?.[n],s=i.hostDirectiveInputs?.[n],a=!1;if(s)for(let c=0;c<s.length;c+=2){let l=s[c],u=s[c+1],d=e.data[l];DC(d,t[l],u,r),a=!0}if(o)for(let c of o){let l=t[c],u=e.data[c];DC(u,l,n,r),a=!0}return a}function JW(i,e){let t=us(e,i),n=t[Rt];e8(n,t);let r=t[zs];r!==null&&t[od]===null&&(t[od]=AO(r,t[sd])),Xn(18),ME(n,t,t[Wi]),Xn(19,t[Wi])}function e8(i,e){for(let t=e.length;t<i.blueprint.length;t++)e.push(i.blueprint[t])}function ME(i,e,t){ly(e);try{let n=i.viewQuery;n!==null&&yC(1,n,t);let r=i.template;r!==null&&rL(i,e,r,1,t),i.firstCreatePass&&(i.firstCreatePass=!1),e[Ba]?.finishViewCreation(i),i.staticContentQueries&&PO(i,e),i.staticViewQueries&&yC(2,i.viewQuery,t);let o=i.components;o!==null&&t8(e,o)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{e[Ht]&=-5,uy()}}function t8(i,e){for(let t=0;t<e.length;t++)JW(i,e[t])}function Ng(i,e,t,n){let r=Lt(null);try{let o=e.tView,a=i[Ht]&4096?4096:16,c=fE(i,o,t,a,null,e,null,null,n?.injector??null,n?.embeddedViewInjector??null,n?.dehydratedView??null),l=i[e.index];c[Fl]=l;let u=i[Ba];return u!==null&&(c[Ba]=u.createEmbeddedView(o)),ME(o,c,t),c}finally{Lt(r)}}function gf(i,e){return!e||e.firstChild===null||xO(i)}var Lj=!1,n8=new me("");function xg(i,e,t,n,r=!1){for(;t!==null;){if(t.type===128){t=r?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&n.push(ls(o)),Hs(o)&&sL(o,n);let s=t.type;if(s&8)xg(i,e,t.child,n);else if(s&32){let a=mE(t,e),c;for(;c=a();)n.push(c)}else if(s&16){let a=nL(e,t);if(Array.isArray(a))n.push(...a);else{let c=Il(e[so]);xg(c[Rt],c,a,n,!0)}}t=r?t.projectionNext:t.next}return n}function sL(i,e){for(let t=Rr;t<i.length;t++){let n=i[t],r=n[Rt].firstChild;r!==null&&xg(n[Rt],n,r,e)}i[Nl]!==i[zs]&&e.push(i[Nl])}function aL(i){if(i[ld]!==null){for(let e of i[ld])e.impl.addSequence(e);i[ld].length=0}}var cL=[];function i8(i){return i[zo]??r8(i)}function r8(i){let e=cL.pop()??Object.create(s8);return e.lView=i,e}function o8(i){i.lView[zo]!==i&&(i.lView=null,cL.push(i))}var s8=jt(ae({},Mc),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:i=>{Ol(i.lView)},consumerOnSignalRead(){this.lView[zo]=this}});function a8(i){let e=i[zo]??Object.create(c8);return e.lView=i,e}var c8=jt(ae({},Mc),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:i=>{let e=Il(i.lView);for(;e&&!lL(e[Rt]);)e=Il(e);e&&LT(e)},consumerOnSignalRead(){this.lView[zo]=this}});function lL(i){return i.type!==2}function uL(i){if(i[Ac]===null)return;let e=!0;for(;e;){let t=!1;for(let n of i[Ac])n.dirty&&(t=!0,n.zone===null||Zone.current===n.zone?n.run():n.zone.run(()=>n.run()));e=t&&!!(i[Ht]&8192)}}var l8=100;function SE(i,e=0){let n=i[ka].rendererFactory,r=!1;r||n.begin?.();try{u8(i,e)}finally{r||n.end?.()}}function u8(i,e){let t=YT();try{cf(!0),AC(i,e);let n=0;for(;pg(i);){if(n===l8)throw new Xe(103,!1);n++,AC(i,1)}}finally{cf(t)}}function dL(i,e){ZT(e?mg.Exhaustive:mg.OnlyDirtyViews);try{SE(i)}finally{ZT(mg.Off)}}function d8(i,e,t,n){if(dd(e))return;let r=e[Ht],o=!1,s=!1;ly(e);let a=!0,c=null,l=null;o||(lL(i)?(l=i8(e),c=Pa(l)):p0()===null?(a=!1,l=a8(e),c=Pa(l)):e[zo]&&(Hh(e[zo]),e[zo]=null));try{OT(e),dj(i.bindingStartIndex),t!==null&&rL(i,e,t,2,n);let u=(r&3)===3;if(!o)if(u){let f=i.preOrderCheckHooks;f!==null&&by(e,f,null)}else{let f=i.preOrderHooks;f!==null&&vy(e,f,0,null),rC(e,0)}if(s||h8(e),uL(e),hL(e,0),i.contentQueries!==null&&PO(i,e),!o)if(u){let f=i.contentCheckHooks;f!==null&&by(e,f)}else{let f=i.contentHooks;f!==null&&vy(e,f,1),rC(e,1)}p8(i,e);let d=i.components;d!==null&&pL(e,d,0);let h=i.viewQuery;if(h!==null&&yC(2,h,n),!o)if(u){let f=i.viewCheckHooks;f!==null&&by(e,f)}else{let f=i.viewHooks;f!==null&&vy(e,f,2),rC(e,2)}if(i.firstUpdatePass===!0&&(i.firstUpdatePass=!1),e[iy]){for(let f of e[iy])f();e[iy]=null}o||(aL(e),e[Ht]&=-73)}catch(u){throw o||Ol(e),u}finally{l!==null&&(Rc(l,c),a&&o8(l)),uy()}}function hL(i,e){for(let t=MO(i);t!==null;t=SO(t))for(let n=Rr;n<t.length;n++){let r=t[n];fL(r,e)}}function h8(i){for(let e=MO(i);e!==null;e=SO(e)){if(!(e[Ht]&2))continue;let t=e[ud];for(let n=0;n<t.length;n++){let r=t[n];LT(r)}}}function f8(i,e,t){Xn(18);let n=us(e,i);fL(n,t),Xn(19,n[Wi])}function fL(i,e){ry(i)&&AC(i,e)}function AC(i,e){let n=i[Rt],r=i[Ht],o=i[zo],s=!!(e===0&&r&16);if(s||=!!(r&64&&e===0),s||=!!(r&1024),s||=!!(o?.dirty&&Wu(o)),s||=!1,o&&(o.dirty=!1),i[Ht]&=-9217,s)d8(n,i,n.template,i[Wi]);else if(r&8192){let a=Lt(null);try{uL(i),hL(i,1);let c=n.components;c!==null&&pL(i,c,1),aL(i)}finally{Lt(a)}}}function pL(i,e,t){for(let n=0;n<e.length;n++)f8(i,e[n],t)}function p8(i,e){let t=i.hostBindingOpCodes;if(t!==null)try{for(let n=0;n<t.length;n++){let r=t[n];if(r<0)kl(~r);else{let o=r,s=t[++n],a=t[++n];fj(s,o);let c=e[o];Xn(24,c),a(2,c),Xn(25,c)}}}finally{kl(-1)}}function RE(i,e){let t=YT()?64:1088;for(i[ka].changeDetectionScheduler?.notify(e);i;){i[Ht]|=t;let n=Il(i);if(af(i)&&!n)return i;i=n}return null}function mL(i,e,t,n){return[i,!0,0,e,null,n,null,t,null,null]}function gL(i,e){let t=Rr+e;if(t<i.length)return i[t]}function jg(i,e,t,n=!0){let r=e[Rt];if(m8(r,e,i,t),n){let s=IC(t,i),a=e[fi],c=a.parentNode(i[Nl]);c!==null&&IW(r,i[oo],a,e,c,s)}let o=e[od];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function _L(i,e){let t=wg(i,e);return t!==void 0&&Wy(t[Rt],t),t}function wg(i,e){if(i.length<=Rr)return;let t=Rr+e,n=i[t];if(n){let r=n[Fl];r!==null&&r!==i&&gE(r,n),e>0&&(i[t-1][cs]=n[cs]);let o=sg(i,Rr+e);DW(n[Rt],n);let s=o[Ba];s!==null&&s.detachView(o[Rt]),n[pr]=null,n[cs]=null,n[Ht]&=-129}return n}function m8(i,e,t,n){let r=Rr+n,o=t.length;n>0&&(t[r-1][cs]=e),n<o-Rr?(e[cs]=t[r],MT(t,Rr+n,e)):(t.push(e),e[cs]=null),e[pr]=t;let s=e[Fl];s!==null&&t!==s&&bL(s,e);let a=e[Ba];a!==null&&a.insertView(i),oy(e),e[Ht]|=128}function bL(i,e){let t=i[ud],n=e[pr];if(Ua(n))i[Ht]|=2;else{let r=n[pr][so];e[so]!==r&&(i[Ht]|=2)}t===null?i[ud]=[e]:t.push(e)}var Bl=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[Rt];return xg(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[Wi]}set context(e){this._lView[Wi]=e}get destroyed(){return dd(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[pr];if(Hs(e)){let t=e[ug],n=t?t.indexOf(this):-1;n>-1&&(wg(e,n),sg(t,n))}this._attachedToViewContainer=!1}Wy(this._lView[Rt],this._lView)}onDestroy(e){kT(this._lView,e)}markForCheck(){RE(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[Ht]&=-129}reattach(){oy(this._lView),this._lView[Ht]|=128}detectChanges(){this._lView[Ht]|=1024,SE(this._lView)}checkNoChanges(){return;try{this.exhaustive??=this._lView[sd].get(n8,Lj)}catch{this.exhaustive=Lj}}attachToViewContainerRef(){if(this._appRef)throw new Xe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=af(this._lView),t=this._lView[Fl];t!==null&&!e&&gE(t,this._lView),JO(this._lView[Rt],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Xe(902,!1);this._appRef=e;let t=af(this._lView),n=this._lView[Fl];n!==null&&!t&&bL(n,this._lView),oy(this._lView)}};var To=(()=>{class i{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=g8;constructor(t,n,r){this._declarationLView=t,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,n){return this.createEmbeddedViewImpl(t,n)}createEmbeddedViewImpl(t,n,r){let o=Ng(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:n,dehydratedView:r});return new Bl(o)}}return i})();function g8(){return Xy(mr(),Tt())}function Xy(i,e){return i.type&4?new To(e,i,yf(i,e)):null}function xd(i,e,t,n,r){let o=i.data[e];if(o===null)o=_8(i,e,t,n,r),hj()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=n,o.attrs=r;let s=uj();o.injectorIndex=s===null?-1:s.injectorIndex}return hd(o,!0),o}function _8(i,e,t,n,r){let o=WT(),s=$T(),a=s?o:o&&o.parent,c=i.data[e]=v8(i,a,t,e,n,r);return b8(i,c,o,s),c}function b8(i,e,t,n){i.firstChild===null&&(i.firstChild=e),t!==null&&(n?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function v8(i,e,t,n,r,o){let s=e?e.injectorIndex:-1,a=0;return zT()&&(a|=128),{type:t,index:n,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var Rve=new RegExp(`^(\\d+)*(${j5}|${N5})*(.*)`);function y8(i){let e=i[FT]??[],n=i[pr][fi],r=[];for(let o of e)o.data[EO]!==void 0?r.push(o):x8(o,n);i[FT]=r}function x8(i,e){let t=0,n=i.firstChild;if(n){let r=i.data[CO];for(;t<r;){let o=n.nextSibling;XO(e,n,!1),n=o,t++}}}var w8=()=>null,M8=()=>null;function Ey(i,e){return w8(i,e)}function vL(i,e,t){return M8(i,e,t)}var yL=class{},Zy=class{},PC=class{resolveComponentFactory(e){throw new Xe(917,!1)}},Og=class{static NULL=new PC},Co=class{},Yi=(()=>{class i{destroyNode=null;static __NG_ELEMENT_ID__=()=>S8()}return i})();function S8(){let i=Tt(),e=mr(),t=us(e.index,i);return(Ua(t)?t:i)[fi]}var xL=(()=>{class i{static \u0275prov=ge({token:i,providedIn:"root",factory:()=>null})}return i})();var xy={},FC=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){let r=this.injector.get(e,xy,n);return r!==xy||t===xy?r:this.parentInjector.get(e,t,n)}};function Dy(i,e,t){let n=t?i.styles:null,r=t?i.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)r=K0(r,a);else if(o==2){let c=a,l=e[++s];n=K0(n,c+": "+l+";")}}t?i.styles=n:i.stylesWithoutHost=n,t?i.classes=r:i.classesWithoutHost=r}function Dn(i,e=0){let t=Tt();if(t===null)return ht(i,e);let n=mr();return bO(n,t,Fr(i),e)}function TE(){let i="invalid";throw new Error(i)}function wL(i,e,t,n,r){let o=n===null?null:{"":-1},s=r(i,t);if(s!==null){let a=s,c=null,l=null;for(let u of s)if(u.resolveHostDirectives!==null){[a,c,l]=u.resolveHostDirectives(s);break}C8(i,e,t,a,o,c,l)}o!==null&&n!==null&&R8(t,n,o)}function R8(i,e,t){let n=i.localNames=[];for(let r=0;r<e.length;r+=2){let o=t[e[r+1]];if(o==null)throw new Xe(-301,!1);n.push(e[r],o)}}function T8(i,e,t){e.componentOffset=t,(i.components??=[]).push(e.index)}function C8(i,e,t,n,r,o,s){let a=n.length,c=!1;for(let h=0;h<a;h++){let f=n[h];!c&&Va(f)&&(c=!0,T8(i,t,h)),gC(Ty(t,e),i,f.type)}F8(t,i.data.length,a);for(let h=0;h<a;h++){let f=n[h];f.providersResolver&&f.providersResolver(f)}let l=!1,u=!1,d=QO(i,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let h=0;h<a;h++){let f=n[h];if(t.mergedAttrs=pf(t.mergedAttrs,f.hostAttrs),D8(i,t,e,d,f),P8(d,f,r),s!==null&&s.has(f)){let[_,m]=s.get(f);t.directiveToIndex.set(f.type,[d,_+t.directiveStart,m+t.directiveStart])}else(o===null||!o.has(f))&&t.directiveToIndex.set(f.type,d);f.contentQueries!==null&&(t.flags|=4),(f.hostBindings!==null||f.hostAttrs!==null||f.hostVars!==0)&&(t.flags|=64);let g=f.type.prototype;!l&&(g.ngOnChanges||g.ngOnInit||g.ngDoCheck)&&((i.preOrderHooks??=[]).push(t.index),l=!0),!u&&(g.ngOnChanges||g.ngDoCheck)&&((i.preOrderCheckHooks??=[]).push(t.index),u=!0),d++}E8(i,t,o)}function E8(i,e,t){for(let n=e.directiveStart;n<e.directiveEnd;n++){let r=i.data[n];if(t===null||!t.has(r))kj(0,e,r,n),kj(1,e,r,n),Uj(e,n,!1);else{let o=t.get(r);Bj(0,e,o,n),Bj(1,e,o,n),Uj(e,n,!0)}}}function kj(i,e,t,n){let r=i===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s;i===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(n),ML(e,o)}}function Bj(i,e,t,n){let r=i===0?t.inputs:t.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s=r[o],a;i===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(n,o),ML(e,s)}}function ML(i,e){e==="class"?i.flags|=8:e==="style"&&(i.flags|=16)}function Uj(i,e,t){let{attrs:n,inputs:r,hostDirectiveInputs:o}=i;if(n===null||!t&&r===null||t&&o===null||dE(i)){i.initialInputs??=[],i.initialInputs.push(null);return}let s=null,a=0;for(;a<n.length;){let c=n[a];if(c===0){a+=4;continue}else if(c===5){a+=2;continue}else if(typeof c=="number")break;if(!t&&r.hasOwnProperty(c)){let l=r[c];for(let u of l)if(u===e){s??=[],s.push(c,n[a+1]);break}}else if(t&&o.hasOwnProperty(c)){let l=o[c];for(let u=0;u<l.length;u+=2)if(l[u]===e){s??=[],s.push(l[u+1],n[a+1]);break}}a+=2}i.initialInputs??=[],i.initialInputs.push(s)}function D8(i,e,t,n,r){i.data[n]=r;let o=r.factory||(r.factory=Dl(r.type,!0)),s=new bd(o,Va(r),Dn);i.blueprint[n]=s,t[n]=s,I8(i,e,n,QO(i,t,r.hostVars,Wo),r)}function I8(i,e,t,n,r){let o=r.hostBindings;if(o){let s=i.hostBindingOpCodes;s===null&&(s=i.hostBindingOpCodes=[]);let a=~e.index;A8(s)!=a&&s.push(a),s.push(t,n,o)}}function A8(i){let e=i.length;for(;e>0;){let t=i[--e];if(typeof t=="number"&&t<0)return t}return 0}function P8(i,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=i;Va(e)&&(t[""]=i)}}function F8(i,e,t){i.flags|=1,i.directiveStart=e,i.directiveEnd=e+t,i.providerIndexes=e}function CE(i,e,t,n,r,o,s,a){let c=e[Rt],l=c.consts,u=Ho(l,s),d=xd(c,i,t,n,u);return o&&wL(c,e,d,Ho(l,a),r),d.mergedAttrs=pf(d.mergedAttrs,d.attrs),d.attrs!==null&&Dy(d,d.attrs,!1),d.mergedAttrs!==null&&Dy(d,d.mergedAttrs,!0),c.queries!==null&&c.queries.elementStart(c,d),d}function EE(i,e){lO(i,e),NT(e)&&i.queries.elementEnd(e)}function N8(i,e,t,n,r,o){let s=e.consts,a=Ho(s,r),c=xd(e,i,t,n,a);if(c.mergedAttrs=pf(c.mergedAttrs,c.attrs),o!=null){let l=Ho(s,o);c.localNames=[];for(let u=0;u<l.length;u+=2)c.localNames.push(l[u],-1)}return c.attrs!==null&&Dy(c,c.attrs,!1),c.mergedAttrs!==null&&Dy(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function Lg(i,e,t){return i[e]=t}function j8(i,e){return i[e]}function ds(i,e,t){if(t===Wo)return!1;let n=i[e];return Object.is(n,t)?!1:(i[e]=t,!0)}function Iy(i,e,t,n){let r=ds(i,e,t);return ds(i,e+1,n)||r}function O8(i,e,t,n,r){let o=Iy(i,e,t,n);return ds(i,e+2,r)||o}function L8(i,e,t,n,r,o){let s=Iy(i,e,t,n);return Iy(i,e+2,r,o)||s}function aC(i,e,t){return function n(r){let o=jl(i)?us(i.index,e):e;RE(o,5);let s=e[Wi],a=Vj(e,s,t,r),c=n.__ngNextListenerFn__;for(;c;)a=Vj(e,s,c,r)&&a,c=c.__ngNextListenerFn__;return a}}function Vj(i,e,t,n){let r=Lt(null);try{return Xn(6,e,t),t(n)!==!1}catch(o){return KW(i,o),!1}finally{Xn(7,e,t),Lt(r)}}function k8(i,e,t,n,r,o,s,a){let c=sf(i),l=!1,u=null;if(!n&&c&&(u=B8(e,t,o,i.index)),u!==null){let d=u.__ngLastListenerFn__||u;d.__ngNextListenerFn__=s,u.__ngLastListenerFn__=s,l=!0}else{let d=Gs(i,t),h=n?n(d):d;L5(t,h,o,a);let f=r.listen(h,o,a),g=n?_=>n(ls(_[i.index])):i.index;SL(g,e,t,o,a,f,!1)}return l}function B8(i,e,t,n){let r=i.cleanup;if(r!=null)for(let o=0;o<r.length-1;o+=2){let s=r[o];if(s===t&&r[o+1]===n){let a=e[rf],c=r[o+2];return a&&a.length>c?a[c]:null}typeof s=="string"&&(o+=2)}return null}function SL(i,e,t,n,r,o,s){let a=e.firstCreatePass?UT(e):null,c=BT(t),l=c.length;c.push(r,o),a&&a.push(n,i,l,(l+1)*(s?-1:1))}function zj(i,e,t,n,r,o){let s=e[t],a=e[Rt],l=a.data[t].outputs[n],d=s[l].subscribe(o);SL(i.index,a,e,r,o,d,!0)}var NC=Symbol("BINDING");var Ay=class extends Og{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=La(e);return new Ul(t,this.ngModule)}};function U8(i){return Object.keys(i).map(e=>{let[t,n,r]=i[e],o={propName:t,templateName:e,isSignal:(n&Gy.SignalBased)!==0};return r&&(o.transform=r),o})}function V8(i){return Object.keys(i).map(e=>({propName:i[e],templateName:e}))}function z8(i,e,t){let n=e instanceof Ei?e:e?.injector;return n&&i.getStandaloneInjector!==null&&(n=i.getStandaloneInjector(n)||n),n?new FC(t,n):t}function H8(i){let e=i.get(Co,null);if(e===null)throw new Xe(407,!1);let t=i.get(xL,null),n=i.get(Vo,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:n,ngReflect:!1}}function G8(i,e){let t=(i.selectors[0][0]||"div").toLowerCase();return $O(e,t,t==="svg"?tj:t==="math"?nj:null)}var Ul=class extends Zy{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=U8(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=V8(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=bW(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,n,r,o,s){Xn(22);let a=Lt(null);try{let c=this.componentDef,l=W8(n,c,s,o),u=z8(c,r||this.ngModule,e),d=H8(u),h=d.rendererFactory.createRenderer(null,c),f=n?UW(h,n,c.encapsulation,u):G8(c,h),g=s?.some(Hj)||o?.some(p=>typeof p!="function"&&p.bindings.some(Hj)),_=fE(null,l,null,512|YO(c),null,null,d,h,u,null,AO(f,u,!0));_[ri]=f,ly(_);let m=null;try{let p=CE(ri,_,2,"#host",()=>l.directiveRegistry,!0,0);f&&(ZO(h,f,p),mf(f,_)),qy(l,_,p),iE(l,p,_),EE(l,p),t!==void 0&&q8(p,this.ngContentSelectors,t),m=us(p.index,_),_[Wi]=m[Wi],ME(l,_,null)}catch(p){throw m!==null&&bC(m),bC(_),p}finally{Xn(23),uy()}return new Py(this.componentType,_,!!g)}finally{Lt(a)}}};function W8(i,e,t,n){let r=i?["ng-version","20.1.0"]:vW(e.selectors[0]),o=null,s=null,a=0;if(t)for(let u of t)a+=u[NC].requiredVars,u.create&&(u.targetIdx=0,(o??=[]).push(u)),u.update&&(u.targetIdx=0,(s??=[]).push(u));if(n)for(let u=0;u<n.length;u++){let d=n[u];if(typeof d!="function")for(let h of d.bindings){a+=h[NC].requiredVars;let f=u+1;h.create&&(h.targetIdx=f,(o??=[]).push(h)),h.update&&(h.targetIdx=f,(s??=[]).push(h))}}let c=[e];if(n)for(let u of n){let d=typeof u=="function"?u:u.type,h=CT(d);c.push(h)}return hE(0,null,$8(o,s),1,a,c,null,null,null,[r],null)}function $8(i,e){return!i&&!e?null:t=>{if(t&1&&i)for(let n of i)n.create();if(t&2&&e)for(let n of e)n.update()}}function Hj(i){let e=i[NC].kind;return e==="input"||e==="twoWay"}var Py=class extends yL{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,n){super(),this._rootLView=t,this._hasInputBindings=n,this._tNode=dg(t[Rt],ri),this.location=yf(this._tNode,t),this.instance=us(this._tNode.index,t)[Wi],this.hostView=this.changeDetectorRef=new Bl(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let n=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let r=this._rootLView,o=wE(n,r[Rt],r,e,t);this.previousInputValues.set(e,t);let s=us(n.index,r);RE(s,1)}get injector(){return new _d(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function q8(i,e,t){let n=i.projection=[];for(let r=0;r<e.length;r++){let o=t[r];n.push(o!=null&&o.length?Array.from(o):null)}}var Ur=(()=>{class i{static __NG_ELEMENT_ID__=X8}return i})();function X8(){let i=mr();return TL(i,Tt())}var Z8=Ur,RL=class extends Z8{_lContainer;_hostTNode;_hostLView;constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return yf(this._hostTNode,this._hostLView)}get injector(){return new _d(this._hostTNode,this._hostLView)}get parentInjector(){let e=JC(this._hostTNode,this._hostLView);if(hO(e)){let t=Sy(e,this._hostLView),n=My(e),r=t[Rt].data[n+8];return new _d(r,t)}else return new _d(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=Gj(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Rr}createEmbeddedView(e,t,n){let r,o;typeof n=="number"?r=n:n!=null&&(r=n.index,o=n.injector);let s=Ey(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,r,gf(this._hostTNode,s)),a}createComponent(e,t,n,r,o,s,a){let c=e&&!c5(e),l;if(c)l=t;else{let m=t||{};l=m.index,n=m.injector,r=m.projectableNodes,o=m.environmentInjector||m.ngModuleRef,s=m.directives,a=m.bindings}let u=c?e:new Ul(La(e)),d=n||this.parentInjector;if(!o&&u.ngModule==null){let p=(c?d:this.parentInjector).get(Ei,null);p&&(o=p)}let h=La(u.componentType??{}),f=Ey(this._lContainer,h?.id??null),g=f?.firstChild??null,_=u.create(d,r,g,o,s,a);return this.insertImpl(_.hostView,l,gf(this._hostTNode,f)),_}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,n){let r=e._lView;if(rj(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=r[pr],l=new RL(c,c[oo],c[pr]);l.detach(l.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return jg(s,r,o,n),e.attachToViewContainerRef(),MT(cC(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=Gj(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),n=wg(this._lContainer,t);n&&(sg(cC(this._lContainer),t),Wy(n[Rt],n))}detach(e){let t=this._adjustIndex(e,-1),n=wg(this._lContainer,t);return n&&sg(cC(this._lContainer),t)!=null?new Bl(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function Gj(i){return i[ug]}function cC(i){return i[ug]||(i[ug]=[])}function TL(i,e){let t,n=e[i.index];return Hs(n)?t=n:(t=mL(n,e,null,i),e[i.index]=t,pE(e,t)),Q8(t,e,i,n),new RL(t,i,e)}function Y8(i,e){let t=i[fi],n=t.createComment(""),r=Gs(e,i),o=t.parentNode(r);return Cy(t,o,n,t.nextSibling(r),!1),n}var Q8=e6,K8=()=>!1;function J8(i,e,t){return K8(i,e,t)}function e6(i,e,t,n){if(i[Nl])return;let r;t.type&8?r=ls(n):r=Y8(e,t),i[Nl]=r}var jC=class i{queryList;matches=null;constructor(e){this.queryList=e}clone(){return new i(this.queryList)}setDirty(){this.queryList.setDirty()}},OC=class i{queries;constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let n=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let o=0;o<n;o++){let s=t.getByIndex(o),a=this.queries[s.indexInDeclarationView];r.push(a.clone())}return new i(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)DE(e,t).matches!==null&&this.queries[t].setDirty()}},Fy=class{flags;read;predicate;constructor(e,t,n=null){this.flags=t,this.read=n,typeof e=="string"?this.predicate=c6(e):this.predicate=e}},LC=class i{queries;constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){let r=t!==null?t.length:0,o=this.getByIndex(n).embeddedTView(e,r);o&&(o.indexInDeclarationView=n,t!==null?t.push(o):t=[o])}return t!==null?new i(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},kC=class i{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(e,t=-1){this.metadata=e,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new i(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,n=e.parent;for(;n!==null&&n.type&8&&n.index!==t;)n=n.parent;return t===(n!==null?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){let o=n[r];this.matchTNodeWithReadOption(e,t,t6(t,o)),this.matchTNodeWithReadOption(e,t,yy(t,e,o,!1,!1))}else n===To?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,yy(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(n!==null){let r=this.metadata.read;if(r!==null)if(r===vt||r===Ur||r===To&&t.type&4)this.addMatch(t.index,-2);else{let o=yy(t,e,r,!1,!1);o!==null&&this.addMatch(t.index,o)}else this.addMatch(t.index,n)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function t6(i,e){let t=i.localNames;if(t!==null){for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1]}return null}function n6(i,e){return i.type&11?yf(i,e):i.type&4?Xy(i,e):null}function i6(i,e,t,n){return t===-1?n6(e,i):t===-2?r6(i,e,n):yg(i,i[Rt],t,e)}function r6(i,e,t){if(t===vt)return yf(e,i);if(t===To)return Xy(e,i);if(t===Ur)return TL(e,i)}function CL(i,e,t,n){let r=e[Ba].queries[n];if(r.matches===null){let o=i.data,s=t.matches,a=[];for(let c=0;s!==null&&c<s.length;c+=2){let l=s[c];if(l<0)a.push(null);else{let u=o[l];a.push(i6(e,u,s[c+1],t.metadata.read))}}r.matches=a}return r.matches}function BC(i,e,t,n){let r=i.queries.getByIndex(t),o=r.matches;if(o!==null){let s=CL(i,e,r,t);for(let a=0;a<o.length;a+=2){let c=o[a];if(c>0)n.push(s[a/2]);else{let l=o[a+1],u=e[-c];for(let d=Rr;d<u.length;d++){let h=u[d];h[Fl]===h[pr]&&BC(h[Rt],h,l,n)}if(u[ud]!==null){let d=u[ud];for(let h=0;h<d.length;h++){let f=d[h];BC(f[Rt],f,l,n)}}}}}return n}function o6(i,e){return i[Ba].queries[e].queryList}function EL(i,e,t){let n=new $s((t&4)===4);return aj(i,e,n,n.destroy),(e[Ba]??=new OC).queries.push(new jC(n))-1}function s6(i,e,t){let n=pi();return n.firstCreatePass&&(DL(n,new Fy(i,e,t),-1),(e&2)===2&&(n.staticViewQueries=!0)),EL(n,Tt(),e)}function a6(i,e,t,n){let r=pi();if(r.firstCreatePass){let o=mr();DL(r,new Fy(e,t,n),o.index),l6(r,i),(t&2)===2&&(r.staticContentQueries=!0)}return EL(r,Tt(),t)}function c6(i){return i.split(",").map(e=>e.trim())}function DL(i,e,t){i.queries===null&&(i.queries=new LC),i.queries.track(new kC(e,t))}function l6(i,e){let t=i.contentQueries||(i.contentQueries=[]),n=t.length?t[t.length-1]:-1;e!==n&&t.push(i.queries.length-1,e)}function DE(i,e){return i.queries.getByIndex(e)}function u6(i,e){let t=i[Rt],n=DE(t,e);return n.crossesNgTemplate?BC(t,i,e,[]):CL(t,i,n,e)}var Wj=new Set;function hs(i){Wj.has(i)||(Wj.add(i),performance?.mark?.("mark_feature_usage",{detail:{feature:i}}))}var Wa=class{},Yy=class{};function IE(i,e){return new Mg(i,e??null,[])}var Mg=class extends Wa{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Ay(this);constructor(e,t,n,r=!0){super(),this.ngModuleType=e,this._parent=t;let o=TT(e);this._bootstrapComponents=HO(o.bootstrap),this._r3Injector=tC(e,t,[{provide:Wa,useValue:this},{provide:Og,useValue:this.componentFactoryResolver},...n],Ro(e),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Ny=class extends Yy{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new Mg(this.moduleType,e,[])}};var Sg=class extends Wa{injector;componentFactoryResolver=new Ay(this);instance=null;constructor(e){super();let t=new id([...e.providers,{provide:Wa,useValue:this},{provide:Og,useValue:this.componentFactoryResolver}],e.parent||nf(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Mf(i,e,t=null){return new Sg({providers:i,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var d6=(()=>{class i{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let n=ET(!1,t.type),r=n.length>0?Mf([n],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=ge({token:i,providedIn:"environment",factory:()=>new i(ht(Ei))})}return i})();function O(i){return Eg(()=>{let e=IL(i),t=jt(ae({},e),{decls:i.decls,vars:i.vars,template:i.template,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,onPush:i.changeDetection===eE.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&i.dependencies||null,getStandaloneInjector:e.standalone?r=>r.get(d6).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:i.signals??!1,data:i.data||{},encapsulation:i.encapsulation||Fc.Emulated,styles:i.styles||ro,_:null,schemas:i.schemas||null,tView:null,id:""});e.standalone&&hs("NgStandalone"),AL(t);let n=i.dependencies;return t.directiveDefs=$j(n,h6),t.pipeDefs=$j(n,XN),t.id=m6(t),t})}function h6(i){return La(i)||CT(i)}function Mn(i){return Eg(()=>({type:i.type,bootstrap:i.bootstrap||ro,declarations:i.declarations||ro,imports:i.imports||ro,exports:i.exports||ro,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null}))}function f6(i,e){if(i==null)return Pl;let t={};for(let n in i)if(i.hasOwnProperty(n)){let r=i[n],o,s,a,c;Array.isArray(r)?(a=r[0],o=r[1],s=r[2]??o,c=r[3]||null):(o=r,s=r,a=Gy.None,c=null),t[o]=[n,a,c],e[o]=s}return t}function p6(i){if(i==null)return Pl;let e={};for(let t in i)i.hasOwnProperty(t)&&(e[i[t]]=t);return e}function Ge(i){return Eg(()=>{let e=IL(i);return AL(e),e})}function $o(i){return{type:i.type,name:i.name,factory:null,pure:i.pure!==!1,standalone:i.standalone??!0,onDestroy:i.type.prototype.ngOnDestroy||null}}function IL(i){let e={};return{type:i.type,providersResolver:null,factory:null,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:e,inputConfig:i.inputs||Pl,exportAs:i.exportAs||null,standalone:i.standalone??!0,signals:i.signals===!0,selectors:i.selectors||ro,viewQuery:i.viewQuery||null,features:i.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:f6(i.inputs,e),outputs:p6(i.outputs),debugInfo:null}}function AL(i){i.features?.forEach(e=>e(i))}function $j(i,e){return i?()=>{let t=typeof i=="function"?i():i,n=[];for(let r of t){let o=e(r);o!==null&&n.push(o)}return n}:null}function m6(i){let e=0,t=typeof i.consts=="function"?"":i.consts,n=[i.selectors,i.ngContentSelectors,i.hostVars,i.hostAttrs,t,i.vars,i.decls,i.encapsulation,i.standalone,i.signals,i.exportAs,JSON.stringify(i.inputs),JSON.stringify(i.outputs),Object.getOwnPropertyNames(i.type.prototype),!!i.contentQueries,!!i.viewQuery];for(let o of n.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function g6(i){return Object.getPrototypeOf(i.prototype).constructor}function $(i){let e=g6(i.type),t=!0,n=[i];for(;e;){let r;if(Va(i))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Xe(903,!1);r=e.\u0275dir}if(r){if(t){n.push(r);let s=i;s.inputs=lC(i.inputs),s.declaredInputs=lC(i.declaredInputs),s.outputs=lC(i.outputs);let a=r.hostBindings;a&&x6(i,a);let c=r.viewQuery,l=r.contentQueries;if(c&&v6(i,c),l&&y6(i,l),_6(i,r),UN(i.outputs,r.outputs),Va(r)&&r.data.animation){let u=i.data;u.animation=(u.animation||[]).concat(r.data.animation)}}let o=r.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(i),a===$&&(t=!1)}}e=Object.getPrototypeOf(e)}b6(n)}function _6(i,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||i.inputs.hasOwnProperty(t))continue;let n=e.inputs[t];n!==void 0&&(i.inputs[t]=n,i.declaredInputs[t]=e.declaredInputs[t])}}function b6(i){let e=0,t=null;for(let n=i.length-1;n>=0;n--){let r=i[n];r.hostVars=e+=r.hostVars,r.hostAttrs=pf(r.hostAttrs,t=pf(t,r.hostAttrs))}}function lC(i){return i===Pl?{}:i===ro?[]:i}function v6(i,e){let t=i.viewQuery;t?i.viewQuery=(n,r)=>{e(n,r),t(n,r)}:i.viewQuery=e}function y6(i,e){let t=i.contentQueries;t?i.contentQueries=(n,r,o)=>{e(n,r,o),t(n,r,o)}:i.contentQueries=e}function x6(i,e){let t=i.hostBindings;t?i.hostBindings=(n,r)=>{e(n,r),t(n,r)}:i.hostBindings=e}function PL(i,e,t,n,r,o,s,a){if(t.firstCreatePass){i.mergedAttrs=pf(i.mergedAttrs,i.attrs);let u=i.tView=hE(2,i,r,o,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,i),u.queries=t.queries.embeddedTView(i))}a&&(i.flags|=a),hd(i,!1);let c=M6(t,e,i,n);hy()&&_E(t,e,c,i),mf(c,e);let l=mL(c,e,c,i);e[n+ri]=l,pE(e,l),J8(l,i,e)}function w6(i,e,t,n,r,o,s,a,c,l,u){let d=t+ri,h;return e.firstCreatePass?(h=xd(e,d,4,s||null,a||null),sy()&&wL(e,i,h,Ho(e.consts,l),vE),lO(e,h)):h=e.data[d],PL(h,i,e,t,n,r,o,c),sf(h)&&qy(e,i,h),l!=null&&Fg(i,h,u),h}function _f(i,e,t,n,r,o,s,a,c,l,u){let d=t+ri,h;if(e.firstCreatePass){if(h=xd(e,d,4,s||null,a||null),l!=null){let f=Ho(e.consts,l);h.localNames=[];for(let g=0;g<f.length;g+=2)h.localNames.push(f[g],-1)}}else h=e.data[d];return PL(h,i,e,t,n,r,o,c),l!=null&&Fg(i,h,u),h}function fs(i,e,t,n,r,o,s,a){let c=Tt(),l=pi(),u=Ho(l.consts,o);return w6(c,l,i,e,t,n,r,u,void 0,s,a),fs}function Qy(i,e,t,n,r,o,s,a){let c=Tt(),l=pi(),u=Ho(l.consts,o);return _f(c,l,i,e,t,n,r,u,void 0,s,a),Qy}var M6=S6;function S6(i,e,t,n){return gg(!0),e[fi].createComment("")}var Ky=function(i){return i[i.CHANGE_DETECTION=0]="CHANGE_DETECTION",i[i.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",i}(Ky||{}),Vl=new me(""),FL=!1,UC=class extends lt{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,JN()&&(this.destroyRef=S(Nr,{optional:!0})??void 0,this.pendingTasks=S(Pc,{optional:!0})??void 0)}emit(e){let t=Lt(null);try{super.next(e)}finally{Lt(t)}}subscribe(e,t,n){let r=e,o=t||(()=>null),s=n;if(e&&typeof e=="object"){let c=e;r=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=this.wrapInTimeout(o),r&&(r=this.wrapInTimeout(r)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:r,error:o,complete:s});return e instanceof Rn&&e.add(a),a}wrapInTimeout(e){return t=>{let n=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{n!==void 0&&this.pendingTasks?.remove(n)}})}}},dt=UC;function NL(i){let e,t;function n(){i=gd;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{i(),n()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{i(),n()})),()=>n()}function qj(i){return queueMicrotask(()=>i()),()=>{i=gd}}var AE="isAngularZone",jy=AE+"_ID",R6=0,pt=class i{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new dt(!1);onMicrotaskEmpty=new dt(!1);onStable=new dt(!1);onError=new dt(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:o=FL}=e;if(typeof Zone>"u")throw new Xe(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&n,s.shouldCoalesceRunChangeDetection=r,s.callbackScheduled=!1,s.scheduleInRootZone=o,E6(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(AE)===!0}static assertInAngularZone(){if(!i.isInAngularZone())throw new Xe(909,!1)}static assertNotInAngularZone(){if(i.isInAngularZone())throw new Xe(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,e,T6,gd,gd);try{return o.runTask(s,t,n)}finally{o.cancelTask(s)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}},T6={};function PE(i){if(i._nesting==0&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function C6(i){if(i.isCheckStableRunning||i.callbackScheduled)return;i.callbackScheduled=!0;function e(){NL(()=>{i.callbackScheduled=!1,VC(i),i.isCheckStableRunning=!0,PE(i),i.isCheckStableRunning=!1})}i.scheduleInRootZone?Zone.root.run(()=>{e()}):i._outer.run(()=>{e()}),VC(i)}function E6(i){let e=()=>{C6(i)},t=R6++;i._inner=i._inner.fork({name:"angular",properties:{[AE]:!0,[jy]:t,[jy+t]:!0},onInvokeTask:(n,r,o,s,a,c)=>{if(D6(c))return n.invokeTask(o,s,a,c);try{return Xj(i),n.invokeTask(o,s,a,c)}finally{(i.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||i.shouldCoalesceRunChangeDetection)&&e(),Zj(i)}},onInvoke:(n,r,o,s,a,c,l)=>{try{return Xj(i),n.invoke(o,s,a,c,l)}finally{i.shouldCoalesceRunChangeDetection&&!i.callbackScheduled&&!I6(c)&&e(),Zj(i)}},onHasTask:(n,r,o,s)=>{n.hasTask(o,s),r===o&&(s.change=="microTask"?(i._hasPendingMicrotasks=s.microTask,VC(i),PE(i)):s.change=="macroTask"&&(i.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,o,s)=>(n.handleError(o,s),i.runOutsideAngular(()=>i.onError.emit(s)),!1)})}function VC(i){i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&i.callbackScheduled===!0?i.hasPendingMicrotasks=!0:i.hasPendingMicrotasks=!1}function Xj(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function Zj(i){i._nesting--,PE(i)}var Rg=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new dt;onMicrotaskEmpty=new dt;onStable=new dt;onError=new dt;run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,r){return e.apply(t,n)}};function D6(i){return jL(i,"__ignore_ng_zone__")}function I6(i){return jL(i,"__scheduler_tick__")}function jL(i,e){return!Array.isArray(i)||i.length!==1?!1:i[0]?.data?.[e]===!0}var Jy=(()=>{class i{impl=null;execute(){this.impl?.execute()}static \u0275prov=ge({token:i,providedIn:"root",factory:()=>new i})}return i})(),FE=[0,1,2,3],NE=(()=>{class i{ngZone=S(pt);scheduler=S(Vo);errorHandler=S(Mr,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){S(Vl,{optional:!0})}execute(){let t=this.sequences.size>0;t&&Xn(16),this.executing=!0;for(let n of FE)for(let r of this.sequences)if(!(r.erroredOrDestroyed||!r.hooks[n]))try{r.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let o=r.hooks[n];return o(r.pipelinedValue)},r.snapshot))}catch(o){r.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(let n of this.sequences)n.afterRun(),n.once&&(this.sequences.delete(n),n.destroy());for(let n of this.deferredRegistrations)this.sequences.add(n);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&Xn(17)}register(t){let{view:n}=t;n!==void 0?((n[ld]??=[]).push(t),Ol(n),n[Ht]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,n){return n?n.run(Ky.AFTER_NEXT_RENDER,t):t()}static \u0275prov=ge({token:i,providedIn:"root",factory:()=>new i})}return i})(),Tg=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,n,r,o,s=null){this.impl=e,this.hooks=t,this.view=n,this.once=r,this.snapshot=s,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[ld];e&&(this.view[ld]=e.filter(t=>t!==this))}};function co(i,e){let t=e?.injector??S(yn);return hs("NgAfterNextRender"),P6(i,t,e,!0)}function A6(i){return i instanceof Function?[void 0,void 0,i,void 0]:[i.earlyRead,i.write,i.mixedReadWrite,i.read]}function P6(i,e,t,n){let r=e.get(Jy);r.impl??=e.get(NE);let o=e.get(Vl,null,{optional:!0}),s=t?.manualCleanup!==!0?e.get(Nr):null,a=e.get(pd,null,{optional:!0}),c=new Tg(r.impl,A6(i),a?.view,n,s,o?.snapshot(null));return r.impl.register(c),c}var ex=(()=>{class i{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"platform"})}return i})();var jE=new me("");function Lc(i){return!!i&&typeof i.then=="function"}function tx(i){return!!i&&typeof i.subscribe=="function"}var OE=new me("");function nx(i){return Vs([{provide:OE,multi:!0,useValue:i}])}var LE=(()=>{class i{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,n)=>{this.resolve=t,this.reject=n});appInits=S(OE,{optional:!0})??[];injector=S(yn);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let r of this.appInits){let o=Sr(this.injector,r);if(Lc(o))t.push(o);else if(tx(o)){let s=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});t.push(s)}}let n=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{n()}).catch(r=>{this.reject(r)}),t.length===0&&n(),this.initialized=!0}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),kg=new me("");function OL(){VR(()=>{let i="";throw new Xe(600,i)})}function LL(i){return i.isBoundToModule}var F6=10;var ps=(()=>{class i{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=S(ao);afterRenderManager=S(Jy);zonelessEnabled=S(df);rootEffectScheduler=S(_g);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new lt;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=S(Pc);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(tt(t=>!t))}constructor(){S(Vl,{optional:!0})}whenStable(){let t;return new Promise(n=>{t=this.isStable.subscribe({next:r=>{r&&n()}})}).finally(()=>{t.unsubscribe()})}_injector=S(Ei);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,n){return this.bootstrapImpl(t,n)}bootstrapImpl(t,n,r=yn.NULL){return this._injector.get(pt).run(()=>{Xn(10);let s=t instanceof Zy;if(!this._injector.get(LE).done){let g="";throw new Xe(405,g)}let c;s?c=t:c=this._injector.get(Og).resolveComponentFactory(t),this.componentTypes.push(c.componentType);let l=LL(c)?void 0:this._injector.get(Wa),u=n||c.selector,d=c.create(r,[],u,l),h=d.location.nativeElement,f=d.injector.get(jE,null);return f?.registerApplication(h),d.onDestroy(()=>{this.detachView(d.hostView),vg(this.components,d),f?.unregisterApplication(h)}),this._loadComponent(d),Xn(11,d),d})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){Xn(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(Ky.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new Xe(101,!1);let t=Lt(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,Lt(t),this.afterTick.next(),Xn(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Co,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<F6;)Xn(14),this.synchronizeOnce(),Xn(15)}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let n=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r}of this.allViews){if(!n&&!pg(r))continue;let o=n&&!this.zonelessEnabled?0:1;SE(r,o),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>pg(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let n=t;this._views.push(n),n.attachToAppRef(this)}detachView(t){let n=t;vg(this._views,n),n.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(r){this.internalErrorHandler(r)}this.components.push(t),this._injector.get(kg,[]).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>vg(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Xe(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function vg(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}function oi(i,e,t,n){let r=Tt(),o=fd();if(ds(r,o,e)){let s=pi(),a=dy();ZW(a,r,i,e,t,n)}return oi}var zC=class{destroy(e){}updateValue(e,t){}swap(e,t){let n=Math.min(e,t),r=Math.max(e,t),o=this.detach(r);if(r-n>1){let s=this.detach(n);this.attach(n,o),this.attach(r,s)}else this.attach(n,o)}move(e,t){this.attach(t,this.detach(e))}};function uC(i,e,t,n,r){return i===t&&Object.is(e,n)?1:Object.is(r(i,e),r(t,n))?-1:0}function N6(i,e,t){let n,r,o=0,s=i.length-1,a=void 0;if(Array.isArray(e)){let c=e.length-1;for(;o<=s&&o<=c;){let l=i.at(o),u=e[o],d=uC(o,l,o,u,t);if(d!==0){d<0&&i.updateValue(o,u),o++;continue}let h=i.at(s),f=e[c],g=uC(s,h,c,f,t);if(g!==0){g<0&&i.updateValue(s,f),s--,c--;continue}let _=t(o,l),m=t(s,h),p=t(o,u);if(Object.is(p,m)){let b=t(c,f);Object.is(b,_)?(i.swap(o,s),i.updateValue(s,f),c--,s--):i.move(s,o),i.updateValue(o,u),o++;continue}if(n??=new Oy,r??=Qj(i,o,s,t),HC(i,n,o,p))i.updateValue(o,u),o++,s++;else if(r.has(p))n.set(_,i.detach(o)),s--;else{let b=i.create(o,e[o]);i.attach(o,b),o++,s++}}for(;o<=c;)Yj(i,n,t,o,e[o]),o++}else if(e!=null){let c=e[Symbol.iterator](),l=c.next();for(;!l.done&&o<=s;){let u=i.at(o),d=l.value,h=uC(o,u,o,d,t);if(h!==0)h<0&&i.updateValue(o,d),o++,l=c.next();else{n??=new Oy,r??=Qj(i,o,s,t);let f=t(o,d);if(HC(i,n,o,f))i.updateValue(o,d),o++,s++,l=c.next();else if(!r.has(f))i.attach(o,i.create(o,d)),o++,s++,l=c.next();else{let g=t(o,u);n.set(g,i.detach(o)),s--}}}for(;!l.done;)Yj(i,n,t,i.length,l.value),l=c.next()}for(;o<=s;)i.destroy(i.detach(s--));n?.forEach(c=>{i.destroy(c)})}function HC(i,e,t,n){return e!==void 0&&e.has(n)?(i.attach(t,e.get(n)),e.delete(n),!0):!1}function Yj(i,e,t,n,r){if(HC(i,e,n,t(n,r)))i.updateValue(n,r);else{let o=i.create(n,r);i.attach(n,o)}}function Qj(i,e,t,n){let r=new Set;for(let o=e;o<=t;o++)r.add(n(o,i.at(o)));return r}var Oy=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let n=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let r=this._vMap;for(;r.has(n);)n=r.get(n);r.set(n,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,n]of this.kvMap)if(e(n,t),this._vMap!==void 0){let r=this._vMap;for(;r.has(n);)n=r.get(n),e(n,t)}}};function Vi(i,e,t,n,r,o,s,a){hs("NgControlFlow");let c=Tt(),l=pi(),u=Ho(l.consts,o);return _f(c,l,i,e,t,n,r,u,256,s,a),kE}function kE(i,e,t,n,r,o,s,a){hs("NgControlFlow");let c=Tt(),l=pi(),u=Ho(l.consts,o);return _f(c,l,i,e,t,n,r,u,512,s,a),kE}function zi(i,e){hs("NgControlFlow");let t=Tt(),n=fd(),r=t[n]!==Wo?t[n]:-1,o=r!==-1?Ly(t,ri+r):void 0,s=0;if(ds(t,n,i)){let a=Lt(null);try{if(o!==void 0&&_L(o,s),i!==-1){let c=ri+i,l=Ly(t,c),u=qC(t[Rt],c),d=vL(l,u,t),h=Ng(t,u,e,{dehydratedView:d});jg(l,h,s,gf(u,d))}}finally{Lt(a)}}else if(o!==void 0){let a=gL(o,s);a!==void 0&&(a[Wi]=e)}}var GC=class{lContainer;$implicit;$index;constructor(e,t,n){this.lContainer=e,this.$implicit=t,this.$index=n}get $count(){return this.lContainer.length-Rr}};function Qi(i,e){return e}var WC=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,n){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=n}};function Ki(i,e,t,n,r,o,s,a,c,l,u,d,h){hs("NgControlFlow");let f=Tt(),g=pi(),_=c!==void 0,m=Tt(),p=a?s.bind(m[so][Wi]):s,b=new WC(_,p);m[ri+i]=b,_f(f,g,i+1,e,t,n,r,Ho(g.consts,o),256),_&&_f(f,g,i+2,c,l,u,d,Ho(g.consts,h),512)}var $C=class extends zC{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,n){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=n}get length(){return this.lContainer.length-Rr}at(e){return this.getLView(e)[Wi].$implicit}attach(e,t){let n=t[od];this.needsIndexUpdate||=e!==this.length,jg(this.lContainer,t,e,gf(this.templateTNode,n))}detach(e){return this.needsIndexUpdate||=e!==this.length-1,j6(this.lContainer,e)}create(e,t){let n=Ey(this.lContainer,this.templateTNode.tView.ssrId),r=Ng(this.hostLView,this.templateTNode,new GC(this.lContainer,t,e),{dehydratedView:n});return this.operationsCounter?.recordCreate(),r}destroy(e){Wy(e[Rt],e),this.operationsCounter?.recordDestroy()}updateValue(e,t){this.getLView(e)[Wi].$implicit=t}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[Wi].$index=e}getLView(e){return O6(this.lContainer,e)}};function Ji(i){let e=Lt(null),t=za();try{let n=Tt(),r=n[Rt],o=n[t],s=t+1,a=Ly(n,s);if(o.liveCollection===void 0){let l=qC(r,s);o.liveCollection=new $C(a,n,l)}else o.liveCollection.reset();let c=o.liveCollection;if(N6(c,i,o.trackByFn),c.updateIndexes(),o.hasEmptyBlock){let l=fd(),u=c.length===0;if(ds(n,l,u)){let d=t+2,h=Ly(n,d);if(u){let f=qC(r,d),g=vL(h,f,n),_=Ng(n,f,void 0,{dehydratedView:g});jg(h,_,0,gf(f,g))}else r.firstUpdatePass&&y8(h),_L(h,0)}}}finally{Lt(e)}}function Ly(i,e){return i[e]}function j6(i,e){return wg(i,e)}function O6(i,e){return gL(i,e)}function qC(i,e){return dg(i,e)}function N(i,e,t){let n=Tt(),r=fd();if(ds(n,r,e)){let o=pi(),s=dy();oL(s,n,i,e,n[fi],t)}return N}function XC(i,e,t,n,r){wE(e,i,t,r?"class":"style",n)}function B(i,e,t,n){let r=Tt(),o=r[Rt],s=i+ri,a=o.firstCreatePass?CE(s,r,2,e,vE,sy(),t,n):o.data[s];if(yE(a,r,i,e,kL),sf(a)){let c=r[Rt];qy(c,r,a),iE(c,a,r)}return n!=null&&Fg(r,a),B}function X(){let i=pi(),e=mr(),t=xE(e);return i.firstCreatePass&&EE(i,t),HT(t)&&GT(),VT(),t.classesWithoutHost!=null&&p5(t)&&XC(i,t,Tt(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&m5(t)&&XC(i,t,Tt(),t.stylesWithoutHost,!1),X}function ne(i,e,t,n){return B(i,e,t,n),X(),ne}function wd(i,e,t,n){let r=Tt(),o=r[Rt],s=i+ri,a=o.firstCreatePass?N8(s,o,2,e,t,n):o.data[s];return yE(a,r,i,e,kL),n!=null&&Fg(r,a),wd}function Md(){let i=mr(),e=xE(i);return HT(e)&&GT(),VT(),Md}function Sd(i,e,t,n){return wd(i,e,t,n),Md(),Sd}var kL=(i,e,t,n,r)=>(gg(!0),$O(e[fi],n,yj()));function BE(i,e,t){let n=Tt(),r=n[Rt],o=i+ri,s=r.firstCreatePass?CE(o,n,8,"ng-container",vE,sy(),e,t):r.data[o];if(yE(s,n,i,"ng-container",L6),sf(s)){let a=n[Rt];qy(a,n,s),iE(a,s,n)}return t!=null&&Fg(n,s),BE}function UE(){let i=pi(),e=mr(),t=xE(e);return i.firstCreatePass&&EE(i,t),UE}function Rd(i,e,t){return BE(i,e,t),UE(),Rd}var L6=(i,e,t,n,r)=>(gg(!0),wW(e[fi],""));function en(){return Tt()}var Bg="en-US";var k6=Bg;function BL(i){typeof i=="string"&&(k6=i.toLowerCase().replace(/_/g,"-"))}function Ie(i,e,t){let n=Tt(),r=pi(),o=mr();return UL(r,n,n[fi],o,i,e,t),Ie}function UL(i,e,t,n,r,o,s){let a=!0,c=null;if((n.type&3||s)&&(c??=aC(n,e,o),k8(n,i,e,s,t,r,o,c)&&(a=!1)),a){let l=n.outputs?.[r],u=n.hostDirectiveOutputs?.[r];if(u&&u.length)for(let d=0;d<u.length;d+=2){let h=u[d],f=u[d+1];c??=aC(n,e,o),zj(n,e,h,f,r,c)}if(l&&l.length)for(let d of l)c??=aC(n,e,o),zj(n,e,d,r,r,c)}}function $t(i=1){return vj(i)}function B6(i,e){let t=null,n=fW(i);for(let r=0;r<e.length;r++){let o=e[r];if(o==="*"){t=r;continue}if(n===null?WO(i,o,!0):gW(n,o))return r}return t}function ie(i){let e=Tt()[so][oo];if(!e.projection){let t=i?i.length:1,n=e.projection=$N(t,null),r=n.slice(),o=e.child;for(;o!==null;){if(o.type!==128){let s=i?B6(o,i):0;s!==null&&(r[s]?r[s].projectionNext=o:n[s]=o,r[s]=o)}o=o.next}}}function Q(i,e=0,t,n,r,o){let s=Tt(),a=pi(),c=n?i+1:null;c!==null&&_f(s,a,c,n,r,o,null,t);let l=xd(a,ri+i,16,null,t||null);l.projection===null&&(l.projection=e),qT();let d=!s[od]||zT();s[so][oo].projection[l.projection]===null&&c!==null?U6(s,a,c):d&&!Vy(l)&&LW(a,s,l)}function U6(i,e,t){let n=ri+t,r=e.data[n],o=i[n],s=Ey(o,r.tView.ssrId),a=Ng(i,r,void 0,{dehydratedView:s});jg(o,a,0,gf(r,s))}function xi(i,e,t,n){a6(i,e,t,n)}function tn(i,e,t){s6(i,e,t)}function st(i){let e=Tt(),t=pi(),n=KT();cy(n+1);let r=DE(t,n);if(i.dirty&&ij(e)===((r.metadata.flags&2)===2)){if(r.matches===null)i.reset([]);else{let o=u6(e,n);i.reset(o,E5),i.notifyOnChanges()}return!0}return!1}function at(){return o6(Tt(),KT())}function Ft(i){let e=XT();return hg(e,ri+i)}function _y(i,e){return i<<17|e<<2}function vd(i){return i>>17&32767}function V6(i){return(i&2)==2}function z6(i,e){return i&131071|e<<17}function ZC(i){return i|2}function bf(i){return(i&131068)>>2}function dC(i,e){return i&-131069|e<<2}function H6(i){return(i&1)===1}function YC(i){return i|1}function G6(i,e,t,n,r,o){let s=o?e.classBindings:e.styleBindings,a=vd(s),c=bf(s);i[n]=t;let l=!1,u;if(Array.isArray(t)){let d=t;u=d[1],(u===null||tf(d,u)>0)&&(l=!0)}else u=t;if(r)if(c!==0){let h=vd(i[a+1]);i[n+1]=_y(h,a),h!==0&&(i[h+1]=dC(i[h+1],n)),i[a+1]=z6(i[a+1],n)}else i[n+1]=_y(a,0),a!==0&&(i[a+1]=dC(i[a+1],n)),a=n;else i[n+1]=_y(c,0),a===0?a=n:i[c+1]=dC(i[c+1],n),c=n;l&&(i[n+1]=ZC(i[n+1])),Kj(i,u,n,!0),Kj(i,u,n,!1),W6(e,u,i,n,o),s=_y(a,c),o?e.classBindings=s:e.styleBindings=s}function W6(i,e,t,n,r){let o=r?i.residualClasses:i.residualStyles;o!=null&&typeof e=="string"&&tf(o,e)>=0&&(t[n+1]=YC(t[n+1]))}function Kj(i,e,t,n){let r=i[t+1],o=e===null,s=n?vd(r):bf(r),a=!1;for(;s!==0&&(a===!1||o);){let c=i[s],l=i[s+1];$6(c,e)&&(a=!0,i[s+1]=n?YC(l):ZC(l)),s=n?vd(l):bf(l)}a&&(i[t+1]=n?ZC(r):YC(r))}function $6(i,e){return i===null||e==null||(Array.isArray(i)?i[1]:i)===e?!0:Array.isArray(i)&&typeof e=="string"?tf(i,e)>=0:!1}var gr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function VL(i){return i.substring(gr.key,gr.keyEnd)}function q6(i){return i.substring(gr.value,gr.valueEnd)}function X6(i){return GL(i),zL(i,vf(i,0,gr.textEnd))}function zL(i,e){let t=gr.textEnd;return t===e?-1:(e=gr.keyEnd=Y6(i,gr.key=e,t),vf(i,e,t))}function Z6(i){return GL(i),HL(i,vf(i,0,gr.textEnd))}function HL(i,e){let t=gr.textEnd,n=gr.key=vf(i,e,t);return t===n?-1:(n=gr.keyEnd=Q6(i,n,t),n=Jj(i,n,t,58),n=gr.value=vf(i,n,t),n=gr.valueEnd=K6(i,n,t),Jj(i,n,t,59))}function GL(i){gr.key=0,gr.keyEnd=0,gr.value=0,gr.valueEnd=0,gr.textEnd=i.length}function vf(i,e,t){for(;e<t&&i.charCodeAt(e)<=32;)e++;return e}function Y6(i,e,t){for(;e<t&&i.charCodeAt(e)>32;)e++;return e}function Q6(i,e,t){let n;for(;e<t&&((n=i.charCodeAt(e))===45||n===95||(n&-33)>=65&&(n&-33)<=90||n>=48&&n<=57);)e++;return e}function Jj(i,e,t,n){return e=vf(i,e,t),e<t&&e++,e}function K6(i,e,t){let n=-1,r=-1,o=-1,s=e,a=s;for(;s<t;){let c=i.charCodeAt(s++);if(c===59)return a;c===34||c===39?a=s=eO(i,c,s,t):e===s-4&&o===85&&r===82&&n===76&&c===40?a=s=eO(i,41,s,t):c>32&&(a=s),o=r,r=n,n=c&-33}return a}function eO(i,e,t,n){let r=-1,o=t;for(;o<n;){let s=i.charCodeAt(o++);if(s==e&&r!==92)return o;s==92&&r===92?r=0:r=s}throw new Error}function qs(i,e,t){return WL(i,e,t,!1),qs}function sn(i,e){return WL(i,e,null,!0),sn}function zl(i){$L(ZL,J6,i,!1)}function J6(i,e){for(let t=Z6(e);t>=0;t=HL(e,t))ZL(i,VL(e),q6(e))}function Xs(i){$L(s$,e$,i,!0)}function e$(i,e){for(let t=X6(e);t>=0;t=zL(e,t))ag(i,VL(e),!0)}function WL(i,e,t,n){let r=Tt(),o=pi(),s=QT(2);if(o.firstUpdatePass&&XL(o,i,s,n),e!==Wo&&ds(r,s,e)){let a=o.data[za()];YL(o,a,r,r[fi],i,r[s+1]=c$(e,t),n,s)}}function $L(i,e,t,n){let r=pi(),o=QT(2);r.firstUpdatePass&&XL(r,null,o,n);let s=Tt();if(t!==Wo&&ds(s,o,t)){let a=r.data[za()];if(QL(a,n)&&!qL(r,o)){let c=n?a.classesWithoutHost:a.stylesWithoutHost;c!==null&&(t=K0(c,t||"")),XC(r,a,s,t,n)}else a$(r,a,s,s[fi],s[o+1],s[o+1]=o$(i,e,t),n,o)}}function qL(i,e){return e>=i.expandoStartIndex}function XL(i,e,t,n){let r=i.data;if(r[t+1]===null){let o=r[za()],s=qL(i,t);QL(o,n)&&e===null&&!s&&(e=!1),e=t$(r,o,e,n),G6(r,o,e,t,s,n)}}function t$(i,e,t,n){let r=mj(i),o=n?e.residualClasses:e.residualStyles;if(r===null)(n?e.classBindings:e.styleBindings)===0&&(t=hC(null,i,e,t,n),t=Cg(t,e.attrs,n),o=null);else{let s=e.directiveStylingLast;if(s===-1||i[s]!==r)if(t=hC(r,i,e,t,n),o===null){let c=n$(i,e,n);c!==void 0&&Array.isArray(c)&&(c=hC(null,i,e,c[1],n),c=Cg(c,e.attrs,n),i$(i,e,n,c))}else o=r$(i,e,n)}return o!==void 0&&(n?e.residualClasses=o:e.residualStyles=o),t}function n$(i,e,t){let n=t?e.classBindings:e.styleBindings;if(bf(n)!==0)return i[vd(n)]}function i$(i,e,t,n){let r=t?e.classBindings:e.styleBindings;i[vd(r)]=n}function r$(i,e,t){let n,r=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<r;o++){let s=i[o].hostAttrs;n=Cg(n,s,t)}return Cg(n,e.attrs,t)}function hC(i,e,t,n,r){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],n=Cg(n,o.hostAttrs,r),o!==i);)a++;return i!==null&&(t.directiveStylingLast=a),n}function Cg(i,e,t){let n=t?1:2,r=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?r=s:r===n&&(Array.isArray(i)||(i=i===void 0?[]:["",i]),ag(i,s,t?!0:e[++o]))}return i===void 0?null:i}function o$(i,e,t){if(t==null||t==="")return ro;let n=[],r=Go(t);if(Array.isArray(r))for(let o=0;o<r.length;o++)i(n,r[o],!0);else if(typeof r=="object")for(let o in r)r.hasOwnProperty(o)&&i(n,o,r[o]);else typeof r=="string"&&e(n,r);return n}function ZL(i,e,t){ag(i,e,Go(t))}function s$(i,e,t){let n=String(e);n!==""&&!n.includes(" ")&&ag(i,n,t)}function a$(i,e,t,n,r,o,s,a){r===Wo&&(r=ro);let c=0,l=0,u=0<r.length?r[0]:null,d=0<o.length?o[0]:null;for(;u!==null||d!==null;){let h=c<r.length?r[c+1]:void 0,f=l<o.length?o[l+1]:void 0,g=null,_;u===d?(c+=2,l+=2,h!==f&&(g=d,_=f)):d===null||u!==null&&u<d?(c+=2,g=u):(l+=2,g=d,_=f),g!==null&&YL(i,e,t,n,g,_,s,a),u=c<r.length?r[c]:null,d=l<o.length?o[l]:null}}function YL(i,e,t,n,r,o,s,a){if(!(e.type&3))return;let c=i.data,l=c[a+1],u=H6(l)?tO(c,e,t,r,bf(l),s):void 0;if(!ky(u)){ky(o)||V6(l)&&(o=tO(c,null,t,r,a,s));let d=jT(za(),t);BW(n,s,d,r,o)}}function tO(i,e,t,n,r,o){let s=e===null,a;for(;r>0;){let c=i[r],l=Array.isArray(c),u=l?c[1]:c,d=u===null,h=t[r+1];h===Wo&&(h=d?ro:void 0);let f=d?ny(h,n):u===n?h:void 0;if(l&&!ky(f)&&(f=ny(c,n)),ky(f)&&(a=f,s))return a;let g=i[r+1];r=s?vd(g):bf(g)}if(e!==null){let c=o?e.residualClasses:e.residualStyles;c!=null&&(a=ny(c,n))}return a}function ky(i){return i!==void 0}function c$(i,e){return i==null||i===""||(typeof e=="string"?i=i+e:typeof i=="object"&&(i=Ro(Go(i)))),i}function QL(i,e){return(i.flags&(e?8:16))!==0}function Vt(i,e=""){let t=Tt(),n=pi(),r=i+ri,o=n.firstCreatePass?xd(n,r,1,e,null):n.data[r],s=l$(n,t,o,e,i);t[r]=s,hy()&&_E(n,t,s,o),hd(o,!1)}var l$=(i,e,t,n,r)=>(gg(!0),yW(e[fi],n));function u$(i,e,t,n=""){return ds(i,fd(),t)?e+og(t)+n:Wo}function Sf(i){return ms("",i),Sf}function ms(i,e,t){let n=Tt(),r=u$(n,i,e,t);return r!==Wo&&d$(n,za(),r),ms}function d$(i,e,t){let n=jT(e,i);xW(i[fi],n,t)}function Td(i,e,t){nC(e)&&(e=e());let n=Tt(),r=fd();if(ds(n,r,e)){let o=pi(),s=dy();oL(s,n,i,e,n[fi],t)}return Td}function Rf(i,e){let t=nC(i);return t&&i.set(e),t}function Cd(i,e){let t=Tt(),n=pi(),r=mr();return UL(n,t,t[fi],r,i,e),Cd}var KL={};function ix(i){let e=pi(),t=Tt(),n=i+ri,r=xd(e,n,128,null,null);return hd(r,!1),fg(e,t,n,KL),ix}function VE(i){hs("NgLet");let e=pi(),t=Tt(),n=za();return fg(e,t,n,i),i}function zE(i){let e=XT(),t=hg(e,ri+i);if(t===KL)throw new Xe(314,!1);return t}function h$(i,e,t){let n=pi();if(n.firstCreatePass){let r=Va(i);QC(t,n.data,n.blueprint,r,!0),QC(e,n.data,n.blueprint,r,!1)}}function QC(i,e,t,n,r){if(i=Fr(i),Array.isArray(i))for(let o=0;o<i.length;o++)QC(i[o],e,t,n,r);else{let o=pi(),s=Tt(),a=mr(),c=nd(i)?i:Fr(i.provide),l=IT(i),u=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(nd(i)||!i.multi){let f=new bd(l,r,Dn),g=pC(c,e,r?u:u+h,d);g===-1?(gC(Ty(a,s),o,c),fC(o,i,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(f),s.push(f)):(t[g]=f,s[g]=f)}else{let f=pC(c,e,u+h,d),g=pC(c,e,u,u+h),_=f>=0&&t[f],m=g>=0&&t[g];if(r&&!m||!r&&!_){gC(Ty(a,s),o,c);let p=m$(r?p$:f$,t.length,r,n,l);!r&&m&&(t[g].providerFactory=p),fC(o,i,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(p),s.push(p)}else{let p=JL(t[r?g:f],l,!r&&n);fC(o,i,f>-1?f:g,p)}!r&&n&&m&&t[g].componentProviders++}}}function fC(i,e,t,n){let r=nd(e),o=KN(e);if(r||o){let c=(o?Fr(e.useClass):e).prototype.ngOnDestroy;if(c){let l=i.destroyHooks||(i.destroyHooks=[]);if(!r&&e.multi){let u=l.indexOf(t);u===-1?l.push(t,[n,c]):l[u+1].push(n,c)}else l.push(t,c)}}}function JL(i,e,t){return t&&i.componentProviders++,i.multi.push(e)-1}function pC(i,e,t,n){for(let r=t;r<n;r++)if(e[r]===i)return r;return-1}function f$(i,e,t,n,r){return KC(this.multi,[])}function p$(i,e,t,n,r){let o=this.multi,s;if(this.providerFactory){let a=this.providerFactory.componentProviders,c=yg(n,n[Rt],this.providerFactory.index,r);s=c.slice(0,a),KC(o,s);for(let l=a;l<c.length;l++)s.push(c[l])}else s=[],KC(o,s);return s}function KC(i,e){for(let t=0;t<i.length;t++){let n=i[t];e.push(n())}return e}function m$(i,e,t,n,r){let o=new bd(i,t,Dn);return o.multi=[],o.index=e,o.componentProviders=0,JL(o,r,n&&!t),o}function K(i,e=[]){return t=>{t.providersResolver=(n,r)=>h$(n,r?r(i):i,e)}}function V(i,e,t){let n=Ll()+i,r=Tt();return r[n]===Wo?Lg(r,n,t?e.call(t):e()):j8(r,n)}function _t(i,e,t,n){return ek(Tt(),Ll(),i,e,t,n)}function br(i,e,t,n,r){return tk(Tt(),Ll(),i,e,t,n,r)}function Zs(i,e,t,n,r,o){return g$(Tt(),Ll(),i,e,t,n,r,o)}function Ed(i,e,t,n,r,o,s){return _$(Tt(),Ll(),i,e,t,n,r,o,s)}function rx(i,e){let t=i[e];return t===Wo?void 0:t}function ek(i,e,t,n,r,o){let s=e+t;return ds(i,s,r)?Lg(i,s+1,o?n.call(o,r):n(r)):rx(i,s+1)}function tk(i,e,t,n,r,o,s){let a=e+t;return Iy(i,a,r,o)?Lg(i,a+2,s?n.call(s,r,o):n(r,o)):rx(i,a+2)}function g$(i,e,t,n,r,o,s,a){let c=e+t;return O8(i,c,r,o,s)?Lg(i,c+3,a?n.call(a,r,o,s):n(r,o,s)):rx(i,c+3)}function _$(i,e,t,n,r,o,s,a,c){let l=e+t;return L8(i,l,r,o,s,a)?Lg(i,l+4,c?n.call(c,r,o,s,a):n(r,o,s,a)):rx(i,l+4)}function In(i,e){let t=pi(),n,r=i+ri;t.firstCreatePass?(n=b$(e,t.pipeRegistry),t.data[r]=n,n.onDestroy&&(t.destroyHooks??=[]).push(r,n.onDestroy)):n=t.data[r];let o=n.factory||(n.factory=Dl(n.type,!0)),s,a=io(Dn);try{let c=Ry(!1),l=o();return Ry(c),fg(t,Tt(),r,l),l}finally{io(a)}}function b$(i,e){if(e)for(let t=e.length-1;t>=0;t--){let n=e[t];if(i===n.name)return n}}function jn(i,e,t){let n=i+ri,r=Tt(),o=hg(r,n);return nk(r,n)?ek(r,Ll(),e,o.transform,t,o):o.transform(t)}function HE(i,e,t,n){let r=i+ri,o=Tt(),s=hg(o,r);return nk(o,r)?tk(o,Ll(),e,s.transform,t,n,s):s.transform(t,n)}function nk(i,e){return i[Rt].data[e].pure}function ox(i,e){return Xy(i,e)}var By=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},GE=(()=>{class i{compileModuleSync(t){return new Ny(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let n=this.compileModuleSync(t),r=TT(t),o=HO(r.declarations).reduce((s,a)=>{let c=La(a);return c&&s.push(new Ul(c)),s},[]);return new By(n,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var v$=(()=>{class i{zone=S(pt);changeDetectionScheduler=S(Vo);applicationRef=S(ps);applicationErrorHandler=S(ao);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{try{this.applicationRef.dirtyFlags|=1,this.applicationRef._tick()}catch(t){this.applicationErrorHandler(t)}})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function ik({ngZoneFactory:i,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return i??=()=>new pt(jt(ae({},rk()),{scheduleInRootZone:t})),[{provide:pt,useFactory:i},{provide:Ic,multi:!0,useFactory:()=>{let n=S(v$,{optional:!0});return()=>n.initialize()}},{provide:Ic,multi:!0,useFactory:()=>{let n=S(y$);return()=>{n.initialize()}}},e===!0?{provide:iC,useValue:!0}:[],{provide:fy,useValue:t??FL},{provide:ao,useFactory:()=>{let n=S(pt),r=S(Ei),o;return s=>{n.runOutsideAngular(()=>{r.destroyed&&!o?setTimeout(()=>{throw s}):(o??=r.get(Mr),o.handleError(s))})}}}]}function rk(i){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:i?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:i?.runCoalescing??!1}}var y$=(()=>{class i{subscription=new Rn;initialized=!1;zone=S(pt);pendingTasks=S(Pc);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{pt.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{pt.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var WE=(()=>{class i{applicationErrorHandler=S(ao);appRef=S(ps);taskService=S(Pc);ngZone=S(pt);zonelessEnabled=S(df);tracing=S(Vl,{optional:!0});disableScheduling=S(iC,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Rn;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(jy):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(S(fy,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Rg||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let n=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,n=!0;break}case 12:{this.appRef.dirtyFlags|=16,n=!0;break}case 13:{this.appRef.dirtyFlags|=2,n=!0;break}case 11:{n=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(n))return;let r=this.useMicrotaskScheduler?qj:NL;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(jy+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(n){this.taskService.remove(t),this.applicationErrorHandler(n)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,qj(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function $E(){return hs("NgZoneless"),Vs([{provide:Vo,useExisting:WE},{provide:pt,useClass:Rg},{provide:df,useValue:!0},{provide:fy,useValue:!1},[]])}function x$(){return typeof $localize<"u"&&$localize.locale||Bg}var sx=new me("",{providedIn:"root",factory:()=>S(sx,{optional:!0,skipSelf:!0})||x$()});var Ug=class{destroyed=!1;listeners=null;errorHandler=S(Mr,{optional:!0});destroyRef=S(Nr);constructor(){this.destroyRef.onDestroy(()=>{this.destroyed=!0,this.listeners=null})}subscribe(e){if(this.destroyed)throw new Xe(953,!1);return(this.listeners??=[]).push(e),{unsubscribe:()=>{let t=this.listeners?.indexOf(e);t!==void 0&&t!==-1&&this.listeners?.splice(t,1)}}}emit(e){if(this.destroyed){console.warn(Oa(953,!1));return}if(this.listeners===null)return;let t=Lt(null);try{for(let n of this.listeners)try{n(e)}catch(r){this.errorHandler?.handleError(r)}}finally{Lt(t)}}};function Fi(i){return ON(i)}function qo(i,e){return _0(i,e?.equal)}var qE=class{[Zi];constructor(e){this[Zi]=e}destroy(){this[Zi].destroy()}};function Tf(i,e){let t=e?.injector??S(yn),n=e?.manualCleanup!==!0?t.get(Nr):null,r,o=t.get(pd,null,{optional:!0}),s=t.get(Vo);return o!==null?(r=S$(o.view,s,i),n instanceof ig&&n._lView===o.view&&(n=null)):r=R$(i,t.get(_g),s),r.injector=t,n!==null&&(r.onDestroyFn=n.onDestroy(()=>r.destroy())),new qE(r)}var ak=jt(ae({},Mc),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,hasRun:!1,cleanupFns:void 0,zone:null,kind:"effect",onDestroyFn:gd,run(){if(this.dirty=!1,this.hasRun&&!Wu(this))return;this.hasRun=!0;let i=n=>(this.cleanupFns??=[]).push(n),e=Pa(this),t=cf(!1);try{this.maybeCleanup(),this.fn(i)}finally{cf(t),Rc(this,e)}},maybeCleanup(){if(!this.cleanupFns?.length)return;let i=Lt(null);try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[],Lt(i)}}}),w$=jt(ae({},ak),{consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(12)},destroy(){Hh(this),this.onDestroyFn(),this.maybeCleanup(),this.scheduler.remove(this)}}),M$=jt(ae({},ak),{consumerMarkedDirty(){this.view[Ht]|=8192,Ol(this.view),this.notifier.notify(13)},destroy(){Hh(this),this.onDestroyFn(),this.maybeCleanup(),this.view[Ac]?.delete(this)}});function S$(i,e,t){let n=Object.create(M$);return n.view=i,n.zone=typeof Zone<"u"?Zone.current:null,n.notifier=e,n.fn=t,i[Ac]??=new Set,i[Ac].add(n),n.consumerMarkedDirty(n),n}function R$(i,e,t){let n=Object.create(w$);return n.fn=i,n.scheduler=e,n.notifier=t,n.zone=typeof Zone<"u"?Zone.current:null,n.scheduler.add(n),n.notifier.notify(12),n}var T$=i=>i;function XE(i,e){if(typeof i=="function"){let t=iT(i,T$,e?.equal);return ok(t)}else{let t=iT(i.source,i.computation,i.equal);return ok(t)}}function ok(i){let e=i[Zi],t=i;return t.set=n=>NN(e,n),t.update=n=>jN(e,n),t.asReadonly=uf.bind(i),t}var ck=!0;function JE(i){let e=i.request,t=i.params??e??(()=>null);return new ax(t,E$(i),i.defaultValue,i.equal?C$(i.equal):void 0,i.injector??S(yn),ck)}var ZE=class{value;constructor(e){this.value=e,this.value.set=this.set.bind(this),this.value.update=this.update.bind(this),this.value.asReadonly=uf}isError=qo(()=>this.status()==="error");update(e){this.set(e(Fi(this.value)))}isLoading=qo(()=>this.status()==="loading"||this.status()==="reloading");hasValue(){return this.isError()?!1:this.value()!==void 0}asReadonly(){return this}},ax=class extends ZE{loaderFn;equal;pendingTasks;state;extRequest;effectRef;pendingController;resolvePendingTask=void 0;destroyed=!1;unregisterOnDestroy;constructor(e,t,n,r,o,s=ck){super(qo(()=>{let a=this.state().stream?.();if(!a||this.state().status==="loading"&&this.error())return n;if(!YE(a)){if(s)throw new QE(this.error());return n}return a.value},{equal:r})),this.loaderFn=t,this.equal=r,this.extRequest=XE({source:e,computation:a=>({request:a,reload:0})}),this.state=XE({source:this.extRequest,computation:(a,c)=>{let l=a.request===void 0?"idle":"loading";return c?{extRequest:a,status:l,previousStatus:sk(c.value),stream:c.value.extRequest.request===a.request?c.value.stream:void 0}:{extRequest:a,status:l,previousStatus:"idle",stream:void 0}}}),this.effectRef=Tf(this.loadEffect.bind(this),{injector:o,manualCleanup:!0}),this.pendingTasks=o.get(md),this.unregisterOnDestroy=o.get(Nr).onDestroy(()=>this.destroy())}status=qo(()=>sk(this.state()));error=qo(()=>{let e=this.state().stream?.();return e&&!YE(e)?e.error:void 0});set(e){if(this.destroyed)return;let t=Fi(this.error),n=Fi(this.state);if(!t){let r=Fi(this.value);if(n.status==="local"&&(this.equal?this.equal(r,e):r===e))return}this.state.set({extRequest:n.extRequest,status:"local",previousStatus:"local",stream:Vn({value:e})}),this.abortInProgressLoad()}reload(){let{status:e}=Fi(this.state);return e==="idle"||e==="loading"?!1:(this.extRequest.update(({request:t,reload:n})=>({request:t,reload:n+1})),!0)}destroy(){this.destroyed=!0,this.unregisterOnDestroy(),this.effectRef.destroy(),this.abortInProgressLoad(),this.state.set({extRequest:{request:void 0,reload:0},status:"idle",previousStatus:"idle",stream:void 0})}loadEffect(){return Wt(this,null,function*(){let e=this.extRequest(),{status:t,previousStatus:n}=Fi(this.state);if(e.request===void 0)return;if(t!=="loading")return;this.abortInProgressLoad();let r=this.resolvePendingTask=this.pendingTasks.add(),{signal:o}=this.pendingController=new AbortController;try{let s=yield Fi(()=>this.loaderFn({params:e.request,request:e.request,abortSignal:o,previous:{status:n}}));if(o.aborted||Fi(this.extRequest)!==e)return;this.state.set({extRequest:e,status:"resolved",previousStatus:"resolved",stream:s})}catch(s){if(o.aborted||Fi(this.extRequest)!==e)return;this.state.set({extRequest:e,status:"resolved",previousStatus:"error",stream:Vn({error:eD(s)})})}finally{r?.(),r=void 0}})}abortInProgressLoad(){Fi(()=>this.pendingController?.abort()),this.pendingController=void 0,this.resolvePendingTask?.(),this.resolvePendingTask=void 0}};function C$(i){return(e,t)=>e===void 0||t===void 0?e===t:i(e,t)}function E$(i){return D$(i)?i.stream:e=>Wt(null,null,function*(){try{return Vn({value:yield i.loader(e)})}catch(t){return Vn({error:eD(t)})}})}function D$(i){return!!i.stream}function sk(i){switch(i.status){case"loading":return i.extRequest.reload===0?"loading":"reloading";case"resolved":return YE(i.stream())?"resolved":"error";default:return i.status}}function YE(i){return i.error===void 0}function eD(i){return i instanceof Error?i:new KE(i)}var QE=class extends Error{constructor(e){super(e.message,{cause:e})}},KE=class extends Error{constructor(e){super(String(e),{cause:e})}};var lx=Symbol("InputSignalNode#UNSET"),fk=jt(ae({},Wm),{transformFn:void 0,applyValueToInputSignal(i,e){Rl(i,e)}});function pk(i,e){let t=Object.create(fk);t.value=i,t.transformFn=e?.transform;function n(){if(Sc(t),t.value===lx){let r=null;throw new Xe(-950,r)}return t.value}return n[Zi]=t,n}var Dd=class{attributeName;constructor(e){this.attributeName=e}__NG_ELEMENT_ID__=()=>Dg(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}},G$=new me("");G$.__NG_ELEMENT_ID__=i=>{let e=mr();if(e===null)throw new Xe(204,!1);if(e.type&2)return e.value;if(i&8)return null;throw new Xe(204,!1)};function mk(i){return new Ug}function lk(i,e){return pk(i,e)}function W$(i){return pk(lx,i)}var Cf=(lk.required=W$,lk);function gk(i,e){let t=Object.create(fk),n=new Ug;t.value=i;function r(){return Sc(t),uk(t.value),t.value}return r[Zi]=t,r.asReadonly=uf.bind(r),r.set=o=>{t.equal(t.value,o)||(Rl(t,o),n.emit(o))},r.update=o=>{uk(t.value),r.set(o(t.value))},r.subscribe=n.subscribe.bind(n),r.destroyRef=n.destroyRef,r}function uk(i){if(i===lx)throw new Xe(952,!1)}function dk(i,e){return gk(i,e)}function $$(i){return gk(lx,i)}var _k=(dk.required=$$,dk);var nD=new me(""),q$=new me("");function Vg(i){return!i.moduleRef}function X$(i){let e=Vg(i)?i.r3Injector:i.moduleRef.injector,t=e.get(pt);return t.run(()=>{Vg(i)?i.r3Injector.resolveInjectorInitializers():i.moduleRef.resolveInjectorInitializers();let n=e.get(ao),r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:n})}),Vg(i)){let o=()=>e.destroy(),s=i.platformInjector.get(nD);s.add(o),e.onDestroy(()=>{r.unsubscribe(),s.delete(o)})}else{let o=()=>i.moduleRef.destroy(),s=i.platformInjector.get(nD);s.add(o),i.moduleRef.onDestroy(()=>{vg(i.allPlatformModules,i.moduleRef),r.unsubscribe(),s.delete(o)})}return Y$(n,t,()=>{let o=e.get(LE);return o.runInitializers(),o.donePromise.then(()=>{let s=e.get(sx,Bg);if(BL(s||Bg),!e.get(q$,!0))return Vg(i)?e.get(ps):(i.allPlatformModules.push(i.moduleRef),i.moduleRef);if(Vg(i)){let c=e.get(ps);return i.rootComponent!==void 0&&c.bootstrap(i.rootComponent),c}else return Z$?.(i.moduleRef,i.allPlatformModules),i.moduleRef})})})}var Z$;function Y$(i,e,t){try{let n=t();return Lc(n)?n.catch(r=>{throw e.runOutsideAngular(()=>i(r)),r}):n}catch(n){throw e.runOutsideAngular(()=>i(n)),n}}var cx=null;function Q$(i=[],e){return yn.create({name:e,providers:[{provide:cg,useValue:"platform"},{provide:nD,useValue:new Set([()=>cx=null])},...i]})}function K$(i=[]){if(cx)return cx;let e=Q$(i);return cx=e,OL(),J$(e),e}function J$(i){let e=i.get(Uy,null);Sr(i,()=>{e?.forEach(t=>t())})}function bk(){return!1}var Ni=(()=>{class i{static __NG_ELEMENT_ID__=e9}return i})();function e9(i){return t9(mr(),Tt(),(i&16)===16)}function t9(i,e,t){if(jl(i)&&!t){let n=us(i.index,e);return new Bl(n,n)}else if(i.type&175){let n=e[so];return new Bl(n,e)}return null}function vk(i){Xn(8);try{let{rootComponent:e,appProviders:t,platformProviders:n}=i,r=K$(n),o=[ik({}),{provide:Vo,useExisting:WE},wj,...t||[]],s=new Sg({providers:o,parent:r,debugName:"",runEnvironmentInitializers:!1});return X$({r3Injector:s.injector,platformInjector:r,rootComponent:e})}catch(e){return Promise.reject(e)}finally{Xn(9)}}function On(i){return typeof i=="boolean"?i:i!=null&&i!=="false"}function Id(i,e=NaN){return!isNaN(parseFloat(i))&&!isNaN(Number(i))?Number(i):e}var tD=Symbol("NOT_SET"),yk=new Set,n9=jt(ae({},Wm),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,value:tD,cleanup:null,consumerMarkedDirty(){if(this.sequence.impl.executing){if(this.sequence.lastPhase===null||this.sequence.lastPhase<this.phase)return;this.sequence.erroredOrDestroyed=!0}this.sequence.scheduler.notify(7)},phaseFn(i){if(this.sequence.lastPhase=this.phase,!this.dirty)return this.signal;if(this.dirty=!1,this.value!==tD&&!Wu(this))return this.signal;try{for(let r of this.cleanup??yk)r()}finally{this.cleanup?.clear()}let e=[];i!==void 0&&e.push(i),e.push(this.registerCleanupFn);let t=Pa(this),n;try{n=this.userFn.apply(null,e)}finally{Rc(this,t)}return(this.value===tD||!this.equal(this.value,n))&&(this.value=n,this.version++),this.signal}}),iD=class extends Tg{scheduler;lastPhase=null;nodes=[void 0,void 0,void 0,void 0];constructor(e,t,n,r,o,s=null){super(e,[void 0,void 0,void 0,void 0],n,!1,o,s),this.scheduler=r;for(let a of FE){let c=t[a];if(c===void 0)continue;let l=Object.create(n9);l.sequence=this,l.phase=a,l.userFn=c,l.dirty=!0,l.signal=()=>(Sc(l),l.value),l.signal[Zi]=l,l.registerCleanupFn=u=>(l.cleanup??=new Set).add(u),this.nodes[a]=l,this.hooks[a]=u=>l.phaseFn(u)}}afterRun(){super.afterRun(),this.lastPhase=null}destroy(){super.destroy();for(let e of this.nodes)for(let t of e?.cleanup??yk)t()}};function oD(i,e){let t=e?.injector??S(yn),n=t.get(Vo),r=t.get(Jy),o=t.get(Vl,null,{optional:!0});r.impl??=t.get(NE);let s=i;typeof s=="function"&&(s={mixedReadWrite:i});let a=t.get(pd,null,{optional:!0}),c=new iD(r.impl,[s.earlyRead,s.write,s.mixedReadWrite,s.read],a?.view,n,t.get(Nr),o?.snapshot(null));return r.impl.register(c),c}function sD(i,e){let t=La(i),n=e.elementInjector||nf();return new Ul(t).create(n,e.projectableNodes,e.hostElement,e.environmentInjector,e.directives,e.bindings)}function xk(i){let e=La(i);if(!e)return null;let t=new Ul(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var Sk=null;function gs(){return Sk}function aD(i){Sk??=i}var zg=class{},Hg=(()=>{class i{historyGo(t){throw new Error("")}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:()=>S(Rk),providedIn:"platform"})}return i})(),cD=new me(""),Rk=(()=>{class i extends Hg{_location;_history;_doc=S(kt);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return gs().getBaseHref(this._doc)}onPopState(t){let n=gs().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",t,!1),()=>n.removeEventListener("popstate",t)}onHashChange(t){let n=gs().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",t,!1),()=>n.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,n,r){this._history.pushState(t,n,r)}replaceState(t,n,r){this._history.replaceState(t,n,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:()=>new i,providedIn:"platform"})}return i})();function ux(i,e){return i?e?i.endsWith("/")?e.startsWith("/")?i+e.slice(1):i+e:e.startsWith("/")?i+e:`${i}/${e}`:i:e}function wk(i){let e=i.search(/#|\?|$/);return i[e-1]==="/"?i.slice(0,e-1)+i.slice(e):i}function Ys(i){return i&&i[0]!=="?"?`?${i}`:i}var Qs=(()=>{class i{historyGo(t){throw new Error("")}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:()=>S(hx),providedIn:"root"})}return i})(),dx=new me(""),hx=(()=>{class i extends Qs{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,n){super(),this._platformLocation=t,this._baseHref=n??this._platformLocation.getBaseHrefFromDOM()??S(kt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return ux(this._baseHref,t)}path(t=!1){let n=this._platformLocation.pathname+Ys(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${n}${r}`:n}pushState(t,n,r,o){let s=this.prepareExternalUrl(r+Ys(o));this._platformLocation.pushState(t,n,s)}replaceState(t,n,r,o){let s=this.prepareExternalUrl(r+Ys(o));this._platformLocation.replaceState(t,n,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(n){return new(n||i)(ht(Hg),ht(dx,8))};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),Hl=(()=>{class i{_subject=new lt;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let n=this._locationStrategy.getBaseHref();this._basePath=o9(wk(Mk(n))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,n=""){return this.path()==this.normalize(t+Ys(n))}normalize(t){return i.stripTrailingSlash(r9(this._basePath,Mk(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,n="",r=null){this._locationStrategy.pushState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ys(n)),r)}replaceState(t,n="",r=null){this._locationStrategy.replaceState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ys(n)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)}),()=>{let n=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(n,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",n){this._urlChangeListeners.forEach(r=>r(t,n))}subscribe(t,n,r){return this._subject.subscribe({next:t,error:n??void 0,complete:r??void 0})}static normalizeQueryParams=Ys;static joinWithSlash=ux;static stripTrailingSlash=wk;static \u0275fac=function(n){return new(n||i)(ht(Qs))};static \u0275prov=ge({token:i,factory:()=>i9(),providedIn:"root"})}return i})();function i9(){return new Hl(ht(Qs))}function r9(i,e){if(!i||!e.startsWith(i))return e;let t=e.substring(i.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function Mk(i){return i.replace(/\/index.html$/,"")}function o9(i){if(new RegExp("^(https?:)?//").test(i)){let[,t]=i.split(/\/\/[^\/]+/);return t}return i}var dD=(()=>{class i extends Qs{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(t,n){super(),this._platformLocation=t,n!=null&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let n=this._platformLocation.hash??"#";return n.length>0?n.substring(1):n}prepareExternalUrl(t){let n=ux(this._baseHref,t);return n.length>0?"#"+n:n}pushState(t,n,r,o){let s=this.prepareExternalUrl(r+Ys(o))||this._platformLocation.pathname;this._platformLocation.pushState(t,n,s)}replaceState(t,n,r,o){let s=this.prepareExternalUrl(r+Ys(o))||this._platformLocation.pathname;this._platformLocation.replaceState(t,n,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(n){return new(n||i)(ht(Hg),ht(dx,8))};static \u0275prov=ge({token:i,factory:i.\u0275fac})}return i})();var hD=(()=>{class i{_viewContainerRef;ngComponentOutlet=null;ngComponentOutletInputs;ngComponentOutletInjector;ngComponentOutletEnvironmentInjector;ngComponentOutletContent;ngComponentOutletNgModule;ngComponentOutletNgModuleFactory;_componentRef;_moduleRef;_inputsUsed=new Map;get componentInstance(){return this._componentRef?.instance??null}constructor(t){this._viewContainerRef=t}_needToReCreateNgModuleInstance(t){return t.ngComponentOutletNgModule!==void 0||t.ngComponentOutletNgModuleFactory!==void 0}_needToReCreateComponentInstance(t){return t.ngComponentOutlet!==void 0||t.ngComponentOutletContent!==void 0||t.ngComponentOutletInjector!==void 0||t.ngComponentOutletEnvironmentInjector!==void 0||this._needToReCreateNgModuleInstance(t)}ngOnChanges(t){if(this._needToReCreateComponentInstance(t)&&(this._viewContainerRef.clear(),this._inputsUsed.clear(),this._componentRef=void 0,this.ngComponentOutlet)){let n=this.ngComponentOutletInjector||this._viewContainerRef.parentInjector;this._needToReCreateNgModuleInstance(t)&&(this._moduleRef?.destroy(),this.ngComponentOutletNgModule?this._moduleRef=IE(this.ngComponentOutletNgModule,Tk(n)):this.ngComponentOutletNgModuleFactory?this._moduleRef=this.ngComponentOutletNgModuleFactory.create(Tk(n)):this._moduleRef=void 0),this._componentRef=this._viewContainerRef.createComponent(this.ngComponentOutlet,{injector:n,ngModuleRef:this._moduleRef,projectableNodes:this.ngComponentOutletContent,environmentInjector:this.ngComponentOutletEnvironmentInjector})}}ngDoCheck(){if(this._componentRef){if(this.ngComponentOutletInputs)for(let t of Object.keys(this.ngComponentOutletInputs))this._inputsUsed.set(t,!0);this._applyInputStateDiff(this._componentRef)}}ngOnDestroy(){this._moduleRef?.destroy()}_applyInputStateDiff(t){for(let[n,r]of this._inputsUsed)r?(t.setInput(n,this.ngComponentOutletInputs[n]),this._inputsUsed.set(n,!1)):(t.setInput(n,void 0),this._inputsUsed.delete(n))}static \u0275fac=function(n){return new(n||i)(Dn(Ur))};static \u0275dir=Ge({type:i,selectors:[["","ngComponentOutlet",""]],inputs:{ngComponentOutlet:"ngComponentOutlet",ngComponentOutletInputs:"ngComponentOutletInputs",ngComponentOutletInjector:"ngComponentOutletInjector",ngComponentOutletEnvironmentInjector:"ngComponentOutletEnvironmentInjector",ngComponentOutletContent:"ngComponentOutletContent",ngComponentOutletNgModule:"ngComponentOutletNgModule",ngComponentOutletNgModuleFactory:"ngComponentOutletNgModuleFactory"},exportAs:["ngComponentOutlet"],features:[$i]})}return i})();function Tk(i){return i.get(Wa).injector}var fD=(()=>{class i{_viewContainerRef;_viewRef=null;ngTemplateOutletContext=null;ngTemplateOutlet=null;ngTemplateOutletInjector=null;constructor(t){this._viewContainerRef=t}ngOnChanges(t){if(this._shouldRecreateView(t)){let n=this._viewContainerRef;if(this._viewRef&&n.remove(n.indexOf(this._viewRef)),!this.ngTemplateOutlet){this._viewRef=null;return}let r=this._createContextForwardProxy();this._viewRef=n.createEmbeddedView(this.ngTemplateOutlet,r,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(t){return!!t.ngTemplateOutlet||!!t.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(t,n,r)=>this.ngTemplateOutletContext?Reflect.set(this.ngTemplateOutletContext,n,r):!1,get:(t,n,r)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,n,r)}})}static \u0275fac=function(n){return new(n||i)(Dn(Ur))};static \u0275dir=Ge({type:i,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},features:[$i]})}return i})();function a9(i,e){return new Xe(2100,!1)}var lD=class{createSubscription(e,t,n){return Fi(()=>e.subscribe({next:t,error:n}))}dispose(e){Fi(()=>e.unsubscribe())}},uD=class{createSubscription(e,t,n){return e.then(r=>t?.(r),r=>n?.(r)),{unsubscribe:()=>{t=null,n=null}}}dispose(e){e.unsubscribe()}},c9=new uD,l9=new lD,Gg=(()=>{class i{_ref;_latestValue=null;markForCheckOnValueUpdate=!0;_subscription=null;_obj=null;_strategy=null;applicationErrorHandler=S(ao);constructor(t){this._ref=t}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(t){if(!this._obj){if(t)try{this.markForCheckOnValueUpdate=!1,this._subscribe(t)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return t!==this._obj?(this._dispose(),this.transform(t)):this._latestValue}_subscribe(t){this._obj=t,this._strategy=this._selectStrategy(t),this._subscription=this._strategy.createSubscription(t,n=>this._updateLatestValue(t,n),n=>this.applicationErrorHandler(n))}_selectStrategy(t){if(Lc(t))return c9;if(tx(t))return l9;throw a9(i,t)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(t,n){t===this._obj&&(this._latestValue=n,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}static \u0275fac=function(n){return new(n||i)(Dn(Ni,16))};static \u0275pipe=$o({name:"async",type:i,pure:!1})}return i})();var fx=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Mn({type:i});static \u0275inj=xn({})}return i})();function Wg(i,e){e=encodeURIComponent(e);for(let t of i.split(";")){let n=t.indexOf("="),[r,o]=n==-1?[t,""]:[t.slice(0,n),t.slice(n+1)];if(r.trim()===e)return decodeURIComponent(o)}return null}var Ad=class{};var mD="browser";function px(i){return i===mD}var Ek=(()=>{class i{static \u0275prov=ge({token:i,providedIn:"root",factory:()=>new pD(S(kt),window)})}return i})(),pD=class{document;window;offset=()=>[0,0];constructor(e,t){this.document=e,this.window=t}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e,t){this.window.scrollTo(jt(ae({},t),{left:e[0],top:e[1]}))}scrollToAnchor(e,t){let n=d9(this.document,e);n&&(this.scrollToElement(n,t),n.focus())}setHistoryScrollRestoration(e){try{this.window.history.scrollRestoration=e}catch{console.warn(Oa(2400,!1))}}scrollToElement(e,t){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,o=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(jt(ae({},t),{left:r-s[0],top:o-s[1]}))}};function d9(i,e){let t=i.getElementById(e)||i.getElementsByName(e)[0];if(t)return t;if(typeof i.createTreeWalker=="function"&&i.body&&typeof i.body.attachShadow=="function"){let n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT),r=n.currentNode;for(;r;){let o=r.shadowRoot;if(o){let s=o.getElementById(e)||o.querySelector(`[name="${e}"]`);if(s)return s}r=n.nextNode()}}return null}var gx=new me(""),yD=(()=>{class i{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,n){this._zone=n,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,n,r,o){return this._findPluginFor(n).addEventListener(t,n,r,o)}getZone(){return this._zone}_findPluginFor(t){let n=this._eventNameToPlugin.get(t);if(n)return n;if(n=this._plugins.find(o=>o.supports(t)),!n)throw new Xe(5101,!1);return this._eventNameToPlugin.set(t,n),n}static \u0275fac=function(n){return new(n||i)(ht(gx),ht(pt))};static \u0275prov=ge({token:i,factory:i.\u0275fac})}return i})(),$g=class{_doc;constructor(e){this._doc=e}manager},gD="ng-app-id";function Dk(i){for(let e of i)e.remove()}function Ik(i,e){let t=e.createElement("style");return t.textContent=i,t}function f9(i,e,t,n){let r=i.head?.querySelectorAll(`style[${gD}="${e}"],link[${gD}="${e}"]`);if(r)for(let o of r)o.removeAttribute(gD),o instanceof HTMLLinkElement?n.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function bD(i,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",i),t}var xD=(()=>{class i{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,n,r,o={}){this.doc=t,this.appId=n,this.nonce=r,f9(t,n,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,n){for(let r of t)this.addUsage(r,this.inline,Ik);n?.forEach(r=>this.addUsage(r,this.external,bD))}removeStyles(t,n){for(let r of t)this.removeUsage(r,this.inline);n?.forEach(r=>this.removeUsage(r,this.external))}addUsage(t,n,r){let o=n.get(t);o?o.usage++:n.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,r(t,this.doc)))})}removeUsage(t,n){let r=n.get(t);r&&(r.usage--,r.usage<=0&&(Dk(r.elements),n.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])Dk(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[n,{elements:r}]of this.inline)r.push(this.addElement(t,Ik(n,this.doc)));for(let[n,{elements:r}]of this.external)r.push(this.addElement(t,bD(n,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,n){return this.nonce&&n.setAttribute("nonce",this.nonce),t.appendChild(n)}static \u0275fac=function(n){return new(n||i)(ht(kt),ht(xf),ht(wf,8),ht($a))};static \u0275prov=ge({token:i,factory:i.\u0275fac})}return i})(),_D={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},wD=/%COMP%/g;var Pk="%COMP%",p9=`_nghost-${Pk}`,m9=`_ngcontent-${Pk}`,g9=!0,_9=new me("",{providedIn:"root",factory:()=>g9});function b9(i){return m9.replace(wD,i)}function v9(i){return p9.replace(wD,i)}function Fk(i,e){return e.map(t=>t.replace(wD,i))}var MD=(()=>{class i{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,n,r,o,s,a,c,l=null,u=null){this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=c,this.nonce=l,this.tracingService=u,this.platformIsServer=!1,this.defaultRenderer=new qg(t,s,c,this.platformIsServer,this.tracingService)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;let r=this.getOrCreateRenderer(t,n);return r instanceof mx?r.applyToHost(t):r instanceof Xg&&r.applyStyles(),r}getOrCreateRenderer(t,n){let r=this.rendererByCompId,o=r.get(n.id);if(!o){let s=this.doc,a=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,d=this.platformIsServer,h=this.tracingService;switch(n.encapsulation){case Fc.Emulated:o=new mx(c,l,n,this.appId,u,s,a,d,h);break;case Fc.ShadowDom:return new vD(c,l,t,n,s,a,this.nonce,d,h);default:o=new Xg(c,l,n,u,s,a,d,h);break}r.set(n.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(n){return new(n||i)(ht(yD),ht(xD),ht(xf),ht(_9),ht(kt),ht($a),ht(pt),ht(wf),ht(Vl,8))};static \u0275prov=ge({token:i,factory:i.\u0275fac})}return i})(),qg=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,n,r,o){this.eventManager=e,this.doc=t,this.ngZone=n,this.platformIsServer=r,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(_D[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Ak(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(Ak(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){t.remove()}selectRootElement(e,t){let n=typeof e=="string"?this.doc.querySelector(e):e;if(!n)throw new Xe(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;let o=_D[r];o?e.setAttributeNS(o,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){let r=_D[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(Ga.DashCase|Ga.Important)?e.style.setProperty(t,n,r&Ga.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&Ga.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e!=null&&(e[t]=n)}setValue(e,t){e.nodeValue=t}listen(e,t,n,r){if(typeof e=="string"&&(e=gs().getGlobalEventTarget(this.doc,e),!e))throw new Xe(5102,!1);let o=this.decoratePreventDefault(n);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,r)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function Ak(i){return i.tagName==="TEMPLATE"&&i.content!==void 0}var vD=class extends qg{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,n,r,o,s,a,c,l){super(e,o,s,c,l),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=r.styles;u=Fk(r.id,u);for(let h of u){let f=document.createElement("style");a&&f.setAttribute("nonce",a),f.textContent=h,this.shadowRoot.appendChild(f)}let d=r.getExternalStyles?.();if(d)for(let h of d){let f=bD(h,o);a&&f.setAttribute("nonce",a),this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Xg=class extends qg{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,n,r,o,s,a,c,l){super(e,o,s,a,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r;let u=n.styles;this.styles=l?Fk(l,u):u,this.styleUrls=n.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},mx=class extends Xg{contentAttr;hostAttr;constructor(e,t,n,r,o,s,a,c,l){let u=r+"-"+n.id;super(e,t,n,o,s,a,c,l,u),this.contentAttr=b9(u),this.hostAttr=v9(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}};var _x=class i extends zg{supportsDOMEvents=!0;static makeCurrent(){aD(new i)}onAndCancel(e,t,n,r){return e.addEventListener(t,n,r),()=>{e.removeEventListener(t,n,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=y9();return t==null?null:x9(t)}resetBaseElement(){Zg=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Wg(document.cookie,e)}},Zg=null;function y9(){return Zg=Zg||document.head.querySelector("base"),Zg?Zg.getAttribute("href"):null}function x9(i){return new URL(i,document.baseURI).pathname}var w9=(()=>{class i{build(){return new XMLHttpRequest}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac})}return i})(),jk=(()=>{class i extends $g{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,r,o){return t.addEventListener(n,r,o),()=>this.removeEventListener(t,n,r,o)}removeEventListener(t,n,r,o){return t.removeEventListener(n,r,o)}static \u0275fac=function(n){return new(n||i)(ht(kt))};static \u0275prov=ge({token:i,factory:i.\u0275fac})}return i})(),Nk=["alt","control","meta","shift"],M9={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},S9={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey},Ok=(()=>{class i extends $g{constructor(t){super(t)}supports(t){return i.parseEventName(t)!=null}addEventListener(t,n,r,o){let s=i.parseEventName(n),a=i.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>gs().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let n=t.toLowerCase().split("."),r=n.shift();if(n.length===0||!(r==="keydown"||r==="keyup"))return null;let o=i._normalizeKey(n.pop()),s="",a=n.indexOf("code");if(a>-1&&(n.splice(a,1),s="code."),Nk.forEach(l=>{let u=n.indexOf(l);u>-1&&(n.splice(u,1),s+=l+".")}),s+=o,n.length!=0||o.length===0)return null;let c={};return c.domEventName=r,c.fullKey=s,c}static matchEventFullKeyCode(t,n){let r=M9[t.key]||t.key,o="";return n.indexOf("code.")>-1&&(r=t.code,o="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),Nk.forEach(s=>{if(s!==r){let a=S9[s];a(t)&&(o+=s+".")}}),o+=r,o===n)}static eventCallback(t,n,r){return o=>{i.matchEventFullKeyCode(o,t)&&r.runGuarded(()=>n(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(n){return new(n||i)(ht(kt))};static \u0275prov=ge({token:i,factory:i.\u0275fac})}return i})();function SD(i,e){return vk(ae({rootComponent:i},R9(e)))}function R9(i){return{appProviders:[...I9,...i?.providers??[]],platformProviders:D9}}function T9(){_x.makeCurrent()}function C9(){return new Mr}function E9(){return tE(document),document}var D9=[{provide:$a,useValue:mD},{provide:Uy,useValue:T9,multi:!0},{provide:kt,useFactory:E9}];var I9=[{provide:cg,useValue:"root"},{provide:Mr,useFactory:C9},{provide:gx,useClass:jk,multi:!0,deps:[kt]},{provide:gx,useClass:Ok,multi:!0,deps:[kt]},MD,xD,yD,{provide:Co,useExisting:MD},{provide:Ad,useClass:w9},[]];var Df=class{},If=class{},Xa=class i{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(e){e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let n=t.indexOf(":");if(n>0){let r=t.slice(0,n),o=t.slice(n+1).trim();this.addHeaderEntry(r,o)}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,n)=>{this.addHeaderEntry(n,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,n])=>{this.setHeaderEntries(t,n)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof i?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new i;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof i?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if(typeof n=="string"&&(n=[n]),n.length===0)return;this.maybeSetNormalizedName(e.name,t);let r=(e.op==="a"?this.headers.get(t):void 0)||[];r.push(...n),this.headers.set(t,r);break;case"d":let o=e.value;if(!o)this.headers.delete(t),this.normalizedNames.delete(t);else{let s=this.headers.get(t);if(!s)return;s=s.filter(a=>o.indexOf(a)===-1),s.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}break}}addHeaderEntry(e,t){let n=e.toLowerCase();this.maybeSetNormalizedName(e,n),this.headers.has(n)?this.headers.get(n).push(t):this.headers.set(n,[t])}setHeaderEntries(e,t){let n=(Array.isArray(t)?t:[t]).map(o=>o.toString()),r=e.toLowerCase();this.headers.set(r,n),this.maybeSetNormalizedName(e,r)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var yx=class{encodeKey(e){return Lk(e)}encodeValue(e){return Lk(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function A9(i,e){let t=new Map;return i.length>0&&i.replace(/^\?/,"").split("&").forEach(r=>{let o=r.indexOf("="),[s,a]=o==-1?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,o)),e.decodeValue(r.slice(o+1))],c=t.get(s)||[];c.push(a),t.set(s,c)}),t}var P9=/%(\d[a-f0-9])/gi,F9={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Lk(i){return encodeURIComponent(i).replace(P9,(e,t)=>F9[t]??e)}function bx(i){return`${i}`}var Ks=class i{map;encoder;updates=null;cloneFrom=null;constructor(e={}){if(this.encoder=e.encoder||new yx,e.fromString){if(e.fromObject)throw new Xe(2805,!1);this.map=A9(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let n=e.fromObject[t],r=Array.isArray(n)?n.map(bx):[bx(n)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(n=>{let r=e[n];Array.isArray(r)?r.forEach(o=>{t.push({param:n,value:o,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new i({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(bx(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let n=this.map.get(e.param)||[],r=n.indexOf(bx(e.value));r!==-1&&n.splice(r,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var xx=class{map=new Map;set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function N9(i){switch(i){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function kk(i){return typeof ArrayBuffer<"u"&&i instanceof ArrayBuffer}function Bk(i){return typeof Blob<"u"&&i instanceof Blob}function Uk(i){return typeof FormData<"u"&&i instanceof FormData}function j9(i){return typeof URLSearchParams<"u"&&i instanceof URLSearchParams}var Yg="Content-Type",wx="Accept",DD="X-Request-URL",Hk="text/plain",Gk="application/json",Wk=`${Gk}, ${Hk}, */*`,Ef=class i{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;credentials;keepalive=!1;cache;priority;mode;redirect;responseType="json";method;params;urlWithParams;transferCache;timeout;constructor(e,t,n,r){this.url=t,this.method=e.toUpperCase();let o;if(N9(this.method)||r?(this.body=n!==void 0?n:null,o=r):o=n,o){if(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,this.keepalive=!!o.keepalive,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),o.priority&&(this.priority=o.priority),o.cache&&(this.cache=o.cache),o.credentials&&(this.credentials=o.credentials),typeof o.timeout=="number"){if(o.timeout<1||!Number.isInteger(o.timeout))throw new Error("");this.timeout=o.timeout}o.mode&&(this.mode=o.mode),o.redirect&&(this.redirect=o.redirect),this.transferCache=o.transferCache}if(this.headers??=new Xa,this.context??=new xx,!this.params)this.params=new Ks,this.urlWithParams=t;else{let s=this.params.toString();if(s.length===0)this.urlWithParams=t;else{let a=t.indexOf("?"),c=a===-1?"?":a<t.length-1?"&":"";this.urlWithParams=t+c+s}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||kk(this.body)||Bk(this.body)||Uk(this.body)||j9(this.body)?this.body:this.body instanceof Ks?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Uk(this.body)?null:Bk(this.body)?this.body.type||null:kk(this.body)?null:typeof this.body=="string"?Hk:this.body instanceof Ks?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?Gk:null}clone(e={}){let t=e.method||this.method,n=e.url||this.url,r=e.responseType||this.responseType,o=e.keepalive??this.keepalive,s=e.priority||this.priority,a=e.cache||this.cache,c=e.mode||this.mode,l=e.redirect||this.redirect,u=e.credentials||this.credentials,d=e.transferCache??this.transferCache,h=e.timeout??this.timeout,f=e.body!==void 0?e.body:this.body,g=e.withCredentials??this.withCredentials,_=e.reportProgress??this.reportProgress,m=e.headers||this.headers,p=e.params||this.params,b=e.context??this.context;return e.setHeaders!==void 0&&(m=Object.keys(e.setHeaders).reduce((v,y)=>v.set(y,e.setHeaders[y]),m)),e.setParams&&(p=Object.keys(e.setParams).reduce((v,y)=>v.set(y,e.setParams[y]),p)),new i(t,n,f,{params:p,headers:m,context:b,reportProgress:_,responseType:r,withCredentials:g,transferCache:d,keepalive:o,cache:a,priority:s,timeout:h,mode:c,redirect:l,credentials:u})}},kc=function(i){return i[i.Sent=0]="Sent",i[i.UploadProgress=1]="UploadProgress",i[i.ResponseHeader=2]="ResponseHeader",i[i.DownloadProgress=3]="DownloadProgress",i[i.Response=4]="Response",i[i.User=5]="User",i}(kc||{}),Af=class{headers;status;statusText;url;ok;type;constructor(e,t=200,n="OK"){this.headers=e.headers||new Xa,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},Qg=class i extends Af{constructor(e={}){super(e)}type=kc.ResponseHeader;clone(e={}){return new i({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Pf=class i extends Af{body;constructor(e={}){super(e),this.body=e.body!==void 0?e.body:null}type=kc.Response;clone(e={}){return new i({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},qa=class extends Af{name="HttpErrorResponse";message;error;ok=!1;constructor(e){super(e,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},$k=200,O9=204;function RD(i,e){return{body:e,headers:i.headers,context:i.context,observe:i.observe,params:i.params,reportProgress:i.reportProgress,responseType:i.responseType,withCredentials:i.withCredentials,transferCache:i.transferCache,keepalive:i.keepalive,priority:i.priority,cache:i.cache,mode:i.mode,redirect:i.redirect}}var Ff=(()=>{class i{handler;constructor(t){this.handler=t}request(t,n,r={}){let o;if(t instanceof Ef)o=t;else{let c;r.headers instanceof Xa?c=r.headers:c=new Xa(r.headers);let l;r.params&&(r.params instanceof Ks?l=r.params:l=new Ks({fromObject:r.params})),o=new Ef(t,n,r.body!==void 0?r.body:null,{headers:c,context:r.context,params:l,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache,keepalive:r.keepalive,priority:r.priority,cache:r.cache,mode:r.mode,redirect:r.redirect,credentials:r.credentials})}let s=ut(o).pipe(Na(c=>this.handler.handle(c)));if(t instanceof Ef||r.observe==="events")return s;let a=s.pipe(vn(c=>c instanceof Pf));switch(r.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return a.pipe(tt(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new Xe(2806,!1);return c.body}));case"blob":return a.pipe(tt(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new Xe(2807,!1);return c.body}));case"text":return a.pipe(tt(c=>{if(c.body!==null&&typeof c.body!="string")throw new Xe(2808,!1);return c.body}));case"json":default:return a.pipe(tt(c=>c.body))}case"response":return a;default:throw new Xe(2809,!1)}}delete(t,n={}){return this.request("DELETE",t,n)}get(t,n={}){return this.request("GET",t,n)}head(t,n={}){return this.request("HEAD",t,n)}jsonp(t,n){return this.request("JSONP",t,{params:new Ks().append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,n={}){return this.request("OPTIONS",t,n)}patch(t,n,r={}){return this.request("PATCH",t,RD(r,n))}post(t,n,r={}){return this.request("POST",t,RD(r,n))}put(t,n,r={}){return this.request("PUT",t,RD(r,n))}static \u0275fac=function(n){return new(n||i)(ht(Df))};static \u0275prov=ge({token:i,factory:i.\u0275fac})}return i})(),L9=/^\)\]\}',?\n/;function Vk(i){if(i.url)return i.url;let e=DD.toLocaleLowerCase();return i.headers.get(e)}var qk=new me(""),vx=(()=>{class i{fetchImpl=S(TD,{optional:!0})?.fetch??((...t)=>globalThis.fetch(...t));ngZone=S(pt);destroyRef=S(Nr);destroyed=!1;constructor(){this.destroyRef.onDestroy(()=>{this.destroyed=!0})}handle(t){return new It(n=>{let r=new AbortController;this.doRequest(t,r.signal,n).then(CD,s=>n.error(new qa({error:s})));let o;return t.timeout&&(o=this.ngZone.runOutsideAngular(()=>setTimeout(()=>{r.signal.aborted||r.abort(new DOMException("signal timed out","TimeoutError"))},t.timeout))),()=>{o!==void 0&&clearTimeout(o),r.abort()}})}doRequest(t,n,r){return Wt(this,null,function*(){let o=this.createRequestInit(t),s;try{let f=this.ngZone.runOutsideAngular(()=>this.fetchImpl(t.urlWithParams,ae({signal:n},o)));k9(f),r.next({type:kc.Sent}),s=yield f}catch(f){r.error(new qa({error:f,status:f.status??0,statusText:f.statusText,url:t.urlWithParams,headers:f.headers}));return}let a=new Xa(s.headers),c=s.statusText,l=Vk(s)??t.urlWithParams,u=s.status,d=null;if(t.reportProgress&&r.next(new Qg({headers:a,status:u,statusText:c,url:l})),s.body){let f=s.headers.get("content-length"),g=[],_=s.body.getReader(),m=0,p,b,v=typeof Zone<"u"&&Zone.current,y=!1;if(yield this.ngZone.runOutsideAngular(()=>Wt(this,null,function*(){for(;;){if(this.destroyed){yield _.cancel(),y=!0;break}let{done:R,value:E}=yield _.read();if(R)break;if(g.push(E),m+=E.length,t.reportProgress){b=t.responseType==="text"?(b??"")+(p??=new TextDecoder).decode(E,{stream:!0}):void 0;let A=()=>r.next({type:kc.DownloadProgress,total:f?+f:void 0,loaded:m,partialText:b});v?v.run(A):A()}}})),y){r.complete();return}let w=this.concatChunks(g,m);try{let R=s.headers.get(Yg)??"";d=this.parseBody(t,w,R)}catch(R){r.error(new qa({error:R,headers:new Xa(s.headers),status:s.status,statusText:s.statusText,url:Vk(s)??t.urlWithParams}));return}}u===0&&(u=d?$k:0),u>=200&&u<300?(r.next(new Pf({body:d,headers:a,status:u,statusText:c,url:l})),r.complete()):r.error(new qa({error:d,headers:a,status:u,statusText:c,url:l}))})}parseBody(t,n,r){switch(t.responseType){case"json":let o=new TextDecoder().decode(n).replace(L9,"");return o===""?null:JSON.parse(o);case"text":return new TextDecoder().decode(n);case"blob":return new Blob([n],{type:r});case"arraybuffer":return n.buffer}}createRequestInit(t){let n={},r;if(r=t.credentials,t.withCredentials&&(r="include"),t.headers.forEach((o,s)=>n[o]=s.join(",")),t.headers.has(wx)||(n[wx]=Wk),!t.headers.has(Yg)){let o=t.detectContentTypeHeader();o!==null&&(n[Yg]=o)}return{body:t.serializeBody(),method:t.method,headers:n,credentials:r,keepalive:t.keepalive,cache:t.cache,priority:t.priority,mode:t.mode,redirect:t.redirect}}concatChunks(t,n){let r=new Uint8Array(n),o=0;for(let s of t)r.set(s,o),o+=s.length;return r}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac})}return i})(),TD=class{};function CD(){}function k9(i){i.then(CD,CD)}function Xk(i,e){return e(i)}function B9(i,e){return(t,n)=>e.intercept(t,{handle:r=>i(r,n)})}function U9(i,e,t){return(n,r)=>Sr(t,()=>e(n,o=>i(o,r)))}var Zk=new me(""),ID=new me(""),Yk=new me(""),AD=new me("",{providedIn:"root",factory:()=>!0});function V9(){let i=null;return(e,t)=>{i===null&&(i=(S(Zk,{optional:!0})??[]).reduceRight(B9,Xk));let n=S(md);if(S(AD)){let o=n.add();return i(e,t).pipe(ja(o))}else return i(e,t)}}var Mx=(()=>{class i extends Df{backend;injector;chain=null;pendingTasks=S(md);contributeToStability=S(AD);constructor(t,n){super(),this.backend=t,this.injector=n}handle(t){if(this.chain===null){let n=Array.from(new Set([...this.injector.get(ID),...this.injector.get(Yk,[])]));this.chain=n.reduceRight((r,o)=>U9(r,o,this.injector),Xk)}if(this.contributeToStability){let n=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(ja(n))}else return this.chain(t,n=>this.backend.handle(n))}static \u0275fac=function(n){return new(n||i)(ht(If),ht(Ei))};static \u0275prov=ge({token:i,factory:i.\u0275fac})}return i})();var z9=/^\)\]\}',?\n/,H9=RegExp(`^${DD}:`,"m");function G9(i){return"responseURL"in i&&i.responseURL?i.responseURL:H9.test(i.getAllResponseHeaders())?i.getResponseHeader(DD):null}var ED=(()=>{class i{xhrFactory;constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new Xe(-2800,!1);let n=this.xhrFactory;return ut(null).pipe(Ui(()=>new It(o=>{let s=n.build();if(s.open(t.method,t.urlWithParams),t.withCredentials&&(s.withCredentials=!0),t.headers.forEach((m,p)=>s.setRequestHeader(m,p.join(","))),t.headers.has(wx)||s.setRequestHeader(wx,Wk),!t.headers.has(Yg)){let m=t.detectContentTypeHeader();m!==null&&s.setRequestHeader(Yg,m)}if(t.timeout&&(s.timeout=t.timeout),t.responseType){let m=t.responseType.toLowerCase();s.responseType=m!=="json"?m:"text"}let a=t.serializeBody(),c=null,l=()=>{if(c!==null)return c;let m=s.statusText||"OK",p=new Xa(s.getAllResponseHeaders()),b=G9(s)||t.url;return c=new Qg({headers:p,status:s.status,statusText:m,url:b}),c},u=()=>{let{headers:m,status:p,statusText:b,url:v}=l(),y=null;p!==O9&&(y=typeof s.response>"u"?s.responseText:s.response),p===0&&(p=y?$k:0);let w=p>=200&&p<300;if(t.responseType==="json"&&typeof y=="string"){let R=y;y=y.replace(z9,"");try{y=y!==""?JSON.parse(y):null}catch(E){y=R,w&&(w=!1,y={error:E,text:y})}}w?(o.next(new Pf({body:y,headers:m,status:p,statusText:b,url:v||void 0})),o.complete()):o.error(new qa({error:y,headers:m,status:p,statusText:b,url:v||void 0}))},d=m=>{let{url:p}=l(),b=new qa({error:m,status:s.status||0,statusText:s.statusText||"Unknown Error",url:p||void 0});o.error(b)},h=d;t.timeout&&(h=m=>{let{url:p}=l(),b=new qa({error:new DOMException("Request timed out","TimeoutError"),status:s.status||0,statusText:s.statusText||"Request timeout",url:p||void 0});o.error(b)});let f=!1,g=m=>{f||(o.next(l()),f=!0);let p={type:kc.DownloadProgress,loaded:m.loaded};m.lengthComputable&&(p.total=m.total),t.responseType==="text"&&s.responseText&&(p.partialText=s.responseText),o.next(p)},_=m=>{let p={type:kc.UploadProgress,loaded:m.loaded};m.lengthComputable&&(p.total=m.total),o.next(p)};return s.addEventListener("load",u),s.addEventListener("error",d),s.addEventListener("timeout",h),s.addEventListener("abort",d),t.reportProgress&&(s.addEventListener("progress",g),a!==null&&s.upload&&s.upload.addEventListener("progress",_)),s.send(a),o.next({type:kc.Sent}),()=>{s.removeEventListener("error",d),s.removeEventListener("abort",d),s.removeEventListener("load",u),s.removeEventListener("timeout",h),t.reportProgress&&(s.removeEventListener("progress",g),a!==null&&s.upload&&s.upload.removeEventListener("progress",_)),s.readyState!==s.DONE&&s.abort()}})))}static \u0275fac=function(n){return new(n||i)(ht(Ad))};static \u0275prov=ge({token:i,factory:i.\u0275fac})}return i})(),Qk=new me(""),W9="XSRF-TOKEN",$9=new me("",{providedIn:"root",factory:()=>W9}),q9="X-XSRF-TOKEN",X9=new me("",{providedIn:"root",factory:()=>q9}),Kg=class{},Z9=(()=>{class i{doc;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(t,n){this.doc=t,this.cookieName=n}getToken(){let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Wg(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(n){return new(n||i)(ht(kt),ht($9))};static \u0275prov=ge({token:i,factory:i.\u0275fac})}return i})();function Y9(i,e){let t=i.url.toLowerCase();if(!S(Qk)||i.method==="GET"||i.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(i);let n=S(Kg).getToken(),r=S(X9);return n!=null&&!i.headers.has(r)&&(i=i.clone({headers:i.headers.set(r,n)})),e(i)}var Sx=function(i){return i[i.Interceptors=0]="Interceptors",i[i.LegacyInterceptors=1]="LegacyInterceptors",i[i.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",i[i.NoXsrfProtection=3]="NoXsrfProtection",i[i.JsonpSupport=4]="JsonpSupport",i[i.RequestsMadeViaParent=5]="RequestsMadeViaParent",i[i.Fetch=6]="Fetch",i}(Sx||{});function Kk(i,e){return{\u0275kind:i,\u0275providers:e}}function PD(...i){let e=[Ff,ED,Mx,{provide:Df,useExisting:Mx},{provide:If,useFactory:()=>S(qk,{optional:!0})??S(ED)},{provide:ID,useValue:Y9,multi:!0},{provide:Qk,useValue:!0},{provide:Kg,useClass:Z9}];for(let t of i)e.push(...t.\u0275providers);return Vs(e)}var zk=new me("");function FD(){return Kk(Sx.LegacyInterceptors,[{provide:zk,useFactory:V9},{provide:ID,useExisting:zk,multi:!0}])}function ND(){return Kk(Sx.Fetch,[vx,{provide:qk,useExisting:vx},{provide:If,useExisting:vx}])}var Jk=(()=>{class i{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(n){return new(n||i)(ht(kt))};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Jg=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:function(n){let r=null;return n?r=new(n||i):r=ht(K9),r},providedIn:"root"})}return i})(),K9=(()=>{class i extends Jg{_doc;constructor(t){super(),this._doc=t}sanitize(t,n){if(n==null)return null;switch(t){case _r.NONE:return n;case _r.HTML:return jc(n,"HTML")?Go(n):lE(this._doc,String(n)).toString();case _r.STYLE:return jc(n,"Style")?Go(n):n;case _r.SCRIPT:if(jc(n,"Script"))return Go(n);throw new Xe(5200,!1);case _r.URL:return jc(n,"URL")?Go(n):Ig(String(n));case _r.RESOURCE_URL:if(jc(n,"ResourceURL"))return Go(n);throw new Xe(5201,!1);default:throw new Xe(5202,!1)}}bypassSecurityTrustHtml(t){return rE(t)}bypassSecurityTrustStyle(t){return oE(t)}bypassSecurityTrustScript(t){return sE(t)}bypassSecurityTrustUrl(t){return aE(t)}bypassSecurityTrustResourceUrl(t){return cE(t)}static \u0275fac=function(n){return new(n||i)(ht(kt))};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var LD=new me("HIGHLIGHT_OPTIONS");function n2(i){return Vs([{provide:LD,useValue:i}])}var Nf=function(i){return i.FULL_WITH_CORE_LIBRARY_IMPORTS="The full library and the core library were imported, only one of them should be imported!",i.FULL_WITH_LANGUAGE_IMPORTS="The highlighting languages were imported they are not needed!",i.CORE_WITHOUT_LANGUAGE_IMPORTS="The highlighting languages were not imported!",i.LANGUAGE_WITHOUT_CORE_IMPORTS="The core library was not imported!",i.NO_FULL_AND_NO_CORE_IMPORTS="Highlight.js library was not imported!",i}(Nf||{}),J9=(()=>{let e=class e{constructor(){this.document=S(kt),this.isPlatformBrowser=px(S($a)),this.options=S(LD,{optional:!0}),this._ready=new Bi(null),this.ready=JR(this._ready.asObservable().pipe(vn(n=>!!n))),this.isPlatformBrowser&&(this.document.defaultView.hljs?this._ready.next(this.document.defaultView.hljs):this._loadLibrary().pipe(Ui(n=>this.options?.lineNumbersLoader?(this.document.defaultView.hljs=n,this.loadLineNumbers().pipe(Kn(r=>{r.activateLineNumbers(),this._ready.next(n)}))):(this._ready.next(n),Ti)),Br(n=>(console.error("[HLJS] ",n),this._ready.error(n),Ti))).subscribe(),this.options?.themePath&&this.loadTheme(this.options.themePath))}_loadLibrary(){if(this.options){if(this.options.fullLibraryLoader&&this.options.coreLibraryLoader)return So(()=>Nf.FULL_WITH_CORE_LIBRARY_IMPORTS);if(this.options.fullLibraryLoader&&this.options.languages)return So(()=>Nf.FULL_WITH_LANGUAGE_IMPORTS);if(this.options.coreLibraryLoader&&!this.options.languages)return So(()=>Nf.CORE_WITHOUT_LANGUAGE_IMPORTS);if(!this.options.coreLibraryLoader&&this.options.languages)return So(()=>Nf.LANGUAGE_WITHOUT_CORE_IMPORTS);if(this.options.fullLibraryLoader)return this.loadFullLibrary();if(this.options.coreLibraryLoader&&this.options.languages&&Object.keys(this.options.languages).length)return this.loadCoreLibrary().pipe(Ui(n=>this._loadLanguages(n)))}return So(()=>Nf.NO_FULL_AND_NO_CORE_IMPORTS)}_loadLanguages(n){let r=Object.entries(this.options.languages).map(([o,s])=>jD(s()).pipe(Kn(a=>n.registerLanguage(o,a))));return Ku(r).pipe(tt(()=>n))}loadCoreLibrary(){return jD(this.options.coreLibraryLoader())}loadFullLibrary(){return jD(this.options.fullLibraryLoader())}loadLineNumbers(){return qn(this.options.lineNumbersLoader())}setTheme(n){this.isPlatformBrowser&&(this._themeLinkElement?this._themeLinkElement.href=n:this.loadTheme(n))}loadTheme(n){this._themeLinkElement=this.document.createElement("link"),this._themeLinkElement.href=n,this._themeLinkElement.type="text/css",this._themeLinkElement.rel="stylesheet",this._themeLinkElement.media="screen,print",this.document.head.appendChild(this._themeLinkElement)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ge({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),jD=i=>qn(i).pipe(vn(e=>!!e?.default),tt(e=>e.default)),eq=(()=>{let e=class e{constructor(){this.loader=S(J9),this.options=S(LD,{optional:!0}),this.hljsSignal=Vn(null),this.hljs=qo(()=>this.hljsSignal()),this.loader.ready.then(n=>{this.hljsSignal.set(n),this.options?.highlightOptions&&n.configure(this.options.highlightOptions)})}highlight(n,r){return Wt(this,null,function*(){return(yield this.loader.ready).highlight(n,r)})}highlightAuto(n,r){return Wt(this,null,function*(){return(yield this.loader.ready).highlightAuto(n,r)})}highlightElement(n){return Wt(this,null,function*(){(yield this.loader.ready).highlightElement(n)})}highlightAll(){return Wt(this,null,function*(){(yield this.loader.ready).highlightAll()})}configure(n){return Wt(this,null,function*(){(yield this.loader.ready).configure(n)})}registerLanguage(n,r){return Wt(this,null,function*(){(yield this.loader.ready).registerLanguage(n,r)})}unregisterLanguage(n){return Wt(this,null,function*(){(yield this.loader.ready).unregisterLanguage(n)})}registerAliases(o,s){return Wt(this,arguments,function*(n,{languageName:r}){(yield this.loader.ready).registerAliases(n,{languageName:r})})}listLanguages(){return Wt(this,null,function*(){return(yield this.loader.ready).listLanguages()})}getLanguage(n){return Wt(this,null,function*(){return(yield this.loader.ready).getLanguage(n)})}safeMode(){return Wt(this,null,function*(){(yield this.loader.ready).safeMode()})}debugMode(){return Wt(this,null,function*(){(yield this.loader.ready).debugMode()})}lineNumbersBlock(n,r){return Wt(this,null,function*(){let o=yield this.loader.ready;o.lineNumbersBlock&&o.lineNumbersBlock(n,r)})}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ge({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),OD;function tq(){if(!OD)try{OD=window?.trustedTypes?.createPolicy("ngx-highlightjs",{createHTML:i=>i})}catch{}return OD}function nq(i){return tq()?.createHTML(i)||i}var t2=(()=>{let e=class e{constructor(){this._hljs=S(eq),this._nativeElement=S(vt).nativeElement,this._sanitizer=S(Jg),oD({write:()=>{let n=this.code();this.setTextContent(n||""),n&&this.highlightElement(n)}}),oD({write:()=>{let n=this.highlightResult();this.setInnerHTML(n?.value),this.highlighted.emit(n)}})}setTextContent(n){requestAnimationFrame(()=>this._nativeElement.textContent=n)}setInnerHTML(n){requestAnimationFrame(()=>this._nativeElement.innerHTML=nq(this._sanitizer.sanitize(_r.HTML,n)||""))}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Ge({type:e});let i=e;return i})(),i2=(()=>{let e=class e extends t2{constructor(){super(...arguments),this.code=Cf(null,{alias:"highlight"}),this.highlightResult=Vn(null),this.language=Cf.required(),this.ignoreIllegals=Cf(void 0,{transform:On}),this.highlighted=mk()}highlightElement(n){return Wt(this,null,function*(){let r=yield this._hljs.highlight(n,{language:this.language(),ignoreIllegals:this.ignoreIllegals()});this.highlightResult.set(r)})}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275dir=Ge({type:e,selectors:[["","highlight",""]],hostVars:2,hostBindings:function(r,o){r&2&&sn("hljs",!0)},inputs:{code:[1,"highlight","code"],language:[1,"language"],ignoreIllegals:[1,"ignoreIllegals"]},outputs:{highlighted:"highlighted"},features:[K([{provide:t2,useExisting:e}]),$]});let i=e;return i})();var r2=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Mn({type:e}),e.\u0275inj=xn({});let i=e;return i})();var o2={production:!0};var kD;try{kD=typeof Intl<"u"&&Intl.v8BreakIterator}catch{kD=!1}var si=(()=>{class i{_platformId=S($a);isBrowser=this._platformId?px(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||kD)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function BD(i){return Array.isArray(i)?i:[i]}var s2=new Set,Pd,Rx=(()=>{class i{_platform=S(si);_nonce=S(wf,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):oq}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&rq(t,this._nonce),this._matchMedia(t)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function rq(i,e){if(!s2.has(i))try{Pd||(Pd=document.createElement("style"),e&&Pd.setAttribute("nonce",e),Pd.setAttribute("type","text/css"),document.head.appendChild(Pd)),Pd.sheet&&(Pd.sheet.insertRule(`@media ${i} {body{ }}`,0),s2.add(i))}catch(t){console.error(t)}}function oq(i){return{matches:i==="all"||i==="",media:i,addListener:()=>{},removeListener:()=>{}}}var e_=(()=>{class i{_mediaMatcher=S(Rx);_zone=S(pt);_queries=new Map;_destroySubject=new lt;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return a2(BD(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let r=a2(BD(t)).map(s=>this._registerQuery(s).observable),o=Qu(r);return o=Cl(o.pipe(no(1)),o.pipe(Ju(1),Us(0))),o.pipe(tt(s=>{let a={matches:!1,breakpoints:{}};return s.forEach(({matches:c,query:l})=>{a.matches=a.matches||c,a.breakpoints[l]=c}),a}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);let n=this._mediaMatcher.matchMedia(t),o={observable:new It(s=>{let a=c=>this._zone.run(()=>s.next(c));return n.addListener(a),()=>{n.removeListener(a)}}).pipe(Uo(n),tt(({matches:s})=>({query:t,matches:s})),Pn(this._destroySubject)),mql:n};return this._queries.set(t,o),o}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function a2(i){return i.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}var c2={XSmall:"(max-width: 599.98px)",Small:"(min-width: 600px) and (max-width: 959.98px)",Medium:"(min-width: 960px) and (max-width: 1279.98px)",Large:"(min-width: 1280px) and (max-width: 1919.98px)",XLarge:"(min-width: 1920px)",Handset:"(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)",Tablet:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait), (min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",Web:"(min-width: 840px) and (orientation: portrait), (min-width: 1280px) and (orientation: landscape)",HandsetPortrait:"(max-width: 599.98px) and (orientation: portrait)",TabletPortrait:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait)",WebPortrait:"(min-width: 840px) and (orientation: portrait)",HandsetLandscape:"(max-width: 959.98px) and (orientation: landscape)",TabletLandscape:"(min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",WebLandscape:"(min-width: 1280px) and (orientation: landscape)"};var vu={};X4(vu,{ACESFilmicToneMapping:()=>vM,AddEquation:()=>Er,AddOperation:()=>J1,AdditiveAnimationBlendMode:()=>DM,AdditiveBlending:()=>pu,AgXToneMapping:()=>xM,AlphaFormat:()=>CM,AlwaysCompare:()=>uI,AlwaysDepth:()=>fb,AlwaysStencilFunc:()=>mw,AmbientLight:()=>ph,AnimationAction:()=>ub,AnimationClip:()=>nc,AnimationLoader:()=>Fw,AnimationMixer:()=>Ip,AnimationObjectGroup:()=>Hw,AnimationUtils:()=>Pw,ArcCurve:()=>A_,ArrayCamera:()=>ab,ArrowHelper:()=>lM,AttachedBindMode:()=>pw,Audio:()=>cb,AudioAnalyser:()=>zw,AudioContext:()=>Dp,AudioListener:()=>Uw,AudioLoader:()=>kw,AxesHelper:()=>uM,BackSide:()=>qr,BasicDepthPacking:()=>iI,BasicShadowMap:()=>gB,BatchedMesh:()=>S_,Bone:()=>cu,BooleanKeyframeTrack:()=>ec,Box2:()=>Kw,Box3:()=>wi,Box3Helper:()=>Ap,BoxGeometry:()=>ei,BoxHelper:()=>aM,BufferAttribute:()=>pn,BufferGeometry:()=>nt,BufferGeometryLoader:()=>sb,ByteType:()=>MM,Cache:()=>ra,Camera:()=>qc,CameraHelper:()=>sM,CanvasTexture:()=>uu,CapsuleGeometry:()=>C_,CatmullRomCurve3:()=>P_,CineonToneMapping:()=>bM,CircleGeometry:()=>E_,ClampToEdgeWrapping:()=>jr,Clock:()=>go,Color:()=>ue,ColorKeyframeTrack:()=>Sp,ColorManagement:()=>hn,CompressedArrayTexture:()=>Dw,CompressedCubeTexture:()=>Iw,CompressedTexture:()=>ah,CompressedTextureLoader:()=>Nw,ConeGeometry:()=>pp,ConstantAlphaFactor:()=>Y1,ConstantColorFactor:()=>X1,Controls:()=>Ir,CubeCamera:()=>y_,CubeDepthTexture:()=>T_,CubeReflectionMapping:()=>ga,CubeRefractionMapping:()=>Jc,CubeTexture:()=>au,CubeTextureLoader:()=>jw,CubeUVReflectionMapping:()=>bh,CubicBezierCurve:()=>mp,CubicBezierCurve3:()=>F_,CubicInterpolant:()=>K_,CullFaceBack:()=>fM,CullFaceFront:()=>O1,CullFaceFrontBack:()=>mB,CullFaceNone:()=>j1,Curve:()=>Ao,CurvePath:()=>j_,CustomBlending:()=>mu,CustomToneMapping:()=>yM,CylinderGeometry:()=>Oi,Cylindrical:()=>Yw,Data3DTexture:()=>Qd,DataArrayTexture:()=>Yd,DataTexture:()=>Cr,DataTextureLoader:()=>Ow,DataUtils:()=>bw,DecrementStencilOp:()=>IB,DecrementWrapStencilOp:()=>PB,DefaultLoadingManager:()=>_I,DepthFormat:()=>oa,DepthStencilFormat:()=>ts,DepthTexture:()=>fo,DetachedBindMode:()=>eI,DirectionalLight:()=>Yc,DirectionalLightHelper:()=>oM,DiscreteInterpolant:()=>J_,DodecahedronGeometry:()=>D_,DoubleSide:()=>rr,DstAlphaFactor:()=>gh,DstColorFactor:()=>_h,DynamicCopyUsage:()=>qB,DynamicDrawUsage:()=>VB,DynamicReadUsage:()=>GB,EdgesGeometry:()=>I_,EllipseCurve:()=>Ss,EqualCompare:()=>aI,EqualDepth:()=>mb,EqualStencilFunc:()=>OB,EquirectangularReflectionMapping:()=>Np,EquirectangularRefractionMapping:()=>jp,Euler:()=>ho,EventDispatcher:()=>Ko,ExternalTexture:()=>fp,ExtrudeGeometry:()=>B_,FileLoader:()=>ir,Float16BufferAttribute:()=>Sw,Float32BufferAttribute:()=>Oe,FloatType:()=>tr,Fog:()=>eh,FogExp2:()=>x_,FramebufferTexture:()=>Ew,FrontSide:()=>vs,Frustum:()=>Xc,FrustumArray:()=>M_,GLBufferAttribute:()=>Xw,GLSL1:()=>ZB,GLSL3:()=>PM,GreaterCompare:()=>cI,GreaterDepth:()=>_b,GreaterEqualCompare:()=>ov,GreaterEqualDepth:()=>gb,GreaterEqualStencilFunc:()=>UB,GreaterStencilFunc:()=>kB,GridHelper:()=>fu,Group:()=>Or,HalfFloatType:()=>An,HemisphereLight:()=>hh,HemisphereLightHelper:()=>iM,IcosahedronGeometry:()=>uh,ImageBitmapLoader:()=>Ep,ImageLoader:()=>hu,ImageUtils:()=>v_,IncrementStencilOp:()=>DB,IncrementWrapStencilOp:()=>AB,InstancedBufferAttribute:()=>ws,InstancedBufferGeometry:()=>ob,InstancedInterleavedBuffer:()=>qw,InstancedMesh:()=>Ms,Int16BufferAttribute:()=>ww,Int32BufferAttribute:()=>Mw,Int8BufferAttribute:()=>vw,IntType:()=>vb,InterleavedBuffer:()=>xs,InterleavedBufferAttribute:()=>Jo,Interpolant:()=>Ja,InterpolateDiscrete:()=>ru,InterpolateLinear:()=>ou,InterpolateSmooth:()=>p_,InterpolationSamplingMode:()=>KB,InterpolationSamplingType:()=>QB,InvertStencilOp:()=>FB,KeepStencilOp:()=>Ql,KeyframeTrack:()=>po,LOD:()=>nh,LatheGeometry:()=>U_,Layers:()=>Kd,LessCompare:()=>sI,LessDepth:()=>pb,LessEqualCompare:()=>rv,LessEqualDepth:()=>nu,LessEqualStencilFunc:()=>LB,LessStencilFunc:()=>jB,Light:()=>ma,LightProbe:()=>ib,Line:()=>ti,Line3:()=>Jw,LineBasicMaterial:()=>mi,LineCurve:()=>gp,LineCurve3:()=>N_,LineDashedMaterial:()=>Q_,LineLoop:()=>oh,LineSegments:()=>Lr,LinearFilter:()=>zn,LinearInterpolant:()=>Mp,LinearMipMapLinearFilter:()=>yB,LinearMipMapNearestFilter:()=>vB,LinearMipmapLinearFilter:()=>Po,LinearMipmapNearestFilter:()=>gu,LinearSRGBColorSpace:()=>nr,LinearToneMapping:()=>gM,LinearTransfer:()=>rp,Loader:()=>or,LoaderUtils:()=>Rs,LoadingManager:()=>Rp,LoopOnce:()=>nv,LoopPingPong:()=>nI,LoopRepeat:()=>tI,MOUSE:()=>gi,Material:()=>Mi,MaterialLoader:()=>rb,MathUtils:()=>Ze,Matrix2:()=>Qw,Matrix3:()=>Yt,Matrix4:()=>Ee,MaxEquation:()=>V1,Mesh:()=>Pe,MeshBasicMaterial:()=>ci,MeshDepthMaterial:()=>du,MeshDistanceMaterial:()=>wp,MeshLambertMaterial:()=>Z_,MeshMatcapMaterial:()=>Y_,MeshNormalMaterial:()=>da,MeshPhongMaterial:()=>dh,MeshPhysicalMaterial:()=>Wr,MeshStandardMaterial:()=>kr,MeshToonMaterial:()=>X_,MinEquation:()=>U1,MirroredRepeatWrapping:()=>iu,MixOperation:()=>K1,MultiplyBlending:()=>mM,MultiplyOperation:()=>Fp,NearestFilter:()=>Zt,NearestMipMapLinearFilter:()=>bB,NearestMipMapNearestFilter:()=>_B,NearestMipmapLinearFilter:()=>el,NearestMipmapNearestFilter:()=>Op,NeutralToneMapping:()=>wM,NeverCompare:()=>oI,NeverDepth:()=>hb,NeverStencilFunc:()=>NB,NoBlending:()=>rn,NoColorSpace:()=>ic,NoNormalPacking:()=>SB,NoToneMapping:()=>Ts,NormalAnimationBlendMode:()=>iv,NormalBlending:()=>ys,NormalGAPacking:()=>TB,NormalRGPacking:()=>RB,NotEqualCompare:()=>lI,NotEqualDepth:()=>bb,NotEqualStencilFunc:()=>BB,NumberKeyframeTrack:()=>ha,Object3D:()=>wt,ObjectLoader:()=>Lw,ObjectSpaceNormalMap:()=>rI,OctahedronGeometry:()=>ca,OneFactor:()=>z1,OneMinusConstantAlphaFactor:()=>Q1,OneMinusConstantColorFactor:()=>Z1,OneMinusDstAlphaFactor:()=>W1,OneMinusDstColorFactor:()=>$1,OneMinusSrcAlphaFactor:()=>tu,OneMinusSrcColorFactor:()=>G1,OrthographicCamera:()=>mo,PCFShadowMap:()=>Pp,PCFSoftShadowMap:()=>L1,PMREMGenerator:()=>lv,Path:()=>ch,PerspectiveCamera:()=>ai,Plane:()=>Xi,PlaneGeometry:()=>la,PlaneHelper:()=>cM,PointLight:()=>Zc,PointLightHelper:()=>nM,Points:()=>sh,PointsMaterial:()=>lu,PolarGridHelper:()=>rM,PolyhedronGeometry:()=>aa,PositionalAudio:()=>Vw,PropertyBinding:()=>Zn,PropertyMixer:()=>lb,QuadraticBezierCurve:()=>_p,QuadraticBezierCurve3:()=>bp,Quaternion:()=>nn,QuaternionKeyframeTrack:()=>fa,QuaternionLinearInterpolant:()=>eb,R11_EAC_Format:()=>Ab,RED_GREEN_RGTC2_Format:()=>ev,RED_RGTC1_Format:()=>Kb,REVISION:()=>db,RG11_EAC_Format:()=>Fb,RGBADepthPacking:()=>AM,RGBAFormat:()=>Gr,RGBAIntegerFormat:()=>Mb,RGBA_ASTC_10x10_Format:()=>$b,RGBA_ASTC_10x5_Format:()=>Hb,RGBA_ASTC_10x6_Format:()=>Gb,RGBA_ASTC_10x8_Format:()=>Wb,RGBA_ASTC_12x10_Format:()=>qb,RGBA_ASTC_12x12_Format:()=>Xb,RGBA_ASTC_4x4_Format:()=>jb,RGBA_ASTC_5x4_Format:()=>Ob,RGBA_ASTC_5x5_Format:()=>Lb,RGBA_ASTC_6x5_Format:()=>kb,RGBA_ASTC_6x6_Format:()=>Bb,RGBA_ASTC_8x5_Format:()=>Ub,RGBA_ASTC_8x6_Format:()=>Vb,RGBA_ASTC_8x8_Format:()=>zb,RGBA_BPTC_Format:()=>Zb,RGBA_ETC2_EAC_Format:()=>Ib,RGBA_PVRTC_2BPPV1_Format:()=>Cb,RGBA_PVRTC_4BPPV1_Format:()=>Tb,RGBA_S3TC_DXT1_Format:()=>Bp,RGBA_S3TC_DXT3_Format:()=>Up,RGBA_S3TC_DXT5_Format:()=>Vp,RGBDepthPacking:()=>wB,RGBFormat:()=>EM,RGBIntegerFormat:()=>xB,RGB_BPTC_SIGNED_Format:()=>Yb,RGB_BPTC_UNSIGNED_Format:()=>Qb,RGB_ETC1_Format:()=>Eb,RGB_ETC2_Format:()=>Db,RGB_PVRTC_2BPPV1_Format:()=>Rb,RGB_PVRTC_4BPPV1_Format:()=>Sb,RGB_S3TC_DXT1_Format:()=>kp,RGDepthPacking:()=>MB,RGFormat:()=>_u,RGIntegerFormat:()=>wb,RawShaderMaterial:()=>xp,Ray:()=>sa,Raycaster:()=>Dr,RectAreaLight:()=>nb,RedFormat:()=>nl,RedIntegerFormat:()=>Lp,ReinhardToneMapping:()=>_M,RenderTarget:()=>cp,RenderTarget3D:()=>Gw,RepeatWrapping:()=>Qo,ReplaceStencilOp:()=>EB,ReverseSubtractEquation:()=>B1,RingGeometry:()=>V_,SIGNED_R11_EAC_Format:()=>Pb,SIGNED_RED_GREEN_RGTC2_Format:()=>tv,SIGNED_RED_RGTC1_Format:()=>Jb,SIGNED_RG11_EAC_Format:()=>Nb,SRGBColorSpace:()=>Jn,SRGBTransfer:()=>kn,Scene:()=>th,ShaderChunk:()=>fn,ShaderLib:()=>ba,ShaderMaterial:()=>Nt,ShadowMaterial:()=>q_,Shape:()=>Qa,ShapeGeometry:()=>z_,ShapePath:()=>dM,ShapeUtils:()=>bs,ShortType:()=>SM,Skeleton:()=>rh,SkeletonHelper:()=>tM,SkinnedMesh:()=>ih,Source:()=>ia,Sphere:()=>Di,SphereGeometry:()=>Ka,Spherical:()=>Qc,SphericalHarmonics3:()=>Cp,SplineCurve:()=>vp,SpotLight:()=>fh,SpotLightHelper:()=>eM,Sprite:()=>w_,SpriteMaterial:()=>hp,SrcAlphaFactor:()=>eu,SrcAlphaSaturateFactor:()=>q1,SrcColorFactor:()=>H1,StaticCopyUsage:()=>$B,StaticDrawUsage:()=>op,StaticReadUsage:()=>HB,StereoCamera:()=>Bw,StreamCopyUsage:()=>XB,StreamDrawUsage:()=>zB,StreamReadUsage:()=>WB,StringKeyframeTrack:()=>tc,SubtractEquation:()=>k1,SubtractiveBlending:()=>pM,TOUCH:()=>$r,TangentSpaceNormalMap:()=>il,TetrahedronGeometry:()=>H_,Texture:()=>Ii,TextureLoader:()=>Tp,TextureUtils:()=>hM,Timer:()=>Zw,TimestampQuery:()=>YB,TorusGeometry:()=>ua,TorusKnotGeometry:()=>G_,Triangle:()=>na,TriangleFanDrawMode:()=>vh,TriangleStripDrawMode:()=>zp,TrianglesDrawMode:()=>IM,TubeGeometry:()=>W_,UVMapping:()=>b_,Uint16BufferAttribute:()=>lp,Uint32BufferAttribute:()=>up,Uint8BufferAttribute:()=>yw,Uint8ClampedBufferAttribute:()=>xw,Uniform:()=>Ww,UniformsGroup:()=>$w,UniformsLib:()=>We,UniformsUtils:()=>Hn,UnsignedByteType:()=>_o,UnsignedInt101111Type:()=>TM,UnsignedInt248Type:()=>_a,UnsignedInt5999Type:()=>RM,UnsignedIntType:()=>es,UnsignedShort4444Type:()=>yb,UnsignedShort5551Type:()=>xb,UnsignedShortType:()=>tl,VSMShadowMap:()=>mh,Vector2:()=>z,Vector3:()=>C,Vector4:()=>En,VectorKeyframeTrack:()=>pa,VideoFrameTexture:()=>Cw,VideoTexture:()=>R_,WebGL3DRenderTarget:()=>_w,WebGLArrayRenderTarget:()=>gw,WebGLCoordinateSystem:()=>Io,WebGLCubeRenderTarget:()=>dp,WebGLRenderTarget:()=>Qt,WebGLRenderer:()=>rl,WebGLUtils:()=>k3,WebGPUCoordinateSystem:()=>qd,WebXRController:()=>Jd,WireframeGeometry:()=>$_,WrapAroundEnding:()=>ip,ZeroCurvatureEnding:()=>Kl,ZeroFactor:()=>Kc,ZeroSlopeEnding:()=>Jl,ZeroStencilOp:()=>CB,createCanvasElement:()=>hI,error:()=>bt,getConsoleFunction:()=>t3,log:()=>ap,setConsoleFunction:()=>e3,warn:()=>Ue,warnOnce:()=>Xd});var db="182",gi={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},$r={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},j1=0,fM=1,O1=2,mB=3,gB=0,Pp=1,L1=2,mh=3,vs=0,qr=1,rr=2,rn=0,ys=1,pu=2,pM=3,mM=4,mu=5,Er=100,k1=101,B1=102,U1=103,V1=104,Kc=200,z1=201,H1=202,G1=203,eu=204,tu=205,gh=206,W1=207,_h=208,$1=209,q1=210,X1=211,Z1=212,Y1=213,Q1=214,hb=0,fb=1,pb=2,nu=3,mb=4,gb=5,_b=6,bb=7,Fp=0,K1=1,J1=2,Ts=0,gM=1,_M=2,bM=3,vM=4,yM=5,xM=6,wM=7,pw="attached",eI="detached",b_=300,ga=301,Jc=302,Np=303,jp=304,bh=306,Qo=1e3,jr=1001,iu=1002,Zt=1003,Op=1004,_B=1004,el=1005,bB=1005,zn=1006,gu=1007,vB=1007,Po=1008,yB=1008,_o=1009,MM=1010,SM=1011,tl=1012,vb=1013,es=1014,tr=1015,An=1016,yb=1017,xb=1018,_a=1020,RM=35902,TM=35899,CM=1021,EM=1022,Gr=1023,oa=1026,ts=1027,nl=1028,Lp=1029,_u=1030,wb=1031,xB=1032,Mb=1033,kp=33776,Bp=33777,Up=33778,Vp=33779,Sb=35840,Rb=35841,Tb=35842,Cb=35843,Eb=36196,Db=37492,Ib=37496,Ab=37488,Pb=37489,Fb=37490,Nb=37491,jb=37808,Ob=37809,Lb=37810,kb=37811,Bb=37812,Ub=37813,Vb=37814,zb=37815,Hb=37816,Gb=37817,Wb=37818,$b=37819,qb=37820,Xb=37821,Zb=36492,Yb=36494,Qb=36495,Kb=36283,Jb=36284,ev=36285,tv=36286,nv=2200,tI=2201,nI=2202,ru=2300,ou=2301,p_=2302,Kl=2400,Jl=2401,ip=2402,iv=2500,DM=2501,IM=0,zp=1,vh=2,iI=3200,AM=3201,wB=3202,MB=3203,il=0,rI=1,ic="",Jn="srgb",nr="srgb-linear",rp="linear",kn="srgb",SB="",RB="rg",TB="ga",CB=0,Ql=7680,EB=7681,DB=7682,IB=7683,AB=34055,PB=34056,FB=5386,NB=512,jB=513,OB=514,LB=515,kB=516,BB=517,UB=518,mw=519,oI=512,sI=513,aI=514,rv=515,cI=516,lI=517,ov=518,uI=519,op=35044,VB=35048,zB=35040,HB=35045,GB=35049,WB=35041,$B=35046,qB=35050,XB=35042,ZB="100",PM="300 es",Io=2e3,qd=2001,YB={COMPUTE:"compute",RENDER:"render"},QB={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},KB={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};function dI(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}var sq={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function tp(i,e){return new sq[i](e)}function JB(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function sp(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function hI(){let i=sp("canvas");return i.style.display="block",i}var l2={},su=null;function e3(i){su=i}function t3(){return su}function ap(...i){let e="THREE."+i.shift();su?su("log",e,...i):console.log(e,...i)}function Ue(...i){let e="THREE."+i.shift();su?su("warn",e,...i):console.warn(e,...i)}function bt(...i){let e="THREE."+i.shift();su?su("error",e,...i):console.error(e,...i)}function Xd(...i){let e=i.join(" ");e in l2||(l2[e]=!0,Ue(...i))}function n3(i,e,t){return new Promise(function(n,r){function o(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:r();break;case i.TIMEOUT_EXPIRED:setTimeout(o,t);break;default:n()}}setTimeout(o,t)})}var Ko=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){let n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){let n=this._listeners;if(n===void 0)return;let r=n[e];if(r!==void 0){let o=r.indexOf(t);o!==-1&&r.splice(o,1)}}dispatchEvent(e){let t=this._listeners;if(t===void 0)return;let n=t[e.type];if(n!==void 0){e.target=this;let r=n.slice(0);for(let o=0,s=r.length;o<s;o++)r[o].call(this,e);e.target=null}}},Vr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],u2=1234567,$d=Math.PI/180,Zd=180/Math.PI;function Yo(){let i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Vr[i&255]+Vr[i>>8&255]+Vr[i>>16&255]+Vr[i>>24&255]+"-"+Vr[e&255]+Vr[e>>8&255]+"-"+Vr[e>>16&15|64]+Vr[e>>24&255]+"-"+Vr[t&63|128]+Vr[t>>8&255]+"-"+Vr[t>>16&255]+Vr[t>>24&255]+Vr[n&255]+Vr[n>>8&255]+Vr[n>>16&255]+Vr[n>>24&255]).toLowerCase()}function Bt(i,e,t){return Math.max(e,Math.min(t,i))}function fI(i,e){return(i%e+e)%e}function aq(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)}function cq(i,e,t){return i!==e?(t-i)/(e-i):0}function m_(i,e,t){return(1-t)*i+t*e}function lq(i,e,t,n){return m_(i,e,1-Math.exp(-t*n))}function uq(i,e=1){return e-Math.abs(fI(i,e*2)-e)}function dq(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function hq(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function fq(i,e){return i+Math.floor(Math.random()*(e-i+1))}function pq(i,e){return i+Math.random()*(e-i)}function mq(i){return i*(.5-Math.random())}function gq(i){i!==void 0&&(u2=i);let e=u2+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function _q(i){return i*$d}function bq(i){return i*Zd}function vq(i){return(i&i-1)===0&&i!==0}function yq(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function xq(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function wq(i,e,t,n,r){let o=Math.cos,s=Math.sin,a=o(t/2),c=s(t/2),l=o((e+n)/2),u=s((e+n)/2),d=o((e-n)/2),h=s((e-n)/2),f=o((n-e)/2),g=s((n-e)/2);switch(r){case"XYX":i.set(a*u,c*d,c*h,a*l);break;case"YZY":i.set(c*h,a*u,c*d,a*l);break;case"ZXZ":i.set(c*d,c*h,a*u,a*l);break;case"XZX":i.set(a*u,c*g,c*f,a*l);break;case"YXY":i.set(c*f,a*u,c*g,a*l);break;case"ZYZ":i.set(c*g,c*f,a*u,a*l);break;default:Ue("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function uo(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function an(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}var Ze={DEG2RAD:$d,RAD2DEG:Zd,generateUUID:Yo,clamp:Bt,euclideanModulo:fI,mapLinear:aq,inverseLerp:cq,lerp:m_,damp:lq,pingpong:uq,smoothstep:dq,smootherstep:hq,randInt:fq,randFloat:pq,randFloatSpread:mq,seededRandom:gq,degToRad:_q,radToDeg:bq,isPowerOfTwo:vq,ceilPowerOfTwo:yq,floorPowerOfTwo:xq,setQuaternionFromProperEuler:wq,normalize:an,denormalize:uo},z=class i{constructor(e=0,t=0){i.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Bt(this.x,e.x,t.x),this.y=Bt(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Bt(this.x,e,t),this.y=Bt(this.y,e,t),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Bt(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let n=this.dot(e)/t;return Math.acos(Bt(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let n=Math.cos(t),r=Math.sin(t),o=this.x-e.x,s=this.y-e.y;return this.x=o*n-s*r+e.x,this.y=o*r+s*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},nn=class{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,o,s,a){let c=n[r+0],l=n[r+1],u=n[r+2],d=n[r+3],h=o[s+0],f=o[s+1],g=o[s+2],_=o[s+3];if(a<=0){e[t+0]=c,e[t+1]=l,e[t+2]=u,e[t+3]=d;return}if(a>=1){e[t+0]=h,e[t+1]=f,e[t+2]=g,e[t+3]=_;return}if(d!==_||c!==h||l!==f||u!==g){let m=c*h+l*f+u*g+d*_;m<0&&(h=-h,f=-f,g=-g,_=-_,m=-m);let p=1-a;if(m<.9995){let b=Math.acos(m),v=Math.sin(b);p=Math.sin(p*b)/v,a=Math.sin(a*b)/v,c=c*p+h*a,l=l*p+f*a,u=u*p+g*a,d=d*p+_*a}else{c=c*p+h*a,l=l*p+f*a,u=u*p+g*a,d=d*p+_*a;let b=1/Math.sqrt(c*c+l*l+u*u+d*d);c*=b,l*=b,u*=b,d*=b}}e[t]=c,e[t+1]=l,e[t+2]=u,e[t+3]=d}static multiplyQuaternionsFlat(e,t,n,r,o,s){let a=n[r],c=n[r+1],l=n[r+2],u=n[r+3],d=o[s],h=o[s+1],f=o[s+2],g=o[s+3];return e[t]=a*g+u*d+c*f-l*h,e[t+1]=c*g+u*h+l*d-a*f,e[t+2]=l*g+u*f+a*h-c*d,e[t+3]=u*g-a*d-c*h-l*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){let n=e._x,r=e._y,o=e._z,s=e._order,a=Math.cos,c=Math.sin,l=a(n/2),u=a(r/2),d=a(o/2),h=c(n/2),f=c(r/2),g=c(o/2);switch(s){case"XYZ":this._x=h*u*d+l*f*g,this._y=l*f*d-h*u*g,this._z=l*u*g+h*f*d,this._w=l*u*d-h*f*g;break;case"YXZ":this._x=h*u*d+l*f*g,this._y=l*f*d-h*u*g,this._z=l*u*g-h*f*d,this._w=l*u*d+h*f*g;break;case"ZXY":this._x=h*u*d-l*f*g,this._y=l*f*d+h*u*g,this._z=l*u*g+h*f*d,this._w=l*u*d-h*f*g;break;case"ZYX":this._x=h*u*d-l*f*g,this._y=l*f*d+h*u*g,this._z=l*u*g-h*f*d,this._w=l*u*d+h*f*g;break;case"YZX":this._x=h*u*d+l*f*g,this._y=l*f*d+h*u*g,this._z=l*u*g-h*f*d,this._w=l*u*d-h*f*g;break;case"XZY":this._x=h*u*d-l*f*g,this._y=l*f*d-h*u*g,this._z=l*u*g+h*f*d,this._w=l*u*d+h*f*g;break;default:Ue("Quaternion: .setFromEuler() encountered an unknown order: "+s)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,n=t[0],r=t[4],o=t[8],s=t[1],a=t[5],c=t[9],l=t[2],u=t[6],d=t[10],h=n+a+d;if(h>0){let f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(u-c)*f,this._y=(o-l)*f,this._z=(s-r)*f}else if(n>a&&n>d){let f=2*Math.sqrt(1+n-a-d);this._w=(u-c)/f,this._x=.25*f,this._y=(r+s)/f,this._z=(o+l)/f}else if(a>d){let f=2*Math.sqrt(1+a-n-d);this._w=(o-l)/f,this._x=(r+s)/f,this._y=.25*f,this._z=(c+u)/f}else{let f=2*Math.sqrt(1+d-n-a);this._w=(s-r)/f,this._x=(o+l)/f,this._y=(c+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Bt(this.dot(e),-1,1)))}rotateTowards(e,t){let n=this.angleTo(e);if(n===0)return this;let r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let n=e._x,r=e._y,o=e._z,s=e._w,a=t._x,c=t._y,l=t._z,u=t._w;return this._x=n*u+s*a+r*l-o*c,this._y=r*u+s*c+o*a-n*l,this._z=o*u+s*l+n*c-r*a,this._w=s*u-n*a-r*c-o*l,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let n=e._x,r=e._y,o=e._z,s=e._w,a=this.dot(e);a<0&&(n=-n,r=-r,o=-o,s=-s,a=-a);let c=1-t;if(a<.9995){let l=Math.acos(a),u=Math.sin(l);c=Math.sin(c*l)/u,t=Math.sin(t*l)/u,this._x=this._x*c+n*t,this._y=this._y*c+r*t,this._z=this._z*c+o*t,this._w=this._w*c+s*t,this._onChangeCallback()}else this._x=this._x*c+n*t,this._y=this._y*c+r*t,this._z=this._z*c+o*t,this._w=this._w*c+s*t,this.normalize();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){let e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),o=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),o*Math.sin(t),o*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},C=class i{constructor(e=0,t=0,n=0){i.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(d2.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(d2.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,n=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[3]*n+o[6]*r,this.y=o[1]*t+o[4]*n+o[7]*r,this.z=o[2]*t+o[5]*n+o[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,n=this.y,r=this.z,o=e.elements,s=1/(o[3]*t+o[7]*n+o[11]*r+o[15]);return this.x=(o[0]*t+o[4]*n+o[8]*r+o[12])*s,this.y=(o[1]*t+o[5]*n+o[9]*r+o[13])*s,this.z=(o[2]*t+o[6]*n+o[10]*r+o[14])*s,this}applyQuaternion(e){let t=this.x,n=this.y,r=this.z,o=e.x,s=e.y,a=e.z,c=e.w,l=2*(s*r-a*n),u=2*(a*t-o*r),d=2*(o*n-s*t);return this.x=t+c*l+s*d-a*u,this.y=n+c*u+a*l-o*d,this.z=r+c*d+o*u-s*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,n=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r,this.y=o[1]*t+o[5]*n+o[9]*r,this.z=o[2]*t+o[6]*n+o[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Bt(this.x,e.x,t.x),this.y=Bt(this.y,e.y,t.y),this.z=Bt(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Bt(this.x,e,t),this.y=Bt(this.y,e,t),this.z=Bt(this.z,e,t),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Bt(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let n=e.x,r=e.y,o=e.z,s=t.x,a=t.y,c=t.z;return this.x=r*c-o*a,this.y=o*s-n*c,this.z=n*a-r*s,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return UD.copy(this).projectOnVector(e),this.sub(UD)}reflect(e){return this.sub(UD.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let n=this.dot(e)/t;return Math.acos(Bt(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){let r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},UD=new C,d2=new nn,Yt=class i{constructor(e,t,n,r,o,s,a,c,l){i.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,o,s,a,c,l)}set(e,t,n,r,o,s,a,c,l){let u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=o,u[5]=c,u[6]=n,u[7]=s,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,r=t.elements,o=this.elements,s=n[0],a=n[3],c=n[6],l=n[1],u=n[4],d=n[7],h=n[2],f=n[5],g=n[8],_=r[0],m=r[3],p=r[6],b=r[1],v=r[4],y=r[7],w=r[2],R=r[5],E=r[8];return o[0]=s*_+a*b+c*w,o[3]=s*m+a*v+c*R,o[6]=s*p+a*y+c*E,o[1]=l*_+u*b+d*w,o[4]=l*m+u*v+d*R,o[7]=l*p+u*y+d*E,o[2]=h*_+f*b+g*w,o[5]=h*m+f*v+g*R,o[8]=h*p+f*y+g*E,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],c=e[6],l=e[7],u=e[8];return t*s*u-t*a*l-n*o*u+n*a*c+r*o*l-r*s*c}invert(){let e=this.elements,t=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],c=e[6],l=e[7],u=e[8],d=u*s-a*l,h=a*c-u*o,f=l*o-s*c,g=t*d+n*h+r*f;if(g===0)return this.set(0,0,0,0,0,0,0,0,0);let _=1/g;return e[0]=d*_,e[1]=(r*l-u*n)*_,e[2]=(a*n-r*s)*_,e[3]=h*_,e[4]=(u*t-r*c)*_,e[5]=(r*o-a*t)*_,e[6]=f*_,e[7]=(n*c-l*t)*_,e[8]=(s*t-n*o)*_,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,o,s,a){let c=Math.cos(o),l=Math.sin(o);return this.set(n*c,n*l,-n*(c*s+l*a)+s+e,-r*l,r*c,-r*(-l*s+c*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(VD.makeScale(e,t)),this}rotate(e){return this.premultiply(VD.makeRotation(-e)),this}translate(e,t){return this.premultiply(VD.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){let n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}},VD=new Yt,h2=new Yt().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),f2=new Yt().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function Mq(){let i={enabled:!0,workingColorSpace:nr,spaces:{},convert:function(r,o,s){return this.enabled===!1||o===s||!o||!s||(this.spaces[o].transfer===kn&&(r.r=$c(r.r),r.g=$c(r.g),r.b=$c(r.b)),this.spaces[o].primaries!==this.spaces[s].primaries&&(r.applyMatrix3(this.spaces[o].toXYZ),r.applyMatrix3(this.spaces[s].fromXYZ)),this.spaces[s].transfer===kn&&(r.r=np(r.r),r.g=np(r.g),r.b=np(r.b))),r},workingToColorSpace:function(r,o){return this.convert(r,this.workingColorSpace,o)},colorSpaceToWorking:function(r,o){return this.convert(r,o,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===ic?rp:this.spaces[r].transfer},getToneMappingMode:function(r){return this.spaces[r].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(r,o=this.workingColorSpace){return r.fromArray(this.spaces[o].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,o,s){return r.copy(this.spaces[o].toXYZ).multiply(this.spaces[s].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,o){return Xd("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),i.workingToColorSpace(r,o)},toWorkingColorSpace:function(r,o){return Xd("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),i.colorSpaceToWorking(r,o)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return i.define({[nr]:{primaries:e,whitePoint:n,transfer:rp,toXYZ:h2,fromXYZ:f2,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Jn},outputColorSpaceConfig:{drawingBufferColorSpace:Jn}},[Jn]:{primaries:e,whitePoint:n,transfer:kn,toXYZ:h2,fromXYZ:f2,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Jn}}}),i}var hn=Mq();function $c(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function np(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}var jf,v_=class{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{jf===void 0&&(jf=sp("canvas")),jf.width=e.width,jf.height=e.height;let r=jf.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=jf}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=sp("canvas");t.width=e.width,t.height=e.height;let n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);let r=n.getImageData(0,0,e.width,e.height),o=r.data;for(let s=0;s<o.length;s++)o[s]=$c(o[s]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){let t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor($c(t[n]/255)*255):t[n]=$c(t[n]);return{data:t,width:e.width,height:e.height}}else return Ue("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},Sq=0,ia=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Sq++}),this.uuid=Yo(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){let t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):typeof VideoFrame<"u"&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let o;if(Array.isArray(r)){o=[];for(let s=0,a=r.length;s<a;s++)r[s].isDataTexture?o.push(zD(r[s].image)):o.push(zD(r[s]))}else o=zD(r);n.url=o}return t||(e.images[this.uuid]=n),n}};function zD(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?v_.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(Ue("Texture: Unable to serialize Texture."),{})}var Rq=0,HD=new C,Ii=(()=>{class i extends Ko{constructor(t=i.DEFAULT_IMAGE,n=i.DEFAULT_MAPPING,r=jr,o=jr,s=zn,a=Po,c=Gr,l=_o,u=i.DEFAULT_ANISOTROPY,d=ic){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Rq++}),this.uuid=Yo(),this.name="",this.source=new ia(t),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=o,this.magFilter=s,this.minFilter=a,this.anisotropy=u,this.format=c,this.internalFormat=null,this.type=l,this.offset=new z(0,0),this.repeat=new z(1,1),this.center=new z(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Yt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=d,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(t&&t.depth&&t.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(HD).x}get height(){return this.source.getSize(HD).y}get depth(){return this.source.getSize(HD).z}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(t,n){this.updateRanges.push({start:t,count:n})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.isArrayTexture=t.isArrayTexture,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}setValues(t){for(let n in t){let r=t[n];if(r===void 0){Ue(`Texture.setValues(): parameter '${n}' has value of undefined.`);continue}let o=this[n];if(o===void 0){Ue(`Texture.setValues(): property '${n}' does not exist.`);continue}o&&r&&o.isVector2&&r.isVector2||o&&r&&o.isVector3&&r.isVector3||o&&r&&o.isMatrix3&&r.isMatrix3?o.copy(r):this[n]=r}}toJSON(t){let n=t===void 0||typeof t=="string";if(!n&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];let r={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==b_)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Qo:t.x=t.x-Math.floor(t.x);break;case jr:t.x=t.x<0?0:1;break;case iu:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case Qo:t.y=t.y-Math.floor(t.y);break;case jr:t.y=t.y<0?0:1;break;case iu:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){t===!0&&this.pmremVersion++}}return i.DEFAULT_IMAGE=null,i.DEFAULT_MAPPING=b_,i.DEFAULT_ANISOTROPY=1,i})(),En=class i{constructor(e=0,t=0,n=0,r=1){i.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,n=this.y,r=this.z,o=this.w,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r+s[12]*o,this.y=s[1]*t+s[5]*n+s[9]*r+s[13]*o,this.z=s[2]*t+s[6]*n+s[10]*r+s[14]*o,this.w=s[3]*t+s[7]*n+s[11]*r+s[15]*o,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,o,c=e.elements,l=c[0],u=c[4],d=c[8],h=c[1],f=c[5],g=c[9],_=c[2],m=c[6],p=c[10];if(Math.abs(u-h)<.01&&Math.abs(d-_)<.01&&Math.abs(g-m)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+_)<.1&&Math.abs(g+m)<.1&&Math.abs(l+f+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let v=(l+1)/2,y=(f+1)/2,w=(p+1)/2,R=(u+h)/4,E=(d+_)/4,A=(g+m)/4;return v>y&&v>w?v<.01?(n=0,r=.707106781,o=.707106781):(n=Math.sqrt(v),r=R/n,o=E/n):y>w?y<.01?(n=.707106781,r=0,o=.707106781):(r=Math.sqrt(y),n=R/r,o=A/r):w<.01?(n=.707106781,r=.707106781,o=0):(o=Math.sqrt(w),n=E/o,r=A/o),this.set(n,r,o,t),this}let b=Math.sqrt((m-g)*(m-g)+(d-_)*(d-_)+(h-u)*(h-u));return Math.abs(b)<.001&&(b=1),this.x=(m-g)/b,this.y=(d-_)/b,this.z=(h-u)/b,this.w=Math.acos((l+f+p-1)/2),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Bt(this.x,e.x,t.x),this.y=Bt(this.y,e.y,t.y),this.z=Bt(this.z,e.z,t.z),this.w=Bt(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Bt(this.x,e,t),this.y=Bt(this.y,e,t),this.z=Bt(this.z,e,t),this.w=Bt(this.w,e,t),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Bt(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},cp=class extends Ko{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:zn,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new En(0,0,e,t),this.scissorTest=!1,this.viewport=new En(0,0,e,t);let r={width:e,height:t,depth:n.depth},o=new Ii(r);this.textures=[];let s=n.count;for(let a=0;a<s;a++)this.textures[a]=o.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){let t={minFilter:zn,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,o=this.textures.length;r<o;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,this.textures[r].isData3DTexture!==!0&&(this.textures[r].isArrayTexture=this.textures[r].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;let r=Object.assign({},e.textures[t].image);this.textures[t].source=new ia(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},Qt=class extends cp{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}},Yd=class extends Ii{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Zt,this.minFilter=Zt,this.wrapR=jr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}},gw=class extends Qt{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Yd(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}},Qd=class extends Ii{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Zt,this.minFilter=Zt,this.wrapR=jr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},_w=class extends Qt{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Qd(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}},wi=class{constructor(e=new C(1/0,1/0,1/0),t=new C(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Js.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Js.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let n=Js.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let n=e.geometry;if(n!==void 0){let o=n.getAttribute("position");if(t===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let s=0,a=o.count;s<a;s++)e.isMesh===!0?e.getVertexPosition(s,Js):Js.fromBufferAttribute(o,s),Js.applyMatrix4(e.matrixWorld),this.expandByPoint(Js);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Tx.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),Tx.copy(n.boundingBox)),Tx.applyMatrix4(e.matrixWorld),this.union(Tx)}let r=e.children;for(let o=0,s=r.length;o<s;o++)this.expandByObject(r[o],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Js),Js.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(t_),Cx.subVectors(this.max,t_),Of.subVectors(e.a,t_),Lf.subVectors(e.b,t_),kf.subVectors(e.c,t_),Gl.subVectors(Lf,Of),Wl.subVectors(kf,Lf),Fd.subVectors(Of,kf);let t=[0,-Gl.z,Gl.y,0,-Wl.z,Wl.y,0,-Fd.z,Fd.y,Gl.z,0,-Gl.x,Wl.z,0,-Wl.x,Fd.z,0,-Fd.x,-Gl.y,Gl.x,0,-Wl.y,Wl.x,0,-Fd.y,Fd.x,0];return!GD(t,Of,Lf,kf,Cx)||(t=[1,0,0,0,1,0,0,0,1],!GD(t,Of,Lf,kf,Cx))?!1:(Ex.crossVectors(Gl,Wl),t=[Ex.x,Ex.y,Ex.z],GD(t,Of,Lf,kf,Cx))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Js).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Js).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Bc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Bc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Bc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Bc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Bc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Bc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Bc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Bc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Bc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}},Bc=[new C,new C,new C,new C,new C,new C,new C,new C],Js=new C,Tx=new wi,Of=new C,Lf=new C,kf=new C,Gl=new C,Wl=new C,Fd=new C,t_=new C,Cx=new C,Ex=new C,Nd=new C;function GD(i,e,t,n,r){for(let o=0,s=i.length-3;o<=s;o+=3){Nd.fromArray(i,o);let a=r.x*Math.abs(Nd.x)+r.y*Math.abs(Nd.y)+r.z*Math.abs(Nd.z),c=e.dot(Nd),l=t.dot(Nd),u=n.dot(Nd);if(Math.max(-Math.max(c,l,u),Math.min(c,l,u))>a)return!1}return!0}var Tq=new wi,n_=new C,WD=new C,Di=class{constructor(e=new C,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let n=this.center;t!==void 0?n.copy(t):Tq.setFromPoints(e).getCenter(n);let r=0;for(let o=0,s=e.length;o<s;o++)r=Math.max(r,n.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;n_.subVectors(e,this.center);let t=n_.lengthSq();if(t>this.radius*this.radius){let n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(n_,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(WD.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(n_.copy(e.center).add(WD)),this.expandByPoint(n_.copy(e.center).sub(WD))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}},Uc=new C,$D=new C,Dx=new C,$l=new C,qD=new C,Ix=new C,XD=new C,sa=class{constructor(e=new C,t=new C(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Uc)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=Uc.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Uc.copy(this.origin).addScaledVector(this.direction,t),Uc.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){$D.copy(e).add(t).multiplyScalar(.5),Dx.copy(t).sub(e).normalize(),$l.copy(this.origin).sub($D);let o=e.distanceTo(t)*.5,s=-this.direction.dot(Dx),a=$l.dot(this.direction),c=-$l.dot(Dx),l=$l.lengthSq(),u=Math.abs(1-s*s),d,h,f,g;if(u>0)if(d=s*c-a,h=s*a-c,g=o*u,d>=0)if(h>=-g)if(h<=g){let _=1/u;d*=_,h*=_,f=d*(d+s*h+2*a)+h*(s*d+h+2*c)+l}else h=o,d=Math.max(0,-(s*h+a)),f=-d*d+h*(h+2*c)+l;else h=-o,d=Math.max(0,-(s*h+a)),f=-d*d+h*(h+2*c)+l;else h<=-g?(d=Math.max(0,-(-s*o+a)),h=d>0?-o:Math.min(Math.max(-o,-c),o),f=-d*d+h*(h+2*c)+l):h<=g?(d=0,h=Math.min(Math.max(-o,-c),o),f=h*(h+2*c)+l):(d=Math.max(0,-(s*o+a)),h=d>0?o:Math.min(Math.max(-o,-c),o),f=-d*d+h*(h+2*c)+l);else h=s>0?-o:o,d=Math.max(0,-(s*h+a)),f=-d*d+h*(h+2*c)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy($D).addScaledVector(Dx,h),f}intersectSphere(e,t){Uc.subVectors(e.center,this.origin);let n=Uc.dot(this.direction),r=Uc.dot(Uc)-n*n,o=e.radius*e.radius;if(r>o)return null;let s=Math.sqrt(o-r),a=n-s,c=n+s;return c<0?null:a<0?this.at(c,t):this.at(a,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){let n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,o,s,a,c,l=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,r=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,r=(e.min.x-h.x)*l),u>=0?(o=(e.min.y-h.y)*u,s=(e.max.y-h.y)*u):(o=(e.max.y-h.y)*u,s=(e.min.y-h.y)*u),n>s||o>r||((o>n||isNaN(n))&&(n=o),(s<r||isNaN(r))&&(r=s),d>=0?(a=(e.min.z-h.z)*d,c=(e.max.z-h.z)*d):(a=(e.max.z-h.z)*d,c=(e.min.z-h.z)*d),n>c||a>r)||((a>n||n!==n)&&(n=a),(c<r||r!==r)&&(r=c),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,Uc)!==null}intersectTriangle(e,t,n,r,o){qD.subVectors(t,e),Ix.subVectors(n,e),XD.crossVectors(qD,Ix);let s=this.direction.dot(XD),a;if(s>0){if(r)return null;a=1}else if(s<0)a=-1,s=-s;else return null;$l.subVectors(this.origin,e);let c=a*this.direction.dot(Ix.crossVectors($l,Ix));if(c<0)return null;let l=a*this.direction.dot(qD.cross($l));if(l<0||c+l>s)return null;let u=-a*$l.dot(XD);return u<0?null:this.at(u/s,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},Ee=class i{constructor(e,t,n,r,o,s,a,c,l,u,d,h,f,g,_,m){i.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,o,s,a,c,l,u,d,h,f,g,_,m)}set(e,t,n,r,o,s,a,c,l,u,d,h,f,g,_,m){let p=this.elements;return p[0]=e,p[4]=t,p[8]=n,p[12]=r,p[1]=o,p[5]=s,p[9]=a,p[13]=c,p[2]=l,p[6]=u,p[10]=d,p[14]=h,p[3]=f,p[7]=g,p[11]=_,p[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new i().fromArray(this.elements)}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){let t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return this.determinant()===0?(e.set(1,0,0),t.set(0,1,0),n.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this)}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();let t=this.elements,n=e.elements,r=1/Bf.setFromMatrixColumn(e,0).length(),o=1/Bf.setFromMatrixColumn(e,1).length(),s=1/Bf.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*o,t[5]=n[5]*o,t[6]=n[6]*o,t[7]=0,t[8]=n[8]*s,t[9]=n[9]*s,t[10]=n[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,n=e.x,r=e.y,o=e.z,s=Math.cos(n),a=Math.sin(n),c=Math.cos(r),l=Math.sin(r),u=Math.cos(o),d=Math.sin(o);if(e.order==="XYZ"){let h=s*u,f=s*d,g=a*u,_=a*d;t[0]=c*u,t[4]=-c*d,t[8]=l,t[1]=f+g*l,t[5]=h-_*l,t[9]=-a*c,t[2]=_-h*l,t[6]=g+f*l,t[10]=s*c}else if(e.order==="YXZ"){let h=c*u,f=c*d,g=l*u,_=l*d;t[0]=h+_*a,t[4]=g*a-f,t[8]=s*l,t[1]=s*d,t[5]=s*u,t[9]=-a,t[2]=f*a-g,t[6]=_+h*a,t[10]=s*c}else if(e.order==="ZXY"){let h=c*u,f=c*d,g=l*u,_=l*d;t[0]=h-_*a,t[4]=-s*d,t[8]=g+f*a,t[1]=f+g*a,t[5]=s*u,t[9]=_-h*a,t[2]=-s*l,t[6]=a,t[10]=s*c}else if(e.order==="ZYX"){let h=s*u,f=s*d,g=a*u,_=a*d;t[0]=c*u,t[4]=g*l-f,t[8]=h*l+_,t[1]=c*d,t[5]=_*l+h,t[9]=f*l-g,t[2]=-l,t[6]=a*c,t[10]=s*c}else if(e.order==="YZX"){let h=s*c,f=s*l,g=a*c,_=a*l;t[0]=c*u,t[4]=_-h*d,t[8]=g*d+f,t[1]=d,t[5]=s*u,t[9]=-a*u,t[2]=-l*u,t[6]=f*d+g,t[10]=h-_*d}else if(e.order==="XZY"){let h=s*c,f=s*l,g=a*c,_=a*l;t[0]=c*u,t[4]=-d,t[8]=l*u,t[1]=h*d+_,t[5]=s*u,t[9]=f*d-g,t[2]=g*d-f,t[6]=a*u,t[10]=_*d+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Cq,e,Eq)}lookAt(e,t,n){let r=this.elements;return Xo.subVectors(e,t),Xo.lengthSq()===0&&(Xo.z=1),Xo.normalize(),ql.crossVectors(n,Xo),ql.lengthSq()===0&&(Math.abs(n.z)===1?Xo.x+=1e-4:Xo.z+=1e-4,Xo.normalize(),ql.crossVectors(n,Xo)),ql.normalize(),Ax.crossVectors(Xo,ql),r[0]=ql.x,r[4]=Ax.x,r[8]=Xo.x,r[1]=ql.y,r[5]=Ax.y,r[9]=Xo.y,r[2]=ql.z,r[6]=Ax.z,r[10]=Xo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,r=t.elements,o=this.elements,s=n[0],a=n[4],c=n[8],l=n[12],u=n[1],d=n[5],h=n[9],f=n[13],g=n[2],_=n[6],m=n[10],p=n[14],b=n[3],v=n[7],y=n[11],w=n[15],R=r[0],E=r[4],A=r[8],x=r[12],T=r[1],P=r[5],L=r[9],H=r[13],te=r[2],Y=r[6],J=r[10],W=r[14],fe=r[3],ve=r[7],Re=r[11],Te=r[15];return o[0]=s*R+a*T+c*te+l*fe,o[4]=s*E+a*P+c*Y+l*ve,o[8]=s*A+a*L+c*J+l*Re,o[12]=s*x+a*H+c*W+l*Te,o[1]=u*R+d*T+h*te+f*fe,o[5]=u*E+d*P+h*Y+f*ve,o[9]=u*A+d*L+h*J+f*Re,o[13]=u*x+d*H+h*W+f*Te,o[2]=g*R+_*T+m*te+p*fe,o[6]=g*E+_*P+m*Y+p*ve,o[10]=g*A+_*L+m*J+p*Re,o[14]=g*x+_*H+m*W+p*Te,o[3]=b*R+v*T+y*te+w*fe,o[7]=b*E+v*P+y*Y+w*ve,o[11]=b*A+v*L+y*J+w*Re,o[15]=b*x+v*H+y*W+w*Te,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[4],r=e[8],o=e[12],s=e[1],a=e[5],c=e[9],l=e[13],u=e[2],d=e[6],h=e[10],f=e[14],g=e[3],_=e[7],m=e[11],p=e[15],b=c*f-l*h,v=a*f-l*d,y=a*h-c*d,w=s*f-l*u,R=s*h-c*u,E=s*d-a*u;return t*(_*b-m*v+p*y)-n*(g*b-m*w+p*R)+r*(g*v-_*w+p*E)-o*(g*y-_*R+m*E)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){let r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){let e=this.elements,t=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],c=e[6],l=e[7],u=e[8],d=e[9],h=e[10],f=e[11],g=e[12],_=e[13],m=e[14],p=e[15],b=d*m*l-_*h*l+_*c*f-a*m*f-d*c*p+a*h*p,v=g*h*l-u*m*l-g*c*f+s*m*f+u*c*p-s*h*p,y=u*_*l-g*d*l+g*a*f-s*_*f-u*a*p+s*d*p,w=g*d*c-u*_*c-g*a*h+s*_*h+u*a*m-s*d*m,R=t*b+n*v+r*y+o*w;if(R===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let E=1/R;return e[0]=b*E,e[1]=(_*h*o-d*m*o-_*r*f+n*m*f+d*r*p-n*h*p)*E,e[2]=(a*m*o-_*c*o+_*r*l-n*m*l-a*r*p+n*c*p)*E,e[3]=(d*c*o-a*h*o-d*r*l+n*h*l+a*r*f-n*c*f)*E,e[4]=v*E,e[5]=(u*m*o-g*h*o+g*r*f-t*m*f-u*r*p+t*h*p)*E,e[6]=(g*c*o-s*m*o-g*r*l+t*m*l+s*r*p-t*c*p)*E,e[7]=(s*h*o-u*c*o+u*r*l-t*h*l-s*r*f+t*c*f)*E,e[8]=y*E,e[9]=(g*d*o-u*_*o-g*n*f+t*_*f+u*n*p-t*d*p)*E,e[10]=(s*_*o-g*a*o+g*n*l-t*_*l-s*n*p+t*a*p)*E,e[11]=(u*a*o-s*d*o-u*n*l+t*d*l+s*n*f-t*a*f)*E,e[12]=w*E,e[13]=(u*_*r-g*d*r+g*n*h-t*_*h-u*n*m+t*d*m)*E,e[14]=(g*a*r-s*_*r-g*n*c+t*_*c+s*n*m-t*a*m)*E,e[15]=(s*d*r-u*a*r+u*n*c-t*d*c-s*n*h+t*a*h)*E,this}scale(e){let t=this.elements,n=e.x,r=e.y,o=e.z;return t[0]*=n,t[4]*=r,t[8]*=o,t[1]*=n,t[5]*=r,t[9]*=o,t[2]*=n,t[6]*=r,t[10]*=o,t[3]*=n,t[7]*=r,t[11]*=o,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let n=Math.cos(t),r=Math.sin(t),o=1-n,s=e.x,a=e.y,c=e.z,l=o*s,u=o*a;return this.set(l*s+n,l*a-r*c,l*c+r*a,0,l*a+r*c,u*a+n,u*c-r*s,0,l*c-r*a,u*c+r*s,o*c*c+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,o,s){return this.set(1,n,o,0,e,1,s,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){let r=this.elements,o=t._x,s=t._y,a=t._z,c=t._w,l=o+o,u=s+s,d=a+a,h=o*l,f=o*u,g=o*d,_=s*u,m=s*d,p=a*d,b=c*l,v=c*u,y=c*d,w=n.x,R=n.y,E=n.z;return r[0]=(1-(_+p))*w,r[1]=(f+y)*w,r[2]=(g-v)*w,r[3]=0,r[4]=(f-y)*R,r[5]=(1-(h+p))*R,r[6]=(m+b)*R,r[7]=0,r[8]=(g+v)*E,r[9]=(m-b)*E,r[10]=(1-(h+_))*E,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){let r=this.elements;if(e.x=r[12],e.y=r[13],e.z=r[14],this.determinant()===0)return n.set(1,1,1),t.identity(),this;let o=Bf.set(r[0],r[1],r[2]).length(),s=Bf.set(r[4],r[5],r[6]).length(),a=Bf.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),ea.copy(this);let l=1/o,u=1/s,d=1/a;return ea.elements[0]*=l,ea.elements[1]*=l,ea.elements[2]*=l,ea.elements[4]*=u,ea.elements[5]*=u,ea.elements[6]*=u,ea.elements[8]*=d,ea.elements[9]*=d,ea.elements[10]*=d,t.setFromRotationMatrix(ea),n.x=o,n.y=s,n.z=a,this}makePerspective(e,t,n,r,o,s,a=Io,c=!1){let l=this.elements,u=2*o/(t-e),d=2*o/(n-r),h=(t+e)/(t-e),f=(n+r)/(n-r),g,_;if(c)g=o/(s-o),_=s*o/(s-o);else if(a===Io)g=-(s+o)/(s-o),_=-2*s*o/(s-o);else if(a===qd)g=-s/(s-o),_=-s*o/(s-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=u,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=d,l[9]=f,l[13]=0,l[2]=0,l[6]=0,l[10]=g,l[14]=_,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,n,r,o,s,a=Io,c=!1){let l=this.elements,u=2/(t-e),d=2/(n-r),h=-(t+e)/(t-e),f=-(n+r)/(n-r),g,_;if(c)g=1/(s-o),_=s/(s-o);else if(a===Io)g=-2/(s-o),_=-(s+o)/(s-o);else if(a===qd)g=-1/(s-o),_=-o/(s-o);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=u,l[4]=0,l[8]=0,l[12]=h,l[1]=0,l[5]=d,l[9]=0,l[13]=f,l[2]=0,l[6]=0,l[10]=g,l[14]=_,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){let t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){let n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}},Bf=new C,ea=new Ee,Cq=new C(0,0,0),Eq=new C(1,1,1),ql=new C,Ax=new C,Xo=new C,p2=new Ee,m2=new nn,ho=(()=>{class i{constructor(t=0,n=0,r=0,o=i.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=o}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,r,o=this._order){return this._x=t,this._y=n,this._z=r,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,r=!0){let o=t.elements,s=o[0],a=o[4],c=o[8],l=o[1],u=o[5],d=o[9],h=o[2],f=o[6],g=o[10];switch(n){case"XYZ":this._y=Math.asin(Bt(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,g),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Bt(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(c,g),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(Bt(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,g),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Bt(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,g),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(Bt(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,u),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(c,g));break;case"XZY":this._z=Math.asin(-Bt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(c,s)):(this._x=Math.atan2(-d,g),this._y=0);break;default:Ue("Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(t,n,r){return p2.makeRotationFromQuaternion(t),this.setFromRotationMatrix(p2,n,r)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return m2.setFromEuler(this),this.setFromQuaternion(m2,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return i.DEFAULT_ORDER="XYZ",i})(),Kd=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},Dq=0,g2=new C,Uf=new nn,Vc=new Ee,Px=new C,i_=new C,Iq=new C,Aq=new nn,_2=new C(1,0,0),b2=new C(0,1,0),v2=new C(0,0,1),y2={type:"added"},Pq={type:"removed"},Vf={type:"childadded",child:null},ZD={type:"childremoved",child:null},wt=(()=>{class i extends Ko{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Dq++}),this.uuid=Yo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=i.DEFAULT_UP.clone();let t=new C,n=new ho,r=new nn,o=new C(1,1,1);function s(){r.setFromEuler(n,!1)}function a(){n.setFromQuaternion(r,void 0,!1)}n._onChange(s),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new Ee},normalMatrix:{value:new Yt}}),this.matrix=new Ee,this.matrixWorld=new Ee,this.matrixAutoUpdate=i.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Kd,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,n){this.quaternion.setFromAxisAngle(t,n)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,n){return Uf.setFromAxisAngle(t,n),this.quaternion.multiply(Uf),this}rotateOnWorldAxis(t,n){return Uf.setFromAxisAngle(t,n),this.quaternion.premultiply(Uf),this}rotateX(t){return this.rotateOnAxis(_2,t)}rotateY(t){return this.rotateOnAxis(b2,t)}rotateZ(t){return this.rotateOnAxis(v2,t)}translateOnAxis(t,n){return g2.copy(t).applyQuaternion(this.quaternion),this.position.add(g2.multiplyScalar(n)),this}translateX(t){return this.translateOnAxis(_2,t)}translateY(t){return this.translateOnAxis(b2,t)}translateZ(t){return this.translateOnAxis(v2,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Vc.copy(this.matrixWorld).invert())}lookAt(t,n,r){t.isVector3?Px.copy(t):Px.set(t,n,r);let o=this.parent;this.updateWorldMatrix(!0,!1),i_.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Vc.lookAt(i_,Px,this.up):Vc.lookAt(Px,i_,this.up),this.quaternion.setFromRotationMatrix(Vc),o&&(Vc.extractRotation(o.matrixWorld),Uf.setFromRotationMatrix(Vc),this.quaternion.premultiply(Uf.invert()))}add(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(bt("Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(y2),Vf.child=t,this.dispatchEvent(Vf),Vf.child=null):bt("Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let n=this.children.indexOf(t);return n!==-1&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(Pq),ZD.child=t,this.dispatchEvent(ZD),ZD.child=null),this}removeFromParent(){let t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Vc.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Vc.multiply(t.parent.matrixWorld)),t.applyMatrix4(Vc),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(y2),Vf.child=t,this.dispatchEvent(Vf),Vf.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,n){if(this[t]===n)return this;for(let r=0,o=this.children.length;r<o;r++){let a=this.children[r].getObjectByProperty(t,n);if(a!==void 0)return a}}getObjectsByProperty(t,n,r=[]){this[t]===n&&r.push(this);let o=this.children;for(let s=0,a=o.length;s<a;s++)o[s].getObjectsByProperty(t,n,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(i_,t,Iq),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(i_,Aq,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(t){t(this);let n=this.children;for(let r=0,o=n.length;r<o;r++)n[r].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);let n=this.children;for(let r=0,o=n.length;r<o;r++)n[r].traverseVisible(t)}traverseAncestors(t){let n=this.parent;n!==null&&(t(n),n.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);let n=this.children;for(let r=0,o=n.length;r<o;r++)n[r].updateMatrixWorld(t)}updateWorldMatrix(t,n){let r=this.parent;if(t===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){let o=this.children;for(let s=0,a=o.length;s<a;s++)o[s].updateWorldMatrix(!1,!0)}}toJSON(t){let n=t===void 0||typeof t=="string",r={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});let o={};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.castShadow===!0&&(o.castShadow=!0),this.receiveShadow===!0&&(o.receiveShadow=!0),this.visible===!1&&(o.visible=!1),this.frustumCulled===!1&&(o.frustumCulled=!1),this.renderOrder!==0&&(o.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),o.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(o.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(o.type="BatchedMesh",o.perObjectFrustumCulled=this.perObjectFrustumCulled,o.sortObjects=this.sortObjects,o.drawRanges=this._drawRanges,o.reservedRanges=this._reservedRanges,o.geometryInfo=this._geometryInfo.map(c=>jt(ae({},c),{boundingBox:c.boundingBox?c.boundingBox.toJSON():void 0,boundingSphere:c.boundingSphere?c.boundingSphere.toJSON():void 0})),o.instanceInfo=this._instanceInfo.map(c=>ae({},c)),o.availableInstanceIds=this._availableInstanceIds.slice(),o.availableGeometryIds=this._availableGeometryIds.slice(),o.nextIndexStart=this._nextIndexStart,o.nextVertexStart=this._nextVertexStart,o.geometryCount=this._geometryCount,o.maxInstanceCount=this._maxInstanceCount,o.maxVertexCount=this._maxVertexCount,o.maxIndexCount=this._maxIndexCount,o.geometryInitialized=this._geometryInitialized,o.matricesTexture=this._matricesTexture.toJSON(t),o.indirectTexture=this._indirectTexture.toJSON(t),this._colorsTexture!==null&&(o.colorsTexture=this._colorsTexture.toJSON(t)),this.boundingSphere!==null&&(o.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(o.boundingBox=this.boundingBox.toJSON()));function s(c,l){return c[l.uuid]===void 0&&(c[l.uuid]=l.toJSON(t)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(o.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=s(t.geometries,this.geometry);let c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){let l=c.shapes;if(Array.isArray(l))for(let u=0,d=l.length;u<d;u++){let h=l[u];s(t.shapes,h)}else s(t.shapes,l)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(t.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let c=[];for(let l=0,u=this.material.length;l<u;l++)c.push(s(t.materials,this.material[l]));o.material=c}else o.material=s(t.materials,this.material);if(this.children.length>0){o.children=[];for(let c=0;c<this.children.length;c++)o.children.push(this.children[c].toJSON(t).object)}if(this.animations.length>0){o.animations=[];for(let c=0;c<this.animations.length;c++){let l=this.animations[c];o.animations.push(s(t.animations,l))}}if(n){let c=a(t.geometries),l=a(t.materials),u=a(t.textures),d=a(t.images),h=a(t.shapes),f=a(t.skeletons),g=a(t.animations),_=a(t.nodes);c.length>0&&(r.geometries=c),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),d.length>0&&(r.images=d),h.length>0&&(r.shapes=h),f.length>0&&(r.skeletons=f),g.length>0&&(r.animations=g),_.length>0&&(r.nodes=_)}return r.object=o,r;function a(c){let l=[];for(let u in c){let d=c[u];delete d.metadata,l.push(d)}return l}}clone(t){return new this.constructor().copy(this,t)}copy(t,n=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),n===!0)for(let r=0;r<t.children.length;r++){let o=t.children[r];this.add(o.clone())}return this}}return i.DEFAULT_UP=new C(0,1,0),i.DEFAULT_MATRIX_AUTO_UPDATE=!0,i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,i})(),ta=new C,zc=new C,YD=new C,Hc=new C,zf=new C,Hf=new C,x2=new C,QD=new C,KD=new C,JD=new C,e1=new En,t1=new En,n1=new En,na=class i{constructor(e=new C,t=new C,n=new C){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),ta.subVectors(e,t),r.cross(ta);let o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(e,t,n,r,o){ta.subVectors(r,t),zc.subVectors(n,t),YD.subVectors(e,t);let s=ta.dot(ta),a=ta.dot(zc),c=ta.dot(YD),l=zc.dot(zc),u=zc.dot(YD),d=s*l-a*a;if(d===0)return o.set(0,0,0),null;let h=1/d,f=(l*c-a*u)*h,g=(s*u-a*c)*h;return o.set(1-f-g,g,f)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Hc)===null?!1:Hc.x>=0&&Hc.y>=0&&Hc.x+Hc.y<=1}static getInterpolation(e,t,n,r,o,s,a,c){return this.getBarycoord(e,t,n,r,Hc)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(o,Hc.x),c.addScaledVector(s,Hc.y),c.addScaledVector(a,Hc.z),c)}static getInterpolatedAttribute(e,t,n,r,o,s){return e1.setScalar(0),t1.setScalar(0),n1.setScalar(0),e1.fromBufferAttribute(e,t),t1.fromBufferAttribute(e,n),n1.fromBufferAttribute(e,r),s.setScalar(0),s.addScaledVector(e1,o.x),s.addScaledVector(t1,o.y),s.addScaledVector(n1,o.z),s}static isFrontFacing(e,t,n,r){return ta.subVectors(n,t),zc.subVectors(e,t),ta.cross(zc).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ta.subVectors(this.c,this.b),zc.subVectors(this.a,this.b),ta.cross(zc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return i.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return i.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,o){return i.getInterpolation(e,this.a,this.b,this.c,t,n,r,o)}containsPoint(e){return i.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return i.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let n=this.a,r=this.b,o=this.c,s,a;zf.subVectors(r,n),Hf.subVectors(o,n),QD.subVectors(e,n);let c=zf.dot(QD),l=Hf.dot(QD);if(c<=0&&l<=0)return t.copy(n);KD.subVectors(e,r);let u=zf.dot(KD),d=Hf.dot(KD);if(u>=0&&d<=u)return t.copy(r);let h=c*d-u*l;if(h<=0&&c>=0&&u<=0)return s=c/(c-u),t.copy(n).addScaledVector(zf,s);JD.subVectors(e,o);let f=zf.dot(JD),g=Hf.dot(JD);if(g>=0&&f<=g)return t.copy(o);let _=f*l-c*g;if(_<=0&&l>=0&&g<=0)return a=l/(l-g),t.copy(n).addScaledVector(Hf,a);let m=u*g-f*d;if(m<=0&&d-u>=0&&f-g>=0)return x2.subVectors(o,r),a=(d-u)/(d-u+(f-g)),t.copy(r).addScaledVector(x2,a);let p=1/(m+_+h);return s=_*p,a=h*p,t.copy(n).addScaledVector(zf,s).addScaledVector(Hf,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},i3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Xl={h:0,s:0,l:0},Fx={h:0,s:0,l:0};function i1(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}var ue=class{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){let r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Jn){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,hn.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=hn.workingColorSpace){return this.r=e,this.g=t,this.b=n,hn.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=hn.workingColorSpace){if(e=fI(e,1),t=Bt(t,0,1),n=Bt(n,0,1),t===0)this.r=this.g=this.b=n;else{let o=n<=.5?n*(1+t):n+t-n*t,s=2*n-o;this.r=i1(s,o,e+1/3),this.g=i1(s,o,e),this.b=i1(s,o,e-1/3)}return hn.colorSpaceToWorking(this,r),this}setStyle(e,t=Jn){function n(o){o!==void 0&&parseFloat(o)<1&&Ue("Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let o,s=r[1],a=r[2];switch(s){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,t);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,t);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,t);break;default:Ue("Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){let o=r[1],s=o.length;if(s===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,t);if(s===6)return this.setHex(parseInt(o,16),t);Ue("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Jn){let n=i3[e.toLowerCase()];return n!==void 0?this.setHex(n,t):Ue("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=$c(e.r),this.g=$c(e.g),this.b=$c(e.b),this}copyLinearToSRGB(e){return this.r=np(e.r),this.g=np(e.g),this.b=np(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Jn){return hn.workingToColorSpace(zr.copy(this),e),Math.round(Bt(zr.r*255,0,255))*65536+Math.round(Bt(zr.g*255,0,255))*256+Math.round(Bt(zr.b*255,0,255))}getHexString(e=Jn){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=hn.workingColorSpace){hn.workingToColorSpace(zr.copy(this),t);let n=zr.r,r=zr.g,o=zr.b,s=Math.max(n,r,o),a=Math.min(n,r,o),c,l,u=(a+s)/2;if(a===s)c=0,l=0;else{let d=s-a;switch(l=u<=.5?d/(s+a):d/(2-s-a),s){case n:c=(r-o)/d+(r<o?6:0);break;case r:c=(o-n)/d+2;break;case o:c=(n-r)/d+4;break}c/=6}return e.h=c,e.s=l,e.l=u,e}getRGB(e,t=hn.workingColorSpace){return hn.workingToColorSpace(zr.copy(this),t),e.r=zr.r,e.g=zr.g,e.b=zr.b,e}getStyle(e=Jn){hn.workingToColorSpace(zr.copy(this),e);let t=zr.r,n=zr.g,r=zr.b;return e!==Jn?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(Xl),this.setHSL(Xl.h+e,Xl.s+t,Xl.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Xl),e.getHSL(Fx);let n=m_(Xl.h,Fx.h,t),r=m_(Xl.s,Fx.s,t),o=m_(Xl.l,Fx.l,t);return this.setHSL(n,r,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,n=this.g,r=this.b,o=e.elements;return this.r=o[0]*t+o[3]*n+o[6]*r,this.g=o[1]*t+o[4]*n+o[7]*r,this.b=o[2]*t+o[5]*n+o[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}},zr=new ue;ue.NAMES=i3;var Fq=0,Mi=class extends Ko{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Fq++}),this.uuid=Yo(),this.name="",this.type="Material",this.blending=ys,this.side=vs,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=eu,this.blendDst=tu,this.blendEquation=Er,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new ue(0,0,0),this.blendAlpha=0,this.depthFunc=nu,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=mw,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ql,this.stencilZFail=Ql,this.stencilZPass=Ql,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let n=e[t];if(n===void 0){Ue(`Material: parameter '${t}' has value of undefined.`);continue}let r=this[t];if(r===void 0){Ue(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==ys&&(n.blending=this.blending),this.side!==vs&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==eu&&(n.blendSrc=this.blendSrc),this.blendDst!==tu&&(n.blendDst=this.blendDst),this.blendEquation!==Er&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==nu&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==mw&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Ql&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Ql&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Ql&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.allowOverride===!1&&(n.allowOverride=!1),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(o){let s=[];for(let a in o){let c=o[a];delete c.metadata,s.push(c)}return s}if(t){let o=r(e.textures),s=r(e.images);o.length>0&&(n.textures=o),s.length>0&&(n.images=s)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,n=null;if(t!==null){let r=t.length;n=new Array(r);for(let o=0;o!==r;++o)n[o]=t[o].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},ci=class extends Mi{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ue(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ho,this.combine=Fp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},Wc=Nq();function Nq(){let i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),r=new Uint32Array(512);for(let c=0;c<256;++c){let l=c-127;l<-27?(n[c]=0,n[c|256]=32768,r[c]=24,r[c|256]=24):l<-14?(n[c]=1024>>-l-14,n[c|256]=1024>>-l-14|32768,r[c]=-l-1,r[c|256]=-l-1):l<=15?(n[c]=l+15<<10,n[c|256]=l+15<<10|32768,r[c]=13,r[c|256]=13):l<128?(n[c]=31744,n[c|256]=64512,r[c]=24,r[c|256]=24):(n[c]=31744,n[c|256]=64512,r[c]=13,r[c|256]=13)}let o=new Uint32Array(2048),s=new Uint32Array(64),a=new Uint32Array(64);for(let c=1;c<1024;++c){let l=c<<13,u=0;for(;(l&8388608)===0;)l<<=1,u-=8388608;l&=-8388609,u+=947912704,o[c]=l|u}for(let c=1024;c<2048;++c)o[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)s[c]=c<<23;s[31]=1199570944,s[32]=2147483648;for(let c=33;c<63;++c)s[c]=2147483648+(c-32<<23);s[63]=3347054592;for(let c=1;c<64;++c)c!==32&&(a[c]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:o,exponentTable:s,offsetTable:a}}function Do(i){Math.abs(i)>65504&&Ue("DataUtils.toHalfFloat(): Value out of range."),i=Bt(i,-65504,65504),Wc.floatView[0]=i;let e=Wc.uint32View[0],t=e>>23&511;return Wc.baseTable[t]+((e&8388607)>>Wc.shiftTable[t])}function h_(i){let e=i>>10;return Wc.uint32View[0]=Wc.mantissaTable[Wc.offsetTable[e]+(i&1023)]+Wc.exponentTable[e],Wc.floatView[0]}var bw=class{static toHalfFloat(e){return Do(e)}static fromHalfFloat(e){return h_(e)}},er=new C,Nx=new z,jq=0,pn=class{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:jq++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=op,this.updateRanges=[],this.gpuType=tr,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)Nx.fromBufferAttribute(this,t),Nx.applyMatrix3(e),this.setXY(t,Nx.x,Nx.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)er.fromBufferAttribute(this,t),er.applyMatrix3(e),this.setXYZ(t,er.x,er.y,er.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)er.fromBufferAttribute(this,t),er.applyMatrix4(e),this.setXYZ(t,er.x,er.y,er.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)er.fromBufferAttribute(this,t),er.applyNormalMatrix(e),this.setXYZ(t,er.x,er.y,er.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)er.fromBufferAttribute(this,t),er.transformDirection(e),this.setXYZ(t,er.x,er.y,er.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=uo(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=an(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=uo(t,this.array)),t}setX(e,t){return this.normalized&&(t=an(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=uo(t,this.array)),t}setY(e,t){return this.normalized&&(t=an(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=uo(t,this.array)),t}setZ(e,t){return this.normalized&&(t=an(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=uo(t,this.array)),t}setW(e,t){return this.normalized&&(t=an(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=an(t,this.array),n=an(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=an(t,this.array),n=an(n,this.array),r=an(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,o){return e*=this.itemSize,this.normalized&&(t=an(t,this.array),n=an(n,this.array),r=an(r,this.array),o=an(o,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==op&&(e.usage=this.usage),e}},vw=class extends pn{constructor(e,t,n){super(new Int8Array(e),t,n)}},yw=class extends pn{constructor(e,t,n){super(new Uint8Array(e),t,n)}},xw=class extends pn{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}},ww=class extends pn{constructor(e,t,n){super(new Int16Array(e),t,n)}},lp=class extends pn{constructor(e,t,n){super(new Uint16Array(e),t,n)}},Mw=class extends pn{constructor(e,t,n){super(new Int32Array(e),t,n)}},up=class extends pn{constructor(e,t,n){super(new Uint32Array(e),t,n)}},Sw=class extends pn{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=h_(this.array[e*this.itemSize]);return this.normalized&&(t=uo(t,this.array)),t}setX(e,t){return this.normalized&&(t=an(t,this.array)),this.array[e*this.itemSize]=Do(t),this}getY(e){let t=h_(this.array[e*this.itemSize+1]);return this.normalized&&(t=uo(t,this.array)),t}setY(e,t){return this.normalized&&(t=an(t,this.array)),this.array[e*this.itemSize+1]=Do(t),this}getZ(e){let t=h_(this.array[e*this.itemSize+2]);return this.normalized&&(t=uo(t,this.array)),t}setZ(e,t){return this.normalized&&(t=an(t,this.array)),this.array[e*this.itemSize+2]=Do(t),this}getW(e){let t=h_(this.array[e*this.itemSize+3]);return this.normalized&&(t=uo(t,this.array)),t}setW(e,t){return this.normalized&&(t=an(t,this.array)),this.array[e*this.itemSize+3]=Do(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=an(t,this.array),n=an(n,this.array)),this.array[e+0]=Do(t),this.array[e+1]=Do(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=an(t,this.array),n=an(n,this.array),r=an(r,this.array)),this.array[e+0]=Do(t),this.array[e+1]=Do(n),this.array[e+2]=Do(r),this}setXYZW(e,t,n,r,o){return e*=this.itemSize,this.normalized&&(t=an(t,this.array),n=an(n,this.array),r=an(r,this.array),o=an(o,this.array)),this.array[e+0]=Do(t),this.array[e+1]=Do(n),this.array[e+2]=Do(r),this.array[e+3]=Do(o),this}},Oe=class extends pn{constructor(e,t,n){super(new Float32Array(e),t,n)}},Oq=0,_s=new Ee,r1=new wt,Gf=new C,Zo=new wi,r_=new wi,Tr=new C,nt=class i extends Ko{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Oq++}),this.uuid=Yo(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(dI(e)?up:lp)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let n=this.attributes.normal;if(n!==void 0){let o=new Yt().getNormalMatrix(e);n.applyNormalMatrix(o),n.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return _s.makeRotationFromQuaternion(e),this.applyMatrix4(_s),this}rotateX(e){return _s.makeRotationX(e),this.applyMatrix4(_s),this}rotateY(e){return _s.makeRotationY(e),this.applyMatrix4(_s),this}rotateZ(e){return _s.makeRotationZ(e),this.applyMatrix4(_s),this}translate(e,t,n){return _s.makeTranslation(e,t,n),this.applyMatrix4(_s),this}scale(e,t,n){return _s.makeScale(e,t,n),this.applyMatrix4(_s),this}lookAt(e){return r1.lookAt(e),r1.updateMatrix(),this.applyMatrix4(r1.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Gf).negate(),this.translate(Gf.x,Gf.y,Gf.z),this}setFromPoints(e){let t=this.getAttribute("position");if(t===void 0){let n=[];for(let r=0,o=e.length;r<o;r++){let s=e[r];n.push(s.x,s.y,s.z||0)}this.setAttribute("position",new Oe(n,3))}else{let n=Math.min(e.length,t.count);for(let r=0;r<n;r++){let o=e[r];t.setXYZ(r,o.x,o.y,o.z||0)}e.length>t.count&&Ue("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new wi);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){bt("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new C(-1/0,-1/0,-1/0),new C(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){let o=t[n];Zo.setFromBufferAttribute(o),this.morphTargetsRelative?(Tr.addVectors(this.boundingBox.min,Zo.min),this.boundingBox.expandByPoint(Tr),Tr.addVectors(this.boundingBox.max,Zo.max),this.boundingBox.expandByPoint(Tr)):(this.boundingBox.expandByPoint(Zo.min),this.boundingBox.expandByPoint(Zo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&bt('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Di);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){bt("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new C,1/0);return}if(e){let n=this.boundingSphere.center;if(Zo.setFromBufferAttribute(e),t)for(let o=0,s=t.length;o<s;o++){let a=t[o];r_.setFromBufferAttribute(a),this.morphTargetsRelative?(Tr.addVectors(Zo.min,r_.min),Zo.expandByPoint(Tr),Tr.addVectors(Zo.max,r_.max),Zo.expandByPoint(Tr)):(Zo.expandByPoint(r_.min),Zo.expandByPoint(r_.max))}Zo.getCenter(n);let r=0;for(let o=0,s=e.count;o<s;o++)Tr.fromBufferAttribute(e,o),r=Math.max(r,n.distanceToSquared(Tr));if(t)for(let o=0,s=t.length;o<s;o++){let a=t[o],c=this.morphTargetsRelative;for(let l=0,u=a.count;l<u;l++)Tr.fromBufferAttribute(a,l),c&&(Gf.fromBufferAttribute(e,l),Tr.add(Gf)),r=Math.max(r,n.distanceToSquared(Tr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&bt('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){bt("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let n=t.position,r=t.normal,o=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new pn(new Float32Array(4*n.count),4));let s=this.getAttribute("tangent"),a=[],c=[];for(let A=0;A<n.count;A++)a[A]=new C,c[A]=new C;let l=new C,u=new C,d=new C,h=new z,f=new z,g=new z,_=new C,m=new C;function p(A,x,T){l.fromBufferAttribute(n,A),u.fromBufferAttribute(n,x),d.fromBufferAttribute(n,T),h.fromBufferAttribute(o,A),f.fromBufferAttribute(o,x),g.fromBufferAttribute(o,T),u.sub(l),d.sub(l),f.sub(h),g.sub(h);let P=1/(f.x*g.y-g.x*f.y);isFinite(P)&&(_.copy(u).multiplyScalar(g.y).addScaledVector(d,-f.y).multiplyScalar(P),m.copy(d).multiplyScalar(f.x).addScaledVector(u,-g.x).multiplyScalar(P),a[A].add(_),a[x].add(_),a[T].add(_),c[A].add(m),c[x].add(m),c[T].add(m))}let b=this.groups;b.length===0&&(b=[{start:0,count:e.count}]);for(let A=0,x=b.length;A<x;++A){let T=b[A],P=T.start,L=T.count;for(let H=P,te=P+L;H<te;H+=3)p(e.getX(H+0),e.getX(H+1),e.getX(H+2))}let v=new C,y=new C,w=new C,R=new C;function E(A){w.fromBufferAttribute(r,A),R.copy(w);let x=a[A];v.copy(x),v.sub(w.multiplyScalar(w.dot(x))).normalize(),y.crossVectors(R,x);let P=y.dot(c[A])<0?-1:1;s.setXYZW(A,v.x,v.y,v.z,P)}for(let A=0,x=b.length;A<x;++A){let T=b[A],P=T.start,L=T.count;for(let H=P,te=P+L;H<te;H+=3)E(e.getX(H+0)),E(e.getX(H+1)),E(e.getX(H+2))}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new pn(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let h=0,f=n.count;h<f;h++)n.setXYZ(h,0,0,0);let r=new C,o=new C,s=new C,a=new C,c=new C,l=new C,u=new C,d=new C;if(e)for(let h=0,f=e.count;h<f;h+=3){let g=e.getX(h+0),_=e.getX(h+1),m=e.getX(h+2);r.fromBufferAttribute(t,g),o.fromBufferAttribute(t,_),s.fromBufferAttribute(t,m),u.subVectors(s,o),d.subVectors(r,o),u.cross(d),a.fromBufferAttribute(n,g),c.fromBufferAttribute(n,_),l.fromBufferAttribute(n,m),a.add(u),c.add(u),l.add(u),n.setXYZ(g,a.x,a.y,a.z),n.setXYZ(_,c.x,c.y,c.z),n.setXYZ(m,l.x,l.y,l.z)}else for(let h=0,f=t.count;h<f;h+=3)r.fromBufferAttribute(t,h+0),o.fromBufferAttribute(t,h+1),s.fromBufferAttribute(t,h+2),u.subVectors(s,o),d.subVectors(r,o),u.cross(d),n.setXYZ(h+0,u.x,u.y,u.z),n.setXYZ(h+1,u.x,u.y,u.z),n.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Tr.fromBufferAttribute(e,t),Tr.normalize(),e.setXYZ(t,Tr.x,Tr.y,Tr.z)}toNonIndexed(){function e(a,c){let l=a.array,u=a.itemSize,d=a.normalized,h=new l.constructor(c.length*u),f=0,g=0;for(let _=0,m=c.length;_<m;_++){a.isInterleavedBufferAttribute?f=c[_]*a.data.stride+a.offset:f=c[_]*u;for(let p=0;p<u;p++)h[g++]=l[f++]}return new pn(h,u,d)}if(this.index===null)return Ue("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new i,n=this.index.array,r=this.attributes;for(let a in r){let c=r[a],l=e(c,n);t.setAttribute(a,l)}let o=this.morphAttributes;for(let a in o){let c=[],l=o[a];for(let u=0,d=l.length;u<d;u++){let h=l[u],f=e(h,n);c.push(f)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;let s=this.groups;for(let a=0,c=s.length;a<c;a++){let l=s[a];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){let e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let c=this.parameters;for(let l in c)c[l]!==void 0&&(e[l]=c[l]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let n=this.attributes;for(let c in n){let l=n[c];e.data.attributes[c]=l.toJSON(e.data)}let r={},o=!1;for(let c in this.morphAttributes){let l=this.morphAttributes[c],u=[];for(let d=0,h=l.length;d<h;d++){let f=l[d];u.push(f.toJSON(e.data))}u.length>0&&(r[c]=u,o=!0)}o&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);let s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));let a=this.boundingSphere;return a!==null&&(e.data.boundingSphere=a.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let n=e.index;n!==null&&this.setIndex(n.clone());let r=e.attributes;for(let l in r){let u=r[l];this.setAttribute(l,u.clone(t))}let o=e.morphAttributes;for(let l in o){let u=[],d=o[l];for(let h=0,f=d.length;h<f;h++)u.push(d[h].clone(t));this.morphAttributes[l]=u}this.morphTargetsRelative=e.morphTargetsRelative;let s=e.groups;for(let l=0,u=s.length;l<u;l++){let d=s[l];this.addGroup(d.start,d.count,d.materialIndex)}let a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());let c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}},w2=new Ee,jd=new sa,jx=new Di,M2=new C,Ox=new C,Lx=new C,kx=new C,o1=new C,Bx=new C,S2=new C,Ux=new C,Pe=class extends wt{constructor(e=new nt,t=new ci){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){let r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){let a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}getVertexPosition(e,t){let n=this.geometry,r=n.attributes.position,o=n.morphAttributes.position,s=n.morphTargetsRelative;t.fromBufferAttribute(r,e);let a=this.morphTargetInfluences;if(o&&a){Bx.set(0,0,0);for(let c=0,l=o.length;c<l;c++){let u=a[c],d=o[c];u!==0&&(o1.fromBufferAttribute(d,e),s?Bx.addScaledVector(o1,u):Bx.addScaledVector(o1.sub(t),u))}t.add(Bx)}return t}raycast(e,t){let n=this.geometry,r=this.material,o=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),jx.copy(n.boundingSphere),jx.applyMatrix4(o),jd.copy(e.ray).recast(e.near),!(jx.containsPoint(jd.origin)===!1&&(jd.intersectSphere(jx,M2)===null||jd.origin.distanceToSquared(M2)>(e.far-e.near)**2))&&(w2.copy(o).invert(),jd.copy(e.ray).applyMatrix4(w2),!(n.boundingBox!==null&&jd.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,jd)))}_computeIntersections(e,t,n){let r,o=this.geometry,s=this.material,a=o.index,c=o.attributes.position,l=o.attributes.uv,u=o.attributes.uv1,d=o.attributes.normal,h=o.groups,f=o.drawRange;if(a!==null)if(Array.isArray(s))for(let g=0,_=h.length;g<_;g++){let m=h[g],p=s[m.materialIndex],b=Math.max(m.start,f.start),v=Math.min(a.count,Math.min(m.start+m.count,f.start+f.count));for(let y=b,w=v;y<w;y+=3){let R=a.getX(y),E=a.getX(y+1),A=a.getX(y+2);r=Vx(this,p,e,n,l,u,d,R,E,A),r&&(r.faceIndex=Math.floor(y/3),r.face.materialIndex=m.materialIndex,t.push(r))}}else{let g=Math.max(0,f.start),_=Math.min(a.count,f.start+f.count);for(let m=g,p=_;m<p;m+=3){let b=a.getX(m),v=a.getX(m+1),y=a.getX(m+2);r=Vx(this,s,e,n,l,u,d,b,v,y),r&&(r.faceIndex=Math.floor(m/3),t.push(r))}}else if(c!==void 0)if(Array.isArray(s))for(let g=0,_=h.length;g<_;g++){let m=h[g],p=s[m.materialIndex],b=Math.max(m.start,f.start),v=Math.min(c.count,Math.min(m.start+m.count,f.start+f.count));for(let y=b,w=v;y<w;y+=3){let R=y,E=y+1,A=y+2;r=Vx(this,p,e,n,l,u,d,R,E,A),r&&(r.faceIndex=Math.floor(y/3),r.face.materialIndex=m.materialIndex,t.push(r))}}else{let g=Math.max(0,f.start),_=Math.min(c.count,f.start+f.count);for(let m=g,p=_;m<p;m+=3){let b=m,v=m+1,y=m+2;r=Vx(this,s,e,n,l,u,d,b,v,y),r&&(r.faceIndex=Math.floor(m/3),t.push(r))}}}};function Lq(i,e,t,n,r,o,s,a){let c;if(e.side===qr?c=n.intersectTriangle(s,o,r,!0,a):c=n.intersectTriangle(r,o,s,e.side===vs,a),c===null)return null;Ux.copy(a),Ux.applyMatrix4(i.matrixWorld);let l=t.ray.origin.distanceTo(Ux);return l<t.near||l>t.far?null:{distance:l,point:Ux.clone(),object:i}}function Vx(i,e,t,n,r,o,s,a,c,l){i.getVertexPosition(a,Ox),i.getVertexPosition(c,Lx),i.getVertexPosition(l,kx);let u=Lq(i,e,t,n,Ox,Lx,kx,S2);if(u){let d=new C;na.getBarycoord(S2,Ox,Lx,kx,d),r&&(u.uv=na.getInterpolatedAttribute(r,a,c,l,d,new z)),o&&(u.uv1=na.getInterpolatedAttribute(o,a,c,l,d,new z)),s&&(u.normal=na.getInterpolatedAttribute(s,a,c,l,d,new C),u.normal.dot(n.direction)>0&&u.normal.multiplyScalar(-1));let h={a,b:c,c:l,normal:new C,materialIndex:0};na.getNormal(Ox,Lx,kx,h.normal),u.face=h,u.barycoord=d}return u}var ei=class i extends nt{constructor(e=1,t=1,n=1,r=1,o=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:o,depthSegments:s};let a=this;r=Math.floor(r),o=Math.floor(o),s=Math.floor(s);let c=[],l=[],u=[],d=[],h=0,f=0;g("z","y","x",-1,-1,n,t,e,s,o,0),g("z","y","x",1,-1,n,t,-e,s,o,1),g("x","z","y",1,1,e,n,t,r,s,2),g("x","z","y",1,-1,e,n,-t,r,s,3),g("x","y","z",1,-1,e,t,n,r,o,4),g("x","y","z",-1,-1,e,t,-n,r,o,5),this.setIndex(c),this.setAttribute("position",new Oe(l,3)),this.setAttribute("normal",new Oe(u,3)),this.setAttribute("uv",new Oe(d,2));function g(_,m,p,b,v,y,w,R,E,A,x){let T=y/E,P=w/A,L=y/2,H=w/2,te=R/2,Y=E+1,J=A+1,W=0,fe=0,ve=new C;for(let Re=0;Re<J;Re++){let Te=Re*P-H;for(let mt=0;mt<Y;mt++){let gt=mt*T-L;ve[_]=gt*b,ve[m]=Te*v,ve[p]=te,l.push(ve.x,ve.y,ve.z),ve[_]=0,ve[m]=0,ve[p]=R>0?1:-1,u.push(ve.x,ve.y,ve.z),d.push(mt/E),d.push(1-Re/A),W+=1}}for(let Re=0;Re<A;Re++)for(let Te=0;Te<E;Te++){let mt=h+Te+Y*Re,gt=h+Te+Y*(Re+1),dn=h+(Te+1)+Y*(Re+1),_n=h+(Te+1)+Y*Re;c.push(mt,gt,_n),c.push(gt,dn,_n),fe+=6}a.addGroup(f,fe,x),f+=fe,h+=W}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function yh(i){let e={};for(let t in i){e[t]={};for(let n in i[t]){let r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(Ue("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function Xr(i){let e={};for(let t=0;t<i.length;t++){let n=yh(i[t]);for(let r in n)e[r]=n[r]}return e}function kq(i){let e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function pI(i){let e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:hn.workingColorSpace}var Hn={clone:yh,merge:Xr},Bq=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Uq=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Nt=class extends Mi{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Bq,this.fragmentShader=Uq,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=yh(e.uniforms),this.uniformsGroups=kq(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let r in this.uniforms){let s=this.uniforms[r].value;s&&s.isTexture?t.uniforms[r]={type:"t",value:s.toJSON(e).uuid}:s&&s.isColor?t.uniforms[r]={type:"c",value:s.getHex()}:s&&s.isVector2?t.uniforms[r]={type:"v2",value:s.toArray()}:s&&s.isVector3?t.uniforms[r]={type:"v3",value:s.toArray()}:s&&s.isVector4?t.uniforms[r]={type:"v4",value:s.toArray()}:s&&s.isMatrix3?t.uniforms[r]={type:"m3",value:s.toArray()}:s&&s.isMatrix4?t.uniforms[r]={type:"m4",value:s.toArray()}:t.uniforms[r]={value:s}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;let n={};for(let r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}},qc=class extends wt{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ee,this.projectionMatrix=new Ee,this.projectionMatrixInverse=new Ee,this.coordinateSystem=Io,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},Zl=new C,R2=new z,T2=new z,ai=class extends qc{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=Zd*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan($d*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Zd*2*Math.atan(Math.tan($d*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Zl.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Zl.x,Zl.y).multiplyScalar(-e/Zl.z),Zl.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Zl.x,Zl.y).multiplyScalar(-e/Zl.z)}getViewSize(e,t){return this.getViewBounds(e,R2,T2),t.subVectors(T2,R2)}setViewOffset(e,t,n,r,o,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan($d*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,o=-.5*r,s=this.view;if(this.view!==null&&this.view.enabled){let c=s.fullWidth,l=s.fullHeight;o+=s.offsetX*r/c,t-=s.offsetY*n/l,r*=s.width/c,n*=s.height/l}let a=this.filmOffset;a!==0&&(o+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},Wf=-90,$f=1,y_=class extends wt{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;let r=new ai(Wf,$f,e,t);r.layers=this.layers,this.add(r);let o=new ai(Wf,$f,e,t);o.layers=this.layers,this.add(o);let s=new ai(Wf,$f,e,t);s.layers=this.layers,this.add(s);let a=new ai(Wf,$f,e,t);a.layers=this.layers,this.add(a);let c=new ai(Wf,$f,e,t);c.layers=this.layers,this.add(c);let l=new ai(Wf,$f,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){let e=this.coordinateSystem,t=this.children.concat(),[n,r,o,s,a,c]=t;for(let l of t)this.remove(l);if(e===Io)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else if(e===qd)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let l of t)this.add(l),l.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();let{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[o,s,a,c,l,u]=this.children,d=e.getRenderTarget(),h=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),g=e.xr.enabled;e.xr.enabled=!1;let _=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,o),e.setRenderTarget(n,1,r),e.render(t,s),e.setRenderTarget(n,2,r),e.render(t,a),e.setRenderTarget(n,3,r),e.render(t,c),e.setRenderTarget(n,4,r),e.render(t,l),n.texture.generateMipmaps=_,e.setRenderTarget(n,5,r),e.render(t,u),e.setRenderTarget(d,h,f),e.xr.enabled=g,n.texture.needsPMREMUpdate=!0}},au=class extends Ii{constructor(e=[],t=ga,n,r,o,s,a,c,l,u){super(e,t,n,r,o,s,a,c,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},dp=class extends Qt{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new au(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new ei(5,5,5),o=new Nt({name:"CubemapFromEquirect",uniforms:yh(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:qr,blending:rn});o.uniforms.tEquirect.value=t;let s=new Pe(r,o),a=t.minFilter;return t.minFilter===Po&&(t.minFilter=zn),new y_(1,10,this).update(e,s),t.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){let o=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,n,r);e.setRenderTarget(o)}},Or=class extends wt{constructor(){super(),this.isGroup=!0,this.type="Group"}},Vq={type:"move"},Jd=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Or,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Or,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new C,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new C),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Or,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new C,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new C),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,o=null,s=null,a=this._targetRay,c=this._grip,l=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(l&&e.hand){s=!0;for(let _ of e.hand.values()){let m=t.getJointPose(_,n),p=this._getHandJoint(l,_);m!==null&&(p.matrix.fromArray(m.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.matrixWorldNeedsUpdate=!0,p.jointRadius=m.radius),p.visible=m!==null}let u=l.joints["index-finger-tip"],d=l.joints["thumb-tip"],h=u.position.distanceTo(d.position),f=.02,g=.005;l.inputState.pinching&&h>f+g?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&h<=f-g&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(o=t.getPose(e.gripSpace,n),o!==null&&(c.matrix.fromArray(o.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,o.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(o.linearVelocity)):c.hasLinearVelocity=!1,o.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(o.angularVelocity)):c.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&o!==null&&(r=o),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Vq)))}return a!==null&&(a.visible=r!==null),c!==null&&(c.visible=o!==null),l!==null&&(l.visible=s!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let n=new Or;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}},x_=class i{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new ue(e),this.density=t}clone(){return new i(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}},eh=class i{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new ue(e),this.near=t,this.far=n}clone(){return new i(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}},th=class extends wt{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ho,this.environmentIntensity=1,this.environmentRotation=new ho,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}},xs=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=op,this.updateRanges=[],this.version=0,this.uuid=Yo()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,o=this.stride;r<o;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Yo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Yo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},lo=new C,Jo=class i{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)lo.fromBufferAttribute(this,t),lo.applyMatrix4(e),this.setXYZ(t,lo.x,lo.y,lo.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)lo.fromBufferAttribute(this,t),lo.applyNormalMatrix(e),this.setXYZ(t,lo.x,lo.y,lo.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)lo.fromBufferAttribute(this,t),lo.transformDirection(e),this.setXYZ(t,lo.x,lo.y,lo.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=uo(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=an(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=an(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=an(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=an(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=an(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=uo(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=uo(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=uo(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=uo(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=an(t,this.array),n=an(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=an(t,this.array),n=an(n,this.array),r=an(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,o){return e=e*this.data.stride+this.offset,this.normalized&&(t=an(t,this.array),n=an(n,this.array),r=an(r,this.array),o=an(o,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=o,this}clone(e){if(e===void 0){ap("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let n=0;n<this.count;n++){let r=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[r+o])}return new pn(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new i(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){ap("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let n=0;n<this.count;n++){let r=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[r+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},hp=class extends Mi{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new ue(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},qf,o_=new C,Xf=new C,Zf=new C,Yf=new z,s_=new z,r3=new Ee,zx=new C,a_=new C,Hx=new C,C2=new z,s1=new z,E2=new z,w_=class extends wt{constructor(e=new hp){if(super(),this.isSprite=!0,this.type="Sprite",qf===void 0){qf=new nt;let t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new xs(t,5);qf.setIndex([0,1,2,0,2,3]),qf.setAttribute("position",new Jo(n,3,0,!1)),qf.setAttribute("uv",new Jo(n,2,3,!1))}this.geometry=qf,this.material=e,this.center=new z(.5,.5),this.count=1}raycast(e,t){e.camera===null&&bt('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Xf.setFromMatrixScale(this.matrixWorld),r3.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Zf.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Xf.multiplyScalar(-Zf.z);let n=this.material.rotation,r,o;n!==0&&(o=Math.cos(n),r=Math.sin(n));let s=this.center;Gx(zx.set(-.5,-.5,0),Zf,s,Xf,r,o),Gx(a_.set(.5,-.5,0),Zf,s,Xf,r,o),Gx(Hx.set(.5,.5,0),Zf,s,Xf,r,o),C2.set(0,0),s1.set(1,0),E2.set(1,1);let a=e.ray.intersectTriangle(zx,a_,Hx,!1,o_);if(a===null&&(Gx(a_.set(-.5,.5,0),Zf,s,Xf,r,o),s1.set(0,1),a=e.ray.intersectTriangle(zx,Hx,a_,!1,o_),a===null))return;let c=e.ray.origin.distanceTo(o_);c<e.near||c>e.far||t.push({distance:c,point:o_.clone(),uv:na.getInterpolation(o_,zx,a_,Hx,C2,s1,E2,new z),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}};function Gx(i,e,t,n,r,o){Yf.subVectors(i,t).addScalar(.5).multiply(n),r!==void 0?(s_.x=o*Yf.x-r*Yf.y,s_.y=r*Yf.x+o*Yf.y):s_.copy(Yf),i.copy(e),i.x+=s_.x,i.y+=s_.y,i.applyMatrix4(r3)}var Wx=new C,D2=new C,nh=class extends wt{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);let t=e.levels;for(let n=0,r=t.length;n<r;n++){let o=t[n];this.addLevel(o.object.clone(),o.distance,o.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);let r=this.levels,o;for(o=0;o<r.length&&!(t<r[o].distance);o++);return r.splice(o,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){let t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){let r=t.splice(n,1);return this.remove(r[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){let t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let o=t[n].distance;if(t[n].object.visible&&(o-=o*t[n].hysteresis),e<o)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Wx.setFromMatrixPosition(this.matrixWorld);let r=e.ray.origin.distanceTo(Wx);this.getObjectForDistance(r).raycast(e,t)}}update(e){let t=this.levels;if(t.length>1){Wx.setFromMatrixPosition(e.matrixWorld),D2.setFromMatrixPosition(this.matrixWorld);let n=Wx.distanceTo(D2)/e.zoom;t[0].object.visible=!0;let r,o;for(r=1,o=t.length;r<o;r++){let s=t[r].distance;if(t[r].object.visible&&(s-=s*t[r].hysteresis),n>=s)t[r-1].object.visible=!1,t[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<o;r++)t[r].object.visible=!1}}toJSON(e){let t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];let n=this.levels;for(let r=0,o=n.length;r<o;r++){let s=n[r];t.object.levels.push({object:s.object.uuid,distance:s.distance,hysteresis:s.hysteresis})}return t}},I2=new C,A2=new En,P2=new En,zq=new C,F2=new Ee,$x=new C,a1=new Di,N2=new Ee,c1=new sa,ih=class extends Pe{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=pw,this.bindMatrix=new Ee,this.bindMatrixInverse=new Ee,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let e=this.geometry;this.boundingBox===null&&(this.boundingBox=new wi),this.boundingBox.makeEmpty();let t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,$x),this.boundingBox.expandByPoint($x)}computeBoundingSphere(){let e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Di),this.boundingSphere.makeEmpty();let t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,$x),this.boundingSphere.expandByPoint($x)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){let n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),a1.copy(this.boundingSphere),a1.applyMatrix4(r),e.ray.intersectsSphere(a1)!==!1&&(N2.copy(r).invert(),c1.copy(e.ray).applyMatrix4(N2),!(this.boundingBox!==null&&c1.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,c1)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new En,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);let o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===pw?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===eI?this.bindMatrixInverse.copy(this.bindMatrix).invert():Ue("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){let n=this.skeleton,r=this.geometry;A2.fromBufferAttribute(r.attributes.skinIndex,e),P2.fromBufferAttribute(r.attributes.skinWeight,e),I2.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let o=0;o<4;o++){let s=P2.getComponent(o);if(s!==0){let a=A2.getComponent(o);F2.multiplyMatrices(n.bones[a].matrixWorld,n.boneInverses[a]),t.addScaledVector(zq.copy(I2).applyMatrix4(F2),s)}}return t.applyMatrix4(this.bindMatrixInverse)}},cu=class extends wt{constructor(){super(),this.isBone=!0,this.type="Bone"}},Cr=class extends Ii{constructor(e=null,t=1,n=1,r,o,s,a,c,l=Zt,u=Zt,d,h){super(null,s,a,c,l,u,r,o,d,h),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},j2=new Ee,Hq=new Ee,rh=class i{constructor(e=[],t=[]){this.uuid=Yo(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){Ue("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Ee)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let n=new Ee;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){let e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let o=0,s=e.length;o<s;o++){let a=e[o]?e[o].matrixWorld:Hq;j2.multiplyMatrices(a,t[o]),j2.toArray(n,o*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new i(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let n=new Cr(t,e,e,Gr,tr);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){let r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){let o=e.bones[n],s=t[o];s===void 0&&(Ue("Skeleton: No bone found with UUID:",o),s=new cu),this.bones.push(s),this.boneInverses.push(new Ee().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){let e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,n=this.boneInverses;for(let r=0,o=t.length;r<o;r++){let s=t[r];e.bones.push(s.uuid);let a=n[r];e.boneInverses.push(a.toArray())}return e}},ws=class extends pn{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},Qf=new Ee,O2=new Ee,qx=[],L2=new wi,Gq=new Ee,c_=new Pe,l_=new Di,Ms=class extends Pe{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new ws(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,Gq)}computeBoundingBox(){let e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new wi),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Qf),L2.copy(e.boundingBox).applyMatrix4(Qf),this.boundingBox.union(L2)}computeBoundingSphere(){let e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Di),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Qf),l_.copy(e.boundingSphere).applyMatrix4(Qf),this.boundingSphere.union(l_)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){let n=t.morphTargetInfluences,r=this.morphTexture.source.data.data,o=n.length+1,s=e*o+1;for(let a=0;a<n.length;a++)n[a]=r[s+a]}raycast(e,t){let n=this.matrixWorld,r=this.count;if(c_.geometry=this.geometry,c_.material=this.material,c_.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),l_.copy(this.boundingSphere),l_.applyMatrix4(n),e.ray.intersectsSphere(l_)!==!1))for(let o=0;o<r;o++){this.getMatrixAt(o,Qf),O2.multiplyMatrices(n,Qf),c_.matrixWorld=O2,c_.raycast(e,qx);for(let s=0,a=qx.length;s<a;s++){let c=qx[s];c.instanceId=o,c.object=this,t.push(c)}qx.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new ws(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){let n=t.morphTargetInfluences,r=n.length+1;this.morphTexture===null&&(this.morphTexture=new Cr(new Float32Array(r*this.count),r,this.count,nl,tr));let o=this.morphTexture.source.data.data,s=0;for(let l=0;l<n.length;l++)s+=n[l];let a=this.geometry.morphTargetsRelative?1:1-s,c=r*e;o[c]=a,o.set(n,c+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}},l1=new C,Wq=new C,$q=new Yt,Xi=class{constructor(e=new C(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){let r=l1.subVectors(n,t).cross(Wq.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){let n=e.delta(l1),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let o=-(e.start.dot(this.normal)+this.constant)/r;return o<0||o>1?null:t.copy(e.start).addScaledVector(n,o)}intersectsLine(e){let t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let n=t||$q.getNormalMatrix(e),r=this.coplanarPoint(l1).applyMatrix4(e),o=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},Od=new Di,qq=new z(.5,.5),Xx=new C,Xc=class{constructor(e=new Xi,t=new Xi,n=new Xi,r=new Xi,o=new Xi,s=new Xi){this.planes=[e,t,n,r,o,s]}set(e,t,n,r,o,s){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(o),a[5].copy(s),this}copy(e){let t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Io,n=!1){let r=this.planes,o=e.elements,s=o[0],a=o[1],c=o[2],l=o[3],u=o[4],d=o[5],h=o[6],f=o[7],g=o[8],_=o[9],m=o[10],p=o[11],b=o[12],v=o[13],y=o[14],w=o[15];if(r[0].setComponents(l-s,f-u,p-g,w-b).normalize(),r[1].setComponents(l+s,f+u,p+g,w+b).normalize(),r[2].setComponents(l+a,f+d,p+_,w+v).normalize(),r[3].setComponents(l-a,f-d,p-_,w-v).normalize(),n)r[4].setComponents(c,h,m,y).normalize(),r[5].setComponents(l-c,f-h,p-m,w-y).normalize();else if(r[4].setComponents(l-c,f-h,p-m,w-y).normalize(),t===Io)r[5].setComponents(l+c,f+h,p+m,w+y).normalize();else if(t===qd)r[5].setComponents(c,h,m,y).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Od.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Od.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Od)}intersectsSprite(e){Od.center.set(0,0,0);let t=qq.distanceTo(e.center);return Od.radius=.7071067811865476+t,Od.applyMatrix4(e.matrixWorld),this.intersectsSphere(Od)}intersectsSphere(e){let t=this.planes,n=e.center,r=-e.radius;for(let o=0;o<6;o++)if(t[o].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){let t=this.planes;for(let n=0;n<6;n++){let r=t[n];if(Xx.x=r.normal.x>0?e.max.x:e.min.x,Xx.y=r.normal.y>0?e.max.y:e.min.y,Xx.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Xx)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}},Za=new Ee,Ya=new Xc,M_=class i{constructor(){this.coordinateSystem=Io}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){let r=t.cameras[n];if(Za.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ya.setFromProjectionMatrix(Za,r.coordinateSystem,r.reversedDepth),Ya.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){let r=t.cameras[n];if(Za.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ya.setFromProjectionMatrix(Za,r.coordinateSystem,r.reversedDepth),Ya.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){let r=t.cameras[n];if(Za.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ya.setFromProjectionMatrix(Za,r.coordinateSystem,r.reversedDepth),Ya.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){let r=t.cameras[n];if(Za.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ya.setFromProjectionMatrix(Za,r.coordinateSystem,r.reversedDepth),Ya.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){let r=t.cameras[n];if(Za.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ya.setFromProjectionMatrix(Za,r.coordinateSystem,r.reversedDepth),Ya.containsPoint(e))return!0}return!1}clone(){return new i}};function u1(i,e){return i-e}function Xq(i,e){return i.z-e.z}function Zq(i,e){return e.z-i.z}var M1=class{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,r){let o=this.pool,s=this.list;this.index>=o.length&&o.push({start:-1,count:-1,z:-1,index:-1});let a=o[this.index];s.push(a),this.index++,a.start=e,a.count=t,a.z=n,a.index=r}reset(){this.list.length=0,this.index=0}},Eo=new Ee,Yq=new ue(1,1,1),k2=new Xc,Qq=new M_,Zx=new wi,Ld=new Di,u_=new C,B2=new C,Kq=new C,d1=new M1,Hr=new Pe,Yx=[];function Jq(i,e,t=0){let n=e.itemSize;if(i.isInterleavedBufferAttribute||i.array.constructor!==e.array.constructor){let r=i.count;for(let o=0;o<r;o++)for(let s=0;s<n;s++)e.setComponent(o+t,s,i.getComponent(o,s))}else e.array.set(i.array,t*n);e.needsUpdate=!0}function kd(i,e){if(i.constructor!==e.constructor){let t=Math.min(i.length,e.length);for(let n=0;n<t;n++)e[n]=i[n]}else{let t=Math.min(i.length,e.length);e.set(new i.constructor(i.buffer,0,t))}}var S_=class extends Pe{constructor(e,t,n=t*2,r){super(new nt,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let t=new Float32Array(e*e*4),n=new Cr(t,e,e,Gr,tr);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);let t=new Uint32Array(e*e),n=new Cr(t,e,e,Lp,es);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);let t=new Float32Array(e*e*4).fill(1),n=new Cr(t,e,e,Gr,tr);n.colorSpace=hn.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){let t=this.geometry,n=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(let o in e.attributes){let s=e.getAttribute(o),{array:a,itemSize:c,normalized:l}=s,u=new a.constructor(n*c),d=new pn(u,c,l);t.setAttribute(o,d)}if(e.getIndex()!==null){let o=n>65535?new Uint32Array(r):new Uint16Array(r);t.setIndex(new pn(o,1))}this._geometryInitialized=!0}}_validateGeometry(e){let t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(let n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);let r=e.getAttribute(n),o=t.getAttribute(n);if(r.itemSize!==o.itemSize||r.normalized!==o.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){let t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){let t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new wi);let e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;let o=t[n].geometryIndex;this.getMatrixAt(n,Eo),this.getBoundingBoxAt(o,Zx).applyMatrix4(Eo),e.union(Zx)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Di);let e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;let o=t[n].geometryIndex;this.getMatrixAt(n,Eo),this.getBoundingSphereAt(o,Ld).applyMatrix4(Eo),e.union(Ld)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");let n={visible:!0,active:!0,geometryIndex:e},r=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(u1),r=this._availableInstanceIds.shift(),this._instanceInfo[r]=n):(r=this._instanceInfo.length,this._instanceInfo.push(n));let o=this._matricesTexture;Eo.identity().toArray(o.image.data,r*16),o.needsUpdate=!0;let s=this._colorsTexture;return s&&(Yq.toArray(s.image.data,r*4),s.needsUpdate=!0),this._visibilityChanged=!0,r}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);let r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},o=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=t===-1?e.getAttribute("position").count:t;let s=e.getIndex();if(s!==null&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=n===-1?s.count:n),r.indexStart!==-1&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let c;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(u1),c=this._availableGeometryIds.shift(),o[c]=r):(c=this._geometryCount,this._geometryCount++,o.push(r)),this.setGeometryAt(c,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,c}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);let n=this.geometry,r=n.getIndex()!==null,o=n.getIndex(),s=t.getIndex(),a=this._geometryInfo[e];if(r&&s.count>a.reservedIndexCount||t.attributes.position.count>a.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");let c=a.vertexStart,l=a.reservedVertexCount;a.vertexCount=t.getAttribute("position").count;for(let u in n.attributes){let d=t.getAttribute(u),h=n.getAttribute(u);Jq(d,h,c);let f=d.itemSize;for(let g=d.count,_=l;g<_;g++){let m=c+g;for(let p=0;p<f;p++)h.setComponent(m,p,0)}h.needsUpdate=!0,h.addUpdateRange(c*f,l*f)}if(r){let u=a.indexStart,d=a.reservedIndexCount;a.indexCount=t.getIndex().count;for(let h=0;h<s.count;h++)o.setX(u+h,c+s.getX(h));for(let h=s.count,f=d;h<f;h++)o.setX(u+h,c);o.needsUpdate=!0,o.addUpdateRange(u,a.reservedIndexCount)}return a.start=r?a.indexStart:a.vertexStart,a.count=r?a.indexCount:a.vertexCount,a.boundingBox=null,t.boundingBox!==null&&(a.boundingBox=t.boundingBox.clone()),a.boundingSphere=null,t.boundingSphere!==null&&(a.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){let t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;let n=this._instanceInfo;for(let r=0,o=n.length;r<o;r++)n[r].active&&n[r].geometryIndex===e&&this.deleteInstance(r);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0,n=this._geometryInfo,r=n.map((s,a)=>a).sort((s,a)=>n[s].vertexStart-n[a].vertexStart),o=this.geometry;for(let s=0,a=n.length;s<a;s++){let c=r[s],l=n[c];if(l.active!==!1){if(o.index!==null){if(l.indexStart!==t){let{indexStart:u,vertexStart:d,reservedIndexCount:h}=l,f=o.index,g=f.array,_=e-d;for(let m=u;m<u+h;m++)g[m]=g[m]+_;f.array.copyWithin(t,u,u+h),f.addUpdateRange(t,h),f.needsUpdate=!0,l.indexStart=t}t+=l.reservedIndexCount}if(l.vertexStart!==e){let{vertexStart:u,reservedVertexCount:d}=l,h=o.attributes;for(let f in h){let g=h[f],{array:_,itemSize:m}=g;_.copyWithin(e*m,u*m,(u+d)*m),g.addUpdateRange(e*m,d*m),g.needsUpdate=!0}l.vertexStart=e}e+=l.reservedVertexCount,l.start=o.index?l.indexStart:l.vertexStart,this._nextIndexStart=o.index?l.indexStart+l.reservedIndexCount:0,this._nextVertexStart=l.vertexStart+l.reservedVertexCount}}return this._visibilityChanged=!0,this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;let n=this.geometry,r=this._geometryInfo[e];if(r.boundingBox===null){let o=new wi,s=n.index,a=n.attributes.position;for(let c=r.start,l=r.start+r.count;c<l;c++){let u=c;s&&(u=s.getX(u)),o.expandByPoint(u_.fromBufferAttribute(a,u))}r.boundingBox=o}return t.copy(r.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;let n=this.geometry,r=this._geometryInfo[e];if(r.boundingSphere===null){let o=new Di;this.getBoundingBoxAt(e,Zx),Zx.getCenter(o.center);let s=n.index,a=n.attributes.position,c=0;for(let l=r.start,u=r.start+r.count;l<u;l++){let d=l;s&&(d=s.getX(d)),u_.fromBufferAttribute(a,d),c=Math.max(c,o.center.distanceToSquared(u_))}o.radius=Math.sqrt(c),r.boundingSphere=o}return t.copy(r.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);let n=this._matricesTexture,r=this._matricesTexture.image.data;return t.toArray(r,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);let n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){let t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(u1);t[t.length-1]===n.length-1;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);let r=new Int32Array(e),o=new Int32Array(e);kd(this._multiDrawCounts,r),kd(this._multiDrawStarts,o),this._multiDrawCounts=r,this._multiDrawStarts=o,this._maxInstanceCount=e;let s=this._indirectTexture,a=this._matricesTexture,c=this._colorsTexture;s.dispose(),this._initIndirectTexture(),kd(s.image.data,this._indirectTexture.image.data),a.dispose(),this._initMatricesTexture(),kd(a.image.data,this._matricesTexture.image.data),c&&(c.dispose(),this._initColorsTexture(),kd(c.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){let n=[...this._geometryInfo].filter(a=>a.active);if(Math.max(...n.map(a=>a.vertexStart+a.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(c=>c.indexStart+c.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);let o=this.geometry;o.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new nt,this._initializeGeometry(o));let s=this.geometry;o.index&&kd(o.index.array,s.index.array);for(let a in o.attributes)kd(o.attributes[a].array,s.attributes[a].array)}raycast(e,t){let n=this._instanceInfo,r=this._geometryInfo,o=this.matrixWorld,s=this.geometry;Hr.material=this.material,Hr.geometry.index=s.index,Hr.geometry.attributes=s.attributes,Hr.geometry.boundingBox===null&&(Hr.geometry.boundingBox=new wi),Hr.geometry.boundingSphere===null&&(Hr.geometry.boundingSphere=new Di);for(let a=0,c=n.length;a<c;a++){if(!n[a].visible||!n[a].active)continue;let l=n[a].geometryIndex,u=r[l];Hr.geometry.setDrawRange(u.start,u.count),this.getMatrixAt(a,Hr.matrixWorld).premultiply(o),this.getBoundingBoxAt(l,Hr.geometry.boundingBox),this.getBoundingSphereAt(l,Hr.geometry.boundingSphere),Hr.raycast(e,Yx);for(let d=0,h=Yx.length;d<h;d++){let f=Yx[d];f.object=this,f.batchId=a,t.push(f)}Yx.length=0}Hr.material=null,Hr.geometry.index=null,Hr.geometry.attributes={},Hr.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>jt(ae({},t),{boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>ae({},t)),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,r,o){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;let s=r.getIndex(),a=s===null?1:s.array.BYTES_PER_ELEMENT,c=this._instanceInfo,l=this._multiDrawStarts,u=this._multiDrawCounts,d=this._geometryInfo,h=this.perObjectFrustumCulled,f=this._indirectTexture,g=f.image.data,_=n.isArrayCamera?Qq:k2;h&&!n.isArrayCamera&&(Eo.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),k2.setFromProjectionMatrix(Eo,n.coordinateSystem,n.reversedDepth));let m=0;if(this.sortObjects){Eo.copy(this.matrixWorld).invert(),u_.setFromMatrixPosition(n.matrixWorld).applyMatrix4(Eo),B2.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(Eo);for(let v=0,y=c.length;v<y;v++)if(c[v].visible&&c[v].active){let w=c[v].geometryIndex;this.getMatrixAt(v,Eo),this.getBoundingSphereAt(w,Ld).applyMatrix4(Eo);let R=!1;if(h&&(R=!_.intersectsSphere(Ld,n)),!R){let E=d[w],A=Kq.subVectors(Ld.center,u_).dot(B2);d1.push(E.start,E.count,A,v)}}let p=d1.list,b=this.customSort;b===null?p.sort(o.transparent?Zq:Xq):b.call(this,p,n);for(let v=0,y=p.length;v<y;v++){let w=p[v];l[m]=w.start*a,u[m]=w.count,g[m]=w.index,m++}d1.reset()}else for(let p=0,b=c.length;p<b;p++)if(c[p].visible&&c[p].active){let v=c[p].geometryIndex,y=!1;if(h&&(this.getMatrixAt(p,Eo),this.getBoundingSphereAt(v,Ld).applyMatrix4(Eo),y=!_.intersectsSphere(Ld,n)),!y){let w=d[v];l[m]=w.start*a,u[m]=w.count,g[m]=p,m++}}f.needsUpdate=!0,this._multiDrawCount=m,this._visibilityChanged=!1}onBeforeShadow(e,t,n,r,o,s){this.onBeforeRender(e,null,r,o,s)}},mi=class extends Mi{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ue(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},Rw=new C,Tw=new C,U2=new Ee,d_=new sa,Qx=new Di,h1=new C,V2=new C,ti=class extends wt{constructor(e=new nt,t=new mi){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,n=[0];for(let r=1,o=t.count;r<o;r++)Rw.fromBufferAttribute(t,r-1),Tw.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=Rw.distanceTo(Tw);e.setAttribute("lineDistance",new Oe(n,1))}else Ue("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let n=this.geometry,r=this.matrixWorld,o=e.params.Line.threshold,s=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Qx.copy(n.boundingSphere),Qx.applyMatrix4(r),Qx.radius+=o,e.ray.intersectsSphere(Qx)===!1)return;U2.copy(r).invert(),d_.copy(e.ray).applyMatrix4(U2);let a=o/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,l=this.isLineSegments?2:1,u=n.index,h=n.attributes.position;if(u!==null){let f=Math.max(0,s.start),g=Math.min(u.count,s.start+s.count);for(let _=f,m=g-1;_<m;_+=l){let p=u.getX(_),b=u.getX(_+1),v=Kx(this,e,d_,c,p,b,_);v&&t.push(v)}if(this.isLineLoop){let _=u.getX(g-1),m=u.getX(f),p=Kx(this,e,d_,c,_,m,g-1);p&&t.push(p)}}else{let f=Math.max(0,s.start),g=Math.min(h.count,s.start+s.count);for(let _=f,m=g-1;_<m;_+=l){let p=Kx(this,e,d_,c,_,_+1,_);p&&t.push(p)}if(this.isLineLoop){let _=Kx(this,e,d_,c,g-1,f,g-1);_&&t.push(_)}}}updateMorphTargets(){let t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){let r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){let a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}};function Kx(i,e,t,n,r,o,s){let a=i.geometry.attributes.position;if(Rw.fromBufferAttribute(a,r),Tw.fromBufferAttribute(a,o),t.distanceSqToSegment(Rw,Tw,h1,V2)>n)return;h1.applyMatrix4(i.matrixWorld);let l=e.ray.origin.distanceTo(h1);if(!(l<e.near||l>e.far))return{distance:l,point:V2.clone().applyMatrix4(i.matrixWorld),index:s,face:null,faceIndex:null,barycoord:null,object:i}}var z2=new C,H2=new C,Lr=class extends ti{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,n=[];for(let r=0,o=t.count;r<o;r+=2)z2.fromBufferAttribute(t,r),H2.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+z2.distanceTo(H2);e.setAttribute("lineDistance",new Oe(n,1))}else Ue("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},oh=class extends ti{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}},lu=class extends Mi{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new ue(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},G2=new Ee,S1=new sa,Jx=new Di,ew=new C,sh=class extends wt{constructor(e=new nt,t=new lu){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){let n=this.geometry,r=this.matrixWorld,o=e.params.Points.threshold,s=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Jx.copy(n.boundingSphere),Jx.applyMatrix4(r),Jx.radius+=o,e.ray.intersectsSphere(Jx)===!1)return;G2.copy(r).invert(),S1.copy(e.ray).applyMatrix4(G2);let a=o/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,l=n.index,d=n.attributes.position;if(l!==null){let h=Math.max(0,s.start),f=Math.min(l.count,s.start+s.count);for(let g=h,_=f;g<_;g++){let m=l.getX(g);ew.fromBufferAttribute(d,m),W2(ew,m,c,r,e,t,this)}}else{let h=Math.max(0,s.start),f=Math.min(d.count,s.start+s.count);for(let g=h,_=f;g<_;g++)ew.fromBufferAttribute(d,g),W2(ew,g,c,r,e,t,this)}}updateMorphTargets(){let t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){let r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,s=r.length;o<s;o++){let a=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=o}}}}};function W2(i,e,t,n,r,o,s){let a=S1.distanceSqToPoint(i);if(a<t){let c=new C;S1.closestPointToPoint(i,c),c.applyMatrix4(n);let l=r.ray.origin.distanceTo(c);if(l<r.near||l>r.far)return;o.push({distance:l,distanceToRay:Math.sqrt(a),point:c,index:e,face:null,faceIndex:null,barycoord:null,object:s})}}var R_=class extends Ii{constructor(e,t,n,r,o=zn,s=zn,a,c,l){super(e,t,n,r,o,s,a,c,l),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;let u=this;function d(){u.needsUpdate=!0,u._requestVideoFrameCallbackId=e.requestVideoFrameCallback(d)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(d))}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}},Cw=class extends R_{constructor(e,t,n,r,o,s,a,c){super({},e,t,n,r,o,s,a,c),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}},Ew=class extends Ii{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Zt,this.minFilter=Zt,this.generateMipmaps=!1,this.needsUpdate=!0}},ah=class extends Ii{constructor(e,t,n,r,o,s,a,c,l,u,d,h){super(null,s,a,c,l,u,r,o,d,h),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}},Dw=class extends ah{constructor(e,t,n,r,o,s){super(e,t,n,o,s),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=jr,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}},Iw=class extends ah{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,ga),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}},uu=class extends Ii{constructor(e,t,n,r,o,s,a,c,l){super(e,t,n,r,o,s,a,c,l),this.isCanvasTexture=!0,this.needsUpdate=!0}},fo=class extends Ii{constructor(e,t,n=es,r,o,s,a=Zt,c=Zt,l,u=oa,d=1){if(u!==oa&&u!==ts)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");let h={width:e,height:t,depth:d};super(h,r,o,s,a,c,u,n,l),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new ia(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){let t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}},T_=class extends fo{constructor(e,t=es,n=ga,r,o,s=Zt,a=Zt,c,l=oa){let u={width:e,height:e,depth:1},d=[u,u,u,u,u,u];super(e,e,t,n,r,o,s,a,c,l),this.image=d,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}},fp=class extends Ii{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}},C_=class i extends nt{constructor(e=1,t=1,n=4,r=8,o=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:r,heightSegments:o},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),r=Math.max(3,Math.floor(r)),o=Math.max(1,Math.floor(o));let s=[],a=[],c=[],l=[],u=t/2,d=Math.PI/2*e,h=t,f=2*d+h,g=n*2+o,_=r+1,m=new C,p=new C;for(let b=0;b<=g;b++){let v=0,y=0,w=0,R=0;if(b<=n){let x=b/n,T=x*Math.PI/2;y=-u-e*Math.cos(T),w=e*Math.sin(T),R=-e*Math.cos(T),v=x*d}else if(b<=n+o){let x=(b-n)/o;y=-u+x*t,w=e,R=0,v=d+x*h}else{let x=(b-n-o)/n,T=x*Math.PI/2;y=u+e*Math.sin(T),w=e*Math.cos(T),R=e*Math.sin(T),v=d+h+x*d}let E=Math.max(0,Math.min(1,v/f)),A=0;b===0?A=.5/r:b===g&&(A=-.5/r);for(let x=0;x<=r;x++){let T=x/r,P=T*Math.PI*2,L=Math.sin(P),H=Math.cos(P);p.x=-w*H,p.y=y,p.z=w*L,a.push(p.x,p.y,p.z),m.set(-w*H,R,w*L),m.normalize(),c.push(m.x,m.y,m.z),l.push(T+A,E)}if(b>0){let x=(b-1)*_;for(let T=0;T<r;T++){let P=x+T,L=x+T+1,H=b*_+T,te=b*_+T+1;s.push(P,L,H),s.push(L,te,H)}}}this.setIndex(s),this.setAttribute("position",new Oe(a,3)),this.setAttribute("normal",new Oe(c,3)),this.setAttribute("uv",new Oe(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}},E_=class i extends nt{constructor(e=1,t=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);let o=[],s=[],a=[],c=[],l=new C,u=new z;s.push(0,0,0),a.push(0,0,1),c.push(.5,.5);for(let d=0,h=3;d<=t;d++,h+=3){let f=n+d/t*r;l.x=e*Math.cos(f),l.y=e*Math.sin(f),s.push(l.x,l.y,l.z),a.push(0,0,1),u.x=(s[h]/e+1)/2,u.y=(s[h+1]/e+1)/2,c.push(u.x,u.y)}for(let d=1;d<=t;d++)o.push(d,d+1,0);this.setIndex(o),this.setAttribute("position",new Oe(s,3)),this.setAttribute("normal",new Oe(a,3)),this.setAttribute("uv",new Oe(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.radius,e.segments,e.thetaStart,e.thetaLength)}},Oi=class i extends nt{constructor(e=1,t=1,n=1,r=32,o=1,s=!1,a=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:o,openEnded:s,thetaStart:a,thetaLength:c};let l=this;r=Math.floor(r),o=Math.floor(o);let u=[],d=[],h=[],f=[],g=0,_=[],m=n/2,p=0;b(),s===!1&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(u),this.setAttribute("position",new Oe(d,3)),this.setAttribute("normal",new Oe(h,3)),this.setAttribute("uv",new Oe(f,2));function b(){let y=new C,w=new C,R=0,E=(t-e)/n;for(let A=0;A<=o;A++){let x=[],T=A/o,P=T*(t-e)+e;for(let L=0;L<=r;L++){let H=L/r,te=H*c+a,Y=Math.sin(te),J=Math.cos(te);w.x=P*Y,w.y=-T*n+m,w.z=P*J,d.push(w.x,w.y,w.z),y.set(Y,E,J).normalize(),h.push(y.x,y.y,y.z),f.push(H,1-T),x.push(g++)}_.push(x)}for(let A=0;A<r;A++)for(let x=0;x<o;x++){let T=_[x][A],P=_[x+1][A],L=_[x+1][A+1],H=_[x][A+1];(e>0||x!==0)&&(u.push(T,P,H),R+=3),(t>0||x!==o-1)&&(u.push(P,L,H),R+=3)}l.addGroup(p,R,0),p+=R}function v(y){let w=g,R=new z,E=new C,A=0,x=y===!0?e:t,T=y===!0?1:-1;for(let L=1;L<=r;L++)d.push(0,m*T,0),h.push(0,T,0),f.push(.5,.5),g++;let P=g;for(let L=0;L<=r;L++){let te=L/r*c+a,Y=Math.cos(te),J=Math.sin(te);E.x=x*J,E.y=m*T,E.z=x*Y,d.push(E.x,E.y,E.z),h.push(0,T,0),R.x=Y*.5+.5,R.y=J*.5*T+.5,f.push(R.x,R.y),g++}for(let L=0;L<r;L++){let H=w+L,te=P+L;y===!0?u.push(te,te+1,H):u.push(te+1,te,H),A+=3}l.addGroup(p,A,y===!0?1:2),p+=A}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},pp=class i extends Oi{constructor(e=1,t=1,n=32,r=1,o=!1,s=0,a=Math.PI*2){super(0,e,t,n,r,o,s,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:o,thetaStart:s,thetaLength:a}}static fromJSON(e){return new i(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},aa=class i extends nt{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};let o=[],s=[];a(r),l(n),u(),this.setAttribute("position",new Oe(o,3)),this.setAttribute("normal",new Oe(o.slice(),3)),this.setAttribute("uv",new Oe(s,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(b){let v=new C,y=new C,w=new C;for(let R=0;R<t.length;R+=3)f(t[R+0],v),f(t[R+1],y),f(t[R+2],w),c(v,y,w,b)}function c(b,v,y,w){let R=w+1,E=[];for(let A=0;A<=R;A++){E[A]=[];let x=b.clone().lerp(y,A/R),T=v.clone().lerp(y,A/R),P=R-A;for(let L=0;L<=P;L++)L===0&&A===R?E[A][L]=x:E[A][L]=x.clone().lerp(T,L/P)}for(let A=0;A<R;A++)for(let x=0;x<2*(R-A)-1;x++){let T=Math.floor(x/2);x%2===0?(h(E[A][T+1]),h(E[A+1][T]),h(E[A][T])):(h(E[A][T+1]),h(E[A+1][T+1]),h(E[A+1][T]))}}function l(b){let v=new C;for(let y=0;y<o.length;y+=3)v.x=o[y+0],v.y=o[y+1],v.z=o[y+2],v.normalize().multiplyScalar(b),o[y+0]=v.x,o[y+1]=v.y,o[y+2]=v.z}function u(){let b=new C;for(let v=0;v<o.length;v+=3){b.x=o[v+0],b.y=o[v+1],b.z=o[v+2];let y=m(b)/2/Math.PI+.5,w=p(b)/Math.PI+.5;s.push(y,1-w)}g(),d()}function d(){for(let b=0;b<s.length;b+=6){let v=s[b+0],y=s[b+2],w=s[b+4],R=Math.max(v,y,w),E=Math.min(v,y,w);R>.9&&E<.1&&(v<.2&&(s[b+0]+=1),y<.2&&(s[b+2]+=1),w<.2&&(s[b+4]+=1))}}function h(b){o.push(b.x,b.y,b.z)}function f(b,v){let y=b*3;v.x=e[y+0],v.y=e[y+1],v.z=e[y+2]}function g(){let b=new C,v=new C,y=new C,w=new C,R=new z,E=new z,A=new z;for(let x=0,T=0;x<o.length;x+=9,T+=6){b.set(o[x+0],o[x+1],o[x+2]),v.set(o[x+3],o[x+4],o[x+5]),y.set(o[x+6],o[x+7],o[x+8]),R.set(s[T+0],s[T+1]),E.set(s[T+2],s[T+3]),A.set(s[T+4],s[T+5]),w.copy(b).add(v).add(y).divideScalar(3);let P=m(w);_(R,T+0,b,P),_(E,T+2,v,P),_(A,T+4,y,P)}}function _(b,v,y,w){w<0&&b.x===1&&(s[v]=b.x-1),y.x===0&&y.z===0&&(s[v]=w/2/Math.PI+.5)}function m(b){return Math.atan2(b.z,-b.x)}function p(b){return Math.atan2(-b.y,Math.sqrt(b.x*b.x+b.z*b.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.vertices,e.indices,e.radius,e.detail)}},D_=class i extends aa{constructor(e=1,t=0){let n=(1+Math.sqrt(5))/2,r=1/n,o=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(o,s,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new i(e.radius,e.detail)}},tw=new C,nw=new C,f1=new C,iw=new na,I_=class extends nt{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){let r=Math.pow(10,4),o=Math.cos($d*t),s=e.getIndex(),a=e.getAttribute("position"),c=s?s.count:a.count,l=[0,0,0],u=["a","b","c"],d=new Array(3),h={},f=[];for(let g=0;g<c;g+=3){s?(l[0]=s.getX(g),l[1]=s.getX(g+1),l[2]=s.getX(g+2)):(l[0]=g,l[1]=g+1,l[2]=g+2);let{a:_,b:m,c:p}=iw;if(_.fromBufferAttribute(a,l[0]),m.fromBufferAttribute(a,l[1]),p.fromBufferAttribute(a,l[2]),iw.getNormal(f1),d[0]=`${Math.round(_.x*r)},${Math.round(_.y*r)},${Math.round(_.z*r)}`,d[1]=`${Math.round(m.x*r)},${Math.round(m.y*r)},${Math.round(m.z*r)}`,d[2]=`${Math.round(p.x*r)},${Math.round(p.y*r)},${Math.round(p.z*r)}`,!(d[0]===d[1]||d[1]===d[2]||d[2]===d[0]))for(let b=0;b<3;b++){let v=(b+1)%3,y=d[b],w=d[v],R=iw[u[b]],E=iw[u[v]],A=`${y}_${w}`,x=`${w}_${y}`;x in h&&h[x]?(f1.dot(h[x].normal)<=o&&(f.push(R.x,R.y,R.z),f.push(E.x,E.y,E.z)),h[x]=null):A in h||(h[A]={index0:l[b],index1:l[v],normal:f1.clone()})}}for(let g in h)if(h[g]){let{index0:_,index1:m}=h[g];tw.fromBufferAttribute(a,_),nw.fromBufferAttribute(a,m),f.push(tw.x,tw.y,tw.z),f.push(nw.x,nw.y,nw.z)}this.setAttribute("position",new Oe(f,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}},Ao=class{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){Ue("Curve: .getPoint() not implemented.")}getPointAt(e,t){let n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){let t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){let t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],n,r=this.getPoint(0),o=0;t.push(0);for(let s=1;s<=e;s++)n=this.getPoint(s/e),o+=n.distanceTo(r),t.push(o),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){let n=this.getLengths(),r=0,o=n.length,s;t?s=t:s=e*n[o-1];let a=0,c=o-1,l;for(;a<=c;)if(r=Math.floor(a+(c-a)/2),l=n[r]-s,l<0)a=r+1;else if(l>0)c=r-1;else{c=r;break}if(r=c,n[r]===s)return r/(o-1);let u=n[r],h=n[r+1]-u,f=(s-u)/h;return(r+f)/(o-1)}getTangent(e,t){let r=e-1e-4,o=e+1e-4;r<0&&(r=0),o>1&&(o=1);let s=this.getPoint(r),a=this.getPoint(o),c=t||(s.isVector2?new z:new C);return c.copy(a).sub(s).normalize(),c}getTangentAt(e,t){let n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){let n=new C,r=[],o=[],s=[],a=new C,c=new Ee;for(let f=0;f<=e;f++){let g=f/e;r[f]=this.getTangentAt(g,new C)}o[0]=new C,s[0]=new C;let l=Number.MAX_VALUE,u=Math.abs(r[0].x),d=Math.abs(r[0].y),h=Math.abs(r[0].z);u<=l&&(l=u,n.set(1,0,0)),d<=l&&(l=d,n.set(0,1,0)),h<=l&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),o[0].crossVectors(r[0],a),s[0].crossVectors(r[0],o[0]);for(let f=1;f<=e;f++){if(o[f]=o[f-1].clone(),s[f]=s[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();let g=Math.acos(Bt(r[f-1].dot(r[f]),-1,1));o[f].applyMatrix4(c.makeRotationAxis(a,g))}s[f].crossVectors(r[f],o[f])}if(t===!0){let f=Math.acos(Bt(o[0].dot(o[e]),-1,1));f/=e,r[0].dot(a.crossVectors(o[0],o[e]))>0&&(f=-f);for(let g=1;g<=e;g++)o[g].applyMatrix4(c.makeRotationAxis(r[g],f*g)),s[g].crossVectors(r[g],o[g])}return{tangents:r,normals:o,binormals:s}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},Ss=class extends Ao{constructor(e=0,t=0,n=1,r=1,o=0,s=Math.PI*2,a=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=o,this.aEndAngle=s,this.aClockwise=a,this.aRotation=c}getPoint(e,t=new z){let n=t,r=Math.PI*2,o=this.aEndAngle-this.aStartAngle,s=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=r;for(;o>r;)o-=r;o<Number.EPSILON&&(s?o=0:o=r),this.aClockwise===!0&&!s&&(o===r?o=-r:o=o-r);let a=this.aStartAngle+e*o,c=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let u=Math.cos(this.aRotation),d=Math.sin(this.aRotation),h=c-this.aX,f=l-this.aY;c=h*u-f*d+this.aX,l=h*d+f*u+this.aY}return n.set(c,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},A_=class extends Ss{constructor(e,t,n,r,o,s){super(e,t,n,n,r,o,s),this.isArcCurve=!0,this.type="ArcCurve"}};function mI(){let i=0,e=0,t=0,n=0;function r(o,s,a,c){i=o,e=a,t=-3*o+3*s-2*a-c,n=2*o-2*s+a+c}return{initCatmullRom:function(o,s,a,c,l){r(s,a,l*(a-o),l*(c-s))},initNonuniformCatmullRom:function(o,s,a,c,l,u,d){let h=(s-o)/l-(a-o)/(l+u)+(a-s)/u,f=(a-s)/u-(c-s)/(u+d)+(c-a)/d;h*=u,f*=u,r(s,a,h,f)},calc:function(o){let s=o*o,a=s*o;return i+e*o+t*s+n*a}}}var rw=new C,p1=new mI,m1=new mI,g1=new mI,P_=class extends Ao{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new C){let n=t,r=this.points,o=r.length,s=(o-(this.closed?0:1))*e,a=Math.floor(s),c=s-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/o)+1)*o:c===0&&a===o-1&&(a=o-2,c=1);let l,u;this.closed||a>0?l=r[(a-1)%o]:(rw.subVectors(r[0],r[1]).add(r[0]),l=rw);let d=r[a%o],h=r[(a+1)%o];if(this.closed||a+2<o?u=r[(a+2)%o]:(rw.subVectors(r[o-1],r[o-2]).add(r[o-1]),u=rw),this.curveType==="centripetal"||this.curveType==="chordal"){let f=this.curveType==="chordal"?.5:.25,g=Math.pow(l.distanceToSquared(d),f),_=Math.pow(d.distanceToSquared(h),f),m=Math.pow(h.distanceToSquared(u),f);_<1e-4&&(_=1),g<1e-4&&(g=_),m<1e-4&&(m=_),p1.initNonuniformCatmullRom(l.x,d.x,h.x,u.x,g,_,m),m1.initNonuniformCatmullRom(l.y,d.y,h.y,u.y,g,_,m),g1.initNonuniformCatmullRom(l.z,d.z,h.z,u.z,g,_,m)}else this.curveType==="catmullrom"&&(p1.initCatmullRom(l.x,d.x,h.x,u.x,this.tension),m1.initCatmullRom(l.y,d.y,h.y,u.y,this.tension),g1.initCatmullRom(l.z,d.z,h.z,u.z,this.tension));return n.set(p1.calc(c),m1.calc(c),g1.calc(c)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){let r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(new C().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};function $2(i,e,t,n,r){let o=(n-e)*.5,s=(r-t)*.5,a=i*i,c=i*a;return(2*t-2*n+o+s)*c+(-3*t+3*n-2*o-s)*a+o*i+t}function e7(i,e){let t=1-i;return t*t*e}function t7(i,e){return 2*(1-i)*i*e}function n7(i,e){return i*i*e}function g_(i,e,t,n){return e7(i,e)+t7(i,t)+n7(i,n)}function i7(i,e){let t=1-i;return t*t*t*e}function r7(i,e){let t=1-i;return 3*t*t*i*e}function o7(i,e){return 3*(1-i)*i*i*e}function s7(i,e){return i*i*i*e}function __(i,e,t,n,r){return i7(i,e)+r7(i,t)+o7(i,n)+s7(i,r)}var mp=class extends Ao{constructor(e=new z,t=new z,n=new z,r=new z){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new z){let n=t,r=this.v0,o=this.v1,s=this.v2,a=this.v3;return n.set(__(e,r.x,o.x,s.x,a.x),__(e,r.y,o.y,s.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},F_=class extends Ao{constructor(e=new C,t=new C,n=new C,r=new C){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new C){let n=t,r=this.v0,o=this.v1,s=this.v2,a=this.v3;return n.set(__(e,r.x,o.x,s.x,a.x),__(e,r.y,o.y,s.y,a.y),__(e,r.z,o.z,s.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},gp=class extends Ao{constructor(e=new z,t=new z){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new z){let n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new z){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},N_=class extends Ao{constructor(e=new C,t=new C){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new C){let n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new C){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},_p=class extends Ao{constructor(e=new z,t=new z,n=new z){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new z){let n=t,r=this.v0,o=this.v1,s=this.v2;return n.set(g_(e,r.x,o.x,s.x),g_(e,r.y,o.y,s.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},bp=class extends Ao{constructor(e=new C,t=new C,n=new C){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new C){let n=t,r=this.v0,o=this.v1,s=this.v2;return n.set(g_(e,r.x,o.x,s.x),g_(e,r.y,o.y,s.y),g_(e,r.z,o.z,s.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},vp=class extends Ao{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new z){let n=t,r=this.points,o=(r.length-1)*e,s=Math.floor(o),a=o-s,c=r[s===0?s:s-1],l=r[s],u=r[s>r.length-2?r.length-1:s+1],d=r[s>r.length-3?r.length-1:s+2];return n.set($2(a,c.x,l.x,u.x,d.x),$2(a,c.y,l.y,u.y,d.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){let r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){let r=e.points[t];this.points.push(new z().fromArray(r))}return this}},Aw=Object.freeze({__proto__:null,ArcCurve:A_,CatmullRomCurve3:P_,CubicBezierCurve:mp,CubicBezierCurve3:F_,EllipseCurve:Ss,LineCurve:gp,LineCurve3:N_,QuadraticBezierCurve:_p,QuadraticBezierCurve3:bp,SplineCurve:vp}),j_=class extends Ao{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){let n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Aw[n](t,e))}return this}getPoint(e,t){let n=e*this.getLength(),r=this.getCurveLengths(),o=0;for(;o<r.length;){if(r[o]>=n){let s=r[o]-n,a=this.curves[o],c=a.getLength(),l=c===0?0:1-s/c;return a.getPointAt(l,t)}o++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],n;for(let r=0,o=this.curves;r<o.length;r++){let s=o[r],a=s.isEllipseCurve?e*2:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,c=s.getPoints(a);for(let l=0;l<c.length;l++){let u=c[l];n&&n.equals(u)||(t.push(u),n=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){let r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){let r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){let r=e.curves[t];this.curves.push(new Aw[r.type]().fromJSON(r))}return this}},ch=class extends j_{constructor(e){super(),this.type="Path",this.currentPoint=new z,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let n=new gp(this.currentPoint.clone(),new z(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){let o=new _p(this.currentPoint.clone(),new z(e,t),new z(n,r));return this.curves.push(o),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,o,s){let a=new mp(this.currentPoint.clone(),new z(e,t),new z(n,r),new z(o,s));return this.curves.push(a),this.currentPoint.set(o,s),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),n=new vp(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,o,s){let a=this.currentPoint.x,c=this.currentPoint.y;return this.absarc(e+a,t+c,n,r,o,s),this}absarc(e,t,n,r,o,s){return this.absellipse(e,t,n,n,r,o,s),this}ellipse(e,t,n,r,o,s,a,c){let l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+l,t+u,n,r,o,s,a,c),this}absellipse(e,t,n,r,o,s,a,c){let l=new Ss(e,t,n,r,o,s,a,c);if(this.curves.length>0){let d=l.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(l);let u=l.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},Qa=class extends ch{constructor(e){super(e),this.uuid=Yo(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){let r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){let r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){let r=e.holes[t];this.holes.push(new ch().fromJSON(r))}return this}};function a7(i,e,t=2){let n=e&&e.length,r=n?e[0]*t:i.length,o=o3(i,0,r,t,!0),s=[];if(!o||o.next===o.prev)return s;let a,c,l;if(n&&(o=h7(i,e,o,t)),i.length>80*t){a=i[0],c=i[1];let u=a,d=c;for(let h=t;h<r;h+=t){let f=i[h],g=i[h+1];f<a&&(a=f),g<c&&(c=g),f>u&&(u=f),g>d&&(d=g)}l=Math.max(u-a,d-c),l=l!==0?32767/l:0}return O_(o,s,t,a,c,l,0),s}function o3(i,e,t,n,r){let o;if(r===M7(i,e,t,n)>0)for(let s=e;s<t;s+=n)o=q2(s/n|0,i[s],i[s+1],o);else for(let s=t-n;s>=e;s-=n)o=q2(s/n|0,i[s],i[s+1],o);return o&&yp(o,o.next)&&(k_(o),o=o.next),o}function lh(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(yp(t,t.next)||ji(t.prev,t,t.next)===0)){if(k_(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function O_(i,e,t,n,r,o,s){if(!i)return;!s&&o&&_7(i,n,r,o);let a=i;for(;i.prev!==i.next;){let c=i.prev,l=i.next;if(o?l7(i,n,r,o):c7(i)){e.push(c.i,i.i,l.i),k_(i),i=l.next,a=l.next;continue}if(i=l,i===a){s?s===1?(i=u7(lh(i),e),O_(i,e,t,n,r,o,2)):s===2&&d7(i,e,t,n,r,o):O_(lh(i),e,t,n,r,o,1);break}}}function c7(i){let e=i.prev,t=i,n=i.next;if(ji(e,t,n)>=0)return!1;let r=e.x,o=t.x,s=n.x,a=e.y,c=t.y,l=n.y,u=Math.min(r,o,s),d=Math.min(a,c,l),h=Math.max(r,o,s),f=Math.max(a,c,l),g=n.next;for(;g!==e;){if(g.x>=u&&g.x<=h&&g.y>=d&&g.y<=f&&f_(r,a,o,c,s,l,g.x,g.y)&&ji(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function l7(i,e,t,n){let r=i.prev,o=i,s=i.next;if(ji(r,o,s)>=0)return!1;let a=r.x,c=o.x,l=s.x,u=r.y,d=o.y,h=s.y,f=Math.min(a,c,l),g=Math.min(u,d,h),_=Math.max(a,c,l),m=Math.max(u,d,h),p=R1(f,g,e,t,n),b=R1(_,m,e,t,n),v=i.prevZ,y=i.nextZ;for(;v&&v.z>=p&&y&&y.z<=b;){if(v.x>=f&&v.x<=_&&v.y>=g&&v.y<=m&&v!==r&&v!==s&&f_(a,u,c,d,l,h,v.x,v.y)&&ji(v.prev,v,v.next)>=0||(v=v.prevZ,y.x>=f&&y.x<=_&&y.y>=g&&y.y<=m&&y!==r&&y!==s&&f_(a,u,c,d,l,h,y.x,y.y)&&ji(y.prev,y,y.next)>=0))return!1;y=y.nextZ}for(;v&&v.z>=p;){if(v.x>=f&&v.x<=_&&v.y>=g&&v.y<=m&&v!==r&&v!==s&&f_(a,u,c,d,l,h,v.x,v.y)&&ji(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;y&&y.z<=b;){if(y.x>=f&&y.x<=_&&y.y>=g&&y.y<=m&&y!==r&&y!==s&&f_(a,u,c,d,l,h,y.x,y.y)&&ji(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function u7(i,e){let t=i;do{let n=t.prev,r=t.next.next;!yp(n,r)&&a3(n,t,t.next,r)&&L_(n,r)&&L_(r,n)&&(e.push(n.i,t.i,r.i),k_(t),k_(t.next),t=i=r),t=t.next}while(t!==i);return lh(t)}function d7(i,e,t,n,r,o){let s=i;do{let a=s.next.next;for(;a!==s.prev;){if(s.i!==a.i&&y7(s,a)){let c=c3(s,a);s=lh(s,s.next),c=lh(c,c.next),O_(s,e,t,n,r,o,0),O_(c,e,t,n,r,o,0);return}a=a.next}s=s.next}while(s!==i)}function h7(i,e,t,n){let r=[];for(let o=0,s=e.length;o<s;o++){let a=e[o]*n,c=o<s-1?e[o+1]*n:i.length,l=o3(i,a,c,n,!1);l===l.next&&(l.steiner=!0),r.push(v7(l))}r.sort(f7);for(let o=0;o<r.length;o++)t=p7(r[o],t);return t}function f7(i,e){let t=i.x-e.x;if(t===0&&(t=i.y-e.y,t===0)){let n=(i.next.y-i.y)/(i.next.x-i.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=n-r}return t}function p7(i,e){let t=m7(i,e);if(!t)return e;let n=c3(t,i);return lh(n,n.next),lh(t,t.next)}function m7(i,e){let t=e,n=i.x,r=i.y,o=-1/0,s;if(yp(i,t))return t;do{if(yp(i,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){let d=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=n&&d>o&&(o=d,s=t.x<t.next.x?t:t.next,d===n))return s}t=t.next}while(t!==e);if(!s)return null;let a=s,c=s.x,l=s.y,u=1/0;t=s;do{if(n>=t.x&&t.x>=c&&n!==t.x&&s3(r<l?n:o,r,c,l,r<l?o:n,r,t.x,t.y)){let d=Math.abs(r-t.y)/(n-t.x);L_(t,i)&&(d<u||d===u&&(t.x>s.x||t.x===s.x&&g7(s,t)))&&(s=t,u=d)}t=t.next}while(t!==a);return s}function g7(i,e){return ji(i.prev,i,e.prev)<0&&ji(e.next,i,i.next)<0}function _7(i,e,t,n){let r=i;do r.z===0&&(r.z=R1(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,b7(r)}function b7(i){let e,t=1;do{let n=i,r;i=null;let o=null;for(e=0;n;){e++;let s=n,a=0;for(let l=0;l<t&&(a++,s=s.nextZ,!!s);l++);let c=t;for(;a>0||c>0&&s;)a!==0&&(c===0||!s||n.z<=s.z)?(r=n,n=n.nextZ,a--):(r=s,s=s.nextZ,c--),o?o.nextZ=r:i=r,r.prevZ=o,o=r;n=s}o.nextZ=null,t*=2}while(e>1);return i}function R1(i,e,t,n,r){return i=(i-t)*r|0,e=(e-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function v7(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function s3(i,e,t,n,r,o,s,a){return(r-s)*(e-a)>=(i-s)*(o-a)&&(i-s)*(n-a)>=(t-s)*(e-a)&&(t-s)*(o-a)>=(r-s)*(n-a)}function f_(i,e,t,n,r,o,s,a){return!(i===s&&e===a)&&s3(i,e,t,n,r,o,s,a)}function y7(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!x7(i,e)&&(L_(i,e)&&L_(e,i)&&w7(i,e)&&(ji(i.prev,i,e.prev)||ji(i,e.prev,e))||yp(i,e)&&ji(i.prev,i,i.next)>0&&ji(e.prev,e,e.next)>0)}function ji(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function yp(i,e){return i.x===e.x&&i.y===e.y}function a3(i,e,t,n){let r=sw(ji(i,e,t)),o=sw(ji(i,e,n)),s=sw(ji(t,n,i)),a=sw(ji(t,n,e));return!!(r!==o&&s!==a||r===0&&ow(i,t,e)||o===0&&ow(i,n,e)||s===0&&ow(t,i,n)||a===0&&ow(t,e,n))}function ow(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function sw(i){return i>0?1:i<0?-1:0}function x7(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&a3(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function L_(i,e){return ji(i.prev,i,i.next)<0?ji(i,e,i.next)>=0&&ji(i,i.prev,e)>=0:ji(i,e,i.prev)<0||ji(i,i.next,e)<0}function w7(i,e){let t=i,n=!1,r=(i.x+e.x)/2,o=(i.y+e.y)/2;do t.y>o!=t.next.y>o&&t.next.y!==t.y&&r<(t.next.x-t.x)*(o-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function c3(i,e){let t=T1(i.i,i.x,i.y),n=T1(e.i,e.x,e.y),r=i.next,o=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,o.next=n,n.prev=o,n}function q2(i,e,t,n){let r=T1(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function k_(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function T1(i,e,t){return{i,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function M7(i,e,t,n){let r=0;for(let o=e,s=t-n;o<t;o+=n)r+=(i[s]-i[o])*(i[o+1]+i[s+1]),s=o;return r}var C1=class{static triangulate(e,t,n=2){return a7(e,t,n)}},bs=class i{static area(e){let t=e.length,n=0;for(let r=t-1,o=0;o<t;r=o++)n+=e[r].x*e[o].y-e[o].x*e[r].y;return n*.5}static isClockWise(e){return i.area(e)<0}static triangulateShape(e,t){let n=[],r=[],o=[];X2(e),Z2(n,e);let s=e.length;t.forEach(X2);for(let c=0;c<t.length;c++)r.push(s),s+=t[c].length,Z2(n,t[c]);let a=C1.triangulate(n,r);for(let c=0;c<a.length;c+=3)o.push(a.slice(c,c+3));return o}};function X2(i){let e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function Z2(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}var B_=class i extends nt{constructor(e=new Qa([new z(.5,.5),new z(-.5,.5),new z(-.5,-.5),new z(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let n=this,r=[],o=[];for(let a=0,c=e.length;a<c;a++){let l=e[a];s(l)}this.setAttribute("position",new Oe(r,3)),this.setAttribute("uv",new Oe(o,2)),this.computeVertexNormals();function s(a){let c=[],l=t.curveSegments!==void 0?t.curveSegments:12,u=t.steps!==void 0?t.steps:1,d=t.depth!==void 0?t.depth:1,h=t.bevelEnabled!==void 0?t.bevelEnabled:!0,f=t.bevelThickness!==void 0?t.bevelThickness:.2,g=t.bevelSize!==void 0?t.bevelSize:f-.1,_=t.bevelOffset!==void 0?t.bevelOffset:0,m=t.bevelSegments!==void 0?t.bevelSegments:3,p=t.extrudePath,b=t.UVGenerator!==void 0?t.UVGenerator:S7,v,y=!1,w,R,E,A;if(p){v=p.getSpacedPoints(u),y=!0,h=!1;let ye=p.isCatmullRomCurve3?p.closed:!1;w=p.computeFrenetFrames(u,ye),R=new C,E=new C,A=new C}h||(m=0,f=0,g=0,_=0);let x=a.extractPoints(l),T=x.shape,P=x.holes;if(!bs.isClockWise(T)){T=T.reverse();for(let ye=0,Me=P.length;ye<Me;ye++){let xe=P[ye];bs.isClockWise(xe)&&(P[ye]=xe.reverse())}}function H(ye){let xe=10000000000000001e-36,Ve=ye[0];for(let j=1;j<=ye.length;j++){let yt=j%ye.length,$e=ye[yt],Mt=$e.x-Ve.x,Fe=$e.y-Ve.y,I=Mt*Mt+Fe*Fe,M=Math.max(Math.abs($e.x),Math.abs($e.y),Math.abs(Ve.x),Math.abs(Ve.y)),U=xe*M*M;if(I<=U){ye.splice(yt,1),j--;continue}Ve=$e}}H(T),P.forEach(H);let te=P.length,Y=T;for(let ye=0;ye<te;ye++){let Me=P[ye];T=T.concat(Me)}function J(ye,Me,xe){return Me||bt("ExtrudeGeometry: vec does not exist"),ye.clone().addScaledVector(Me,xe)}let W=T.length;function fe(ye,Me,xe){let Ve,j,yt,$e=ye.x-Me.x,Mt=ye.y-Me.y,Fe=xe.x-ye.x,I=xe.y-ye.y,M=$e*$e+Mt*Mt,U=$e*I-Mt*Fe;if(Math.abs(U)>Number.EPSILON){let se=Math.sqrt(M),be=Math.sqrt(Fe*Fe+I*I),ce=Me.x-Mt/se,Ke=Me.y+$e/se,Ne=xe.x-I/be,Ye=xe.y+Fe/be,Ct=((Ne-ce)*I-(Ye-Ke)*Fe)/($e*I-Mt*Fe);Ve=ce+$e*Ct-ye.x,j=Ke+Mt*Ct-ye.y;let Se=Ve*Ve+j*j;if(Se<=2)return new z(Ve,j);yt=Math.sqrt(Se/2)}else{let se=!1;$e>Number.EPSILON?Fe>Number.EPSILON&&(se=!0):$e<-Number.EPSILON?Fe<-Number.EPSILON&&(se=!0):Math.sign(Mt)===Math.sign(I)&&(se=!0),se?(Ve=-Mt,j=$e,yt=Math.sqrt(M)):(Ve=$e,j=Mt,yt=Math.sqrt(M/2))}return new z(Ve/yt,j/yt)}let ve=[];for(let ye=0,Me=Y.length,xe=Me-1,Ve=ye+1;ye<Me;ye++,xe++,Ve++)xe===Me&&(xe=0),Ve===Me&&(Ve=0),ve[ye]=fe(Y[ye],Y[xe],Y[Ve]);let Re=[],Te,mt=ve.concat();for(let ye=0,Me=te;ye<Me;ye++){let xe=P[ye];Te=[];for(let Ve=0,j=xe.length,yt=j-1,$e=Ve+1;Ve<j;Ve++,yt++,$e++)yt===j&&(yt=0),$e===j&&($e=0),Te[Ve]=fe(xe[Ve],xe[yt],xe[$e]);Re.push(Te),mt=mt.concat(Te)}let gt;if(m===0)gt=bs.triangulateShape(Y,P);else{let ye=[],Me=[];for(let xe=0;xe<m;xe++){let Ve=xe/m,j=f*Math.cos(Ve*Math.PI/2),yt=g*Math.sin(Ve*Math.PI/2)+_;for(let $e=0,Mt=Y.length;$e<Mt;$e++){let Fe=J(Y[$e],ve[$e],yt);Je(Fe.x,Fe.y,-j),Ve===0&&ye.push(Fe)}for(let $e=0,Mt=te;$e<Mt;$e++){let Fe=P[$e];Te=Re[$e];let I=[];for(let M=0,U=Fe.length;M<U;M++){let se=J(Fe[M],Te[M],yt);Je(se.x,se.y,-j),Ve===0&&I.push(se)}Ve===0&&Me.push(I)}}gt=bs.triangulateShape(ye,Me)}let dn=gt.length,_n=g+_;for(let ye=0;ye<W;ye++){let Me=h?J(T[ye],mt[ye],_n):T[ye];y?(E.copy(w.normals[0]).multiplyScalar(Me.x),R.copy(w.binormals[0]).multiplyScalar(Me.y),A.copy(v[0]).add(E).add(R),Je(A.x,A.y,A.z)):Je(Me.x,Me.y,0)}for(let ye=1;ye<=u;ye++)for(let Me=0;Me<W;Me++){let xe=h?J(T[Me],mt[Me],_n):T[Me];y?(E.copy(w.normals[ye]).multiplyScalar(xe.x),R.copy(w.binormals[ye]).multiplyScalar(xe.y),A.copy(v[ye]).add(E).add(R),Je(A.x,A.y,A.z)):Je(xe.x,xe.y,d/u*ye)}for(let ye=m-1;ye>=0;ye--){let Me=ye/m,xe=f*Math.cos(Me*Math.PI/2),Ve=g*Math.sin(Me*Math.PI/2)+_;for(let j=0,yt=Y.length;j<yt;j++){let $e=J(Y[j],ve[j],Ve);Je($e.x,$e.y,d+xe)}for(let j=0,yt=P.length;j<yt;j++){let $e=P[j];Te=Re[j];for(let Mt=0,Fe=$e.length;Mt<Fe;Mt++){let I=J($e[Mt],Te[Mt],Ve);y?Je(I.x,I.y+v[u-1].y,v[u-1].x+xe):Je(I.x,I.y,d+xe)}}}le(),_e();function le(){let ye=r.length/3;if(h){let Me=0,xe=W*Me;for(let Ve=0;Ve<dn;Ve++){let j=gt[Ve];Ae(j[2]+xe,j[1]+xe,j[0]+xe)}Me=u+m*2,xe=W*Me;for(let Ve=0;Ve<dn;Ve++){let j=gt[Ve];Ae(j[0]+xe,j[1]+xe,j[2]+xe)}}else{for(let Me=0;Me<dn;Me++){let xe=gt[Me];Ae(xe[2],xe[1],xe[0])}for(let Me=0;Me<dn;Me++){let xe=gt[Me];Ae(xe[0]+W*u,xe[1]+W*u,xe[2]+W*u)}}n.addGroup(ye,r.length/3-ye,0)}function _e(){let ye=r.length/3,Me=0;Le(Y,Me),Me+=Y.length;for(let xe=0,Ve=P.length;xe<Ve;xe++){let j=P[xe];Le(j,Me),Me+=j.length}n.addGroup(ye,r.length/3-ye,1)}function Le(ye,Me){let xe=ye.length;for(;--xe>=0;){let Ve=xe,j=xe-1;j<0&&(j=ye.length-1);for(let yt=0,$e=u+m*2;yt<$e;yt++){let Mt=W*yt,Fe=W*(yt+1),I=Me+Ve+Mt,M=Me+j+Mt,U=Me+j+Fe,se=Me+Ve+Fe;wn(I,M,U,se)}}}function Je(ye,Me,xe){c.push(ye),c.push(Me),c.push(xe)}function Ae(ye,Me,xe){Fn(ye),Fn(Me),Fn(xe);let Ve=r.length/3,j=b.generateTopUV(n,r,Ve-3,Ve-2,Ve-1);zt(j[0]),zt(j[1]),zt(j[2])}function wn(ye,Me,xe,Ve){Fn(ye),Fn(Me),Fn(Ve),Fn(Me),Fn(xe),Fn(Ve);let j=r.length/3,yt=b.generateSideWallUV(n,r,j-6,j-3,j-2,j-1);zt(yt[0]),zt(yt[1]),zt(yt[3]),zt(yt[1]),zt(yt[2]),zt(yt[3])}function Fn(ye){r.push(c[ye*3+0]),r.push(c[ye*3+1]),r.push(c[ye*3+2])}function zt(ye){o.push(ye.x),o.push(ye.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return R7(t,n,e)}static fromJSON(e,t){let n=[];for(let o=0,s=e.shapes.length;o<s;o++){let a=t[e.shapes[o]];n.push(a)}let r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new Aw[r.type]().fromJSON(r)),new i(n,e.options)}},S7={generateTopUV:function(i,e,t,n,r){let o=e[t*3],s=e[t*3+1],a=e[n*3],c=e[n*3+1],l=e[r*3],u=e[r*3+1];return[new z(o,s),new z(a,c),new z(l,u)]},generateSideWallUV:function(i,e,t,n,r,o){let s=e[t*3],a=e[t*3+1],c=e[t*3+2],l=e[n*3],u=e[n*3+1],d=e[n*3+2],h=e[r*3],f=e[r*3+1],g=e[r*3+2],_=e[o*3],m=e[o*3+1],p=e[o*3+2];return Math.abs(a-u)<Math.abs(s-l)?[new z(s,1-c),new z(l,1-d),new z(h,1-g),new z(_,1-p)]:[new z(a,1-c),new z(u,1-d),new z(f,1-g),new z(m,1-p)]}};function R7(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++){let o=i[n];t.shapes.push(o.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}var uh=class i extends aa{constructor(e=1,t=0){let n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],o=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,o,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new i(e.radius,e.detail)}},U_=class i extends nt{constructor(e=[new z(0,-.5),new z(.5,0),new z(0,.5)],t=12,n=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=Bt(r,0,Math.PI*2);let o=[],s=[],a=[],c=[],l=[],u=1/t,d=new C,h=new z,f=new C,g=new C,_=new C,m=0,p=0;for(let b=0;b<=e.length-1;b++)switch(b){case 0:m=e[b+1].x-e[b].x,p=e[b+1].y-e[b].y,f.x=p*1,f.y=-m,f.z=p*0,_.copy(f),f.normalize(),c.push(f.x,f.y,f.z);break;case e.length-1:c.push(_.x,_.y,_.z);break;default:m=e[b+1].x-e[b].x,p=e[b+1].y-e[b].y,f.x=p*1,f.y=-m,f.z=p*0,g.copy(f),f.x+=_.x,f.y+=_.y,f.z+=_.z,f.normalize(),c.push(f.x,f.y,f.z),_.copy(g)}for(let b=0;b<=t;b++){let v=n+b*u*r,y=Math.sin(v),w=Math.cos(v);for(let R=0;R<=e.length-1;R++){d.x=e[R].x*y,d.y=e[R].y,d.z=e[R].x*w,s.push(d.x,d.y,d.z),h.x=b/t,h.y=R/(e.length-1),a.push(h.x,h.y);let E=c[3*R+0]*y,A=c[3*R+1],x=c[3*R+0]*w;l.push(E,A,x)}}for(let b=0;b<t;b++)for(let v=0;v<e.length-1;v++){let y=v+b*e.length,w=y,R=y+e.length,E=y+e.length+1,A=y+1;o.push(w,R,A),o.push(E,A,R)}this.setIndex(o),this.setAttribute("position",new Oe(s,3)),this.setAttribute("uv",new Oe(a,2)),this.setAttribute("normal",new Oe(l,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.points,e.segments,e.phiStart,e.phiLength)}},ca=class i extends aa{constructor(e=1,t=0){let n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new i(e.radius,e.detail)}},la=class i extends nt{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};let o=e/2,s=t/2,a=Math.floor(n),c=Math.floor(r),l=a+1,u=c+1,d=e/a,h=t/c,f=[],g=[],_=[],m=[];for(let p=0;p<u;p++){let b=p*h-s;for(let v=0;v<l;v++){let y=v*d-o;g.push(y,-b,0),_.push(0,0,1),m.push(v/a),m.push(1-p/c)}}for(let p=0;p<c;p++)for(let b=0;b<a;b++){let v=b+l*p,y=b+l*(p+1),w=b+1+l*(p+1),R=b+1+l*p;f.push(v,y,R),f.push(y,w,R)}this.setIndex(f),this.setAttribute("position",new Oe(g,3)),this.setAttribute("normal",new Oe(_,3)),this.setAttribute("uv",new Oe(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.width,e.height,e.widthSegments,e.heightSegments)}},V_=class i extends nt{constructor(e=.5,t=1,n=32,r=1,o=0,s=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:o,thetaLength:s},n=Math.max(3,n),r=Math.max(1,r);let a=[],c=[],l=[],u=[],d=e,h=(t-e)/r,f=new C,g=new z;for(let _=0;_<=r;_++){for(let m=0;m<=n;m++){let p=o+m/n*s;f.x=d*Math.cos(p),f.y=d*Math.sin(p),c.push(f.x,f.y,f.z),l.push(0,0,1),g.x=(f.x/t+1)/2,g.y=(f.y/t+1)/2,u.push(g.x,g.y)}d+=h}for(let _=0;_<r;_++){let m=_*(n+1);for(let p=0;p<n;p++){let b=p+m,v=b,y=b+n+1,w=b+n+2,R=b+1;a.push(v,y,R),a.push(y,w,R)}}this.setIndex(a),this.setAttribute("position",new Oe(c,3)),this.setAttribute("normal",new Oe(l,3)),this.setAttribute("uv",new Oe(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}},z_=class i extends nt{constructor(e=new Qa([new z(0,.5),new z(-.5,-.5),new z(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};let n=[],r=[],o=[],s=[],a=0,c=0;if(Array.isArray(e)===!1)l(e);else for(let u=0;u<e.length;u++)l(e[u]),this.addGroup(a,c,u),a+=c,c=0;this.setIndex(n),this.setAttribute("position",new Oe(r,3)),this.setAttribute("normal",new Oe(o,3)),this.setAttribute("uv",new Oe(s,2));function l(u){let d=r.length/3,h=u.extractPoints(t),f=h.shape,g=h.holes;bs.isClockWise(f)===!1&&(f=f.reverse());for(let m=0,p=g.length;m<p;m++){let b=g[m];bs.isClockWise(b)===!0&&(g[m]=b.reverse())}let _=bs.triangulateShape(f,g);for(let m=0,p=g.length;m<p;m++){let b=g[m];f=f.concat(b)}for(let m=0,p=f.length;m<p;m++){let b=f[m];r.push(b.x,b.y,0),o.push(0,0,1),s.push(b.x,b.y)}for(let m=0,p=_.length;m<p;m++){let b=_[m],v=b[0]+d,y=b[1]+d,w=b[2]+d;n.push(v,y,w),c+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),t=this.parameters.shapes;return T7(t,e)}static fromJSON(e,t){let n=[];for(let r=0,o=e.shapes.length;r<o;r++){let s=t[e.shapes[r]];n.push(s)}return new i(n,e.curveSegments)}};function T7(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++){let r=i[t];e.shapes.push(r.uuid)}else e.shapes.push(i.uuid);return e}var Ka=class i extends nt{constructor(e=1,t=32,n=16,r=0,o=Math.PI*2,s=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:o,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));let c=Math.min(s+a,Math.PI),l=0,u=[],d=new C,h=new C,f=[],g=[],_=[],m=[];for(let p=0;p<=n;p++){let b=[],v=p/n,y=0;p===0&&s===0?y=.5/t:p===n&&c===Math.PI&&(y=-.5/t);for(let w=0;w<=t;w++){let R=w/t;d.x=-e*Math.cos(r+R*o)*Math.sin(s+v*a),d.y=e*Math.cos(s+v*a),d.z=e*Math.sin(r+R*o)*Math.sin(s+v*a),g.push(d.x,d.y,d.z),h.copy(d).normalize(),_.push(h.x,h.y,h.z),m.push(R+y,1-v),b.push(l++)}u.push(b)}for(let p=0;p<n;p++)for(let b=0;b<t;b++){let v=u[p][b+1],y=u[p][b],w=u[p+1][b],R=u[p+1][b+1];(p!==0||s>0)&&f.push(v,y,R),(p!==n-1||c<Math.PI)&&f.push(y,w,R)}this.setIndex(f),this.setAttribute("position",new Oe(g,3)),this.setAttribute("normal",new Oe(_,3)),this.setAttribute("uv",new Oe(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},H_=class i extends aa{constructor(e=1,t=0){let n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,r,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new i(e.radius,e.detail)}},ua=class i extends nt{constructor(e=1,t=.4,n=12,r=48,o=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:o},n=Math.floor(n),r=Math.floor(r);let s=[],a=[],c=[],l=[],u=new C,d=new C,h=new C;for(let f=0;f<=n;f++)for(let g=0;g<=r;g++){let _=g/r*o,m=f/n*Math.PI*2;d.x=(e+t*Math.cos(m))*Math.cos(_),d.y=(e+t*Math.cos(m))*Math.sin(_),d.z=t*Math.sin(m),a.push(d.x,d.y,d.z),u.x=e*Math.cos(_),u.y=e*Math.sin(_),h.subVectors(d,u).normalize(),c.push(h.x,h.y,h.z),l.push(g/r),l.push(f/n)}for(let f=1;f<=n;f++)for(let g=1;g<=r;g++){let _=(r+1)*f+g-1,m=(r+1)*(f-1)+g-1,p=(r+1)*(f-1)+g,b=(r+1)*f+g;s.push(_,m,b),s.push(m,p,b)}this.setIndex(s),this.setAttribute("position",new Oe(a,3)),this.setAttribute("normal",new Oe(c,3)),this.setAttribute("uv",new Oe(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}},G_=class i extends nt{constructor(e=1,t=.4,n=64,r=8,o=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:o,q:s},n=Math.floor(n),r=Math.floor(r);let a=[],c=[],l=[],u=[],d=new C,h=new C,f=new C,g=new C,_=new C,m=new C,p=new C;for(let v=0;v<=n;++v){let y=v/n*o*Math.PI*2;b(y,o,s,e,f),b(y+.01,o,s,e,g),m.subVectors(g,f),p.addVectors(g,f),_.crossVectors(m,p),p.crossVectors(_,m),_.normalize(),p.normalize();for(let w=0;w<=r;++w){let R=w/r*Math.PI*2,E=-t*Math.cos(R),A=t*Math.sin(R);d.x=f.x+(E*p.x+A*_.x),d.y=f.y+(E*p.y+A*_.y),d.z=f.z+(E*p.z+A*_.z),c.push(d.x,d.y,d.z),h.subVectors(d,f).normalize(),l.push(h.x,h.y,h.z),u.push(v/n),u.push(w/r)}}for(let v=1;v<=n;v++)for(let y=1;y<=r;y++){let w=(r+1)*(v-1)+(y-1),R=(r+1)*v+(y-1),E=(r+1)*v+y,A=(r+1)*(v-1)+y;a.push(w,R,A),a.push(R,E,A)}this.setIndex(a),this.setAttribute("position",new Oe(c,3)),this.setAttribute("normal",new Oe(l,3)),this.setAttribute("uv",new Oe(u,2));function b(v,y,w,R,E){let A=Math.cos(v),x=Math.sin(v),T=w/y*v,P=Math.cos(T);E.x=R*(2+P)*.5*A,E.y=R*(2+P)*x*.5,E.z=R*Math.sin(T)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}},W_=class i extends nt{constructor(e=new bp(new C(-1,-1,0),new C(-1,1,0),new C(1,1,0)),t=64,n=1,r=8,o=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:o};let s=e.computeFrenetFrames(t,o);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;let a=new C,c=new C,l=new z,u=new C,d=[],h=[],f=[],g=[];_(),this.setIndex(g),this.setAttribute("position",new Oe(d,3)),this.setAttribute("normal",new Oe(h,3)),this.setAttribute("uv",new Oe(f,2));function _(){for(let v=0;v<t;v++)m(v);m(o===!1?t:0),b(),p()}function m(v){u=e.getPointAt(v/t,u);let y=s.normals[v],w=s.binormals[v];for(let R=0;R<=r;R++){let E=R/r*Math.PI*2,A=Math.sin(E),x=-Math.cos(E);c.x=x*y.x+A*w.x,c.y=x*y.y+A*w.y,c.z=x*y.z+A*w.z,c.normalize(),h.push(c.x,c.y,c.z),a.x=u.x+n*c.x,a.y=u.y+n*c.y,a.z=u.z+n*c.z,d.push(a.x,a.y,a.z)}}function p(){for(let v=1;v<=t;v++)for(let y=1;y<=r;y++){let w=(r+1)*(v-1)+(y-1),R=(r+1)*v+(y-1),E=(r+1)*v+y,A=(r+1)*(v-1)+y;g.push(w,R,A),g.push(R,E,A)}}function b(){for(let v=0;v<=t;v++)for(let y=0;y<=r;y++)l.x=v/t,l.y=y/r,f.push(l.x,l.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new i(new Aw[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}},$_=class extends nt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){let t=[],n=new Set,r=new C,o=new C;if(e.index!==null){let s=e.attributes.position,a=e.index,c=e.groups;c.length===0&&(c=[{start:0,count:a.count,materialIndex:0}]);for(let l=0,u=c.length;l<u;++l){let d=c[l],h=d.start,f=d.count;for(let g=h,_=h+f;g<_;g+=3)for(let m=0;m<3;m++){let p=a.getX(g+m),b=a.getX(g+(m+1)%3);r.fromBufferAttribute(s,p),o.fromBufferAttribute(s,b),Y2(r,o,n)===!0&&(t.push(r.x,r.y,r.z),t.push(o.x,o.y,o.z))}}}else{let s=e.attributes.position;for(let a=0,c=s.count/3;a<c;a++)for(let l=0;l<3;l++){let u=3*a+l,d=3*a+(l+1)%3;r.fromBufferAttribute(s,u),o.fromBufferAttribute(s,d),Y2(r,o,n)===!0&&(t.push(r.x,r.y,r.z),t.push(o.x,o.y,o.z))}}this.setAttribute("position",new Oe(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}};function Y2(i,e,t){let n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return t.has(n)===!0||t.has(r)===!0?!1:(t.add(n),t.add(r),!0)}var Q2=Object.freeze({__proto__:null,BoxGeometry:ei,CapsuleGeometry:C_,CircleGeometry:E_,ConeGeometry:pp,CylinderGeometry:Oi,DodecahedronGeometry:D_,EdgesGeometry:I_,ExtrudeGeometry:B_,IcosahedronGeometry:uh,LatheGeometry:U_,OctahedronGeometry:ca,PlaneGeometry:la,PolyhedronGeometry:aa,RingGeometry:V_,ShapeGeometry:z_,SphereGeometry:Ka,TetrahedronGeometry:H_,TorusGeometry:ua,TorusKnotGeometry:G_,TubeGeometry:W_,WireframeGeometry:$_}),q_=class extends Mi{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new ue(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}},xp=class extends Nt{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}},kr=class extends Mi{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new ue(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ue(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=il,this.normalScale=new z(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ho,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},Wr=class extends kr{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new z(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Bt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new ue(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new ue(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new ue(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}},dh=class extends Mi{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new ue(16777215),this.specular=new ue(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ue(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=il,this.normalScale=new z(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ho,this.combine=Fp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},X_=class extends Mi{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ue(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ue(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=il,this.normalScale=new z(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},da=class extends Mi{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=il,this.normalScale=new z(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}},Z_=class extends Mi{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new ue(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ue(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=il,this.normalScale=new z(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ho,this.combine=Fp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},du=class extends Mi{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=iI,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},wp=class extends Mi{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},Y_=class extends Mi{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ue(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=il,this.normalScale=new z(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}},Q_=class extends mi{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}};function Wd(i,e){return!i||i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function l3(i){function e(r,o){return i[r]-i[o]}let t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(e),n}function E1(i,e,t){let n=i.length,r=new i.constructor(n);for(let o=0,s=0;s!==n;++o){let a=t[o]*e;for(let c=0;c!==e;++c)r[s++]=i[a+c]}return r}function gI(i,e,t,n){let r=1,o=i[0];for(;o!==void 0&&o[n]===void 0;)o=i[r++];if(o===void 0)return;let s=o[n];if(s!==void 0)if(Array.isArray(s))do s=o[n],s!==void 0&&(e.push(o.time),t.push(...s)),o=i[r++];while(o!==void 0);else if(s.toArray!==void 0)do s=o[n],s!==void 0&&(e.push(o.time),s.toArray(t,t.length)),o=i[r++];while(o!==void 0);else do s=o[n],s!==void 0&&(e.push(o.time),t.push(s)),o=i[r++];while(o!==void 0)}function C7(i,e,t,n,r=30){let o=i.clone();o.name=e;let s=[];for(let c=0;c<o.tracks.length;++c){let l=o.tracks[c],u=l.getValueSize(),d=[],h=[];for(let f=0;f<l.times.length;++f){let g=l.times[f]*r;if(!(g<t||g>=n)){d.push(l.times[f]);for(let _=0;_<u;++_)h.push(l.values[f*u+_])}}d.length!==0&&(l.times=Wd(d,l.times.constructor),l.values=Wd(h,l.values.constructor),s.push(l))}o.tracks=s;let a=1/0;for(let c=0;c<o.tracks.length;++c)a>o.tracks[c].times[0]&&(a=o.tracks[c].times[0]);for(let c=0;c<o.tracks.length;++c)o.tracks[c].shift(-1*a);return o.resetDuration(),o}function E7(i,e=0,t=i,n=30){n<=0&&(n=30);let r=t.tracks.length,o=e/n;for(let s=0;s<r;++s){let a=t.tracks[s],c=a.ValueTypeName;if(c==="bool"||c==="string")continue;let l=i.tracks.find(function(p){return p.name===a.name&&p.ValueTypeName===c});if(l===void 0)continue;let u=0,d=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=d/3);let h=0,f=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=f/3);let g=a.times.length-1,_;if(o<=a.times[0]){let p=u,b=d-u;_=a.values.slice(p,b)}else if(o>=a.times[g]){let p=g*d+u,b=p+d-u;_=a.values.slice(p,b)}else{let p=a.createInterpolant(),b=u,v=d-u;p.evaluate(o),_=p.resultBuffer.slice(b,v)}c==="quaternion"&&new nn().fromArray(_).normalize().conjugate().toArray(_);let m=l.times.length;for(let p=0;p<m;++p){let b=p*f+h;if(c==="quaternion")nn.multiplyQuaternionsFlat(l.values,b,_,0,l.values,b);else{let v=f-h*2;for(let y=0;y<v;++y)l.values[b+y]-=_[y]}}}return i.blendMode=DM,i}var Pw=class{static convertArray(e,t){return Wd(e,t)}static isTypedArray(e){return JB(e)}static getKeyframeOrder(e){return l3(e)}static sortedArray(e,t,n){return E1(e,t,n)}static flattenJSON(e,t,n,r){gI(e,t,n,r)}static subclip(e,t,n,r,o=30){return C7(e,t,n,r,o)}static makeClipAdditive(e,t=0,n=e,r=30){return E7(e,t,n,r)}},Ja=class{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,n=this._cachedIndex,r=t[n],o=t[n-1];e:{t:{let s;n:{i:if(!(e<r)){for(let a=n+2;;){if(r===void 0){if(e<o)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(o=r,r=t[++n],e<r)break t}s=t.length;break n}if(!(e>=o)){let a=t[1];e<a&&(n=2,o=a);for(let c=n-2;;){if(o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===c)break;if(r=o,o=t[--n-1],e>=o)break t}s=n,n=0;break n}break e}for(;n<s;){let a=n+s>>>1;e<t[a]?s=a:n=a+1}if(r=t[n],o=t[n-1],o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,o,r)}return this.interpolate_(n,o,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=e*r;for(let s=0;s!==r;++s)t[s]=n[o+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},K_=class extends Ja{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Kl,endingEnd:Kl}}intervalChanged_(e,t,n){let r=this.parameterPositions,o=e-2,s=e+1,a=r[o],c=r[s];if(a===void 0)switch(this.getSettings_().endingStart){case Jl:o=e,a=2*t-n;break;case ip:o=r.length-2,a=t+r[o]-r[o+1];break;default:o=e,a=n}if(c===void 0)switch(this.getSettings_().endingEnd){case Jl:s=e,c=2*n-t;break;case ip:s=1,c=n+r[1]-r[0];break;default:s=e-1,c=t}let l=(n-t)*.5,u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(c-n),this._offsetPrev=o*u,this._offsetNext=s*u}interpolate_(e,t,n,r){let o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,f=this._weightNext,g=(n-t)/(r-t),_=g*g,m=_*g,p=-h*m+2*h*_-h*g,b=(1+h)*m+(-1.5-2*h)*_+(-.5+h)*g+1,v=(-1-f)*m+(1.5+f)*_+.5*g,y=f*m-f*_;for(let w=0;w!==a;++w)o[w]=p*s[u+w]+b*s[l+w]+v*s[c+w]+y*s[d+w];return o}},Mp=class extends Ja{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){let o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=(n-t)/(r-t),d=1-u;for(let h=0;h!==a;++h)o[h]=s[l+h]*d+s[c+h]*u;return o}},J_=class extends Ja{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}},po=class{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Wd(t,this.TimeBufferType),this.values=Wd(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Wd(e.times,Array),values:Wd(e.values,Array)};let r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new J_(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Mp(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new K_(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case ru:t=this.InterpolantFactoryMethodDiscrete;break;case ou:t=this.InterpolantFactoryMethodLinear;break;case p_:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return Ue("KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ru;case this.InterpolantFactoryMethodLinear:return ou;case this.InterpolantFactoryMethodSmooth:return p_}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){let n=this.times,r=n.length,o=0,s=r-1;for(;o!==r&&n[o]<e;)++o;for(;s!==-1&&n[s]>t;)--s;if(++s,o!==0||s!==r){o>=s&&(s=Math.max(s,1),o=s-1);let a=this.getValueSize();this.times=n.slice(o,s),this.values=this.values.slice(o*a,s*a)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(bt("KeyframeTrack: Invalid value size in track.",this),e=!1);let n=this.times,r=this.values,o=n.length;o===0&&(bt("KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==o;a++){let c=n[a];if(typeof c=="number"&&isNaN(c)){bt("KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(s!==null&&s>c){bt("KeyframeTrack: Out of order keys.",this,a,c,s),e=!1;break}s=c}if(r!==void 0&&JB(r))for(let a=0,c=r.length;a!==c;++a){let l=r[a];if(isNaN(l)){bt("KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){let e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===p_,o=e.length-1,s=1;for(let a=1;a<o;++a){let c=!1,l=e[a],u=e[a+1];if(l!==u&&(a!==1||l!==e[0]))if(r)c=!0;else{let d=a*n,h=d-n,f=d+n;for(let g=0;g!==n;++g){let _=t[d+g];if(_!==t[h+g]||_!==t[f+g]){c=!0;break}}}if(c){if(a!==s){e[s]=e[a];let d=a*n,h=s*n;for(let f=0;f!==n;++f)t[h+f]=t[d+f]}++s}}if(o>0){e[s]=e[o];for(let a=o*n,c=s*n,l=0;l!==n;++l)t[c+l]=t[a+l];++s}return s!==e.length?(this.times=e.slice(0,s),this.values=t.slice(0,s*n)):(this.times=e,this.values=t),this}clone(){let e=this.times.slice(),t=this.values.slice(),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}};po.prototype.ValueTypeName="";po.prototype.TimeBufferType=Float32Array;po.prototype.ValueBufferType=Float32Array;po.prototype.DefaultInterpolation=ou;var ec=class extends po{constructor(e,t,n){super(e,t,n)}};ec.prototype.ValueTypeName="bool";ec.prototype.ValueBufferType=Array;ec.prototype.DefaultInterpolation=ru;ec.prototype.InterpolantFactoryMethodLinear=void 0;ec.prototype.InterpolantFactoryMethodSmooth=void 0;var Sp=class extends po{constructor(e,t,n,r){super(e,t,n,r)}};Sp.prototype.ValueTypeName="color";var ha=class extends po{constructor(e,t,n,r){super(e,t,n,r)}};ha.prototype.ValueTypeName="number";var eb=class extends Ja{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){let o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,c=(n-t)/(r-t),l=e*a;for(let u=l+a;l!==u;l+=4)nn.slerpFlat(o,0,s,l-a,s,l,c);return o}},fa=class extends po{constructor(e,t,n,r){super(e,t,n,r)}InterpolantFactoryMethodLinear(e){return new eb(this.times,this.values,this.getValueSize(),e)}};fa.prototype.ValueTypeName="quaternion";fa.prototype.InterpolantFactoryMethodSmooth=void 0;var tc=class extends po{constructor(e,t,n){super(e,t,n)}};tc.prototype.ValueTypeName="string";tc.prototype.ValueBufferType=Array;tc.prototype.DefaultInterpolation=ru;tc.prototype.InterpolantFactoryMethodLinear=void 0;tc.prototype.InterpolantFactoryMethodSmooth=void 0;var pa=class extends po{constructor(e,t,n,r){super(e,t,n,r)}};pa.prototype.ValueTypeName="vector";var nc=class{constructor(e="",t=-1,n=[],r=iv){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=Yo(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){let t=[],n=e.tracks,r=1/(e.fps||1);for(let s=0,a=n.length;s!==a;++s)t.push(I7(n[s]).scale(r));let o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o.userData=JSON.parse(e.userData||"{}"),o}static toJSON(e){let t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let o=0,s=n.length;o!==s;++o)t.push(po.toJSON(n[o]));return r}static CreateFromMorphTargetSequence(e,t,n,r){let o=t.length,s=[];for(let a=0;a<o;a++){let c=[],l=[];c.push((a+o-1)%o,a,(a+1)%o),l.push(0,1,0);let u=l3(c);c=E1(c,1,u),l=E1(l,1,u),!r&&c[0]===0&&(c.push(o),l.push(l[0])),s.push(new ha(".morphTargetInfluences["+t[a].name+"]",c,l).scale(1/n))}return new this(e,-1,s)}static findByName(e,t){let n=e;if(!Array.isArray(e)){let r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){let r={},o=/^([\w-]*?)([\d]+)$/;for(let a=0,c=e.length;a<c;a++){let l=e[a],u=l.name.match(o);if(u&&u.length>1){let d=u[1],h=r[d];h||(r[d]=h=[]),h.push(l)}}let s=[];for(let a in r)s.push(this.CreateFromMorphTargetSequence(a,r[a],t,n));return s}static parseAnimation(e,t){if(Ue("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return bt("AnimationClip: No animation in JSONLoader data."),null;let n=function(d,h,f,g,_){if(f.length!==0){let m=[],p=[];gI(f,m,p,g),m.length!==0&&_.push(new d(h,m,p))}},r=[],o=e.name||"default",s=e.fps||30,a=e.blendMode,c=e.length||-1,l=e.hierarchy||[];for(let d=0;d<l.length;d++){let h=l[d].keys;if(!(!h||h.length===0))if(h[0].morphTargets){let f={},g;for(g=0;g<h.length;g++)if(h[g].morphTargets)for(let _=0;_<h[g].morphTargets.length;_++)f[h[g].morphTargets[_]]=-1;for(let _ in f){let m=[],p=[];for(let b=0;b!==h[g].morphTargets.length;++b){let v=h[g];m.push(v.time),p.push(v.morphTarget===_?1:0)}r.push(new ha(".morphTargetInfluence["+_+"]",m,p))}c=f.length*s}else{let f=".bones["+t[d].name+"]";n(pa,f+".position",h,"pos",r),n(fa,f+".quaternion",h,"rot",r),n(pa,f+".scale",h,"scl",r)}}return r.length===0?null:new this(o,c,r,a)}resetDuration(){let e=this.tracks,t=0;for(let n=0,r=e.length;n!==r;++n){let o=this.tracks[n];t=Math.max(t,o.times[o.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());let t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}};function D7(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ha;case"vector":case"vector2":case"vector3":case"vector4":return pa;case"color":return Sp;case"quaternion":return fa;case"bool":case"boolean":return ec;case"string":return tc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function I7(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=D7(i.type);if(i.times===void 0){let t=[],n=[];gI(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}var ra={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}},Rp=class{constructor(e,t,n){let r=this,o=!1,s=0,a=0,c,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this._abortController=null,this.itemStart=function(u){a++,o===!1&&r.onStart!==void 0&&r.onStart(u,s,a),o=!0},this.itemEnd=function(u){s++,r.onProgress!==void 0&&r.onProgress(u,s,a),s===a&&(o=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return c?c(u):u},this.setURLModifier=function(u){return c=u,this},this.addHandler=function(u,d){return l.push(u,d),this},this.removeHandler=function(u){let d=l.indexOf(u);return d!==-1&&l.splice(d,2),this},this.getHandler=function(u){for(let d=0,h=l.length;d<h;d+=2){let f=l[d],g=l[d+1];if(f.global&&(f.lastIndex=0),f.test(u))return g}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}},_I=new Rp,or=(()=>{class i{constructor(t){this.manager=t!==void 0?t:_I,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,n){let r=this;return new Promise(function(o,s){r.load(t,o,n,s)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}abort(){return this}}return i.DEFAULT_MATERIAL_NAME="__DEFAULT",i})(),Gc={},D1=class extends Error{constructor(e,t){super(e),this.response=t}},ir=class extends or{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let o=ra.get(`file:${e}`);if(o!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(o),this.manager.itemEnd(e)},0),o;if(Gc[e]!==void 0){Gc[e].push({onLoad:t,onProgress:n,onError:r});return}Gc[e]=[],Gc[e].push({onLoad:t,onProgress:n,onError:r});let s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),a=this.mimeType,c=this.responseType;fetch(s).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&Ue("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let u=Gc[e],d=l.body.getReader(),h=l.headers.get("X-File-Size")||l.headers.get("Content-Length"),f=h?parseInt(h):0,g=f!==0,_=0,m=new ReadableStream({start(p){b();function b(){d.read().then(({done:v,value:y})=>{if(v)p.close();else{_+=y.byteLength;let w=new ProgressEvent("progress",{lengthComputable:g,loaded:_,total:f});for(let R=0,E=u.length;R<E;R++){let A=u[R];A.onProgress&&A.onProgress(w)}p.enqueue(y),b()}},v=>{p.error(v)})}}});return new Response(m)}else throw new D1(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(c){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(u=>new DOMParser().parseFromString(u,a));case"json":return l.json();default:if(a==="")return l.text();{let d=/charset="?([^;"\s]*)"?/i.exec(a),h=d&&d[1]?d[1].toLowerCase():void 0,f=new TextDecoder(h);return l.arrayBuffer().then(g=>f.decode(g))}}}).then(l=>{ra.add(`file:${e}`,l);let u=Gc[e];delete Gc[e];for(let d=0,h=u.length;d<h;d++){let f=u[d];f.onLoad&&f.onLoad(l)}}).catch(l=>{let u=Gc[e];if(u===void 0)throw this.manager.itemError(e),l;delete Gc[e];for(let d=0,h=u.length;d<h;d++){let f=u[d];f.onError&&f.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}},Fw=class extends or{constructor(e){super(e)}load(e,t,n,r){let o=this,s=new ir(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(a){try{t(o.parse(JSON.parse(a)))}catch(c){r?r(c):bt(c),o.manager.itemError(e)}},n,r)}parse(e){let t=[];for(let n=0;n<e.length;n++){let r=nc.parse(e[n]);t.push(r)}return t}},Nw=class extends or{constructor(e){super(e)}load(e,t,n,r){let o=this,s=[],a=new ah,c=new ir(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(o.withCredentials);let l=0;function u(d){c.load(e[d],function(h){let f=o.parse(h,!0);s[d]={width:f.width,height:f.height,format:f.format,mipmaps:f.mipmaps},l+=1,l===6&&(f.mipmapCount===1&&(a.minFilter=zn),a.image=s,a.format=f.format,a.needsUpdate=!0,t&&t(a))},n,r)}if(Array.isArray(e))for(let d=0,h=e.length;d<h;++d)u(d);else c.load(e,function(d){let h=o.parse(d,!0);if(h.isCubemap){let f=h.mipmaps.length/h.mipmapCount;for(let g=0;g<f;g++){s[g]={mipmaps:[]};for(let _=0;_<h.mipmapCount;_++)s[g].mipmaps.push(h.mipmaps[g*h.mipmapCount+_]),s[g].format=h.format,s[g].width=h.width,s[g].height=h.height}a.image=s}else a.image.width=h.width,a.image.height=h.height,a.mipmaps=h.mipmaps;h.mipmapCount===1&&(a.minFilter=zn),a.format=h.format,a.needsUpdate=!0,t&&t(a)},n,r);return a}},Kf=new WeakMap,hu=class extends or{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let o=this,s=ra.get(`image:${e}`);if(s!==void 0){if(s.complete===!0)o.manager.itemStart(e),setTimeout(function(){t&&t(s),o.manager.itemEnd(e)},0);else{let d=Kf.get(s);d===void 0&&(d=[],Kf.set(s,d)),d.push({onLoad:t,onError:r})}return s}let a=sp("img");function c(){u(),t&&t(this);let d=Kf.get(this)||[];for(let h=0;h<d.length;h++){let f=d[h];f.onLoad&&f.onLoad(this)}Kf.delete(this),o.manager.itemEnd(e)}function l(d){u(),r&&r(d),ra.remove(`image:${e}`);let h=Kf.get(this)||[];for(let f=0;f<h.length;f++){let g=h[f];g.onError&&g.onError(d)}Kf.delete(this),o.manager.itemError(e),o.manager.itemEnd(e)}function u(){a.removeEventListener("load",c,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",l,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),ra.add(`image:${e}`,a),o.manager.itemStart(e),a.src=e,a}},jw=class extends or{constructor(e){super(e)}load(e,t,n,r){let o=new au;o.colorSpace=Jn;let s=new hu(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let a=0;function c(l){s.load(e[l],function(u){o.images[l]=u,a++,a===6&&(o.needsUpdate=!0,t&&t(o))},void 0,r)}for(let l=0;l<e.length;++l)c(l);return o}},Ow=class extends or{constructor(e){super(e)}load(e,t,n,r){let o=this,s=new Cr,a=new ir(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(o.withCredentials),a.load(e,function(c){let l;try{l=o.parse(c)}catch(u){if(r!==void 0)r(u);else{u(u);return}}l.image!==void 0?s.image=l.image:l.data!==void 0&&(s.image.width=l.width,s.image.height=l.height,s.image.data=l.data),s.wrapS=l.wrapS!==void 0?l.wrapS:jr,s.wrapT=l.wrapT!==void 0?l.wrapT:jr,s.magFilter=l.magFilter!==void 0?l.magFilter:zn,s.minFilter=l.minFilter!==void 0?l.minFilter:zn,s.anisotropy=l.anisotropy!==void 0?l.anisotropy:1,l.colorSpace!==void 0&&(s.colorSpace=l.colorSpace),l.flipY!==void 0&&(s.flipY=l.flipY),l.format!==void 0&&(s.format=l.format),l.type!==void 0&&(s.type=l.type),l.mipmaps!==void 0&&(s.mipmaps=l.mipmaps,s.minFilter=Po),l.mipmapCount===1&&(s.minFilter=zn),l.generateMipmaps!==void 0&&(s.generateMipmaps=l.generateMipmaps),s.needsUpdate=!0,t&&t(s,l)},n,r),s}},Tp=class extends or{constructor(e){super(e)}load(e,t,n,r){let o=new Ii,s=new hu(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,function(a){o.image=a,o.needsUpdate=!0,t!==void 0&&t(o)},n,r),o}},ma=class extends wt{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new ue(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}},hh=class extends ma{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(wt.DEFAULT_UP),this.updateMatrix(),this.groundColor=new ue(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}toJSON(e){let t=super.toJSON(e);return t.object.groundColor=this.groundColor.getHex(),t}},_1=new Ee,K2=new C,J2=new C,tb=class{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new z(512,512),this.mapType=_o,this.map=null,this.mapPass=null,this.matrix=new Ee,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Xc,this._frameExtents=new z(1,1),this._viewportCount=1,this._viewports=[new En(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,n=this.matrix;K2.setFromMatrixPosition(e.matrixWorld),t.position.copy(K2),J2.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(J2),t.updateMatrixWorld(),_1.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_1,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(_1)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},I1=class extends tb{constructor(){super(new ai(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){let t=this.camera,n=Zd*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,o=e.distance||t.far;(n!==t.fov||r!==t.aspect||o!==t.far)&&(t.fov=n,t.aspect=r,t.far=o,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},fh=class extends ma{constructor(e,t,n=0,r=Math.PI/3,o=0,s=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(wt.DEFAULT_UP),this.updateMatrix(),this.target=new wt,this.distance=n,this.angle=r,this.penumbra=o,this.decay=s,this.map=null,this.shadow=new I1}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){let t=super.toJSON(e);return t.object.distance=this.distance,t.object.angle=this.angle,t.object.decay=this.decay,t.object.penumbra=this.penumbra,t.object.target=this.target.uuid,this.map&&this.map.isTexture&&(t.object.map=this.map.toJSON(e).uuid),t.object.shadow=this.shadow.toJSON(),t}},A1=class extends tb{constructor(){super(new ai(90,1,.5,500)),this.isPointLightShadow=!0}},Zc=class extends ma{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new A1}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){let t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}},mo=class extends qc{constructor(e=-1,t=1,n=1,r=-1,o=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=o,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,o,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,o=n-e,s=n+e,a=r+t,c=r-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=l*this.view.offsetX,s=o+l*this.view.width,a-=u*this.view.offsetY,c=a-u*this.view.height}this.projectionMatrix.makeOrthographic(o,s,a,c,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},P1=class extends tb{constructor(){super(new mo(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},Yc=class extends ma{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(wt.DEFAULT_UP),this.updateMatrix(),this.target=new wt,this.shadow=new P1}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){let t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}},ph=class extends ma{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}},nb=class extends ma{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){let t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}},Cp=class{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new C)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){let n=e.x,r=e.y,o=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.282095),t.addScaledVector(s[1],.488603*r),t.addScaledVector(s[2],.488603*o),t.addScaledVector(s[3],.488603*n),t.addScaledVector(s[4],1.092548*(n*r)),t.addScaledVector(s[5],1.092548*(r*o)),t.addScaledVector(s[6],.315392*(3*o*o-1)),t.addScaledVector(s[7],1.092548*(n*o)),t.addScaledVector(s[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){let n=e.x,r=e.y,o=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.886227),t.addScaledVector(s[1],2*.511664*r),t.addScaledVector(s[2],2*.511664*o),t.addScaledVector(s[3],2*.511664*n),t.addScaledVector(s[4],2*.429043*n*r),t.addScaledVector(s[5],2*.429043*r*o),t.addScaledVector(s[6],.743125*o*o-.247708),t.addScaledVector(s[7],2*.429043*n*o),t.addScaledVector(s[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){let n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){let n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){let n=e.x,r=e.y,o=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*o,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*o,t[6]=.315392*(3*o*o-1),t[7]=1.092548*n*o,t[8]=.546274*(n*n-r*r)}},ib=class extends ma{constructor(e=new Cp,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}toJSON(e){let t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}},rb=class i extends or{constructor(e){super(e),this.textures={}}load(e,t,n,r){let o=this,s=new ir(o.manager);s.setPath(o.path),s.setRequestHeader(o.requestHeader),s.setWithCredentials(o.withCredentials),s.load(e,function(a){try{t(o.parse(JSON.parse(a)))}catch(c){r?r(c):bt(c),o.manager.itemError(e)}},n,r)}parse(e){let t=this.textures;function n(o){return t[o]===void 0&&Ue("MaterialLoader: Undefined texture",o),t[o]}let r=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new ue().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.allowOverride!==void 0&&(r.allowOverride=e.allowOverride),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(let o in e.uniforms){let s=e.uniforms[o];switch(r.uniforms[o]={},s.type){case"t":r.uniforms[o].value=n(s.value);break;case"c":r.uniforms[o].value=new ue().setHex(s.value);break;case"v2":r.uniforms[o].value=new z().fromArray(s.value);break;case"v3":r.uniforms[o].value=new C().fromArray(s.value);break;case"v4":r.uniforms[o].value=new En().fromArray(s.value);break;case"m3":r.uniforms[o].value=new Yt().fromArray(s.value);break;case"m4":r.uniforms[o].value=new Ee().fromArray(s.value);break;default:r.uniforms[o].value=s.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(let o in e.extensions)r.extensions[o]=e.extensions[o];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=n(e.map)),e.matcap!==void 0&&(r.matcap=n(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let o=e.normalScale;Array.isArray(o)===!1&&(o=[o,o]),r.normalScale=new z().fromArray(o)}return e.displacementMap!==void 0&&(r.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=n(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new z().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return i.createMaterialFromType(e)}static createMaterialFromType(e){let t={ShadowMaterial:q_,SpriteMaterial:hp,RawShaderMaterial:xp,ShaderMaterial:Nt,PointsMaterial:lu,MeshPhysicalMaterial:Wr,MeshStandardMaterial:kr,MeshPhongMaterial:dh,MeshToonMaterial:X_,MeshNormalMaterial:da,MeshLambertMaterial:Z_,MeshDepthMaterial:du,MeshDistanceMaterial:wp,MeshBasicMaterial:ci,MeshMatcapMaterial:Y_,LineDashedMaterial:Q_,LineBasicMaterial:mi,Material:Mi};return new t[e]}},Rs=class{static extractUrlBase(e){let t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}},ob=class extends nt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},sb=class extends or{constructor(e){super(e)}load(e,t,n,r){let o=this,s=new ir(o.manager);s.setPath(o.path),s.setRequestHeader(o.requestHeader),s.setWithCredentials(o.withCredentials),s.load(e,function(a){try{t(o.parse(JSON.parse(a)))}catch(c){r?r(c):bt(c),o.manager.itemError(e)}},n,r)}parse(e){let t={},n={};function r(f,g){if(t[g]!==void 0)return t[g];let m=f.interleavedBuffers[g],p=o(f,m.buffer),b=tp(m.type,p),v=new xs(b,m.stride);return v.uuid=m.uuid,t[g]=v,v}function o(f,g){if(n[g]!==void 0)return n[g];let m=f.arrayBuffers[g],p=new Uint32Array(m).buffer;return n[g]=p,p}let s=e.isInstancedBufferGeometry?new ob:new nt,a=e.data.index;if(a!==void 0){let f=tp(a.type,a.array);s.setIndex(new pn(f,1))}let c=e.data.attributes;for(let f in c){let g=c[f],_;if(g.isInterleavedBufferAttribute){let m=r(e.data,g.data);_=new Jo(m,g.itemSize,g.offset,g.normalized)}else{let m=tp(g.type,g.array),p=g.isInstancedBufferAttribute?ws:pn;_=new p(m,g.itemSize,g.normalized)}g.name!==void 0&&(_.name=g.name),g.usage!==void 0&&_.setUsage(g.usage),s.setAttribute(f,_)}let l=e.data.morphAttributes;if(l)for(let f in l){let g=l[f],_=[];for(let m=0,p=g.length;m<p;m++){let b=g[m],v;if(b.isInterleavedBufferAttribute){let y=r(e.data,b.data);v=new Jo(y,b.itemSize,b.offset,b.normalized)}else{let y=tp(b.type,b.array);v=new pn(y,b.itemSize,b.normalized)}b.name!==void 0&&(v.name=b.name),_.push(v)}s.morphAttributes[f]=_}e.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);let d=e.data.groups||e.data.drawcalls||e.data.offsets;if(d!==void 0)for(let f=0,g=d.length;f!==g;++f){let _=d[f];s.addGroup(_.start,_.count,_.materialIndex)}let h=e.data.boundingSphere;return h!==void 0&&(s.boundingSphere=new Di().fromJSON(h)),e.name&&(s.name=e.name),e.userData&&(s.userData=e.userData),s}},Lw=class extends or{constructor(e){super(e)}load(e,t,n,r){let o=this,s=this.path===""?Rs.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;let a=new ir(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){let l=null;try{l=JSON.parse(c)}catch(d){r!==void 0&&r(d),d("ObjectLoader: Can't parse "+e+".",d.message);return}let u=l.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),bt("ObjectLoader: Can't load "+e);return}o.parse(l,t)},n,r)}loadAsync(e,t){return Wt(this,null,function*(){let n=this,r=this.path===""?Rs.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;let o=new ir(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials);let s=yield o.loadAsync(e,t),a=JSON.parse(s),c=a.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return yield n.parseAsync(a)})}parse(e,t){let n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),o=this.parseGeometries(e.geometries,r),s=this.parseImages(e.images,function(){t!==void 0&&t(l)}),a=this.parseTextures(e.textures,s),c=this.parseMaterials(e.materials,a),l=this.parseObject(e.object,o,c,a,n),u=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,u),this.bindLightTargets(l),t!==void 0){let d=!1;for(let h in s)if(s[h].data instanceof HTMLImageElement){d=!0;break}d===!1&&t(l)}return l}parseAsync(e){return Wt(this,null,function*(){let t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),o=yield this.parseImagesAsync(e.images),s=this.parseTextures(e.textures,o),a=this.parseMaterials(e.materials,s),c=this.parseObject(e.object,r,a,s,t),l=this.parseSkeletons(e.skeletons,c);return this.bindSkeletons(c,l),this.bindLightTargets(c),c})}parseShapes(e){let t={};if(e!==void 0)for(let n=0,r=e.length;n<r;n++){let o=new Qa().fromJSON(e[n]);t[o.uuid]=o}return t}parseSkeletons(e,t){let n={},r={};if(t.traverse(function(o){o.isBone&&(r[o.uuid]=o)}),e!==void 0)for(let o=0,s=e.length;o<s;o++){let a=new rh().fromJSON(e[o],r);n[a.uuid]=a}return n}parseGeometries(e,t){let n={};if(e!==void 0){let r=new sb;for(let o=0,s=e.length;o<s;o++){let a,c=e[o];switch(c.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(c);break;default:c.type in Q2?a=Q2[c.type].fromJSON(c,t):Ue(`ObjectLoader: Unsupported geometry type "${c.type}"`)}a.uuid=c.uuid,c.name!==void 0&&(a.name=c.name),c.userData!==void 0&&(a.userData=c.userData),n[c.uuid]=a}}return n}parseMaterials(e,t){let n={},r={};if(e!==void 0){let o=new rb;o.setTextures(t);for(let s=0,a=e.length;s<a;s++){let c=e[s];n[c.uuid]===void 0&&(n[c.uuid]=o.parse(c)),r[c.uuid]=n[c.uuid]}}return r}parseAnimations(e){let t={};if(e!==void 0)for(let n=0;n<e.length;n++){let r=e[n],o=nc.parse(r);t[o.uuid]=o}return t}parseImages(e,t){let n=this,r={},o;function s(c){return n.manager.itemStart(c),o.load(c,function(){n.manager.itemEnd(c)},void 0,function(){n.manager.itemError(c),n.manager.itemEnd(c)})}function a(c){if(typeof c=="string"){let l=c,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l)?l:n.resourcePath+l;return s(u)}else return c.data?{data:tp(c.type,c.data),width:c.width,height:c.height}:null}if(e!==void 0&&e.length>0){let c=new Rp(t);o=new hu(c),o.setCrossOrigin(this.crossOrigin);for(let l=0,u=e.length;l<u;l++){let d=e[l],h=d.url;if(Array.isArray(h)){let f=[];for(let g=0,_=h.length;g<_;g++){let m=h[g],p=a(m);p!==null&&(p instanceof HTMLImageElement?f.push(p):f.push(new Cr(p.data,p.width,p.height)))}r[d.uuid]=new ia(f)}else{let f=a(d.url);r[d.uuid]=new ia(f)}}}return r}parseImagesAsync(e){return Wt(this,null,function*(){let t=this,n={},r;function o(s){return Wt(this,null,function*(){if(typeof s=="string"){let a=s,c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return yield r.loadAsync(c)}else return s.data?{data:tp(s.type,s.data),width:s.width,height:s.height}:null})}if(e!==void 0&&e.length>0){r=new hu(this.manager),r.setCrossOrigin(this.crossOrigin);for(let s=0,a=e.length;s<a;s++){let c=e[s],l=c.url;if(Array.isArray(l)){let u=[];for(let d=0,h=l.length;d<h;d++){let f=l[d],g=yield o(f);g!==null&&(g instanceof HTMLImageElement?u.push(g):u.push(new Cr(g.data,g.width,g.height)))}n[c.uuid]=new ia(u)}else{let u=yield o(c.url);n[c.uuid]=new ia(u)}}}return n})}parseTextures(e,t){function n(o,s){return typeof o=="number"?o:(Ue("ObjectLoader.parseTexture: Constant should be in numeric form.",o),s[o])}let r={};if(e!==void 0)for(let o=0,s=e.length;o<s;o++){let a=e[o];a.image===void 0&&Ue('ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&Ue("ObjectLoader: Undefined image",a.image);let c=t[a.image],l=c.data,u;Array.isArray(l)?(u=new au,l.length===6&&(u.needsUpdate=!0)):(l&&l.data?u=new Cr:u=new Ii,l&&(u.needsUpdate=!0)),u.source=c,u.uuid=a.uuid,a.name!==void 0&&(u.name=a.name),a.mapping!==void 0&&(u.mapping=n(a.mapping,A7)),a.channel!==void 0&&(u.channel=a.channel),a.offset!==void 0&&u.offset.fromArray(a.offset),a.repeat!==void 0&&u.repeat.fromArray(a.repeat),a.center!==void 0&&u.center.fromArray(a.center),a.rotation!==void 0&&(u.rotation=a.rotation),a.wrap!==void 0&&(u.wrapS=n(a.wrap[0],eB),u.wrapT=n(a.wrap[1],eB)),a.format!==void 0&&(u.format=a.format),a.internalFormat!==void 0&&(u.internalFormat=a.internalFormat),a.type!==void 0&&(u.type=a.type),a.colorSpace!==void 0&&(u.colorSpace=a.colorSpace),a.minFilter!==void 0&&(u.minFilter=n(a.minFilter,tB)),a.magFilter!==void 0&&(u.magFilter=n(a.magFilter,tB)),a.anisotropy!==void 0&&(u.anisotropy=a.anisotropy),a.flipY!==void 0&&(u.flipY=a.flipY),a.generateMipmaps!==void 0&&(u.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(u.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(u.compareFunction=a.compareFunction),a.userData!==void 0&&(u.userData=a.userData),r[a.uuid]=u}return r}parseObject(e,t,n,r,o){let s;function a(h){return t[h]===void 0&&Ue("ObjectLoader: Undefined geometry",h),t[h]}function c(h){if(h!==void 0){if(Array.isArray(h)){let f=[];for(let g=0,_=h.length;g<_;g++){let m=h[g];n[m]===void 0&&Ue("ObjectLoader: Undefined material",m),f.push(n[m])}return f}return n[h]===void 0&&Ue("ObjectLoader: Undefined material",h),n[h]}}function l(h){return r[h]===void 0&&Ue("ObjectLoader: Undefined texture",h),r[h]}let u,d;switch(e.type){case"Scene":s=new th,e.background!==void 0&&(Number.isInteger(e.background)?s.background=new ue(e.background):s.background=l(e.background)),e.environment!==void 0&&(s.environment=l(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?s.fog=new eh(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(s.fog=new x_(e.fog.color,e.fog.density)),e.fog.name!==""&&(s.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(s.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(s.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&s.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(s.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&s.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":s=new ai(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(s.focus=e.focus),e.zoom!==void 0&&(s.zoom=e.zoom),e.filmGauge!==void 0&&(s.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(s.filmOffset=e.filmOffset),e.view!==void 0&&(s.view=Object.assign({},e.view));break;case"OrthographicCamera":s=new mo(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(s.zoom=e.zoom),e.view!==void 0&&(s.view=Object.assign({},e.view));break;case"AmbientLight":s=new ph(e.color,e.intensity);break;case"DirectionalLight":s=new Yc(e.color,e.intensity),s.target=e.target||"";break;case"PointLight":s=new Zc(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":s=new nb(e.color,e.intensity,e.width,e.height);break;case"SpotLight":s=new fh(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),s.target=e.target||"";break;case"HemisphereLight":s=new hh(e.color,e.groundColor,e.intensity);break;case"LightProbe":let h=new Cp().fromArray(e.sh);s=new ib(h,e.intensity);break;case"SkinnedMesh":u=a(e.geometry),d=c(e.material),s=new ih(u,d),e.bindMode!==void 0&&(s.bindMode=e.bindMode),e.bindMatrix!==void 0&&s.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(s.skeleton=e.skeleton);break;case"Mesh":u=a(e.geometry),d=c(e.material),s=new Pe(u,d);break;case"InstancedMesh":u=a(e.geometry),d=c(e.material);let f=e.count,g=e.instanceMatrix,_=e.instanceColor;s=new Ms(u,d,f),s.instanceMatrix=new ws(new Float32Array(g.array),16),_!==void 0&&(s.instanceColor=new ws(new Float32Array(_.array),_.itemSize));break;case"BatchedMesh":u=a(e.geometry),d=c(e.material),s=new S_(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,d),s.geometry=u,s.perObjectFrustumCulled=e.perObjectFrustumCulled,s.sortObjects=e.sortObjects,s._drawRanges=e.drawRanges,s._reservedRanges=e.reservedRanges,s._geometryInfo=e.geometryInfo.map(m=>{let p=null,b=null;return m.boundingBox!==void 0&&(p=new wi().fromJSON(m.boundingBox)),m.boundingSphere!==void 0&&(b=new Di().fromJSON(m.boundingSphere)),jt(ae({},m),{boundingBox:p,boundingSphere:b})}),s._instanceInfo=e.instanceInfo,s._availableInstanceIds=e._availableInstanceIds,s._availableGeometryIds=e._availableGeometryIds,s._nextIndexStart=e.nextIndexStart,s._nextVertexStart=e.nextVertexStart,s._geometryCount=e.geometryCount,s._maxInstanceCount=e.maxInstanceCount,s._maxVertexCount=e.maxVertexCount,s._maxIndexCount=e.maxIndexCount,s._geometryInitialized=e.geometryInitialized,s._matricesTexture=l(e.matricesTexture.uuid),s._indirectTexture=l(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(s._colorsTexture=l(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(s.boundingSphere=new Di().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(s.boundingBox=new wi().fromJSON(e.boundingBox));break;case"LOD":s=new nh;break;case"Line":s=new ti(a(e.geometry),c(e.material));break;case"LineLoop":s=new oh(a(e.geometry),c(e.material));break;case"LineSegments":s=new Lr(a(e.geometry),c(e.material));break;case"PointCloud":case"Points":s=new sh(a(e.geometry),c(e.material));break;case"Sprite":s=new w_(c(e.material));break;case"Group":s=new Or;break;case"Bone":s=new cu;break;default:s=new wt}if(s.uuid=e.uuid,e.name!==void 0&&(s.name=e.name),e.matrix!==void 0?(s.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(s.matrixAutoUpdate=e.matrixAutoUpdate),s.matrixAutoUpdate&&s.matrix.decompose(s.position,s.quaternion,s.scale)):(e.position!==void 0&&s.position.fromArray(e.position),e.rotation!==void 0&&s.rotation.fromArray(e.rotation),e.quaternion!==void 0&&s.quaternion.fromArray(e.quaternion),e.scale!==void 0&&s.scale.fromArray(e.scale)),e.up!==void 0&&s.up.fromArray(e.up),e.castShadow!==void 0&&(s.castShadow=e.castShadow),e.receiveShadow!==void 0&&(s.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(s.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(s.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(s.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(s.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&s.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(s.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(s.visible=e.visible),e.frustumCulled!==void 0&&(s.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(s.renderOrder=e.renderOrder),e.userData!==void 0&&(s.userData=e.userData),e.layers!==void 0&&(s.layers.mask=e.layers),e.children!==void 0){let h=e.children;for(let f=0;f<h.length;f++)s.add(this.parseObject(h[f],t,n,r,o))}if(e.animations!==void 0){let h=e.animations;for(let f=0;f<h.length;f++){let g=h[f];s.animations.push(o[g])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(s.autoUpdate=e.autoUpdate);let h=e.levels;for(let f=0;f<h.length;f++){let g=h[f],_=s.getObjectByProperty("uuid",g.object);_!==void 0&&s.addLevel(_,g.distance,g.hysteresis)}}return s}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){let r=t[n.skeleton];r===void 0?Ue("ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){let n=t.target,r=e.getObjectByProperty("uuid",n);r!==void 0?t.target=r:t.target=new wt}})}},A7={UVMapping:b_,CubeReflectionMapping:ga,CubeRefractionMapping:Jc,EquirectangularReflectionMapping:Np,EquirectangularRefractionMapping:jp,CubeUVReflectionMapping:bh},eB={RepeatWrapping:Qo,ClampToEdgeWrapping:jr,MirroredRepeatWrapping:iu},tB={NearestFilter:Zt,NearestMipmapNearestFilter:Op,NearestMipmapLinearFilter:el,LinearFilter:zn,LinearMipmapNearestFilter:gu,LinearMipmapLinearFilter:Po},b1=new WeakMap,Ep=class extends or{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&Ue("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&Ue("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let o=this,s=ra.get(`image-bitmap:${e}`);if(s!==void 0){if(o.manager.itemStart(e),s.then){s.then(l=>{if(b1.has(s)===!0)r&&r(b1.get(s)),o.manager.itemError(e),o.manager.itemEnd(e);else return t&&t(l),o.manager.itemEnd(e),l});return}return setTimeout(function(){t&&t(s),o.manager.itemEnd(e)},0),s}let a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,a.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;let c=fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(o.options,{colorSpaceConversion:"none"}))}).then(function(l){return ra.add(`image-bitmap:${e}`,l),t&&t(l),o.manager.itemEnd(e),l}).catch(function(l){r&&r(l),b1.set(c,l),ra.remove(`image-bitmap:${e}`),o.manager.itemError(e),o.manager.itemEnd(e)});ra.add(`image-bitmap:${e}`,c),o.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}},aw,Dp=class{static getContext(){return aw===void 0&&(aw=new(window.AudioContext||window.webkitAudioContext)),aw}static setContext(e){aw=e}},kw=class extends or{constructor(e){super(e)}load(e,t,n,r){let o=this,s=new ir(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(c){try{let l=c.slice(0);Dp.getContext().decodeAudioData(l,function(d){t(d)}).catch(a)}catch(l){a(l)}},n,r);function a(c){r?r(c):bt(c),o.manager.itemError(e)}}},nB=new Ee,iB=new Ee,Bd=new Ee,Bw=class{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ai,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ai,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){let t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Bd.copy(e.projectionMatrix);let r=t.eyeSep/2,o=r*t.near/t.focus,s=t.near*Math.tan($d*t.fov*.5)/t.zoom,a,c;iB.elements[12]=-r,nB.elements[12]=r,a=-s*t.aspect+o,c=s*t.aspect+o,Bd.elements[0]=2*t.near/(c-a),Bd.elements[8]=(c+a)/(c-a),this.cameraL.projectionMatrix.copy(Bd),a=-s*t.aspect-o,c=s*t.aspect-o,Bd.elements[0]=2*t.near/(c-a),Bd.elements[8]=(c+a)/(c-a),this.cameraR.projectionMatrix.copy(Bd)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(iB),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(nB)}},ab=class extends ai{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}},go=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}},Ud=new C,v1=new nn,P7=new C,Vd=new C,zd=new C,Uw=class extends wt{constructor(){super(),this.type="AudioListener",this.context=Dp.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new go}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);let t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Ud,v1,P7),Vd.set(0,0,-1).applyQuaternion(v1),zd.set(0,1,0).applyQuaternion(v1),t.positionX){let n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Ud.x,n),t.positionY.linearRampToValueAtTime(Ud.y,n),t.positionZ.linearRampToValueAtTime(Ud.z,n),t.forwardX.linearRampToValueAtTime(Vd.x,n),t.forwardY.linearRampToValueAtTime(Vd.y,n),t.forwardZ.linearRampToValueAtTime(Vd.z,n),t.upX.linearRampToValueAtTime(zd.x,n),t.upY.linearRampToValueAtTime(zd.y,n),t.upZ.linearRampToValueAtTime(zd.z,n)}else t.setPosition(Ud.x,Ud.y,Ud.z),t.setOrientation(Vd.x,Vd.y,Vd.z,zd.x,zd.y,zd.z)}},cb=class extends wt{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){Ue("Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){Ue("Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;let t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){Ue("Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){Ue("Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){Ue("Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(Ue("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){Ue("Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(Ue("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}},Hd=new C,rB=new nn,F7=new C,Gd=new C,Vw=class extends cb{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Hd,rB,F7),Gd.set(0,0,1).applyQuaternion(rB);let t=this.panner;if(t.positionX){let n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Hd.x,n),t.positionY.linearRampToValueAtTime(Hd.y,n),t.positionZ.linearRampToValueAtTime(Hd.z,n),t.orientationX.linearRampToValueAtTime(Gd.x,n),t.orientationY.linearRampToValueAtTime(Gd.y,n),t.orientationZ.linearRampToValueAtTime(Gd.z,n)}else t.setPosition(Hd.x,Hd.y,Hd.z),t.setOrientation(Gd.x,Gd.y,Gd.z)}},zw=class{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0,t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}},lb=class{constructor(e,t,n){this.binding=e,this.valueSize=n;let r,o,s;switch(t){case"quaternion":r=this._slerp,o=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,o=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,o=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=o,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let n=this.buffer,r=this.valueSize,o=e*r+r,s=this.cumulativeWeight;if(s===0){for(let a=0;a!==r;++a)n[o+a]=n[a];s=t}else{s+=t;let a=t/s;this._mixBufferRegion(n,o,0,a,r)}this.cumulativeWeight=s}accumulateAdditive(e){let t=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,n=this.buffer,r=e*t+t,o=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){let c=t*this._origIndex;this._mixBufferRegion(n,r,c,1-o,t)}s>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let c=t,l=t+t;c!==l;++c)if(n[c]!==n[c+t]){a.setValue(n,r);break}}saveOriginalState(){let e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let o=n,s=r;o!==s;++o)t[o]=t[r+o%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,o){if(r>=.5)for(let s=0;s!==o;++s)e[t+s]=e[n+s]}_slerp(e,t,n,r){nn.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,o){let s=this._workIndex*o;nn.multiplyQuaternionsFlat(e,s,e,t,e,n),nn.slerpFlat(e,t,e,t,e,s,r)}_lerp(e,t,n,r,o){let s=1-r;for(let a=0;a!==o;++a){let c=t+a;e[c]=e[c]*s+e[n+a]*r}}_lerpAdditive(e,t,n,r,o){for(let s=0;s!==o;++s){let a=t+s;e[a]=e[a]+e[n+s]*r}}},bI="\\[\\]\\.:\\/",N7=new RegExp("["+bI+"]","g"),vI="[^"+bI+"]",j7="[^"+bI.replace("\\.","")+"]",O7=/((?:WC+[\/:])*)/.source.replace("WC",vI),L7=/(WCOD+)?/.source.replace("WCOD",j7),k7=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",vI),B7=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",vI),U7=new RegExp("^"+O7+L7+k7+B7+"$"),V7=["material","materials","bones","map"],F1=class{constructor(e,t,n){let r=n||Zn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();let n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){let n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,o=n.length;r!==o;++r)n[r].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},Zn=(()=>{class i{constructor(t,n,r){this.path=n,this.parsedPath=r||i.parseTrackName(n),this.node=i.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,r){return t&&t.isAnimationObjectGroup?new i.Composite(t,n,r):new i(t,n,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(N7,"")}static parseTrackName(t){let n=U7.exec(t);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);let r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},o=r.nodeName&&r.nodeName.lastIndexOf(".");if(o!==void 0&&o!==-1){let s=r.nodeName.substring(o+1);V7.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,o),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,n){if(n===void 0||n===""||n==="."||n===-1||n===t.name||n===t.uuid)return t;if(t.skeleton){let r=t.skeleton.getBoneByName(n);if(r!==void 0)return r}if(t.children){let r=function(s){for(let a=0;a<s.length;a++){let c=s[a];if(c.name===n||c.uuid===n)return c;let l=r(c.children);if(l)return l}return null},o=r(t.children);if(o)return o}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){let r=this.resolvedProperty;for(let o=0,s=r.length;o!==s;++o)t[n++]=r[o]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){let r=this.resolvedProperty;for(let o=0,s=r.length;o!==s;++o)r[o]=t[n++]}_setValue_array_setNeedsUpdate(t,n){let r=this.resolvedProperty;for(let o=0,s=r.length;o!==s;++o)r[o]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){let r=this.resolvedProperty;for(let o=0,s=r.length;o!==s;++o)r[o]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node,n=this.parsedPath,r=n.objectName,o=n.propertyName,s=n.propertyIndex;if(t||(t=i.findNode(this.rootNode,n.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){Ue("PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let u=n.objectIndex;switch(r){case"materials":if(!t.material){bt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){bt("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){bt("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===u){u=d;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){bt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){bt("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[r]===void 0){bt("PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[r]}if(u!==void 0){if(t[u]===void 0){bt("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[u]}}let a=t[o];if(a===void 0){let u=n.nodeName;bt("PropertyBinding: Trying to update property for track: "+u+"."+o+" but it wasn't found.",t);return}let c=this.Versioning.None;this.targetObject=t,t.isMaterial===!0?c=this.Versioning.NeedsUpdate:t.isObject3D===!0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(o==="morphTargetInfluences"){if(!t.geometry){bt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){bt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[s]!==void 0&&(s=t.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=o;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return i.Composite=F1,i})();Zn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Zn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Zn.prototype.GetterByBindingType=[Zn.prototype._getValue_direct,Zn.prototype._getValue_array,Zn.prototype._getValue_arrayElement,Zn.prototype._getValue_toArray];Zn.prototype.SetterByBindingTypeAndVersioning=[[Zn.prototype._setValue_direct,Zn.prototype._setValue_direct_setNeedsUpdate,Zn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Zn.prototype._setValue_array,Zn.prototype._setValue_array_setNeedsUpdate,Zn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Zn.prototype._setValue_arrayElement,Zn.prototype._setValue_arrayElement_setNeedsUpdate,Zn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Zn.prototype._setValue_fromArray,Zn.prototype._setValue_fromArray_setNeedsUpdate,Zn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var Hw=class{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Yo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;let e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};let t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){let e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,o=this._bindings,s=o.length,a,c=e.length,l=this.nCachedObjects_;for(let u=0,d=arguments.length;u!==d;++u){let h=arguments[u],f=h.uuid,g=t[f];if(g===void 0){g=c++,t[f]=g,e.push(h);for(let _=0,m=s;_!==m;++_)o[_].push(new Zn(h,n[_],r[_]))}else if(g<l){a=e[g];let _=--l,m=e[_];t[m.uuid]=g,e[g]=m,t[f]=_,e[_]=h;for(let p=0,b=s;p!==b;++p){let v=o[p],y=v[_],w=v[g];v[g]=y,w===void 0&&(w=new Zn(h,n[p],r[p])),v[_]=w}}else e[g]!==a&&bt("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){let e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,o=this.nCachedObjects_;for(let s=0,a=arguments.length;s!==a;++s){let c=arguments[s],l=c.uuid,u=t[l];if(u!==void 0&&u>=o){let d=o++,h=e[d];t[h.uuid]=u,e[u]=h,t[l]=d,e[d]=c;for(let f=0,g=r;f!==g;++f){let _=n[f],m=_[d],p=_[u];_[u]=m,_[d]=p}}}this.nCachedObjects_=o}uncache(){let e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,o=this.nCachedObjects_,s=e.length;for(let a=0,c=arguments.length;a!==c;++a){let l=arguments[a],u=l.uuid,d=t[u];if(d!==void 0)if(delete t[u],d<o){let h=--o,f=e[h],g=--s,_=e[g];t[f.uuid]=d,e[d]=f,t[_.uuid]=h,e[h]=_,e.pop();for(let m=0,p=r;m!==p;++m){let b=n[m],v=b[h],y=b[g];b[d]=v,b[h]=y,b.pop()}}else{let h=--s,f=e[h];h>0&&(t[f.uuid]=d),e[d]=f,e.pop();for(let g=0,_=r;g!==_;++g){let m=n[g];m[d]=m[h],m.pop()}}}this.nCachedObjects_=o}subscribe_(e,t){let n=this._bindingsIndicesByPath,r=n[e],o=this._bindings;if(r!==void 0)return o[r];let s=this._paths,a=this._parsedPaths,c=this._objects,l=c.length,u=this.nCachedObjects_,d=new Array(l);r=o.length,n[e]=r,s.push(e),a.push(t),o.push(d);for(let h=u,f=c.length;h!==f;++h){let g=c[h];d[h]=new Zn(g,e,t)}return d}unsubscribe_(e){let t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){let r=this._paths,o=this._parsedPaths,s=this._bindings,a=s.length-1,c=s[a],l=e[a];t[l]=n,s[n]=c,s.pop(),o[n]=o[a],o.pop(),r[n]=r[a],r.pop()}}},ub=class{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;let o=t.tracks,s=o.length,a=new Array(s),c={endingStart:Kl,endingEnd:Kl};for(let l=0;l!==s;++l){let u=o[l].createInterpolant(null);a[l]=u,u.settings=c}this._interpolantSettings=c,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=tI,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){let r=this._clip.duration,o=e._clip.duration,s=o/r,a=r/o;e.warp(1,s,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){let e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){let r=this._mixer,o=r.time,s=this.timeScale,a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);let c=a.parameterPositions,l=a.sampleValues;return c[0]=o,c[1]=o+n,l[0]=e/s,l[1]=t/s,this}stopWarping(){let e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled){this._updateWeight(e);return}let o=this._startTime;if(o!==null){let c=(e-o)*n;c<0||n===0?t=0:(this._startTime=null,t=n*c)}t*=this._updateTimeScale(e);let s=this._updateTime(t),a=this._updateWeight(e);if(a>0){let c=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case DM:for(let u=0,d=c.length;u!==d;++u)c[u].evaluate(s),l[u].accumulateAdditive(a);break;case iv:default:for(let u=0,d=c.length;u!==d;++u)c[u].evaluate(s),l[u].accumulate(r,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let n=this._weightInterpolant;if(n!==null){let r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let n=this._timeScaleInterpolant;if(n!==null){let r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,n=this.loop,r=this.time+e,o=this._loopCount,s=n===nI;if(e===0)return o===-1?r:s&&(o&1)===1?t-r:r;if(n===nv){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(o===-1&&(e>=0?(o=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),r>=t||r<0){let a=Math.floor(r/t);r-=t*a,o+=Math.abs(a);let c=this.repetitions-o;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(c===1){let l=e<0;this._setEndings(l,!l,s)}else this._setEndings(!1,!1,s);this._loopCount=o,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(s&&(o&1)===1)return t-r}return r}_setEndings(e,t,n){let r=this._interpolantSettings;n?(r.endingStart=Jl,r.endingEnd=Jl):(e?r.endingStart=this.zeroSlopeAtStart?Jl:Kl:r.endingStart=ip,t?r.endingEnd=this.zeroSlopeAtEnd?Jl:Kl:r.endingEnd=ip)}_scheduleFading(e,t,n){let r=this._mixer,o=r.time,s=this._weightInterpolant;s===null&&(s=r._lendControlInterpolant(),this._weightInterpolant=s);let a=s.parameterPositions,c=s.sampleValues;return a[0]=o,c[0]=t,a[1]=o+e,c[1]=n,this}},z7=new Float32Array(1),Ip=class extends Ko{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let n=e._localRoot||this._root,r=e._clip.tracks,o=r.length,s=e._propertyBindings,a=e._interpolants,c=n.uuid,l=this._bindingsByRootAndName,u=l[c];u===void 0&&(u={},l[c]=u);for(let d=0;d!==o;++d){let h=r[d],f=h.name,g=u[f];if(g!==void 0)++g.referenceCount,s[d]=g;else{if(g=s[d],g!==void 0){g._cacheIndex===null&&(++g.referenceCount,this._addInactiveBinding(g,c,f));continue}let _=t&&t._propertyBindings[d].binding.parsedPath;g=new lb(Zn.create(n,f,_),h.ValueTypeName,h.getValueSize()),++g.referenceCount,this._addInactiveBinding(g,c,f),s[d]=g}a[d].resultBuffer=g.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){let n=(e._localRoot||this._root).uuid,r=e._clip.uuid,o=this._actionsByClip[r];this._bindAction(e,o&&o.knownActions[0]),this._addInactiveAction(e,r,n)}let t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){let o=t[n];o.useCount++===0&&(this._lendBinding(o),o.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){let o=t[n];--o.useCount===0&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){let r=this._actions,o=this._actionsByClip,s=o[t];if(s===void 0)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,o[t]=s;else{let a=s.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),s.actionByRoot[n]=e}_removeInactiveAction(e){let t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;let o=e._clip.uuid,s=this._actionsByClip,a=s[o],c=a.knownActions,l=c[c.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,c[u]=l,c.pop(),e._byClipCacheIndex=null;let d=a.actionByRoot,h=(e._localRoot||this._root).uuid;delete d[h],c.length===0&&delete s[o],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){let o=t[n];--o.referenceCount===0&&this._removeInactiveBinding(o)}}_lendAction(e){let t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=n,t[n]=o}_takeBackAction(e){let t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=n,t[n]=o}_addInactiveBinding(e,t,n){let r=this._bindingsByRootAndName,o=this._bindings,s=r[t];s===void 0&&(s={},r[t]=s),s[n]=e,e._cacheIndex=o.length,o.push(e)}_removeInactiveBinding(e){let t=this._bindings,n=e.binding,r=n.rootNode.uuid,o=n.path,s=this._bindingsByRootAndName,a=s[r],c=t[t.length-1],l=e._cacheIndex;c._cacheIndex=l,t[l]=c,t.pop(),delete a[o],Object.keys(a).length===0&&delete s[r]}_lendBinding(e){let t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=n,t[n]=o}_takeBackBinding(e){let t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=n,t[n]=o}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return n===void 0&&(n=new Mp(new Float32Array(2),new Float32Array(2),1,z7),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){let t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,o=t[r];e.__cacheIndex=r,t[r]=e,o.__cacheIndex=n,t[n]=o}clipAction(e,t,n){let r=t||this._root,o=r.uuid,s=typeof e=="string"?nc.findByName(r,e):e,a=s!==null?s.uuid:e,c=this._actionsByClip[a],l=null;if(n===void 0&&(s!==null?n=s.blendMode:n=iv),c!==void 0){let d=c.actionByRoot[o];if(d!==void 0&&d.blendMode===n)return d;l=c.knownActions[0],s===null&&(s=l._clip)}if(s===null)return null;let u=new ub(this,s,t,n);return this._bindAction(u,l),this._addInactiveAction(u,a,o),u}existingAction(e,t){let n=t||this._root,r=n.uuid,o=typeof e=="string"?nc.findByName(n,e):e,s=o?o.uuid:e,a=this._actionsByClip[s];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){let e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;let t=this._actions,n=this._nActiveActions,r=this.time+=e,o=Math.sign(e),s=this._accuIndex^=1;for(let l=0;l!==n;++l)t[l]._update(r,e,o,s);let a=this._bindings,c=this._nActiveBindings;for(let l=0;l!==c;++l)a[l].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,n=e.uuid,r=this._actionsByClip,o=r[n];if(o!==void 0){let s=o.knownActions;for(let a=0,c=s.length;a!==c;++a){let l=s[a];this._deactivateAction(l);let u=l._cacheIndex,d=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,d._cacheIndex=u,t[u]=d,t.pop(),this._removeInactiveBindingsForAction(l)}delete r[n]}}uncacheRoot(e){let t=e.uuid,n=this._actionsByClip;for(let s in n){let a=n[s].actionByRoot,c=a[t];c!==void 0&&(this._deactivateAction(c),this._removeInactiveAction(c))}let r=this._bindingsByRootAndName,o=r[t];if(o!==void 0)for(let s in o){let a=o[s];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){let n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}},Gw=class extends cp{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isRenderTarget3D=!0,this.depth=n,this.texture=new Qd(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}},Ww=class i{constructor(e){this.value=e}clone(){return new i(this.value.clone===void 0?this.value:this.value.clone())}},H7=0,$w=class extends Ko{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:H7++}),this.name="",this.usage=op,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){let t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;let t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++){let o=Array.isArray(t[n])?t[n]:[t[n]];for(let s=0;s<o.length;s++)this.uniforms.push(o[s].clone())}return this}clone(){return new this.constructor().copy(this)}},qw=class extends xs{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){let t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){let t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}},Xw=class{constructor(e,t,n,r,o,s=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=o,this.normalized=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}},oB=new Ee,Dr=class{constructor(e,t,n=0,r=1/0){this.ray=new sa(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new Kd,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):bt("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return oB.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(oB),this}intersectObject(e,t=!0,n=[]){return N1(e,this,n,t),n.sort(sB),n}intersectObjects(e,t=!0,n=[]){for(let r=0,o=e.length;r<o;r++)N1(e[r],this,n,t);return n.sort(sB),n}};function sB(i,e){return i.distance-e.distance}function N1(i,e,t,n){let r=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(r=!1),r===!0&&n===!0){let o=i.children;for(let s=0,a=o.length;s<a;s++)N1(o[s],e,t,!0)}}var Zw=class{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=G7.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}};function G7(){this._document.hidden===!1&&this.reset()}var Qc=class{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Bt(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Bt(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},Yw=class{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}},Qw=class i{constructor(e,t,n,r){i.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){let o=this.elements;return o[0]=e,o[2]=t,o[1]=n,o[3]=r,this}},aB=new z,Kw=class{constructor(e=new z(1/0,1/0),t=new z(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let n=aB.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,aB).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},cB=new C,cw=new C,Jf=new C,ep=new C,y1=new C,W7=new C,$7=new C,Jw=class{constructor(e=new C,t=new C){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){cB.subVectors(e,this.start),cw.subVectors(this.end,this.start);let n=cw.dot(cw),o=cw.dot(cB)/n;return t&&(o=Bt(o,0,1)),o}closestPointToPoint(e,t,n){let r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}distanceSqToLine3(e,t=W7,n=$7){let r=10000000000000001e-32,o,s,a=this.start,c=e.start,l=this.end,u=e.end;Jf.subVectors(l,a),ep.subVectors(u,c),y1.subVectors(a,c);let d=Jf.dot(Jf),h=ep.dot(ep),f=ep.dot(y1);if(d<=r&&h<=r)return t.copy(a),n.copy(c),t.sub(n),t.dot(t);if(d<=r)o=0,s=f/h,s=Bt(s,0,1);else{let g=Jf.dot(y1);if(h<=r)s=0,o=Bt(-g/d,0,1);else{let _=Jf.dot(ep),m=d*h-_*_;m!==0?o=Bt((_*f-g*h)/m,0,1):o=0,s=(_*o+f)/h,s<0?(s=0,o=Bt(-g/d,0,1)):s>1&&(s=1,o=Bt((_-g)/d,0,1))}}return t.copy(a).add(Jf.multiplyScalar(o)),n.copy(c).add(ep.multiplyScalar(s)),t.sub(n),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},lB=new C,eM=class extends wt{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let n=new nt,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,a=1,c=32;s<c;s++,a++){let l=s/c*Math.PI*2,u=a/c*Math.PI*2;r.push(Math.cos(l),Math.sin(l),1,Math.cos(u),Math.sin(u),1)}n.setAttribute("position",new Oe(r,3));let o=new mi({fog:!1,toneMapped:!1});this.cone=new Lr(n,o),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),lB.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(lB),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},Yl=new C,lw=new Ee,x1=new Ee,tM=class extends Lr{constructor(e){let t=u3(e),n=new nt,r=[],o=[];for(let l=0;l<t.length;l++){let u=t[l];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),o.push(0,0,0),o.push(0,0,0))}n.setAttribute("position",new Oe(r,3)),n.setAttribute("color",new Oe(o,3));let s=new mi({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,s),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;let a=new ue(255),c=new ue(65280);this.setColors(a,c)}updateMatrixWorld(e){let t=this.bones,n=this.geometry,r=n.getAttribute("position");x1.copy(this.root.matrixWorld).invert();for(let o=0,s=0;o<t.length;o++){let a=t[o];a.parent&&a.parent.isBone&&(lw.multiplyMatrices(x1,a.matrixWorld),Yl.setFromMatrixPosition(lw),r.setXYZ(s,Yl.x,Yl.y,Yl.z),lw.multiplyMatrices(x1,a.parent.matrixWorld),Yl.setFromMatrixPosition(lw),r.setXYZ(s+1,Yl.x,Yl.y,Yl.z),s+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){let r=this.geometry.getAttribute("color");for(let o=0;o<r.count;o+=2)r.setXYZ(o,e.r,e.g,e.b),r.setXYZ(o+1,t.r,t.g,t.b);return r.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}};function u3(i){let e=[];i.isBone===!0&&e.push(i);for(let t=0;t<i.children.length;t++)e.push(...u3(i.children[t]));return e}var nM=class extends Pe{constructor(e,t,n){let r=new Ka(t,4,2),o=new ci({wireframe:!0,fog:!1,toneMapped:!1});super(r,o),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},q7=new C,uB=new ue,dB=new ue,iM=class extends wt{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";let r=new ca(t);r.rotateY(Math.PI*.5),this.material=new ci({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);let o=r.getAttribute("position"),s=new Float32Array(o.count*3);r.setAttribute("color",new pn(s,3)),this.add(new Pe(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){let e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{let t=e.geometry.getAttribute("color");uB.copy(this.light.color),dB.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){let o=n<r/2?uB:dB;t.setXYZ(n,o.r,o.g,o.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(q7.setFromMatrixPosition(this.light.matrixWorld).negate())}},fu=class extends Lr{constructor(e=10,t=10,n=4473924,r=8947848){n=new ue(n),r=new ue(r);let o=t/2,s=e/t,a=e/2,c=[],l=[];for(let h=0,f=0,g=-a;h<=t;h++,g+=s){c.push(-a,0,g,a,0,g),c.push(g,0,-a,g,0,a);let _=h===o?n:r;_.toArray(l,f),f+=3,_.toArray(l,f),f+=3,_.toArray(l,f),f+=3,_.toArray(l,f),f+=3}let u=new nt;u.setAttribute("position",new Oe(c,3)),u.setAttribute("color",new Oe(l,3));let d=new mi({vertexColors:!0,toneMapped:!1});super(u,d),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}},rM=class extends Lr{constructor(e=10,t=16,n=8,r=64,o=4473924,s=8947848){o=new ue(o),s=new ue(s);let a=[],c=[];if(t>1)for(let d=0;d<t;d++){let h=d/t*(Math.PI*2),f=Math.sin(h)*e,g=Math.cos(h)*e;a.push(0,0,0),a.push(f,0,g);let _=d&1?o:s;c.push(_.r,_.g,_.b),c.push(_.r,_.g,_.b)}for(let d=0;d<n;d++){let h=d&1?o:s,f=e-e/n*d;for(let g=0;g<r;g++){let _=g/r*(Math.PI*2),m=Math.sin(_)*f,p=Math.cos(_)*f;a.push(m,0,p),c.push(h.r,h.g,h.b),_=(g+1)/r*(Math.PI*2),m=Math.sin(_)*f,p=Math.cos(_)*f,a.push(m,0,p),c.push(h.r,h.g,h.b)}}let l=new nt;l.setAttribute("position",new Oe(a,3)),l.setAttribute("color",new Oe(c,3));let u=new mi({vertexColors:!0,toneMapped:!1});super(l,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}},hB=new C,uw=new C,fB=new C,oM=class extends wt{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new nt;r.setAttribute("position",new Oe([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let o=new mi({fog:!1,toneMapped:!1});this.lightPlane=new ti(r,o),this.add(this.lightPlane),r=new nt,r.setAttribute("position",new Oe([0,0,0,0,0,1],3)),this.targetLine=new ti(r,o),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),hB.setFromMatrixPosition(this.light.matrixWorld),uw.setFromMatrixPosition(this.light.target.matrixWorld),fB.subVectors(uw,hB),this.lightPlane.lookAt(uw),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(uw),this.targetLine.scale.z=fB.length()}},dw=new C,Hi=new qc,sM=class extends Lr{constructor(e){let t=new nt,n=new mi({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],o=[],s={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(g,_){c(g),c(_)}function c(g){r.push(0,0,0),o.push(0,0,0),s[g]===void 0&&(s[g]=[]),s[g].push(r.length/3-1)}t.setAttribute("position",new Oe(r,3)),t.setAttribute("color",new Oe(o,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();let l=new ue(16755200),u=new ue(16711680),d=new ue(43775),h=new ue(16777215),f=new ue(3355443);this.setColors(l,u,d,h,f)}setColors(e,t,n,r,o){let a=this.geometry.getAttribute("color");return a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,o.r,o.g,o.b),a.setXYZ(41,o.r,o.g,o.b),a.setXYZ(42,o.r,o.g,o.b),a.setXYZ(43,o.r,o.g,o.b),a.setXYZ(44,o.r,o.g,o.b),a.setXYZ(45,o.r,o.g,o.b),a.setXYZ(46,o.r,o.g,o.b),a.setXYZ(47,o.r,o.g,o.b),a.setXYZ(48,o.r,o.g,o.b),a.setXYZ(49,o.r,o.g,o.b),a.needsUpdate=!0,this}update(){let e=this.geometry,t=this.pointMap,n=1,r=1,o,s;if(Hi.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)o=1,s=0;else if(this.camera.coordinateSystem===Io)o=-1,s=1;else if(this.camera.coordinateSystem===qd)o=0,s=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);qi("c",t,e,Hi,0,0,o),qi("t",t,e,Hi,0,0,s),qi("n1",t,e,Hi,-n,-r,o),qi("n2",t,e,Hi,n,-r,o),qi("n3",t,e,Hi,-n,r,o),qi("n4",t,e,Hi,n,r,o),qi("f1",t,e,Hi,-n,-r,s),qi("f2",t,e,Hi,n,-r,s),qi("f3",t,e,Hi,-n,r,s),qi("f4",t,e,Hi,n,r,s),qi("u1",t,e,Hi,n*.7,r*1.1,o),qi("u2",t,e,Hi,-n*.7,r*1.1,o),qi("u3",t,e,Hi,0,r*2,o),qi("cf1",t,e,Hi,-n,0,s),qi("cf2",t,e,Hi,n,0,s),qi("cf3",t,e,Hi,0,-r,s),qi("cf4",t,e,Hi,0,r,s),qi("cn1",t,e,Hi,-n,0,o),qi("cn2",t,e,Hi,n,0,o),qi("cn3",t,e,Hi,0,-r,o),qi("cn4",t,e,Hi,0,r,o),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function qi(i,e,t,n,r,o,s){dw.set(r,o,s).unproject(n);let a=e[i];if(a!==void 0){let c=t.getAttribute("position");for(let l=0,u=a.length;l<u;l++)c.setXYZ(a[l],dw.x,dw.y,dw.z)}}var hw=new wi,aM=class extends Lr{constructor(e,t=16776960){let n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),o=new nt;o.setIndex(new pn(n,1)),o.setAttribute("position",new pn(r,3)),super(o,new mi({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&hw.setFromObject(this.object),hw.isEmpty())return;let e=hw.min,t=hw.max,n=this.geometry.attributes.position,r=n.array;r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=e.x,r[4]=t.y,r[5]=t.z,r[6]=e.x,r[7]=e.y,r[8]=t.z,r[9]=t.x,r[10]=e.y,r[11]=t.z,r[12]=t.x,r[13]=t.y,r[14]=e.z,r[15]=e.x,r[16]=t.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=t.x,r[22]=e.y,r[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}},Ap=class extends Lr{constructor(e,t=16776960){let n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],o=new nt;o.setIndex(new pn(n,1)),o.setAttribute("position",new Oe(r,3)),super(o,new mi({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},cM=class extends ti{constructor(e,t=1,n=16776960){let r=n,o=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],s=new nt;s.setAttribute("position",new Oe(o,3)),s.computeBoundingSphere(),super(s,new mi({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;let a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],c=new nt;c.setAttribute("position",new Oe(a,3)),c.computeBoundingSphere(),this.add(new Pe(c,new ci({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}},pB=new C,fw,w1,lM=class extends wt{constructor(e=new C(0,0,1),t=new C(0,0,0),n=1,r=16776960,o=n*.2,s=o*.2){super(),this.type="ArrowHelper",fw===void 0&&(fw=new nt,fw.setAttribute("position",new Oe([0,0,0,0,1,0],3)),w1=new pp(.5,1,5,1),w1.translate(0,-.5,0)),this.position.copy(t),this.line=new ti(fw,new mi({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Pe(w1,new ci({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,o,s)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{pB.set(e.z,0,-e.x).normalize();let t=Math.acos(e.y);this.quaternion.setFromAxisAngle(pB,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}},uM=class extends Lr{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new nt;r.setAttribute("position",new Oe(t,3)),r.setAttribute("color",new Oe(n,3));let o=new mi({vertexColors:!0,toneMapped:!1});super(r,o),this.type="AxesHelper"}setColors(e,t,n){let r=new ue,o=this.geometry.attributes.color.array;return r.set(e),r.toArray(o,0),r.toArray(o,3),r.set(t),r.toArray(o,6),r.toArray(o,9),r.set(n),r.toArray(o,12),r.toArray(o,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},dM=class{constructor(){this.type="ShapePath",this.color=new ue,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new ch,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,o,s){return this.currentPath.bezierCurveTo(e,t,n,r,o,s),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(p){let b=[];for(let v=0,y=p.length;v<y;v++){let w=p[v],R=new Qa;R.curves=w.curves,b.push(R)}return b}function n(p,b){let v=b.length,y=!1;for(let w=v-1,R=0;R<v;w=R++){let E=b[w],A=b[R],x=A.x-E.x,T=A.y-E.y;if(Math.abs(T)>Number.EPSILON){if(T<0&&(E=b[R],x=-x,A=b[w],T=-T),p.y<E.y||p.y>A.y)continue;if(p.y===E.y){if(p.x===E.x)return!0}else{let P=T*(p.x-E.x)-x*(p.y-E.y);if(P===0)return!0;if(P<0)continue;y=!y}}else{if(p.y!==E.y)continue;if(A.x<=p.x&&p.x<=E.x||E.x<=p.x&&p.x<=A.x)return!0}}return y}let r=bs.isClockWise,o=this.subPaths;if(o.length===0)return[];let s,a,c,l=[];if(o.length===1)return a=o[0],c=new Qa,c.curves=a.curves,l.push(c),l;let u=!r(o[0].getPoints());u=e?!u:u;let d=[],h=[],f=[],g=0,_;h[g]=void 0,f[g]=[];for(let p=0,b=o.length;p<b;p++)a=o[p],_=a.getPoints(),s=r(_),s=e?!s:s,s?(!u&&h[g]&&g++,h[g]={s:new Qa,p:_},h[g].s.curves=a.curves,u&&g++,f[g]=[]):f[g].push({h:a,p:_[0]});if(!h[0])return t(o);if(h.length>1){let p=!1,b=0;for(let v=0,y=h.length;v<y;v++)d[v]=[];for(let v=0,y=h.length;v<y;v++){let w=f[v];for(let R=0;R<w.length;R++){let E=w[R],A=!0;for(let x=0;x<h.length;x++)n(E.p,h[x].p)&&(v!==x&&b++,A?(A=!1,d[x].push(E)):p=!0);A&&d[v].push(E)}}b>0&&p===!1&&(f=d)}let m;for(let p=0,b=h.length;p<b;p++){c=h[p].s,l.push(c),m=f[p];for(let v=0,y=m.length;v<y;v++)c.holes.push(m[v].h)}return l}},Ir=class extends Ko{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){Ue("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}};function X7(i,e){let t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2):(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0),i}function Z7(i,e){let t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0):(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2),i}function Y7(i){return i.repeat.x=1,i.repeat.y=1,i.offset.x=0,i.offset.y=0,i}function FM(i,e,t,n){let r=Q7(n);switch(t){case CM:return i*e;case nl:return i*e/r.components*r.byteLength;case Lp:return i*e/r.components*r.byteLength;case _u:return i*e*2/r.components*r.byteLength;case wb:return i*e*2/r.components*r.byteLength;case EM:return i*e*3/r.components*r.byteLength;case Gr:return i*e*4/r.components*r.byteLength;case Mb:return i*e*4/r.components*r.byteLength;case kp:case Bp:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case Up:case Vp:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case Rb:case Cb:return Math.max(i,16)*Math.max(e,8)/4;case Sb:case Tb:return Math.max(i,8)*Math.max(e,8)/2;case Eb:case Db:case Ab:case Pb:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case Ib:case Fb:case Nb:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case jb:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case Ob:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case Lb:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case kb:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case Bb:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case Ub:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case Vb:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case zb:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case Hb:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case Gb:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case Wb:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case $b:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case qb:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case Xb:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case Zb:case Yb:case Qb:return Math.ceil(i/4)*Math.ceil(e/4)*16;case Kb:case Jb:return Math.ceil(i/4)*Math.ceil(e/4)*8;case ev:case tv:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function Q7(i){switch(i){case _o:case MM:return{byteLength:1,components:1};case tl:case SM:case An:return{byteLength:2,components:1};case yb:case xb:return{byteLength:2,components:4};case es:case vb:case tr:return{byteLength:4,components:1};case RM:case TM:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}var hM=class{static contain(e,t){return X7(e,t)}static cover(e,t){return Z7(e,t)}static fill(e){return Y7(e)}static getByteLength(e,t,n,r){return FM(e,t,n,r)}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:db}}));typeof window<"u"&&(window.__THREE__?Ue("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=db);function F3(){let i=null,e=!1,t=null,n=null;function r(o,s){t(o,s),n=i.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(o){t=o},setContext:function(o){i=o}}}function K7(i){let e=new WeakMap;function t(a,c){let l=a.array,u=a.usage,d=l.byteLength,h=i.createBuffer();i.bindBuffer(c,h),i.bufferData(c,l,u),a.onUploadCallback();let f;if(l instanceof Float32Array)f=i.FLOAT;else if(typeof Float16Array<"u"&&l instanceof Float16Array)f=i.HALF_FLOAT;else if(l instanceof Uint16Array)a.isFloat16BufferAttribute?f=i.HALF_FLOAT:f=i.UNSIGNED_SHORT;else if(l instanceof Int16Array)f=i.SHORT;else if(l instanceof Uint32Array)f=i.UNSIGNED_INT;else if(l instanceof Int32Array)f=i.INT;else if(l instanceof Int8Array)f=i.BYTE;else if(l instanceof Uint8Array)f=i.UNSIGNED_BYTE;else if(l instanceof Uint8ClampedArray)f=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+l);return{buffer:h,type:f,bytesPerElement:l.BYTES_PER_ELEMENT,version:a.version,size:d}}function n(a,c,l){let u=c.array,d=c.updateRanges;if(i.bindBuffer(l,a),d.length===0)i.bufferSubData(l,0,u);else{d.sort((f,g)=>f.start-g.start);let h=0;for(let f=1;f<d.length;f++){let g=d[h],_=d[f];_.start<=g.start+g.count+1?g.count=Math.max(g.count,_.start+_.count-g.start):(++h,d[h]=_)}d.length=h+1;for(let f=0,g=d.length;f<g;f++){let _=d[f];i.bufferSubData(l,_.start*u.BYTES_PER_ELEMENT,u,_.start,_.count)}c.clearUpdateRanges()}c.onUploadCallback()}function r(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function o(a){a.isInterleavedBufferAttribute&&(a=a.data);let c=e.get(a);c&&(i.deleteBuffer(c.buffer),e.delete(a))}function s(a,c){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){let u=e.get(a);(!u||u.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}let l=e.get(a);if(l===void 0)e.set(a,t(a,c));else if(l.version<a.version){if(l.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(l.buffer,a,c),l.version=a.version}}return{get:r,remove:o,update:s}}var J7=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,eX=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,tX=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,nX=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,iX=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,rX=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,oX=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,sX=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,aX=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,cX=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,lX=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,uX=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,dX=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,hX=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,fX=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,pX=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,mX=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,gX=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,_X=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,bX=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,vX=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,yX=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,xX=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,wX=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,MX=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,SX=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,RX=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,TX=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,CX=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,EX=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,DX="gl_FragColor = linearToOutputTexel( gl_FragColor );",IX=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,AX=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,PX=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,FX=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,NX=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,jX=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,OX=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,LX=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,kX=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,BX=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,UX=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,VX=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,zX=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,HX=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,GX=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,WX=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,$X=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,qX=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,XX=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,ZX=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,YX=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,QX=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,KX=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,JX=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,eZ=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,tZ=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,nZ=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,iZ=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,rZ=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,oZ=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,sZ=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,aZ=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,cZ=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,lZ=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,uZ=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,dZ=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,hZ=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,fZ=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,pZ=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,mZ=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,gZ=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,_Z=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,bZ=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,vZ=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,yZ=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,xZ=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,wZ=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,MZ=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,SZ=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,RZ=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,TZ=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,CZ=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,EZ=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,DZ=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,IZ=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,AZ=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,PZ=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,FZ=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,NZ=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadow = step( depth, dp );
			#else
				shadow = step( dp, depth );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,jZ=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,OZ=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,LZ=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,kZ=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,BZ=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,UZ=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,VZ=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,zZ=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,HZ=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,GZ=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,WZ=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,$Z=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,qZ=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,XZ=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,ZZ=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,YZ=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,QZ=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,KZ=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,JZ=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,eY=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,tY=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,nY=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,iY=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,rY=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,oY=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,sY=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,aY=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,cY=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,lY=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,uY=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,dY=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,hY=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fY=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pY=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,mY=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gY=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,_Y=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,bY=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,vY=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,yY=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,xY=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,wY=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,MY=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,SY=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,RY=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,TY=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,CY=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,EY=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,DY=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,IY=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,AY=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,fn={alphahash_fragment:J7,alphahash_pars_fragment:eX,alphamap_fragment:tX,alphamap_pars_fragment:nX,alphatest_fragment:iX,alphatest_pars_fragment:rX,aomap_fragment:oX,aomap_pars_fragment:sX,batching_pars_vertex:aX,batching_vertex:cX,begin_vertex:lX,beginnormal_vertex:uX,bsdfs:dX,iridescence_fragment:hX,bumpmap_pars_fragment:fX,clipping_planes_fragment:pX,clipping_planes_pars_fragment:mX,clipping_planes_pars_vertex:gX,clipping_planes_vertex:_X,color_fragment:bX,color_pars_fragment:vX,color_pars_vertex:yX,color_vertex:xX,common:wX,cube_uv_reflection_fragment:MX,defaultnormal_vertex:SX,displacementmap_pars_vertex:RX,displacementmap_vertex:TX,emissivemap_fragment:CX,emissivemap_pars_fragment:EX,colorspace_fragment:DX,colorspace_pars_fragment:IX,envmap_fragment:AX,envmap_common_pars_fragment:PX,envmap_pars_fragment:FX,envmap_pars_vertex:NX,envmap_physical_pars_fragment:WX,envmap_vertex:jX,fog_vertex:OX,fog_pars_vertex:LX,fog_fragment:kX,fog_pars_fragment:BX,gradientmap_pars_fragment:UX,lightmap_pars_fragment:VX,lights_lambert_fragment:zX,lights_lambert_pars_fragment:HX,lights_pars_begin:GX,lights_toon_fragment:$X,lights_toon_pars_fragment:qX,lights_phong_fragment:XX,lights_phong_pars_fragment:ZX,lights_physical_fragment:YX,lights_physical_pars_fragment:QX,lights_fragment_begin:KX,lights_fragment_maps:JX,lights_fragment_end:eZ,logdepthbuf_fragment:tZ,logdepthbuf_pars_fragment:nZ,logdepthbuf_pars_vertex:iZ,logdepthbuf_vertex:rZ,map_fragment:oZ,map_pars_fragment:sZ,map_particle_fragment:aZ,map_particle_pars_fragment:cZ,metalnessmap_fragment:lZ,metalnessmap_pars_fragment:uZ,morphinstance_vertex:dZ,morphcolor_vertex:hZ,morphnormal_vertex:fZ,morphtarget_pars_vertex:pZ,morphtarget_vertex:mZ,normal_fragment_begin:gZ,normal_fragment_maps:_Z,normal_pars_fragment:bZ,normal_pars_vertex:vZ,normal_vertex:yZ,normalmap_pars_fragment:xZ,clearcoat_normal_fragment_begin:wZ,clearcoat_normal_fragment_maps:MZ,clearcoat_pars_fragment:SZ,iridescence_pars_fragment:RZ,opaque_fragment:TZ,packing:CZ,premultiplied_alpha_fragment:EZ,project_vertex:DZ,dithering_fragment:IZ,dithering_pars_fragment:AZ,roughnessmap_fragment:PZ,roughnessmap_pars_fragment:FZ,shadowmap_pars_fragment:NZ,shadowmap_pars_vertex:jZ,shadowmap_vertex:OZ,shadowmask_pars_fragment:LZ,skinbase_vertex:kZ,skinning_pars_vertex:BZ,skinning_vertex:UZ,skinnormal_vertex:VZ,specularmap_fragment:zZ,specularmap_pars_fragment:HZ,tonemapping_fragment:GZ,tonemapping_pars_fragment:WZ,transmission_fragment:$Z,transmission_pars_fragment:qZ,uv_pars_fragment:XZ,uv_pars_vertex:ZZ,uv_vertex:YZ,worldpos_vertex:QZ,background_vert:KZ,background_frag:JZ,backgroundCube_vert:eY,backgroundCube_frag:tY,cube_vert:nY,cube_frag:iY,depth_vert:rY,depth_frag:oY,distance_vert:sY,distance_frag:aY,equirect_vert:cY,equirect_frag:lY,linedashed_vert:uY,linedashed_frag:dY,meshbasic_vert:hY,meshbasic_frag:fY,meshlambert_vert:pY,meshlambert_frag:mY,meshmatcap_vert:gY,meshmatcap_frag:_Y,meshnormal_vert:bY,meshnormal_frag:vY,meshphong_vert:yY,meshphong_frag:xY,meshphysical_vert:wY,meshphysical_frag:MY,meshtoon_vert:SY,meshtoon_frag:RY,points_vert:TY,points_frag:CY,shadow_vert:EY,shadow_frag:DY,sprite_vert:IY,sprite_frag:AY},We={common:{diffuse:{value:new ue(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Yt},alphaMap:{value:null},alphaMapTransform:{value:new Yt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Yt}},envmap:{envMap:{value:null},envMapRotation:{value:new Yt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Yt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Yt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Yt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Yt},normalScale:{value:new z(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Yt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Yt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Yt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Yt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ue(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ue(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Yt},alphaTest:{value:0},uvTransform:{value:new Yt}},sprite:{diffuse:{value:new ue(16777215)},opacity:{value:1},center:{value:new z(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Yt},alphaMap:{value:null},alphaMapTransform:{value:new Yt},alphaTest:{value:0}}},ba={basic:{uniforms:Xr([We.common,We.specularmap,We.envmap,We.aomap,We.lightmap,We.fog]),vertexShader:fn.meshbasic_vert,fragmentShader:fn.meshbasic_frag},lambert:{uniforms:Xr([We.common,We.specularmap,We.envmap,We.aomap,We.lightmap,We.emissivemap,We.bumpmap,We.normalmap,We.displacementmap,We.fog,We.lights,{emissive:{value:new ue(0)}}]),vertexShader:fn.meshlambert_vert,fragmentShader:fn.meshlambert_frag},phong:{uniforms:Xr([We.common,We.specularmap,We.envmap,We.aomap,We.lightmap,We.emissivemap,We.bumpmap,We.normalmap,We.displacementmap,We.fog,We.lights,{emissive:{value:new ue(0)},specular:{value:new ue(1118481)},shininess:{value:30}}]),vertexShader:fn.meshphong_vert,fragmentShader:fn.meshphong_frag},standard:{uniforms:Xr([We.common,We.envmap,We.aomap,We.lightmap,We.emissivemap,We.bumpmap,We.normalmap,We.displacementmap,We.roughnessmap,We.metalnessmap,We.fog,We.lights,{emissive:{value:new ue(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:fn.meshphysical_vert,fragmentShader:fn.meshphysical_frag},toon:{uniforms:Xr([We.common,We.aomap,We.lightmap,We.emissivemap,We.bumpmap,We.normalmap,We.displacementmap,We.gradientmap,We.fog,We.lights,{emissive:{value:new ue(0)}}]),vertexShader:fn.meshtoon_vert,fragmentShader:fn.meshtoon_frag},matcap:{uniforms:Xr([We.common,We.bumpmap,We.normalmap,We.displacementmap,We.fog,{matcap:{value:null}}]),vertexShader:fn.meshmatcap_vert,fragmentShader:fn.meshmatcap_frag},points:{uniforms:Xr([We.points,We.fog]),vertexShader:fn.points_vert,fragmentShader:fn.points_frag},dashed:{uniforms:Xr([We.common,We.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:fn.linedashed_vert,fragmentShader:fn.linedashed_frag},depth:{uniforms:Xr([We.common,We.displacementmap]),vertexShader:fn.depth_vert,fragmentShader:fn.depth_frag},normal:{uniforms:Xr([We.common,We.bumpmap,We.normalmap,We.displacementmap,{opacity:{value:1}}]),vertexShader:fn.meshnormal_vert,fragmentShader:fn.meshnormal_frag},sprite:{uniforms:Xr([We.sprite,We.fog]),vertexShader:fn.sprite_vert,fragmentShader:fn.sprite_frag},background:{uniforms:{uvTransform:{value:new Yt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:fn.background_vert,fragmentShader:fn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Yt}},vertexShader:fn.backgroundCube_vert,fragmentShader:fn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:fn.cube_vert,fragmentShader:fn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:fn.equirect_vert,fragmentShader:fn.equirect_frag},distance:{uniforms:Xr([We.common,We.displacementmap,{referencePosition:{value:new C},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:fn.distance_vert,fragmentShader:fn.distance_frag},shadow:{uniforms:Xr([We.lights,We.fog,{color:{value:new ue(0)},opacity:{value:1}}]),vertexShader:fn.shadow_vert,fragmentShader:fn.shadow_frag}};ba.physical={uniforms:Xr([ba.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Yt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Yt},clearcoatNormalScale:{value:new z(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Yt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Yt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Yt},sheen:{value:0},sheenColor:{value:new ue(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Yt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Yt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Yt},transmissionSamplerSize:{value:new z},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Yt},attenuationDistance:{value:0},attenuationColor:{value:new ue(0)},specularColor:{value:new ue(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Yt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Yt},anisotropyVector:{value:new z},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Yt}}]),vertexShader:fn.meshphysical_vert,fragmentShader:fn.meshphysical_frag};var NM={r:0,b:0,g:0},xh=new ho,PY=new Ee;function FY(i,e,t,n,r,o,s){let a=new ue(0),c=o===!0?0:1,l,u,d=null,h=0,f=null;function g(v){let y=v.isScene===!0?v.background:null;return y&&y.isTexture&&(y=(v.backgroundBlurriness>0?t:e).get(y)),y}function _(v){let y=!1,w=g(v);w===null?p(a,c):w&&w.isColor&&(p(w,1),y=!0);let R=i.xr.getEnvironmentBlendMode();R==="additive"?n.buffers.color.setClear(0,0,0,1,s):R==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,s),(i.autoClear||y)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function m(v,y){let w=g(y);w&&(w.isCubeTexture||w.mapping===bh)?(u===void 0&&(u=new Pe(new ei(1,1,1),new Nt({name:"BackgroundCubeMaterial",uniforms:yh(ba.backgroundCube.uniforms),vertexShader:ba.backgroundCube.vertexShader,fragmentShader:ba.backgroundCube.fragmentShader,side:qr,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(R,E,A){this.matrixWorld.copyPosition(A.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),xh.copy(y.backgroundRotation),xh.x*=-1,xh.y*=-1,xh.z*=-1,w.isCubeTexture&&w.isRenderTargetTexture===!1&&(xh.y*=-1,xh.z*=-1),u.material.uniforms.envMap.value=w,u.material.uniforms.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=y.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(PY.makeRotationFromEuler(xh)),u.material.toneMapped=hn.getTransfer(w.colorSpace)!==kn,(d!==w||h!==w.version||f!==i.toneMapping)&&(u.material.needsUpdate=!0,d=w,h=w.version,f=i.toneMapping),u.layers.enableAll(),v.unshift(u,u.geometry,u.material,0,0,null)):w&&w.isTexture&&(l===void 0&&(l=new Pe(new la(2,2),new Nt({name:"BackgroundMaterial",uniforms:yh(ba.background.uniforms),vertexShader:ba.background.vertexShader,fragmentShader:ba.background.fragmentShader,side:vs,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=w,l.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,l.material.toneMapped=hn.getTransfer(w.colorSpace)!==kn,w.matrixAutoUpdate===!0&&w.updateMatrix(),l.material.uniforms.uvTransform.value.copy(w.matrix),(d!==w||h!==w.version||f!==i.toneMapping)&&(l.material.needsUpdate=!0,d=w,h=w.version,f=i.toneMapping),l.layers.enableAll(),v.unshift(l,l.geometry,l.material,0,0,null))}function p(v,y){v.getRGB(NM,pI(i)),n.buffers.color.setClear(NM.r,NM.g,NM.b,y,s)}function b(){u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0),l!==void 0&&(l.geometry.dispose(),l.material.dispose(),l=void 0)}return{getClearColor:function(){return a},setClearColor:function(v,y=1){a.set(v),c=y,p(a,c)},getClearAlpha:function(){return c},setClearAlpha:function(v){c=v,p(a,c)},render:_,addToRenderList:m,dispose:b}}function NY(i,e){let t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},r=h(null),o=r,s=!1;function a(T,P,L,H,te){let Y=!1,J=d(H,L,P);o!==J&&(o=J,l(o.object)),Y=f(T,H,L,te),Y&&g(T,H,L,te),te!==null&&e.update(te,i.ELEMENT_ARRAY_BUFFER),(Y||s)&&(s=!1,y(T,P,L,H),te!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(te).buffer))}function c(){return i.createVertexArray()}function l(T){return i.bindVertexArray(T)}function u(T){return i.deleteVertexArray(T)}function d(T,P,L){let H=L.wireframe===!0,te=n[T.id];te===void 0&&(te={},n[T.id]=te);let Y=te[P.id];Y===void 0&&(Y={},te[P.id]=Y);let J=Y[H];return J===void 0&&(J=h(c()),Y[H]=J),J}function h(T){let P=[],L=[],H=[];for(let te=0;te<t;te++)P[te]=0,L[te]=0,H[te]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:P,enabledAttributes:L,attributeDivisors:H,object:T,attributes:{},index:null}}function f(T,P,L,H){let te=o.attributes,Y=P.attributes,J=0,W=L.getAttributes();for(let fe in W)if(W[fe].location>=0){let Re=te[fe],Te=Y[fe];if(Te===void 0&&(fe==="instanceMatrix"&&T.instanceMatrix&&(Te=T.instanceMatrix),fe==="instanceColor"&&T.instanceColor&&(Te=T.instanceColor)),Re===void 0||Re.attribute!==Te||Te&&Re.data!==Te.data)return!0;J++}return o.attributesNum!==J||o.index!==H}function g(T,P,L,H){let te={},Y=P.attributes,J=0,W=L.getAttributes();for(let fe in W)if(W[fe].location>=0){let Re=Y[fe];Re===void 0&&(fe==="instanceMatrix"&&T.instanceMatrix&&(Re=T.instanceMatrix),fe==="instanceColor"&&T.instanceColor&&(Re=T.instanceColor));let Te={};Te.attribute=Re,Re&&Re.data&&(Te.data=Re.data),te[fe]=Te,J++}o.attributes=te,o.attributesNum=J,o.index=H}function _(){let T=o.newAttributes;for(let P=0,L=T.length;P<L;P++)T[P]=0}function m(T){p(T,0)}function p(T,P){let L=o.newAttributes,H=o.enabledAttributes,te=o.attributeDivisors;L[T]=1,H[T]===0&&(i.enableVertexAttribArray(T),H[T]=1),te[T]!==P&&(i.vertexAttribDivisor(T,P),te[T]=P)}function b(){let T=o.newAttributes,P=o.enabledAttributes;for(let L=0,H=P.length;L<H;L++)P[L]!==T[L]&&(i.disableVertexAttribArray(L),P[L]=0)}function v(T,P,L,H,te,Y,J){J===!0?i.vertexAttribIPointer(T,P,L,te,Y):i.vertexAttribPointer(T,P,L,H,te,Y)}function y(T,P,L,H){_();let te=H.attributes,Y=L.getAttributes(),J=P.defaultAttributeValues;for(let W in Y){let fe=Y[W];if(fe.location>=0){let ve=te[W];if(ve===void 0&&(W==="instanceMatrix"&&T.instanceMatrix&&(ve=T.instanceMatrix),W==="instanceColor"&&T.instanceColor&&(ve=T.instanceColor)),ve!==void 0){let Re=ve.normalized,Te=ve.itemSize,mt=e.get(ve);if(mt===void 0)continue;let gt=mt.buffer,dn=mt.type,_n=mt.bytesPerElement,le=dn===i.INT||dn===i.UNSIGNED_INT||ve.gpuType===vb;if(ve.isInterleavedBufferAttribute){let _e=ve.data,Le=_e.stride,Je=ve.offset;if(_e.isInstancedInterleavedBuffer){for(let Ae=0;Ae<fe.locationSize;Ae++)p(fe.location+Ae,_e.meshPerAttribute);T.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=_e.meshPerAttribute*_e.count)}else for(let Ae=0;Ae<fe.locationSize;Ae++)m(fe.location+Ae);i.bindBuffer(i.ARRAY_BUFFER,gt);for(let Ae=0;Ae<fe.locationSize;Ae++)v(fe.location+Ae,Te/fe.locationSize,dn,Re,Le*_n,(Je+Te/fe.locationSize*Ae)*_n,le)}else{if(ve.isInstancedBufferAttribute){for(let _e=0;_e<fe.locationSize;_e++)p(fe.location+_e,ve.meshPerAttribute);T.isInstancedMesh!==!0&&H._maxInstanceCount===void 0&&(H._maxInstanceCount=ve.meshPerAttribute*ve.count)}else for(let _e=0;_e<fe.locationSize;_e++)m(fe.location+_e);i.bindBuffer(i.ARRAY_BUFFER,gt);for(let _e=0;_e<fe.locationSize;_e++)v(fe.location+_e,Te/fe.locationSize,dn,Re,Te*_n,Te/fe.locationSize*_e*_n,le)}}else if(J!==void 0){let Re=J[W];if(Re!==void 0)switch(Re.length){case 2:i.vertexAttrib2fv(fe.location,Re);break;case 3:i.vertexAttrib3fv(fe.location,Re);break;case 4:i.vertexAttrib4fv(fe.location,Re);break;default:i.vertexAttrib1fv(fe.location,Re)}}}}b()}function w(){A();for(let T in n){let P=n[T];for(let L in P){let H=P[L];for(let te in H)u(H[te].object),delete H[te];delete P[L]}delete n[T]}}function R(T){if(n[T.id]===void 0)return;let P=n[T.id];for(let L in P){let H=P[L];for(let te in H)u(H[te].object),delete H[te];delete P[L]}delete n[T.id]}function E(T){for(let P in n){let L=n[P];if(L[T.id]===void 0)continue;let H=L[T.id];for(let te in H)u(H[te].object),delete H[te];delete L[T.id]}}function A(){x(),s=!0,o!==r&&(o=r,l(o.object))}function x(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:a,reset:A,resetDefaultState:x,dispose:w,releaseStatesOfGeometry:R,releaseStatesOfProgram:E,initAttributes:_,enableAttribute:m,disableUnusedAttributes:b}}function jY(i,e,t){let n;function r(l){n=l}function o(l,u){i.drawArrays(n,l,u),t.update(u,n,1)}function s(l,u,d){d!==0&&(i.drawArraysInstanced(n,l,u,d),t.update(u,n,d))}function a(l,u,d){if(d===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,l,0,u,0,d);let f=0;for(let g=0;g<d;g++)f+=u[g];t.update(f,n,1)}function c(l,u,d,h){if(d===0)return;let f=e.get("WEBGL_multi_draw");if(f===null)for(let g=0;g<l.length;g++)s(l[g],u[g],h[g]);else{f.multiDrawArraysInstancedWEBGL(n,l,0,u,0,h,0,d);let g=0;for(let _=0;_<d;_++)g+=u[_]*h[_];t.update(g,n,1)}}this.setMode=r,this.render=o,this.renderInstances=s,this.renderMultiDraw=a,this.renderMultiDrawInstances=c}function OY(i,e,t,n){let r;function o(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){let E=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(E.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function s(E){return!(E!==Gr&&n.convert(E)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(E){let A=E===An&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(E!==_o&&n.convert(E)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&E!==tr&&!A)}function c(E){if(E==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";E="mediump"}return E==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let l=t.precision!==void 0?t.precision:"highp",u=c(l);u!==l&&(Ue("WebGLRenderer:",l,"not supported, using",u,"instead."),l=u);let d=t.logarithmicDepthBuffer===!0,h=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),f=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),g=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),_=i.getParameter(i.MAX_TEXTURE_SIZE),m=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),p=i.getParameter(i.MAX_VERTEX_ATTRIBS),b=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),v=i.getParameter(i.MAX_VARYING_VECTORS),y=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),w=i.getParameter(i.MAX_SAMPLES),R=i.getParameter(i.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:o,getMaxPrecision:c,textureFormatReadable:s,textureTypeReadable:a,precision:l,logarithmicDepthBuffer:d,reversedDepthBuffer:h,maxTextures:f,maxVertexTextures:g,maxTextureSize:_,maxCubemapSize:m,maxAttributes:p,maxVertexUniforms:b,maxVaryings:v,maxFragmentUniforms:y,maxSamples:w,samples:R}}function LY(i){let e=this,t=null,n=0,r=!1,o=!1,s=new Xi,a=new Yt,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){let f=d.length!==0||h||n!==0||r;return r=h,n=d.length,f},this.beginShadows=function(){o=!0,u(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(d,h){t=u(d,h,0)},this.setState=function(d,h,f){let g=d.clippingPlanes,_=d.clipIntersection,m=d.clipShadows,p=i.get(d);if(!r||g===null||g.length===0||o&&!m)o?u(null):l();else{let b=o?0:n,v=b*4,y=p.clippingState||null;c.value=y,y=u(g,h,v,f);for(let w=0;w!==v;++w)y[w]=t[w];p.clippingState=y,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=b}};function l(){c.value!==t&&(c.value=t,c.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function u(d,h,f,g){let _=d!==null?d.length:0,m=null;if(_!==0){if(m=c.value,g!==!0||m===null){let p=f+_*4,b=h.matrixWorldInverse;a.getNormalMatrix(b),(m===null||m.length<p)&&(m=new Float32Array(p));for(let v=0,y=f;v!==_;++v,y+=4)s.copy(d[v]).applyMatrix4(b,a),s.normal.toArray(m,y),m[y+3]=s.constant}c.value=m,c.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,m}}function kY(i){let e=new WeakMap;function t(s,a){return a===Np?s.mapping=ga:a===jp&&(s.mapping=Jc),s}function n(s){if(s&&s.isTexture){let a=s.mapping;if(a===Np||a===jp)if(e.has(s)){let c=e.get(s).texture;return t(c,s.mapping)}else{let c=s.image;if(c&&c.height>0){let l=new dp(c.height);return l.fromEquirectangularTexture(i,s),e.set(s,l),s.addEventListener("dispose",r),t(l.texture,s.mapping)}else return null}}return s}function r(s){let a=s.target;a.removeEventListener("dispose",r);let c=e.get(a);c!==void 0&&(e.delete(a),c.dispose())}function o(){e=new WeakMap}return{get:n,dispose:o}}var bu=4,d3=[.125,.215,.35,.446,.526,.582],Mh=20,BY=256,sv=new mo,h3=new ue,yI=null,xI=0,wI=0,MI=!1,UY=new C,lv=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,n=.1,r=100,o={}){let{size:s=256,position:a=UY}=o;yI=this._renderer.getRenderTarget(),xI=this._renderer.getActiveCubeFace(),wI=this._renderer.getActiveMipmapLevel(),MI=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(s);let c=this._allocateTargets();return c.depthBuffer=!0,this._sceneToCubeUV(e,n,r,c,a),t>0&&this._blur(c,0,0,t),this._applyPMREM(c),this._cleanup(c),c}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=m3(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=p3(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(yI,xI,wI),this._renderer.xr.enabled=MI,e.scissorTest=!1,Hp(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===ga||e.mapping===Jc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),yI=this._renderer.getRenderTarget(),xI=this._renderer.getActiveCubeFace(),wI=this._renderer.getActiveMipmapLevel(),MI=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;let n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:zn,minFilter:zn,generateMipmaps:!1,type:An,format:Gr,colorSpace:nr,depthBuffer:!1},r=f3(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=f3(e,t,n);let{_lodMax:o}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=VY(o)),this._blurMaterial=HY(o,e,t),this._ggxMaterial=zY(o,e,t)}return r}_compileMaterial(e){let t=new Pe(new nt,e);this._renderer.compile(t,sv)}_sceneToCubeUV(e,t,n,r,o){let c=new ai(90,1,t,n),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],d=this._renderer,h=d.autoClear,f=d.toneMapping;d.getClearColor(h3),d.toneMapping=Ts,d.autoClear=!1,d.state.buffers.depth.getReversed()&&(d.setRenderTarget(r),d.clearDepth(),d.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new Pe(new ei,new ci({name:"PMREM.Background",side:qr,depthWrite:!1,depthTest:!1})));let _=this._backgroundBox,m=_.material,p=!1,b=e.background;b?b.isColor&&(m.color.copy(b),e.background=null,p=!0):(m.color.copy(h3),p=!0);for(let v=0;v<6;v++){let y=v%3;y===0?(c.up.set(0,l[v],0),c.position.set(o.x,o.y,o.z),c.lookAt(o.x+u[v],o.y,o.z)):y===1?(c.up.set(0,0,l[v]),c.position.set(o.x,o.y,o.z),c.lookAt(o.x,o.y+u[v],o.z)):(c.up.set(0,l[v],0),c.position.set(o.x,o.y,o.z),c.lookAt(o.x,o.y,o.z+u[v]));let w=this._cubeSize;Hp(r,y*w,v>2?w:0,w,w),d.setRenderTarget(r),p&&d.render(_,c),d.render(e,c)}d.toneMapping=f,d.autoClear=h,e.background=b}_textureToCubeUV(e,t){let n=this._renderer,r=e.mapping===ga||e.mapping===Jc;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=m3()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=p3());let o=r?this._cubemapMaterial:this._equirectMaterial,s=this._lodMeshes[0];s.material=o;let a=o.uniforms;a.envMap.value=e;let c=this._cubeSize;Hp(t,0,0,3*c,2*c),n.setRenderTarget(t),n.render(s,sv)}_applyPMREM(e){let t=this._renderer,n=t.autoClear;t.autoClear=!1;let r=this._lodMeshes.length;for(let o=1;o<r;o++)this._applyGGXFilter(e,o-1,o);t.autoClear=n}_applyGGXFilter(e,t,n){let r=this._renderer,o=this._pingPongRenderTarget,s=this._ggxMaterial,a=this._lodMeshes[n];a.material=s;let c=s.uniforms,l=n/(this._lodMeshes.length-1),u=t/(this._lodMeshes.length-1),d=Math.sqrt(l*l-u*u),h=0+l*1.25,f=d*h,{_lodMax:g}=this,_=this._sizeLods[n],m=3*_*(n>g-bu?n-g+bu:0),p=4*(this._cubeSize-_);c.envMap.value=e.texture,c.roughness.value=f,c.mipInt.value=g-t,Hp(o,m,p,3*_,2*_),r.setRenderTarget(o),r.render(a,sv),c.envMap.value=o.texture,c.roughness.value=0,c.mipInt.value=g-n,Hp(e,m,p,3*_,2*_),r.setRenderTarget(e),r.render(a,sv)}_blur(e,t,n,r,o){let s=this._pingPongRenderTarget;this._halfBlur(e,s,t,n,r,"latitudinal",o),this._halfBlur(s,e,n,n,r,"longitudinal",o)}_halfBlur(e,t,n,r,o,s,a){let c=this._renderer,l=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&bt("blur direction must be either latitudinal or longitudinal!");let u=3,d=this._lodMeshes[r];d.material=l;let h=l.uniforms,f=this._sizeLods[n]-1,g=isFinite(o)?Math.PI/(2*f):2*Math.PI/(2*Mh-1),_=o/g,m=isFinite(o)?1+Math.floor(u*_):Mh;m>Mh&&Ue(`sigmaRadians, ${o}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${Mh}`);let p=[],b=0;for(let E=0;E<Mh;++E){let A=E/_,x=Math.exp(-A*A/2);p.push(x),E===0?b+=x:E<m&&(b+=2*x)}for(let E=0;E<p.length;E++)p[E]=p[E]/b;h.envMap.value=e.texture,h.samples.value=m,h.weights.value=p,h.latitudinal.value=s==="latitudinal",a&&(h.poleAxis.value=a);let{_lodMax:v}=this;h.dTheta.value=g,h.mipInt.value=v-n;let y=this._sizeLods[r],w=3*y*(r>v-bu?r-v+bu:0),R=4*(this._cubeSize-y);Hp(t,w,R,3*y,2*y),c.setRenderTarget(t),c.render(d,sv)}};function VY(i){let e=[],t=[],n=[],r=i,o=i-bu+1+d3.length;for(let s=0;s<o;s++){let a=Math.pow(2,r);e.push(a);let c=1/a;s>i-bu?c=d3[s-i+bu-1]:s===0&&(c=0),t.push(c);let l=1/(a-2),u=-l,d=1+l,h=[u,u,d,u,d,d,u,u,d,d,u,d],f=6,g=6,_=3,m=2,p=1,b=new Float32Array(_*g*f),v=new Float32Array(m*g*f),y=new Float32Array(p*g*f);for(let R=0;R<f;R++){let E=R%3*2/3-1,A=R>2?0:-1,x=[E,A,0,E+2/3,A,0,E+2/3,A+1,0,E,A,0,E+2/3,A+1,0,E,A+1,0];b.set(x,_*g*R),v.set(h,m*g*R);let T=[R,R,R,R,R,R];y.set(T,p*g*R)}let w=new nt;w.setAttribute("position",new pn(b,_)),w.setAttribute("uv",new pn(v,m)),w.setAttribute("faceIndex",new pn(y,p)),n.push(new Pe(w,null)),r>bu&&r--}return{lodMeshes:n,sizeLods:e,sigmas:t}}function f3(i,e,t){let n=new Qt(i,e,t);return n.texture.mapping=bh,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Hp(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function zY(i,e,t){return new Nt({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:BY,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:OM(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:rn,depthTest:!1,depthWrite:!1})}function HY(i,e,t){let n=new Float32Array(Mh),r=new C(0,1,0);return new Nt({name:"SphericalGaussianBlur",defines:{n:Mh,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:OM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:rn,depthTest:!1,depthWrite:!1})}function p3(){return new Nt({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:OM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:rn,depthTest:!1,depthWrite:!1})}function m3(){return new Nt({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:OM(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:rn,depthTest:!1,depthWrite:!1})}function OM(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function GY(i){let e=new WeakMap,t=null;function n(a){if(a&&a.isTexture){let c=a.mapping,l=c===Np||c===jp,u=c===ga||c===Jc;if(l||u){let d=e.get(a),h=d!==void 0?d.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==h)return t===null&&(t=new lv(i)),d=l?t.fromEquirectangular(a,d):t.fromCubemap(a,d),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),d.texture;if(d!==void 0)return d.texture;{let f=a.image;return l&&f&&f.height>0||u&&f&&r(f)?(t===null&&(t=new lv(i)),d=l?t.fromEquirectangular(a):t.fromCubemap(a),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),a.addEventListener("dispose",o),d.texture):null}}}return a}function r(a){let c=0,l=6;for(let u=0;u<l;u++)a[u]!==void 0&&c++;return c===l}function o(a){let c=a.target;c.removeEventListener("dispose",o);let l=e.get(c);l!==void 0&&(e.delete(c),l.dispose())}function s(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:s}}function WY(i){let e={};function t(n){if(e[n]!==void 0)return e[n];let r=i.getExtension(n);return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){let r=t(n);return r===null&&Xd("WebGLRenderer: "+n+" extension not supported."),r}}}function $Y(i,e,t,n){let r={},o=new WeakMap;function s(d){let h=d.target;h.index!==null&&e.remove(h.index);for(let g in h.attributes)e.remove(h.attributes[g]);h.removeEventListener("dispose",s),delete r[h.id];let f=o.get(h);f&&(e.remove(f),o.delete(h)),n.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,t.memory.geometries--}function a(d,h){return r[h.id]===!0||(h.addEventListener("dispose",s),r[h.id]=!0,t.memory.geometries++),h}function c(d){let h=d.attributes;for(let f in h)e.update(h[f],i.ARRAY_BUFFER)}function l(d){let h=[],f=d.index,g=d.attributes.position,_=0;if(f!==null){let b=f.array;_=f.version;for(let v=0,y=b.length;v<y;v+=3){let w=b[v+0],R=b[v+1],E=b[v+2];h.push(w,R,R,E,E,w)}}else if(g!==void 0){let b=g.array;_=g.version;for(let v=0,y=b.length/3-1;v<y;v+=3){let w=v+0,R=v+1,E=v+2;h.push(w,R,R,E,E,w)}}else return;let m=new(dI(h)?up:lp)(h,1);m.version=_;let p=o.get(d);p&&e.remove(p),o.set(d,m)}function u(d){let h=o.get(d);if(h){let f=d.index;f!==null&&h.version<f.version&&l(d)}else l(d);return o.get(d)}return{get:a,update:c,getWireframeAttribute:u}}function qY(i,e,t){let n;function r(h){n=h}let o,s;function a(h){o=h.type,s=h.bytesPerElement}function c(h,f){i.drawElements(n,f,o,h*s),t.update(f,n,1)}function l(h,f,g){g!==0&&(i.drawElementsInstanced(n,f,o,h*s,g),t.update(f,n,g))}function u(h,f,g){if(g===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,f,0,o,h,0,g);let m=0;for(let p=0;p<g;p++)m+=f[p];t.update(m,n,1)}function d(h,f,g,_){if(g===0)return;let m=e.get("WEBGL_multi_draw");if(m===null)for(let p=0;p<h.length;p++)l(h[p]/s,f[p],_[p]);else{m.multiDrawElementsInstancedWEBGL(n,f,0,o,h,0,_,0,g);let p=0;for(let b=0;b<g;b++)p+=f[b]*_[b];t.update(p,n,1)}}this.setMode=r,this.setIndex=a,this.render=c,this.renderInstances=l,this.renderMultiDraw=u,this.renderMultiDrawInstances=d}function XY(i){let e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(o,s,a){switch(t.calls++,s){case i.TRIANGLES:t.triangles+=a*(o/3);break;case i.LINES:t.lines+=a*(o/2);break;case i.LINE_STRIP:t.lines+=a*(o-1);break;case i.LINE_LOOP:t.lines+=a*o;break;case i.POINTS:t.points+=a*o;break;default:bt("WebGLInfo: Unknown draw mode:",s);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function ZY(i,e,t){let n=new WeakMap,r=new En;function o(s,a,c){let l=s.morphTargetInfluences,u=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,d=u!==void 0?u.length:0,h=n.get(a);if(h===void 0||h.count!==d){let T=function(){A.dispose(),n.delete(a),a.removeEventListener("dispose",T)};var f=T;h!==void 0&&h.texture.dispose();let g=a.morphAttributes.position!==void 0,_=a.morphAttributes.normal!==void 0,m=a.morphAttributes.color!==void 0,p=a.morphAttributes.position||[],b=a.morphAttributes.normal||[],v=a.morphAttributes.color||[],y=0;g===!0&&(y=1),_===!0&&(y=2),m===!0&&(y=3);let w=a.attributes.position.count*y,R=1;w>e.maxTextureSize&&(R=Math.ceil(w/e.maxTextureSize),w=e.maxTextureSize);let E=new Float32Array(w*R*4*d),A=new Yd(E,w,R,d);A.type=tr,A.needsUpdate=!0;let x=y*4;for(let P=0;P<d;P++){let L=p[P],H=b[P],te=v[P],Y=w*R*4*P;for(let J=0;J<L.count;J++){let W=J*x;g===!0&&(r.fromBufferAttribute(L,J),E[Y+W+0]=r.x,E[Y+W+1]=r.y,E[Y+W+2]=r.z,E[Y+W+3]=0),_===!0&&(r.fromBufferAttribute(H,J),E[Y+W+4]=r.x,E[Y+W+5]=r.y,E[Y+W+6]=r.z,E[Y+W+7]=0),m===!0&&(r.fromBufferAttribute(te,J),E[Y+W+8]=r.x,E[Y+W+9]=r.y,E[Y+W+10]=r.z,E[Y+W+11]=te.itemSize===4?r.w:1)}}h={count:d,texture:A,size:new z(w,R)},n.set(a,h),a.addEventListener("dispose",T)}if(s.isInstancedMesh===!0&&s.morphTexture!==null)c.getUniforms().setValue(i,"morphTexture",s.morphTexture,t);else{let g=0;for(let m=0;m<l.length;m++)g+=l[m];let _=a.morphTargetsRelative?1:1-g;c.getUniforms().setValue(i,"morphTargetBaseInfluence",_),c.getUniforms().setValue(i,"morphTargetInfluences",l)}c.getUniforms().setValue(i,"morphTargetsTexture",h.texture,t),c.getUniforms().setValue(i,"morphTargetsTextureSize",h.size)}return{update:o}}function YY(i,e,t,n){let r=new WeakMap;function o(c){let l=n.render.frame,u=c.geometry,d=e.get(c,u);if(r.get(d)!==l&&(e.update(d),r.set(d,l)),c.isInstancedMesh&&(c.hasEventListener("dispose",a)===!1&&c.addEventListener("dispose",a),r.get(c)!==l&&(t.update(c.instanceMatrix,i.ARRAY_BUFFER),c.instanceColor!==null&&t.update(c.instanceColor,i.ARRAY_BUFFER),r.set(c,l))),c.isSkinnedMesh){let h=c.skeleton;r.get(h)!==l&&(h.update(),r.set(h,l))}return d}function s(){r=new WeakMap}function a(c){let l=c.target;l.removeEventListener("dispose",a),t.remove(l.instanceMatrix),l.instanceColor!==null&&t.remove(l.instanceColor)}return{update:o,dispose:s}}var QY={[gM]:"LINEAR_TONE_MAPPING",[_M]:"REINHARD_TONE_MAPPING",[bM]:"CINEON_TONE_MAPPING",[vM]:"ACES_FILMIC_TONE_MAPPING",[xM]:"AGX_TONE_MAPPING",[wM]:"NEUTRAL_TONE_MAPPING",[yM]:"CUSTOM_TONE_MAPPING"};function KY(i,e,t,n,r){let o=new Qt(e,t,{type:i,depthBuffer:n,stencilBuffer:r}),s=new Qt(e,t,{type:An,depthBuffer:!1,stencilBuffer:!1}),a=new nt;a.setAttribute("position",new Oe([-1,3,0,-1,-1,0,3,-1,0],3)),a.setAttribute("uv",new Oe([0,2,0,0,2,0],2));let c=new xp({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),l=new Pe(a,c),u=new mo(-1,1,1,-1,0,1),d=null,h=null,f=!1,g,_=null,m=[],p=!1;this.setSize=function(b,v){o.setSize(b,v),s.setSize(b,v);for(let y=0;y<m.length;y++){let w=m[y];w.setSize&&w.setSize(b,v)}},this.setEffects=function(b){m=b,p=m.length>0&&m[0].isRenderPass===!0;let v=o.width,y=o.height;for(let w=0;w<m.length;w++){let R=m[w];R.setSize&&R.setSize(v,y)}},this.begin=function(b,v){if(f||b.toneMapping===Ts&&m.length===0)return!1;if(_=v,v!==null){let y=v.width,w=v.height;(o.width!==y||o.height!==w)&&this.setSize(y,w)}return p===!1&&b.setRenderTarget(o),g=b.toneMapping,b.toneMapping=Ts,!0},this.hasRenderPass=function(){return p},this.end=function(b,v){b.toneMapping=g,f=!0;let y=o,w=s;for(let R=0;R<m.length;R++){let E=m[R];if(E.enabled!==!1&&(E.render(b,w,y,v),E.needsSwap!==!1)){let A=y;y=w,w=A}}if(d!==b.outputColorSpace||h!==b.toneMapping){d=b.outputColorSpace,h=b.toneMapping,c.defines={},hn.getTransfer(d)===kn&&(c.defines.SRGB_TRANSFER="");let R=QY[h];R&&(c.defines[R]=""),c.needsUpdate=!0}c.uniforms.tDiffuse.value=y.texture,b.setRenderTarget(_),b.render(l,u),_=null,f=!1},this.isCompositing=function(){return f},this.dispose=function(){o.dispose(),s.dispose(),a.dispose(),c.dispose()}}var N3=new Ii,TI=new fo(1,1),j3=new Yd,O3=new Qd,L3=new au,g3=[],_3=[],b3=new Float32Array(16),v3=new Float32Array(9),y3=new Float32Array(4);function Wp(i,e,t){let n=i[0];if(n<=0||n>0)return i;let r=e*t,o=g3[r];if(o===void 0&&(o=new Float32Array(r),g3[r]=o),e!==0){n.toArray(o,0);for(let s=1,a=0;s!==e;++s)a+=t,i[s].toArray(o,a)}return o}function vr(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function yr(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function LM(i,e){let t=_3[e];t===void 0&&(t=new Int32Array(e),_3[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function JY(i,e){let t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function eQ(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(vr(t,e))return;i.uniform2fv(this.addr,e),yr(t,e)}}function tQ(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(vr(t,e))return;i.uniform3fv(this.addr,e),yr(t,e)}}function nQ(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(vr(t,e))return;i.uniform4fv(this.addr,e),yr(t,e)}}function iQ(i,e){let t=this.cache,n=e.elements;if(n===void 0){if(vr(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),yr(t,e)}else{if(vr(t,n))return;y3.set(n),i.uniformMatrix2fv(this.addr,!1,y3),yr(t,n)}}function rQ(i,e){let t=this.cache,n=e.elements;if(n===void 0){if(vr(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),yr(t,e)}else{if(vr(t,n))return;v3.set(n),i.uniformMatrix3fv(this.addr,!1,v3),yr(t,n)}}function oQ(i,e){let t=this.cache,n=e.elements;if(n===void 0){if(vr(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),yr(t,e)}else{if(vr(t,n))return;b3.set(n),i.uniformMatrix4fv(this.addr,!1,b3),yr(t,n)}}function sQ(i,e){let t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function aQ(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(vr(t,e))return;i.uniform2iv(this.addr,e),yr(t,e)}}function cQ(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(vr(t,e))return;i.uniform3iv(this.addr,e),yr(t,e)}}function lQ(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(vr(t,e))return;i.uniform4iv(this.addr,e),yr(t,e)}}function uQ(i,e){let t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function dQ(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(vr(t,e))return;i.uniform2uiv(this.addr,e),yr(t,e)}}function hQ(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(vr(t,e))return;i.uniform3uiv(this.addr,e),yr(t,e)}}function fQ(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(vr(t,e))return;i.uniform4uiv(this.addr,e),yr(t,e)}}function pQ(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r);let o;this.type===i.SAMPLER_2D_SHADOW?(TI.compareFunction=t.isReversedDepthBuffer()?ov:rv,o=TI):o=N3,t.setTexture2D(e||o,r)}function mQ(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||O3,r)}function gQ(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||L3,r)}function _Q(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||j3,r)}function bQ(i){switch(i){case 5126:return JY;case 35664:return eQ;case 35665:return tQ;case 35666:return nQ;case 35674:return iQ;case 35675:return rQ;case 35676:return oQ;case 5124:case 35670:return sQ;case 35667:case 35671:return aQ;case 35668:case 35672:return cQ;case 35669:case 35673:return lQ;case 5125:return uQ;case 36294:return dQ;case 36295:return hQ;case 36296:return fQ;case 35678:case 36198:case 36298:case 36306:case 35682:return pQ;case 35679:case 36299:case 36307:return mQ;case 35680:case 36300:case 36308:case 36293:return gQ;case 36289:case 36303:case 36311:case 36292:return _Q}}function vQ(i,e){i.uniform1fv(this.addr,e)}function yQ(i,e){let t=Wp(e,this.size,2);i.uniform2fv(this.addr,t)}function xQ(i,e){let t=Wp(e,this.size,3);i.uniform3fv(this.addr,t)}function wQ(i,e){let t=Wp(e,this.size,4);i.uniform4fv(this.addr,t)}function MQ(i,e){let t=Wp(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function SQ(i,e){let t=Wp(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function RQ(i,e){let t=Wp(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function TQ(i,e){i.uniform1iv(this.addr,e)}function CQ(i,e){i.uniform2iv(this.addr,e)}function EQ(i,e){i.uniform3iv(this.addr,e)}function DQ(i,e){i.uniform4iv(this.addr,e)}function IQ(i,e){i.uniform1uiv(this.addr,e)}function AQ(i,e){i.uniform2uiv(this.addr,e)}function PQ(i,e){i.uniform3uiv(this.addr,e)}function FQ(i,e){i.uniform4uiv(this.addr,e)}function NQ(i,e,t){let n=this.cache,r=e.length,o=LM(t,r);vr(n,o)||(i.uniform1iv(this.addr,o),yr(n,o));let s;this.type===i.SAMPLER_2D_SHADOW?s=TI:s=N3;for(let a=0;a!==r;++a)t.setTexture2D(e[a]||s,o[a])}function jQ(i,e,t){let n=this.cache,r=e.length,o=LM(t,r);vr(n,o)||(i.uniform1iv(this.addr,o),yr(n,o));for(let s=0;s!==r;++s)t.setTexture3D(e[s]||O3,o[s])}function OQ(i,e,t){let n=this.cache,r=e.length,o=LM(t,r);vr(n,o)||(i.uniform1iv(this.addr,o),yr(n,o));for(let s=0;s!==r;++s)t.setTextureCube(e[s]||L3,o[s])}function LQ(i,e,t){let n=this.cache,r=e.length,o=LM(t,r);vr(n,o)||(i.uniform1iv(this.addr,o),yr(n,o));for(let s=0;s!==r;++s)t.setTexture2DArray(e[s]||j3,o[s])}function kQ(i){switch(i){case 5126:return vQ;case 35664:return yQ;case 35665:return xQ;case 35666:return wQ;case 35674:return MQ;case 35675:return SQ;case 35676:return RQ;case 5124:case 35670:return TQ;case 35667:case 35671:return CQ;case 35668:case 35672:return EQ;case 35669:case 35673:return DQ;case 5125:return IQ;case 36294:return AQ;case 36295:return PQ;case 36296:return FQ;case 35678:case 36198:case 36298:case 36306:case 35682:return NQ;case 35679:case 36299:case 36307:return jQ;case 35680:case 36300:case 36308:case 36293:return OQ;case 36289:case 36303:case 36311:case 36292:return LQ}}var CI=class{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=bQ(t.type)}},EI=class{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=kQ(t.type)}},DI=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){let r=this.seq;for(let o=0,s=r.length;o!==s;++o){let a=r[o];a.setValue(e,t[a.id],n)}}},SI=/(\w+)(\])?(\[|\.)?/g;function x3(i,e){i.seq.push(e),i.map[e.id]=e}function BQ(i,e,t){let n=i.name,r=n.length;for(SI.lastIndex=0;;){let o=SI.exec(n),s=SI.lastIndex,a=o[1],c=o[2]==="]",l=o[3];if(c&&(a=a|0),l===void 0||l==="["&&s+2===r){x3(t,l===void 0?new CI(a,i,e):new EI(a,i,e));break}else{let d=t.map[a];d===void 0&&(d=new DI(a),x3(t,d)),t=d}}}var Gp=class{constructor(e,t){this.seq=[],this.map={};let n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let s=0;s<n;++s){let a=e.getActiveUniform(t,s),c=e.getUniformLocation(t,a.name);BQ(a,c,this)}let r=[],o=[];for(let s of this.seq)s.type===e.SAMPLER_2D_SHADOW||s.type===e.SAMPLER_CUBE_SHADOW||s.type===e.SAMPLER_2D_ARRAY_SHADOW?r.push(s):o.push(s);r.length>0&&(this.seq=r.concat(o))}setValue(e,t,n,r){let o=this.map[t];o!==void 0&&o.setValue(e,n,r)}setOptional(e,t,n){let r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let o=0,s=t.length;o!==s;++o){let a=t[o],c=n[a.id];c.needsUpdate!==!1&&a.setValue(e,c.value,r)}}static seqWithValue(e,t){let n=[];for(let r=0,o=e.length;r!==o;++r){let s=e[r];s.id in t&&n.push(s)}return n}};function w3(i,e,t){let n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}var UQ=37297,VQ=0;function zQ(i,e){let t=i.split(`
`),n=[],r=Math.max(e-6,0),o=Math.min(e+6,t.length);for(let s=r;s<o;s++){let a=s+1;n.push(`${a===e?">":" "} ${a}: ${t[s]}`)}return n.join(`
`)}var M3=new Yt;function HQ(i){hn._getMatrix(M3,hn.workingColorSpace,i);let e=`mat3( ${M3.elements.map(t=>t.toFixed(4))} )`;switch(hn.getTransfer(i)){case rp:return[e,"LinearTransferOETF"];case kn:return[e,"sRGBTransferOETF"];default:return Ue("WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function S3(i,e,t){let n=i.getShaderParameter(e,i.COMPILE_STATUS),o=(i.getShaderInfoLog(e)||"").trim();if(n&&o==="")return"";let s=/ERROR: 0:(\d+)/.exec(o);if(s){let a=parseInt(s[1]);return t.toUpperCase()+`

`+o+`

`+zQ(i.getShaderSource(e),a)}else return o}function GQ(i,e){let t=HQ(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}var WQ={[gM]:"Linear",[_M]:"Reinhard",[bM]:"Cineon",[vM]:"ACESFilmic",[xM]:"AgX",[wM]:"Neutral",[yM]:"Custom"};function $Q(i,e){let t=WQ[e];return t===void 0?(Ue("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+i+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}var jM=new C;function qQ(){hn.getLuminanceCoefficients(jM);let i=jM.x.toFixed(4),e=jM.y.toFixed(4),t=jM.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function XQ(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(cv).join(`
`)}function ZQ(i){let e=[];for(let t in i){let n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function YQ(i,e){let t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){let o=i.getActiveAttrib(e,r),s=o.name,a=1;o.type===i.FLOAT_MAT2&&(a=2),o.type===i.FLOAT_MAT3&&(a=3),o.type===i.FLOAT_MAT4&&(a=4),t[s]={type:o.type,location:i.getAttribLocation(e,s),locationSize:a}}return t}function cv(i){return i!==""}function R3(i,e){let t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function T3(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var QQ=/^[ \t]*#include +<([\w\d./]+)>/gm;function II(i){return i.replace(QQ,JQ)}var KQ=new Map;function JQ(i,e){let t=fn[e];if(t===void 0){let n=KQ.get(e);if(n!==void 0)t=fn[n],Ue('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return II(t)}var eK=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function C3(i){return i.replace(eK,tK)}function tK(i,e,t,n){let r="";for(let o=parseInt(e);o<parseInt(t);o++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function E3(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}var nK={[Pp]:"SHADOWMAP_TYPE_PCF",[mh]:"SHADOWMAP_TYPE_VSM"};function iK(i){return nK[i.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}var rK={[ga]:"ENVMAP_TYPE_CUBE",[Jc]:"ENVMAP_TYPE_CUBE",[bh]:"ENVMAP_TYPE_CUBE_UV"};function oK(i){return i.envMap===!1?"ENVMAP_TYPE_CUBE":rK[i.envMapMode]||"ENVMAP_TYPE_CUBE"}var sK={[Jc]:"ENVMAP_MODE_REFRACTION"};function aK(i){return i.envMap===!1?"ENVMAP_MODE_REFLECTION":sK[i.envMapMode]||"ENVMAP_MODE_REFLECTION"}var cK={[Fp]:"ENVMAP_BLENDING_MULTIPLY",[K1]:"ENVMAP_BLENDING_MIX",[J1]:"ENVMAP_BLENDING_ADD"};function lK(i){return i.envMap===!1?"ENVMAP_BLENDING_NONE":cK[i.combine]||"ENVMAP_BLENDING_NONE"}function uK(i){let e=i.envMapCubeUVHeight;if(e===null)return null;let t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function dK(i,e,t,n){let r=i.getContext(),o=t.defines,s=t.vertexShader,a=t.fragmentShader,c=iK(t),l=oK(t),u=aK(t),d=lK(t),h=uK(t),f=XQ(t),g=ZQ(o),_=r.createProgram(),m,p,b=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(m=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g].filter(cv).join(`
`),m.length>0&&(m+=`
`),p=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g].filter(cv).join(`
`),p.length>0&&(p+=`
`)):(m=[E3(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(cv).join(`
`),p=[E3(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,g,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+l:"",t.envMap?"#define "+u:"",t.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Ts?"#define TONE_MAPPING":"",t.toneMapping!==Ts?fn.tonemapping_pars_fragment:"",t.toneMapping!==Ts?$Q("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",fn.colorspace_pars_fragment,GQ("linearToOutputTexel",t.outputColorSpace),qQ(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(cv).join(`
`)),s=II(s),s=R3(s,t),s=T3(s,t),a=II(a),a=R3(a,t),a=T3(a,t),s=C3(s),a=C3(a),t.isRawShaderMaterial!==!0&&(b=`#version 300 es
`,m=[f,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+m,p=["#define varying in",t.glslVersion===PM?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===PM?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+p);let v=b+m+s,y=b+p+a,w=w3(r,r.VERTEX_SHADER,v),R=w3(r,r.FRAGMENT_SHADER,y);r.attachShader(_,w),r.attachShader(_,R),t.index0AttributeName!==void 0?r.bindAttribLocation(_,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(_,0,"position"),r.linkProgram(_);function E(P){if(i.debug.checkShaderErrors){let L=r.getProgramInfoLog(_)||"",H=r.getShaderInfoLog(w)||"",te=r.getShaderInfoLog(R)||"",Y=L.trim(),J=H.trim(),W=te.trim(),fe=!0,ve=!0;if(r.getProgramParameter(_,r.LINK_STATUS)===!1)if(fe=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(r,_,w,R);else{let Re=S3(r,w,"vertex"),Te=S3(r,R,"fragment");bt("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(_,r.VALIDATE_STATUS)+`

Material Name: `+P.name+`
Material Type: `+P.type+`

Program Info Log: `+Y+`
`+Re+`
`+Te)}else Y!==""?Ue("WebGLProgram: Program Info Log:",Y):(J===""||W==="")&&(ve=!1);ve&&(P.diagnostics={runnable:fe,programLog:Y,vertexShader:{log:J,prefix:m},fragmentShader:{log:W,prefix:p}})}r.deleteShader(w),r.deleteShader(R),A=new Gp(r,_),x=YQ(r,_)}let A;this.getUniforms=function(){return A===void 0&&E(this),A};let x;this.getAttributes=function(){return x===void 0&&E(this),x};let T=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return T===!1&&(T=r.getProgramParameter(_,UQ)),T},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(_),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=VQ++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=w,this.fragmentShader=R,this}var hK=0,AI=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),o=this._getShaderStage(n),s=this._getShaderCacheForMaterial(e);return s.has(r)===!1&&(s.add(r),r.usedTimes++),s.has(o)===!1&&(s.add(o),o.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){let t=this.shaderCache,n=t.get(e);return n===void 0&&(n=new PI(e),t.set(e,n)),n}},PI=class{constructor(e){this.id=hK++,this.code=e,this.usedTimes=0}};function fK(i,e,t,n,r,o,s){let a=new Kd,c=new AI,l=new Set,u=[],d=new Map,h=r.logarithmicDepthBuffer,f=r.precision,g={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(x){return l.add(x),x===0?"uv":`uv${x}`}function m(x,T,P,L,H){let te=L.fog,Y=H.geometry,J=x.isMeshStandardMaterial?L.environment:null,W=(x.isMeshStandardMaterial?t:e).get(x.envMap||J),fe=W&&W.mapping===bh?W.image.height:null,ve=g[x.type];x.precision!==null&&(f=r.getMaxPrecision(x.precision),f!==x.precision&&Ue("WebGLProgram.getParameters:",x.precision,"not supported, using",f,"instead."));let Re=Y.morphAttributes.position||Y.morphAttributes.normal||Y.morphAttributes.color,Te=Re!==void 0?Re.length:0,mt=0;Y.morphAttributes.position!==void 0&&(mt=1),Y.morphAttributes.normal!==void 0&&(mt=2),Y.morphAttributes.color!==void 0&&(mt=3);let gt,dn,_n,le;if(ve){let Gn=ba[ve];gt=Gn.vertexShader,dn=Gn.fragmentShader}else gt=x.vertexShader,dn=x.fragmentShader,c.update(x),_n=c.getVertexShaderID(x),le=c.getFragmentShaderID(x);let _e=i.getRenderTarget(),Le=i.state.buffers.depth.getReversed(),Je=H.isInstancedMesh===!0,Ae=H.isBatchedMesh===!0,wn=!!x.map,Fn=!!x.matcap,zt=!!W,ye=!!x.aoMap,Me=!!x.lightMap,xe=!!x.bumpMap,Ve=!!x.normalMap,j=!!x.displacementMap,yt=!!x.emissiveMap,$e=!!x.metalnessMap,Mt=!!x.roughnessMap,Fe=x.anisotropy>0,I=x.clearcoat>0,M=x.dispersion>0,U=x.iridescence>0,se=x.sheen>0,be=x.transmission>0,ce=Fe&&!!x.anisotropyMap,Ke=I&&!!x.clearcoatMap,Ne=I&&!!x.clearcoatNormalMap,Ye=I&&!!x.clearcoatRoughnessMap,Ct=U&&!!x.iridescenceMap,Se=U&&!!x.iridescenceThicknessMap,ke=se&&!!x.sheenColorMap,it=se&&!!x.sheenRoughnessMap,ft=!!x.specularMap,je=!!x.specularColorMap,qt=!!x.specularIntensityMap,k=be&&!!x.transmissionMap,ze=be&&!!x.thicknessMap,De=!!x.gradientMap,Qe=!!x.alphaMap,Ce=x.alphaTest>0,we=!!x.alphaHash,Be=!!x.extensions,Xt=Ts;x.toneMapped&&(_e===null||_e.isXRRenderTarget===!0)&&(Xt=i.toneMapping);let di={shaderID:ve,shaderType:x.type,shaderName:x.name,vertexShader:gt,fragmentShader:dn,defines:x.defines,customVertexShaderID:_n,customFragmentShaderID:le,isRawShaderMaterial:x.isRawShaderMaterial===!0,glslVersion:x.glslVersion,precision:f,batching:Ae,batchingColor:Ae&&H._colorsTexture!==null,instancing:Je,instancingColor:Je&&H.instanceColor!==null,instancingMorph:Je&&H.morphTexture!==null,outputColorSpace:_e===null?i.outputColorSpace:_e.isXRRenderTarget===!0?_e.texture.colorSpace:nr,alphaToCoverage:!!x.alphaToCoverage,map:wn,matcap:Fn,envMap:zt,envMapMode:zt&&W.mapping,envMapCubeUVHeight:fe,aoMap:ye,lightMap:Me,bumpMap:xe,normalMap:Ve,displacementMap:j,emissiveMap:yt,normalMapObjectSpace:Ve&&x.normalMapType===rI,normalMapTangentSpace:Ve&&x.normalMapType===il,metalnessMap:$e,roughnessMap:Mt,anisotropy:Fe,anisotropyMap:ce,clearcoat:I,clearcoatMap:Ke,clearcoatNormalMap:Ne,clearcoatRoughnessMap:Ye,dispersion:M,iridescence:U,iridescenceMap:Ct,iridescenceThicknessMap:Se,sheen:se,sheenColorMap:ke,sheenRoughnessMap:it,specularMap:ft,specularColorMap:je,specularIntensityMap:qt,transmission:be,transmissionMap:k,thicknessMap:ze,gradientMap:De,opaque:x.transparent===!1&&x.blending===ys&&x.alphaToCoverage===!1,alphaMap:Qe,alphaTest:Ce,alphaHash:we,combine:x.combine,mapUv:wn&&_(x.map.channel),aoMapUv:ye&&_(x.aoMap.channel),lightMapUv:Me&&_(x.lightMap.channel),bumpMapUv:xe&&_(x.bumpMap.channel),normalMapUv:Ve&&_(x.normalMap.channel),displacementMapUv:j&&_(x.displacementMap.channel),emissiveMapUv:yt&&_(x.emissiveMap.channel),metalnessMapUv:$e&&_(x.metalnessMap.channel),roughnessMapUv:Mt&&_(x.roughnessMap.channel),anisotropyMapUv:ce&&_(x.anisotropyMap.channel),clearcoatMapUv:Ke&&_(x.clearcoatMap.channel),clearcoatNormalMapUv:Ne&&_(x.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ye&&_(x.clearcoatRoughnessMap.channel),iridescenceMapUv:Ct&&_(x.iridescenceMap.channel),iridescenceThicknessMapUv:Se&&_(x.iridescenceThicknessMap.channel),sheenColorMapUv:ke&&_(x.sheenColorMap.channel),sheenRoughnessMapUv:it&&_(x.sheenRoughnessMap.channel),specularMapUv:ft&&_(x.specularMap.channel),specularColorMapUv:je&&_(x.specularColorMap.channel),specularIntensityMapUv:qt&&_(x.specularIntensityMap.channel),transmissionMapUv:k&&_(x.transmissionMap.channel),thicknessMapUv:ze&&_(x.thicknessMap.channel),alphaMapUv:Qe&&_(x.alphaMap.channel),vertexTangents:!!Y.attributes.tangent&&(Ve||Fe),vertexColors:x.vertexColors,vertexAlphas:x.vertexColors===!0&&!!Y.attributes.color&&Y.attributes.color.itemSize===4,pointsUvs:H.isPoints===!0&&!!Y.attributes.uv&&(wn||Qe),fog:!!te,useFog:x.fog===!0,fogExp2:!!te&&te.isFogExp2,flatShading:x.flatShading===!0&&x.wireframe===!1,sizeAttenuation:x.sizeAttenuation===!0,logarithmicDepthBuffer:h,reversedDepthBuffer:Le,skinning:H.isSkinnedMesh===!0,morphTargets:Y.morphAttributes.position!==void 0,morphNormals:Y.morphAttributes.normal!==void 0,morphColors:Y.morphAttributes.color!==void 0,morphTargetsCount:Te,morphTextureStride:mt,numDirLights:T.directional.length,numPointLights:T.point.length,numSpotLights:T.spot.length,numSpotLightMaps:T.spotLightMap.length,numRectAreaLights:T.rectArea.length,numHemiLights:T.hemi.length,numDirLightShadows:T.directionalShadowMap.length,numPointLightShadows:T.pointShadowMap.length,numSpotLightShadows:T.spotShadowMap.length,numSpotLightShadowsWithMaps:T.numSpotLightShadowsWithMaps,numLightProbes:T.numLightProbes,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:x.dithering,shadowMapEnabled:i.shadowMap.enabled&&P.length>0,shadowMapType:i.shadowMap.type,toneMapping:Xt,decodeVideoTexture:wn&&x.map.isVideoTexture===!0&&hn.getTransfer(x.map.colorSpace)===kn,decodeVideoTextureEmissive:yt&&x.emissiveMap.isVideoTexture===!0&&hn.getTransfer(x.emissiveMap.colorSpace)===kn,premultipliedAlpha:x.premultipliedAlpha,doubleSided:x.side===rr,flipSided:x.side===qr,useDepthPacking:x.depthPacking>=0,depthPacking:x.depthPacking||0,index0AttributeName:x.index0AttributeName,extensionClipCullDistance:Be&&x.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Be&&x.extensions.multiDraw===!0||Ae)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:x.customProgramCacheKey()};return di.vertexUv1s=l.has(1),di.vertexUv2s=l.has(2),di.vertexUv3s=l.has(3),l.clear(),di}function p(x){let T=[];if(x.shaderID?T.push(x.shaderID):(T.push(x.customVertexShaderID),T.push(x.customFragmentShaderID)),x.defines!==void 0)for(let P in x.defines)T.push(P),T.push(x.defines[P]);return x.isRawShaderMaterial===!1&&(b(T,x),v(T,x),T.push(i.outputColorSpace)),T.push(x.customProgramCacheKey),T.join()}function b(x,T){x.push(T.precision),x.push(T.outputColorSpace),x.push(T.envMapMode),x.push(T.envMapCubeUVHeight),x.push(T.mapUv),x.push(T.alphaMapUv),x.push(T.lightMapUv),x.push(T.aoMapUv),x.push(T.bumpMapUv),x.push(T.normalMapUv),x.push(T.displacementMapUv),x.push(T.emissiveMapUv),x.push(T.metalnessMapUv),x.push(T.roughnessMapUv),x.push(T.anisotropyMapUv),x.push(T.clearcoatMapUv),x.push(T.clearcoatNormalMapUv),x.push(T.clearcoatRoughnessMapUv),x.push(T.iridescenceMapUv),x.push(T.iridescenceThicknessMapUv),x.push(T.sheenColorMapUv),x.push(T.sheenRoughnessMapUv),x.push(T.specularMapUv),x.push(T.specularColorMapUv),x.push(T.specularIntensityMapUv),x.push(T.transmissionMapUv),x.push(T.thicknessMapUv),x.push(T.combine),x.push(T.fogExp2),x.push(T.sizeAttenuation),x.push(T.morphTargetsCount),x.push(T.morphAttributeCount),x.push(T.numDirLights),x.push(T.numPointLights),x.push(T.numSpotLights),x.push(T.numSpotLightMaps),x.push(T.numHemiLights),x.push(T.numRectAreaLights),x.push(T.numDirLightShadows),x.push(T.numPointLightShadows),x.push(T.numSpotLightShadows),x.push(T.numSpotLightShadowsWithMaps),x.push(T.numLightProbes),x.push(T.shadowMapType),x.push(T.toneMapping),x.push(T.numClippingPlanes),x.push(T.numClipIntersection),x.push(T.depthPacking)}function v(x,T){a.disableAll(),T.instancing&&a.enable(0),T.instancingColor&&a.enable(1),T.instancingMorph&&a.enable(2),T.matcap&&a.enable(3),T.envMap&&a.enable(4),T.normalMapObjectSpace&&a.enable(5),T.normalMapTangentSpace&&a.enable(6),T.clearcoat&&a.enable(7),T.iridescence&&a.enable(8),T.alphaTest&&a.enable(9),T.vertexColors&&a.enable(10),T.vertexAlphas&&a.enable(11),T.vertexUv1s&&a.enable(12),T.vertexUv2s&&a.enable(13),T.vertexUv3s&&a.enable(14),T.vertexTangents&&a.enable(15),T.anisotropy&&a.enable(16),T.alphaHash&&a.enable(17),T.batching&&a.enable(18),T.dispersion&&a.enable(19),T.batchingColor&&a.enable(20),T.gradientMap&&a.enable(21),x.push(a.mask),a.disableAll(),T.fog&&a.enable(0),T.useFog&&a.enable(1),T.flatShading&&a.enable(2),T.logarithmicDepthBuffer&&a.enable(3),T.reversedDepthBuffer&&a.enable(4),T.skinning&&a.enable(5),T.morphTargets&&a.enable(6),T.morphNormals&&a.enable(7),T.morphColors&&a.enable(8),T.premultipliedAlpha&&a.enable(9),T.shadowMapEnabled&&a.enable(10),T.doubleSided&&a.enable(11),T.flipSided&&a.enable(12),T.useDepthPacking&&a.enable(13),T.dithering&&a.enable(14),T.transmission&&a.enable(15),T.sheen&&a.enable(16),T.opaque&&a.enable(17),T.pointsUvs&&a.enable(18),T.decodeVideoTexture&&a.enable(19),T.decodeVideoTextureEmissive&&a.enable(20),T.alphaToCoverage&&a.enable(21),x.push(a.mask)}function y(x){let T=g[x.type],P;if(T){let L=ba[T];P=Hn.clone(L.uniforms)}else P=x.uniforms;return P}function w(x,T){let P=d.get(T);return P!==void 0?++P.usedTimes:(P=new dK(i,T,x,o),u.push(P),d.set(T,P)),P}function R(x){if(--x.usedTimes===0){let T=u.indexOf(x);u[T]=u[u.length-1],u.pop(),d.delete(x.cacheKey),x.destroy()}}function E(x){c.remove(x)}function A(){c.dispose()}return{getParameters:m,getProgramCacheKey:p,getUniforms:y,acquireProgram:w,releaseProgram:R,releaseShaderCache:E,programs:u,dispose:A}}function pK(){let i=new WeakMap;function e(s){return i.has(s)}function t(s){let a=i.get(s);return a===void 0&&(a={},i.set(s,a)),a}function n(s){i.delete(s)}function r(s,a,c){i.get(s)[a]=c}function o(){i=new WeakMap}return{has:e,get:t,remove:n,update:r,dispose:o}}function mK(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function D3(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function I3(){let i=[],e=0,t=[],n=[],r=[];function o(){e=0,t.length=0,n.length=0,r.length=0}function s(d,h,f,g,_,m){let p=i[e];return p===void 0?(p={id:d.id,object:d,geometry:h,material:f,groupOrder:g,renderOrder:d.renderOrder,z:_,group:m},i[e]=p):(p.id=d.id,p.object=d,p.geometry=h,p.material=f,p.groupOrder=g,p.renderOrder=d.renderOrder,p.z=_,p.group=m),e++,p}function a(d,h,f,g,_,m){let p=s(d,h,f,g,_,m);f.transmission>0?n.push(p):f.transparent===!0?r.push(p):t.push(p)}function c(d,h,f,g,_,m){let p=s(d,h,f,g,_,m);f.transmission>0?n.unshift(p):f.transparent===!0?r.unshift(p):t.unshift(p)}function l(d,h){t.length>1&&t.sort(d||mK),n.length>1&&n.sort(h||D3),r.length>1&&r.sort(h||D3)}function u(){for(let d=e,h=i.length;d<h;d++){let f=i[d];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:t,transmissive:n,transparent:r,init:o,push:a,unshift:c,finish:u,sort:l}}function gK(){let i=new WeakMap;function e(n,r){let o=i.get(n),s;return o===void 0?(s=new I3,i.set(n,[s])):r>=o.length?(s=new I3,o.push(s)):s=o[r],s}function t(){i=new WeakMap}return{get:e,dispose:t}}function _K(){let i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new C,color:new ue};break;case"SpotLight":t={position:new C,direction:new C,color:new ue,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new C,color:new ue,distance:0,decay:0};break;case"HemisphereLight":t={direction:new C,skyColor:new ue,groundColor:new ue};break;case"RectAreaLight":t={color:new ue,position:new C,halfWidth:new C,halfHeight:new C};break}return i[e.id]=t,t}}}function bK(){let i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new z};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new z};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new z,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}var vK=0;function yK(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function xK(i){let e=new _K,t=bK(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let l=0;l<9;l++)n.probe.push(new C);let r=new C,o=new Ee,s=new Ee;function a(l){let u=0,d=0,h=0;for(let x=0;x<9;x++)n.probe[x].set(0,0,0);let f=0,g=0,_=0,m=0,p=0,b=0,v=0,y=0,w=0,R=0,E=0;l.sort(yK);for(let x=0,T=l.length;x<T;x++){let P=l[x],L=P.color,H=P.intensity,te=P.distance,Y=null;if(P.shadow&&P.shadow.map&&(P.shadow.map.texture.format===_u?Y=P.shadow.map.texture:Y=P.shadow.map.depthTexture||P.shadow.map.texture),P.isAmbientLight)u+=L.r*H,d+=L.g*H,h+=L.b*H;else if(P.isLightProbe){for(let J=0;J<9;J++)n.probe[J].addScaledVector(P.sh.coefficients[J],H);E++}else if(P.isDirectionalLight){let J=e.get(P);if(J.color.copy(P.color).multiplyScalar(P.intensity),P.castShadow){let W=P.shadow,fe=t.get(P);fe.shadowIntensity=W.intensity,fe.shadowBias=W.bias,fe.shadowNormalBias=W.normalBias,fe.shadowRadius=W.radius,fe.shadowMapSize=W.mapSize,n.directionalShadow[f]=fe,n.directionalShadowMap[f]=Y,n.directionalShadowMatrix[f]=P.shadow.matrix,b++}n.directional[f]=J,f++}else if(P.isSpotLight){let J=e.get(P);J.position.setFromMatrixPosition(P.matrixWorld),J.color.copy(L).multiplyScalar(H),J.distance=te,J.coneCos=Math.cos(P.angle),J.penumbraCos=Math.cos(P.angle*(1-P.penumbra)),J.decay=P.decay,n.spot[_]=J;let W=P.shadow;if(P.map&&(n.spotLightMap[w]=P.map,w++,W.updateMatrices(P),P.castShadow&&R++),n.spotLightMatrix[_]=W.matrix,P.castShadow){let fe=t.get(P);fe.shadowIntensity=W.intensity,fe.shadowBias=W.bias,fe.shadowNormalBias=W.normalBias,fe.shadowRadius=W.radius,fe.shadowMapSize=W.mapSize,n.spotShadow[_]=fe,n.spotShadowMap[_]=Y,y++}_++}else if(P.isRectAreaLight){let J=e.get(P);J.color.copy(L).multiplyScalar(H),J.halfWidth.set(P.width*.5,0,0),J.halfHeight.set(0,P.height*.5,0),n.rectArea[m]=J,m++}else if(P.isPointLight){let J=e.get(P);if(J.color.copy(P.color).multiplyScalar(P.intensity),J.distance=P.distance,J.decay=P.decay,P.castShadow){let W=P.shadow,fe=t.get(P);fe.shadowIntensity=W.intensity,fe.shadowBias=W.bias,fe.shadowNormalBias=W.normalBias,fe.shadowRadius=W.radius,fe.shadowMapSize=W.mapSize,fe.shadowCameraNear=W.camera.near,fe.shadowCameraFar=W.camera.far,n.pointShadow[g]=fe,n.pointShadowMap[g]=Y,n.pointShadowMatrix[g]=P.shadow.matrix,v++}n.point[g]=J,g++}else if(P.isHemisphereLight){let J=e.get(P);J.skyColor.copy(P.color).multiplyScalar(H),J.groundColor.copy(P.groundColor).multiplyScalar(H),n.hemi[p]=J,p++}}m>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=We.LTC_FLOAT_1,n.rectAreaLTC2=We.LTC_FLOAT_2):(n.rectAreaLTC1=We.LTC_HALF_1,n.rectAreaLTC2=We.LTC_HALF_2)),n.ambient[0]=u,n.ambient[1]=d,n.ambient[2]=h;let A=n.hash;(A.directionalLength!==f||A.pointLength!==g||A.spotLength!==_||A.rectAreaLength!==m||A.hemiLength!==p||A.numDirectionalShadows!==b||A.numPointShadows!==v||A.numSpotShadows!==y||A.numSpotMaps!==w||A.numLightProbes!==E)&&(n.directional.length=f,n.spot.length=_,n.rectArea.length=m,n.point.length=g,n.hemi.length=p,n.directionalShadow.length=b,n.directionalShadowMap.length=b,n.pointShadow.length=v,n.pointShadowMap.length=v,n.spotShadow.length=y,n.spotShadowMap.length=y,n.directionalShadowMatrix.length=b,n.pointShadowMatrix.length=v,n.spotLightMatrix.length=y+w-R,n.spotLightMap.length=w,n.numSpotLightShadowsWithMaps=R,n.numLightProbes=E,A.directionalLength=f,A.pointLength=g,A.spotLength=_,A.rectAreaLength=m,A.hemiLength=p,A.numDirectionalShadows=b,A.numPointShadows=v,A.numSpotShadows=y,A.numSpotMaps=w,A.numLightProbes=E,n.version=vK++)}function c(l,u){let d=0,h=0,f=0,g=0,_=0,m=u.matrixWorldInverse;for(let p=0,b=l.length;p<b;p++){let v=l[p];if(v.isDirectionalLight){let y=n.directional[d];y.direction.setFromMatrixPosition(v.matrixWorld),r.setFromMatrixPosition(v.target.matrixWorld),y.direction.sub(r),y.direction.transformDirection(m),d++}else if(v.isSpotLight){let y=n.spot[f];y.position.setFromMatrixPosition(v.matrixWorld),y.position.applyMatrix4(m),y.direction.setFromMatrixPosition(v.matrixWorld),r.setFromMatrixPosition(v.target.matrixWorld),y.direction.sub(r),y.direction.transformDirection(m),f++}else if(v.isRectAreaLight){let y=n.rectArea[g];y.position.setFromMatrixPosition(v.matrixWorld),y.position.applyMatrix4(m),s.identity(),o.copy(v.matrixWorld),o.premultiply(m),s.extractRotation(o),y.halfWidth.set(v.width*.5,0,0),y.halfHeight.set(0,v.height*.5,0),y.halfWidth.applyMatrix4(s),y.halfHeight.applyMatrix4(s),g++}else if(v.isPointLight){let y=n.point[h];y.position.setFromMatrixPosition(v.matrixWorld),y.position.applyMatrix4(m),h++}else if(v.isHemisphereLight){let y=n.hemi[_];y.direction.setFromMatrixPosition(v.matrixWorld),y.direction.transformDirection(m),_++}}}return{setup:a,setupView:c,state:n}}function A3(i){let e=new xK(i),t=[],n=[];function r(u){l.camera=u,t.length=0,n.length=0}function o(u){t.push(u)}function s(u){n.push(u)}function a(){e.setup(t)}function c(u){e.setupView(t,u)}let l={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:l,setupLights:a,setupLightsView:c,pushLight:o,pushShadow:s}}function wK(i){let e=new WeakMap;function t(r,o=0){let s=e.get(r),a;return s===void 0?(a=new A3(i),e.set(r,[a])):o>=s.length?(a=new A3(i),s.push(a)):a=s[o],a}function n(){e=new WeakMap}return{get:t,dispose:n}}var MK=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,SK=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,RK=[new C(1,0,0),new C(-1,0,0),new C(0,1,0),new C(0,-1,0),new C(0,0,1),new C(0,0,-1)],TK=[new C(0,-1,0),new C(0,-1,0),new C(0,0,1),new C(0,0,-1),new C(0,-1,0),new C(0,-1,0)],P3=new Ee,av=new C,RI=new C;function CK(i,e,t){let n=new Xc,r=new z,o=new z,s=new En,a=new du,c=new wp,l={},u=t.maxTextureSize,d={[vs]:qr,[qr]:vs,[rr]:rr},h=new Nt({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new z},radius:{value:4}},vertexShader:MK,fragmentShader:SK}),f=h.clone();f.defines.HORIZONTAL_PASS=1;let g=new nt;g.setAttribute("position",new pn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let _=new Pe(g,h),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Pp;let p=this.type;this.render=function(R,E,A){if(m.enabled===!1||m.autoUpdate===!1&&m.needsUpdate===!1||R.length===0)return;R.type===L1&&(Ue("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),R.type=Pp);let x=i.getRenderTarget(),T=i.getActiveCubeFace(),P=i.getActiveMipmapLevel(),L=i.state;L.setBlending(rn),L.buffers.depth.getReversed()===!0?L.buffers.color.setClear(0,0,0,0):L.buffers.color.setClear(1,1,1,1),L.buffers.depth.setTest(!0),L.setScissorTest(!1);let H=p!==this.type;H&&E.traverse(function(te){te.material&&(Array.isArray(te.material)?te.material.forEach(Y=>Y.needsUpdate=!0):te.material.needsUpdate=!0)});for(let te=0,Y=R.length;te<Y;te++){let J=R[te],W=J.shadow;if(W===void 0){Ue("WebGLShadowMap:",J,"has no shadow.");continue}if(W.autoUpdate===!1&&W.needsUpdate===!1)continue;r.copy(W.mapSize);let fe=W.getFrameExtents();if(r.multiply(fe),o.copy(W.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(o.x=Math.floor(u/fe.x),r.x=o.x*fe.x,W.mapSize.x=o.x),r.y>u&&(o.y=Math.floor(u/fe.y),r.y=o.y*fe.y,W.mapSize.y=o.y)),W.map===null||H===!0){if(W.map!==null&&(W.map.depthTexture!==null&&(W.map.depthTexture.dispose(),W.map.depthTexture=null),W.map.dispose()),this.type===mh){if(J.isPointLight){Ue("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}W.map=new Qt(r.x,r.y,{format:_u,type:An,minFilter:zn,magFilter:zn,generateMipmaps:!1}),W.map.texture.name=J.name+".shadowMap",W.map.depthTexture=new fo(r.x,r.y,tr),W.map.depthTexture.name=J.name+".shadowMapDepth",W.map.depthTexture.format=oa,W.map.depthTexture.compareFunction=null,W.map.depthTexture.minFilter=Zt,W.map.depthTexture.magFilter=Zt}else{J.isPointLight?(W.map=new dp(r.x),W.map.depthTexture=new T_(r.x,es)):(W.map=new Qt(r.x,r.y),W.map.depthTexture=new fo(r.x,r.y,es)),W.map.depthTexture.name=J.name+".shadowMap",W.map.depthTexture.format=oa;let Re=i.state.buffers.depth.getReversed();this.type===Pp?(W.map.depthTexture.compareFunction=Re?ov:rv,W.map.depthTexture.minFilter=zn,W.map.depthTexture.magFilter=zn):(W.map.depthTexture.compareFunction=null,W.map.depthTexture.minFilter=Zt,W.map.depthTexture.magFilter=Zt)}W.camera.updateProjectionMatrix()}let ve=W.map.isWebGLCubeRenderTarget?6:1;for(let Re=0;Re<ve;Re++){if(W.map.isWebGLCubeRenderTarget)i.setRenderTarget(W.map,Re),i.clear();else{Re===0&&(i.setRenderTarget(W.map),i.clear());let Te=W.getViewport(Re);s.set(o.x*Te.x,o.y*Te.y,o.x*Te.z,o.y*Te.w),L.viewport(s)}if(J.isPointLight){let Te=W.camera,mt=W.matrix,gt=J.distance||Te.far;gt!==Te.far&&(Te.far=gt,Te.updateProjectionMatrix()),av.setFromMatrixPosition(J.matrixWorld),Te.position.copy(av),RI.copy(Te.position),RI.add(RK[Re]),Te.up.copy(TK[Re]),Te.lookAt(RI),Te.updateMatrixWorld(),mt.makeTranslation(-av.x,-av.y,-av.z),P3.multiplyMatrices(Te.projectionMatrix,Te.matrixWorldInverse),W._frustum.setFromProjectionMatrix(P3,Te.coordinateSystem,Te.reversedDepth)}else W.updateMatrices(J);n=W.getFrustum(),y(E,A,W.camera,J,this.type)}W.isPointLightShadow!==!0&&this.type===mh&&b(W,A),W.needsUpdate=!1}p=this.type,m.needsUpdate=!1,i.setRenderTarget(x,T,P)};function b(R,E){let A=e.update(_);h.defines.VSM_SAMPLES!==R.blurSamples&&(h.defines.VSM_SAMPLES=R.blurSamples,f.defines.VSM_SAMPLES=R.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),R.mapPass===null&&(R.mapPass=new Qt(r.x,r.y,{format:_u,type:An})),h.uniforms.shadow_pass.value=R.map.depthTexture,h.uniforms.resolution.value=R.mapSize,h.uniforms.radius.value=R.radius,i.setRenderTarget(R.mapPass),i.clear(),i.renderBufferDirect(E,null,A,h,_,null),f.uniforms.shadow_pass.value=R.mapPass.texture,f.uniforms.resolution.value=R.mapSize,f.uniforms.radius.value=R.radius,i.setRenderTarget(R.map),i.clear(),i.renderBufferDirect(E,null,A,f,_,null)}function v(R,E,A,x){let T=null,P=A.isPointLight===!0?R.customDistanceMaterial:R.customDepthMaterial;if(P!==void 0)T=P;else if(T=A.isPointLight===!0?c:a,i.localClippingEnabled&&E.clipShadows===!0&&Array.isArray(E.clippingPlanes)&&E.clippingPlanes.length!==0||E.displacementMap&&E.displacementScale!==0||E.alphaMap&&E.alphaTest>0||E.map&&E.alphaTest>0||E.alphaToCoverage===!0){let L=T.uuid,H=E.uuid,te=l[L];te===void 0&&(te={},l[L]=te);let Y=te[H];Y===void 0&&(Y=T.clone(),te[H]=Y,E.addEventListener("dispose",w)),T=Y}if(T.visible=E.visible,T.wireframe=E.wireframe,x===mh?T.side=E.shadowSide!==null?E.shadowSide:E.side:T.side=E.shadowSide!==null?E.shadowSide:d[E.side],T.alphaMap=E.alphaMap,T.alphaTest=E.alphaToCoverage===!0?.5:E.alphaTest,T.map=E.map,T.clipShadows=E.clipShadows,T.clippingPlanes=E.clippingPlanes,T.clipIntersection=E.clipIntersection,T.displacementMap=E.displacementMap,T.displacementScale=E.displacementScale,T.displacementBias=E.displacementBias,T.wireframeLinewidth=E.wireframeLinewidth,T.linewidth=E.linewidth,A.isPointLight===!0&&T.isMeshDistanceMaterial===!0){let L=i.properties.get(T);L.light=A}return T}function y(R,E,A,x,T){if(R.visible===!1)return;if(R.layers.test(E.layers)&&(R.isMesh||R.isLine||R.isPoints)&&(R.castShadow||R.receiveShadow&&T===mh)&&(!R.frustumCulled||n.intersectsObject(R))){R.modelViewMatrix.multiplyMatrices(A.matrixWorldInverse,R.matrixWorld);let H=e.update(R),te=R.material;if(Array.isArray(te)){let Y=H.groups;for(let J=0,W=Y.length;J<W;J++){let fe=Y[J],ve=te[fe.materialIndex];if(ve&&ve.visible){let Re=v(R,ve,x,T);R.onBeforeShadow(i,R,E,A,H,Re,fe),i.renderBufferDirect(A,null,H,Re,R,fe),R.onAfterShadow(i,R,E,A,H,Re,fe)}}}else if(te.visible){let Y=v(R,te,x,T);R.onBeforeShadow(i,R,E,A,H,Y,null),i.renderBufferDirect(A,null,H,Y,R,null),R.onAfterShadow(i,R,E,A,H,Y,null)}}let L=R.children;for(let H=0,te=L.length;H<te;H++)y(L[H],E,A,x,T)}function w(R){R.target.removeEventListener("dispose",w);for(let A in l){let x=l[A],T=R.target.uuid;T in x&&(x[T].dispose(),delete x[T])}}}var EK={[hb]:fb,[pb]:_b,[mb]:bb,[nu]:gb,[fb]:hb,[_b]:pb,[bb]:mb,[gb]:nu};function DK(i,e){function t(){let k=!1,ze=new En,De=null,Qe=new En(0,0,0,0);return{setMask:function(Ce){De!==Ce&&!k&&(i.colorMask(Ce,Ce,Ce,Ce),De=Ce)},setLocked:function(Ce){k=Ce},setClear:function(Ce,we,Be,Xt,di){di===!0&&(Ce*=Xt,we*=Xt,Be*=Xt),ze.set(Ce,we,Be,Xt),Qe.equals(ze)===!1&&(i.clearColor(Ce,we,Be,Xt),Qe.copy(ze))},reset:function(){k=!1,De=null,Qe.set(-1,0,0,0)}}}function n(){let k=!1,ze=!1,De=null,Qe=null,Ce=null;return{setReversed:function(we){if(ze!==we){let Be=e.get("EXT_clip_control");we?Be.clipControlEXT(Be.LOWER_LEFT_EXT,Be.ZERO_TO_ONE_EXT):Be.clipControlEXT(Be.LOWER_LEFT_EXT,Be.NEGATIVE_ONE_TO_ONE_EXT),ze=we;let Xt=Ce;Ce=null,this.setClear(Xt)}},getReversed:function(){return ze},setTest:function(we){we?_e(i.DEPTH_TEST):Le(i.DEPTH_TEST)},setMask:function(we){De!==we&&!k&&(i.depthMask(we),De=we)},setFunc:function(we){if(ze&&(we=EK[we]),Qe!==we){switch(we){case hb:i.depthFunc(i.NEVER);break;case fb:i.depthFunc(i.ALWAYS);break;case pb:i.depthFunc(i.LESS);break;case nu:i.depthFunc(i.LEQUAL);break;case mb:i.depthFunc(i.EQUAL);break;case gb:i.depthFunc(i.GEQUAL);break;case _b:i.depthFunc(i.GREATER);break;case bb:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}Qe=we}},setLocked:function(we){k=we},setClear:function(we){Ce!==we&&(ze&&(we=1-we),i.clearDepth(we),Ce=we)},reset:function(){k=!1,De=null,Qe=null,Ce=null,ze=!1}}}function r(){let k=!1,ze=null,De=null,Qe=null,Ce=null,we=null,Be=null,Xt=null,di=null;return{setTest:function(Gn){k||(Gn?_e(i.STENCIL_TEST):Le(i.STENCIL_TEST))},setMask:function(Gn){ze!==Gn&&!k&&(i.stencilMask(Gn),ze=Gn)},setFunc:function(Gn,Ia,xc){(De!==Gn||Qe!==Ia||Ce!==xc)&&(i.stencilFunc(Gn,Ia,xc),De=Gn,Qe=Ia,Ce=xc)},setOp:function(Gn,Ia,xc){(we!==Gn||Be!==Ia||Xt!==xc)&&(i.stencilOp(Gn,Ia,xc),we=Gn,Be=Ia,Xt=xc)},setLocked:function(Gn){k=Gn},setClear:function(Gn){di!==Gn&&(i.clearStencil(Gn),di=Gn)},reset:function(){k=!1,ze=null,De=null,Qe=null,Ce=null,we=null,Be=null,Xt=null,di=null}}}let o=new t,s=new n,a=new r,c=new WeakMap,l=new WeakMap,u={},d={},h=new WeakMap,f=[],g=null,_=!1,m=null,p=null,b=null,v=null,y=null,w=null,R=null,E=new ue(0,0,0),A=0,x=!1,T=null,P=null,L=null,H=null,te=null,Y=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS),J=!1,W=0,fe=i.getParameter(i.VERSION);fe.indexOf("WebGL")!==-1?(W=parseFloat(/^WebGL (\d)/.exec(fe)[1]),J=W>=1):fe.indexOf("OpenGL ES")!==-1&&(W=parseFloat(/^OpenGL ES (\d)/.exec(fe)[1]),J=W>=2);let ve=null,Re={},Te=i.getParameter(i.SCISSOR_BOX),mt=i.getParameter(i.VIEWPORT),gt=new En().fromArray(Te),dn=new En().fromArray(mt);function _n(k,ze,De,Qe){let Ce=new Uint8Array(4),we=i.createTexture();i.bindTexture(k,we),i.texParameteri(k,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(k,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let Be=0;Be<De;Be++)k===i.TEXTURE_3D||k===i.TEXTURE_2D_ARRAY?i.texImage3D(ze,0,i.RGBA,1,1,Qe,0,i.RGBA,i.UNSIGNED_BYTE,Ce):i.texImage2D(ze+Be,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,Ce);return we}let le={};le[i.TEXTURE_2D]=_n(i.TEXTURE_2D,i.TEXTURE_2D,1),le[i.TEXTURE_CUBE_MAP]=_n(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),le[i.TEXTURE_2D_ARRAY]=_n(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),le[i.TEXTURE_3D]=_n(i.TEXTURE_3D,i.TEXTURE_3D,1,1),o.setClear(0,0,0,1),s.setClear(1),a.setClear(0),_e(i.DEPTH_TEST),s.setFunc(nu),xe(!1),Ve(fM),_e(i.CULL_FACE),ye(rn);function _e(k){u[k]!==!0&&(i.enable(k),u[k]=!0)}function Le(k){u[k]!==!1&&(i.disable(k),u[k]=!1)}function Je(k,ze){return d[k]!==ze?(i.bindFramebuffer(k,ze),d[k]=ze,k===i.DRAW_FRAMEBUFFER&&(d[i.FRAMEBUFFER]=ze),k===i.FRAMEBUFFER&&(d[i.DRAW_FRAMEBUFFER]=ze),!0):!1}function Ae(k,ze){let De=f,Qe=!1;if(k){De=h.get(ze),De===void 0&&(De=[],h.set(ze,De));let Ce=k.textures;if(De.length!==Ce.length||De[0]!==i.COLOR_ATTACHMENT0){for(let we=0,Be=Ce.length;we<Be;we++)De[we]=i.COLOR_ATTACHMENT0+we;De.length=Ce.length,Qe=!0}}else De[0]!==i.BACK&&(De[0]=i.BACK,Qe=!0);Qe&&i.drawBuffers(De)}function wn(k){return g!==k?(i.useProgram(k),g=k,!0):!1}let Fn={[Er]:i.FUNC_ADD,[k1]:i.FUNC_SUBTRACT,[B1]:i.FUNC_REVERSE_SUBTRACT};Fn[U1]=i.MIN,Fn[V1]=i.MAX;let zt={[Kc]:i.ZERO,[z1]:i.ONE,[H1]:i.SRC_COLOR,[eu]:i.SRC_ALPHA,[q1]:i.SRC_ALPHA_SATURATE,[_h]:i.DST_COLOR,[gh]:i.DST_ALPHA,[G1]:i.ONE_MINUS_SRC_COLOR,[tu]:i.ONE_MINUS_SRC_ALPHA,[$1]:i.ONE_MINUS_DST_COLOR,[W1]:i.ONE_MINUS_DST_ALPHA,[X1]:i.CONSTANT_COLOR,[Z1]:i.ONE_MINUS_CONSTANT_COLOR,[Y1]:i.CONSTANT_ALPHA,[Q1]:i.ONE_MINUS_CONSTANT_ALPHA};function ye(k,ze,De,Qe,Ce,we,Be,Xt,di,Gn){if(k===rn){_===!0&&(Le(i.BLEND),_=!1);return}if(_===!1&&(_e(i.BLEND),_=!0),k!==mu){if(k!==m||Gn!==x){if((p!==Er||y!==Er)&&(i.blendEquation(i.FUNC_ADD),p=Er,y=Er),Gn)switch(k){case ys:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case pu:i.blendFunc(i.ONE,i.ONE);break;case pM:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case mM:i.blendFuncSeparate(i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ZERO,i.ONE);break;default:bt("WebGLState: Invalid blending: ",k);break}else switch(k){case ys:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case pu:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE,i.ONE,i.ONE);break;case pM:bt("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case mM:bt("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:bt("WebGLState: Invalid blending: ",k);break}b=null,v=null,w=null,R=null,E.set(0,0,0),A=0,m=k,x=Gn}return}Ce=Ce||ze,we=we||De,Be=Be||Qe,(ze!==p||Ce!==y)&&(i.blendEquationSeparate(Fn[ze],Fn[Ce]),p=ze,y=Ce),(De!==b||Qe!==v||we!==w||Be!==R)&&(i.blendFuncSeparate(zt[De],zt[Qe],zt[we],zt[Be]),b=De,v=Qe,w=we,R=Be),(Xt.equals(E)===!1||di!==A)&&(i.blendColor(Xt.r,Xt.g,Xt.b,di),E.copy(Xt),A=di),m=k,x=!1}function Me(k,ze){k.side===rr?Le(i.CULL_FACE):_e(i.CULL_FACE);let De=k.side===qr;ze&&(De=!De),xe(De),k.blending===ys&&k.transparent===!1?ye(rn):ye(k.blending,k.blendEquation,k.blendSrc,k.blendDst,k.blendEquationAlpha,k.blendSrcAlpha,k.blendDstAlpha,k.blendColor,k.blendAlpha,k.premultipliedAlpha),s.setFunc(k.depthFunc),s.setTest(k.depthTest),s.setMask(k.depthWrite),o.setMask(k.colorWrite);let Qe=k.stencilWrite;a.setTest(Qe),Qe&&(a.setMask(k.stencilWriteMask),a.setFunc(k.stencilFunc,k.stencilRef,k.stencilFuncMask),a.setOp(k.stencilFail,k.stencilZFail,k.stencilZPass)),yt(k.polygonOffset,k.polygonOffsetFactor,k.polygonOffsetUnits),k.alphaToCoverage===!0?_e(i.SAMPLE_ALPHA_TO_COVERAGE):Le(i.SAMPLE_ALPHA_TO_COVERAGE)}function xe(k){T!==k&&(k?i.frontFace(i.CW):i.frontFace(i.CCW),T=k)}function Ve(k){k!==j1?(_e(i.CULL_FACE),k!==P&&(k===fM?i.cullFace(i.BACK):k===O1?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):Le(i.CULL_FACE),P=k}function j(k){k!==L&&(J&&i.lineWidth(k),L=k)}function yt(k,ze,De){k?(_e(i.POLYGON_OFFSET_FILL),(H!==ze||te!==De)&&(i.polygonOffset(ze,De),H=ze,te=De)):Le(i.POLYGON_OFFSET_FILL)}function $e(k){k?_e(i.SCISSOR_TEST):Le(i.SCISSOR_TEST)}function Mt(k){k===void 0&&(k=i.TEXTURE0+Y-1),ve!==k&&(i.activeTexture(k),ve=k)}function Fe(k,ze,De){De===void 0&&(ve===null?De=i.TEXTURE0+Y-1:De=ve);let Qe=Re[De];Qe===void 0&&(Qe={type:void 0,texture:void 0},Re[De]=Qe),(Qe.type!==k||Qe.texture!==ze)&&(ve!==De&&(i.activeTexture(De),ve=De),i.bindTexture(k,ze||le[k]),Qe.type=k,Qe.texture=ze)}function I(){let k=Re[ve];k!==void 0&&k.type!==void 0&&(i.bindTexture(k.type,null),k.type=void 0,k.texture=void 0)}function M(){try{i.compressedTexImage2D(...arguments)}catch(k){bt("WebGLState:",k)}}function U(){try{i.compressedTexImage3D(...arguments)}catch(k){bt("WebGLState:",k)}}function se(){try{i.texSubImage2D(...arguments)}catch(k){bt("WebGLState:",k)}}function be(){try{i.texSubImage3D(...arguments)}catch(k){bt("WebGLState:",k)}}function ce(){try{i.compressedTexSubImage2D(...arguments)}catch(k){bt("WebGLState:",k)}}function Ke(){try{i.compressedTexSubImage3D(...arguments)}catch(k){bt("WebGLState:",k)}}function Ne(){try{i.texStorage2D(...arguments)}catch(k){bt("WebGLState:",k)}}function Ye(){try{i.texStorage3D(...arguments)}catch(k){bt("WebGLState:",k)}}function Ct(){try{i.texImage2D(...arguments)}catch(k){bt("WebGLState:",k)}}function Se(){try{i.texImage3D(...arguments)}catch(k){bt("WebGLState:",k)}}function ke(k){gt.equals(k)===!1&&(i.scissor(k.x,k.y,k.z,k.w),gt.copy(k))}function it(k){dn.equals(k)===!1&&(i.viewport(k.x,k.y,k.z,k.w),dn.copy(k))}function ft(k,ze){let De=l.get(ze);De===void 0&&(De=new WeakMap,l.set(ze,De));let Qe=De.get(k);Qe===void 0&&(Qe=i.getUniformBlockIndex(ze,k.name),De.set(k,Qe))}function je(k,ze){let Qe=l.get(ze).get(k);c.get(ze)!==Qe&&(i.uniformBlockBinding(ze,Qe,k.__bindingPointIndex),c.set(ze,Qe))}function qt(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),s.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),u={},ve=null,Re={},d={},h=new WeakMap,f=[],g=null,_=!1,m=null,p=null,b=null,v=null,y=null,w=null,R=null,E=new ue(0,0,0),A=0,x=!1,T=null,P=null,L=null,H=null,te=null,gt.set(0,0,i.canvas.width,i.canvas.height),dn.set(0,0,i.canvas.width,i.canvas.height),o.reset(),s.reset(),a.reset()}return{buffers:{color:o,depth:s,stencil:a},enable:_e,disable:Le,bindFramebuffer:Je,drawBuffers:Ae,useProgram:wn,setBlending:ye,setMaterial:Me,setFlipSided:xe,setCullFace:Ve,setLineWidth:j,setPolygonOffset:yt,setScissorTest:$e,activeTexture:Mt,bindTexture:Fe,unbindTexture:I,compressedTexImage2D:M,compressedTexImage3D:U,texImage2D:Ct,texImage3D:Se,updateUBOMapping:ft,uniformBlockBinding:je,texStorage2D:Ne,texStorage3D:Ye,texSubImage2D:se,texSubImage3D:be,compressedTexSubImage2D:ce,compressedTexSubImage3D:Ke,scissor:ke,viewport:it,reset:qt}}function IK(i,e,t,n,r,o,s){let a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),l=new z,u=new WeakMap,d,h=new WeakMap,f=!1;try{f=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function g(I,M){return f?new OffscreenCanvas(I,M):sp("canvas")}function _(I,M,U){let se=1,be=Fe(I);if((be.width>U||be.height>U)&&(se=U/Math.max(be.width,be.height)),se<1)if(typeof HTMLImageElement<"u"&&I instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&I instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&I instanceof ImageBitmap||typeof VideoFrame<"u"&&I instanceof VideoFrame){let ce=Math.floor(se*be.width),Ke=Math.floor(se*be.height);d===void 0&&(d=g(ce,Ke));let Ne=M?g(ce,Ke):d;return Ne.width=ce,Ne.height=Ke,Ne.getContext("2d").drawImage(I,0,0,ce,Ke),Ue("WebGLRenderer: Texture has been resized from ("+be.width+"x"+be.height+") to ("+ce+"x"+Ke+")."),Ne}else return"data"in I&&Ue("WebGLRenderer: Image in DataTexture is too big ("+be.width+"x"+be.height+")."),I;return I}function m(I){return I.generateMipmaps}function p(I){i.generateMipmap(I)}function b(I){return I.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:I.isWebGL3DRenderTarget?i.TEXTURE_3D:I.isWebGLArrayRenderTarget||I.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function v(I,M,U,se,be=!1){if(I!==null){if(i[I]!==void 0)return i[I];Ue("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+I+"'")}let ce=M;if(M===i.RED&&(U===i.FLOAT&&(ce=i.R32F),U===i.HALF_FLOAT&&(ce=i.R16F),U===i.UNSIGNED_BYTE&&(ce=i.R8)),M===i.RED_INTEGER&&(U===i.UNSIGNED_BYTE&&(ce=i.R8UI),U===i.UNSIGNED_SHORT&&(ce=i.R16UI),U===i.UNSIGNED_INT&&(ce=i.R32UI),U===i.BYTE&&(ce=i.R8I),U===i.SHORT&&(ce=i.R16I),U===i.INT&&(ce=i.R32I)),M===i.RG&&(U===i.FLOAT&&(ce=i.RG32F),U===i.HALF_FLOAT&&(ce=i.RG16F),U===i.UNSIGNED_BYTE&&(ce=i.RG8)),M===i.RG_INTEGER&&(U===i.UNSIGNED_BYTE&&(ce=i.RG8UI),U===i.UNSIGNED_SHORT&&(ce=i.RG16UI),U===i.UNSIGNED_INT&&(ce=i.RG32UI),U===i.BYTE&&(ce=i.RG8I),U===i.SHORT&&(ce=i.RG16I),U===i.INT&&(ce=i.RG32I)),M===i.RGB_INTEGER&&(U===i.UNSIGNED_BYTE&&(ce=i.RGB8UI),U===i.UNSIGNED_SHORT&&(ce=i.RGB16UI),U===i.UNSIGNED_INT&&(ce=i.RGB32UI),U===i.BYTE&&(ce=i.RGB8I),U===i.SHORT&&(ce=i.RGB16I),U===i.INT&&(ce=i.RGB32I)),M===i.RGBA_INTEGER&&(U===i.UNSIGNED_BYTE&&(ce=i.RGBA8UI),U===i.UNSIGNED_SHORT&&(ce=i.RGBA16UI),U===i.UNSIGNED_INT&&(ce=i.RGBA32UI),U===i.BYTE&&(ce=i.RGBA8I),U===i.SHORT&&(ce=i.RGBA16I),U===i.INT&&(ce=i.RGBA32I)),M===i.RGB&&(U===i.UNSIGNED_INT_5_9_9_9_REV&&(ce=i.RGB9_E5),U===i.UNSIGNED_INT_10F_11F_11F_REV&&(ce=i.R11F_G11F_B10F)),M===i.RGBA){let Ke=be?rp:hn.getTransfer(se);U===i.FLOAT&&(ce=i.RGBA32F),U===i.HALF_FLOAT&&(ce=i.RGBA16F),U===i.UNSIGNED_BYTE&&(ce=Ke===kn?i.SRGB8_ALPHA8:i.RGBA8),U===i.UNSIGNED_SHORT_4_4_4_4&&(ce=i.RGBA4),U===i.UNSIGNED_SHORT_5_5_5_1&&(ce=i.RGB5_A1)}return(ce===i.R16F||ce===i.R32F||ce===i.RG16F||ce===i.RG32F||ce===i.RGBA16F||ce===i.RGBA32F)&&e.get("EXT_color_buffer_float"),ce}function y(I,M){let U;return I?M===null||M===es||M===_a?U=i.DEPTH24_STENCIL8:M===tr?U=i.DEPTH32F_STENCIL8:M===tl&&(U=i.DEPTH24_STENCIL8,Ue("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):M===null||M===es||M===_a?U=i.DEPTH_COMPONENT24:M===tr?U=i.DEPTH_COMPONENT32F:M===tl&&(U=i.DEPTH_COMPONENT16),U}function w(I,M){return m(I)===!0||I.isFramebufferTexture&&I.minFilter!==Zt&&I.minFilter!==zn?Math.log2(Math.max(M.width,M.height))+1:I.mipmaps!==void 0&&I.mipmaps.length>0?I.mipmaps.length:I.isCompressedTexture&&Array.isArray(I.image)?M.mipmaps.length:1}function R(I){let M=I.target;M.removeEventListener("dispose",R),A(M),M.isVideoTexture&&u.delete(M)}function E(I){let M=I.target;M.removeEventListener("dispose",E),T(M)}function A(I){let M=n.get(I);if(M.__webglInit===void 0)return;let U=I.source,se=h.get(U);if(se){let be=se[M.__cacheKey];be.usedTimes--,be.usedTimes===0&&x(I),Object.keys(se).length===0&&h.delete(U)}n.remove(I)}function x(I){let M=n.get(I);i.deleteTexture(M.__webglTexture);let U=I.source,se=h.get(U);delete se[M.__cacheKey],s.memory.textures--}function T(I){let M=n.get(I);if(I.depthTexture&&(I.depthTexture.dispose(),n.remove(I.depthTexture)),I.isWebGLCubeRenderTarget)for(let se=0;se<6;se++){if(Array.isArray(M.__webglFramebuffer[se]))for(let be=0;be<M.__webglFramebuffer[se].length;be++)i.deleteFramebuffer(M.__webglFramebuffer[se][be]);else i.deleteFramebuffer(M.__webglFramebuffer[se]);M.__webglDepthbuffer&&i.deleteRenderbuffer(M.__webglDepthbuffer[se])}else{if(Array.isArray(M.__webglFramebuffer))for(let se=0;se<M.__webglFramebuffer.length;se++)i.deleteFramebuffer(M.__webglFramebuffer[se]);else i.deleteFramebuffer(M.__webglFramebuffer);if(M.__webglDepthbuffer&&i.deleteRenderbuffer(M.__webglDepthbuffer),M.__webglMultisampledFramebuffer&&i.deleteFramebuffer(M.__webglMultisampledFramebuffer),M.__webglColorRenderbuffer)for(let se=0;se<M.__webglColorRenderbuffer.length;se++)M.__webglColorRenderbuffer[se]&&i.deleteRenderbuffer(M.__webglColorRenderbuffer[se]);M.__webglDepthRenderbuffer&&i.deleteRenderbuffer(M.__webglDepthRenderbuffer)}let U=I.textures;for(let se=0,be=U.length;se<be;se++){let ce=n.get(U[se]);ce.__webglTexture&&(i.deleteTexture(ce.__webglTexture),s.memory.textures--),n.remove(U[se])}n.remove(I)}let P=0;function L(){P=0}function H(){let I=P;return I>=r.maxTextures&&Ue("WebGLTextures: Trying to use "+I+" texture units while this GPU supports only "+r.maxTextures),P+=1,I}function te(I){let M=[];return M.push(I.wrapS),M.push(I.wrapT),M.push(I.wrapR||0),M.push(I.magFilter),M.push(I.minFilter),M.push(I.anisotropy),M.push(I.internalFormat),M.push(I.format),M.push(I.type),M.push(I.generateMipmaps),M.push(I.premultiplyAlpha),M.push(I.flipY),M.push(I.unpackAlignment),M.push(I.colorSpace),M.join()}function Y(I,M){let U=n.get(I);if(I.isVideoTexture&&$e(I),I.isRenderTargetTexture===!1&&I.isExternalTexture!==!0&&I.version>0&&U.__version!==I.version){let se=I.image;if(se===null)Ue("WebGLRenderer: Texture marked for update but no image data found.");else if(se.complete===!1)Ue("WebGLRenderer: Texture marked for update but image is incomplete");else{le(U,I,M);return}}else I.isExternalTexture&&(U.__webglTexture=I.sourceTexture?I.sourceTexture:null);t.bindTexture(i.TEXTURE_2D,U.__webglTexture,i.TEXTURE0+M)}function J(I,M){let U=n.get(I);if(I.isRenderTargetTexture===!1&&I.version>0&&U.__version!==I.version){le(U,I,M);return}else I.isExternalTexture&&(U.__webglTexture=I.sourceTexture?I.sourceTexture:null);t.bindTexture(i.TEXTURE_2D_ARRAY,U.__webglTexture,i.TEXTURE0+M)}function W(I,M){let U=n.get(I);if(I.isRenderTargetTexture===!1&&I.version>0&&U.__version!==I.version){le(U,I,M);return}t.bindTexture(i.TEXTURE_3D,U.__webglTexture,i.TEXTURE0+M)}function fe(I,M){let U=n.get(I);if(I.isCubeDepthTexture!==!0&&I.version>0&&U.__version!==I.version){_e(U,I,M);return}t.bindTexture(i.TEXTURE_CUBE_MAP,U.__webglTexture,i.TEXTURE0+M)}let ve={[Qo]:i.REPEAT,[jr]:i.CLAMP_TO_EDGE,[iu]:i.MIRRORED_REPEAT},Re={[Zt]:i.NEAREST,[Op]:i.NEAREST_MIPMAP_NEAREST,[el]:i.NEAREST_MIPMAP_LINEAR,[zn]:i.LINEAR,[gu]:i.LINEAR_MIPMAP_NEAREST,[Po]:i.LINEAR_MIPMAP_LINEAR},Te={[oI]:i.NEVER,[uI]:i.ALWAYS,[sI]:i.LESS,[rv]:i.LEQUAL,[aI]:i.EQUAL,[ov]:i.GEQUAL,[cI]:i.GREATER,[lI]:i.NOTEQUAL};function mt(I,M){if(M.type===tr&&e.has("OES_texture_float_linear")===!1&&(M.magFilter===zn||M.magFilter===gu||M.magFilter===el||M.magFilter===Po||M.minFilter===zn||M.minFilter===gu||M.minFilter===el||M.minFilter===Po)&&Ue("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(I,i.TEXTURE_WRAP_S,ve[M.wrapS]),i.texParameteri(I,i.TEXTURE_WRAP_T,ve[M.wrapT]),(I===i.TEXTURE_3D||I===i.TEXTURE_2D_ARRAY)&&i.texParameteri(I,i.TEXTURE_WRAP_R,ve[M.wrapR]),i.texParameteri(I,i.TEXTURE_MAG_FILTER,Re[M.magFilter]),i.texParameteri(I,i.TEXTURE_MIN_FILTER,Re[M.minFilter]),M.compareFunction&&(i.texParameteri(I,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(I,i.TEXTURE_COMPARE_FUNC,Te[M.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(M.magFilter===Zt||M.minFilter!==el&&M.minFilter!==Po||M.type===tr&&e.has("OES_texture_float_linear")===!1)return;if(M.anisotropy>1||n.get(M).__currentAnisotropy){let U=e.get("EXT_texture_filter_anisotropic");i.texParameterf(I,U.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(M.anisotropy,r.getMaxAnisotropy())),n.get(M).__currentAnisotropy=M.anisotropy}}}function gt(I,M){let U=!1;I.__webglInit===void 0&&(I.__webglInit=!0,M.addEventListener("dispose",R));let se=M.source,be=h.get(se);be===void 0&&(be={},h.set(se,be));let ce=te(M);if(ce!==I.__cacheKey){be[ce]===void 0&&(be[ce]={texture:i.createTexture(),usedTimes:0},s.memory.textures++,U=!0),be[ce].usedTimes++;let Ke=be[I.__cacheKey];Ke!==void 0&&(be[I.__cacheKey].usedTimes--,Ke.usedTimes===0&&x(M)),I.__cacheKey=ce,I.__webglTexture=be[ce].texture}return U}function dn(I,M,U){return Math.floor(Math.floor(I/U)/M)}function _n(I,M,U,se){let ce=I.updateRanges;if(ce.length===0)t.texSubImage2D(i.TEXTURE_2D,0,0,0,M.width,M.height,U,se,M.data);else{ce.sort((Se,ke)=>Se.start-ke.start);let Ke=0;for(let Se=1;Se<ce.length;Se++){let ke=ce[Ke],it=ce[Se],ft=ke.start+ke.count,je=dn(it.start,M.width,4),qt=dn(ke.start,M.width,4);it.start<=ft+1&&je===qt&&dn(it.start+it.count-1,M.width,4)===je?ke.count=Math.max(ke.count,it.start+it.count-ke.start):(++Ke,ce[Ke]=it)}ce.length=Ke+1;let Ne=i.getParameter(i.UNPACK_ROW_LENGTH),Ye=i.getParameter(i.UNPACK_SKIP_PIXELS),Ct=i.getParameter(i.UNPACK_SKIP_ROWS);i.pixelStorei(i.UNPACK_ROW_LENGTH,M.width);for(let Se=0,ke=ce.length;Se<ke;Se++){let it=ce[Se],ft=Math.floor(it.start/4),je=Math.ceil(it.count/4),qt=ft%M.width,k=Math.floor(ft/M.width),ze=je,De=1;i.pixelStorei(i.UNPACK_SKIP_PIXELS,qt),i.pixelStorei(i.UNPACK_SKIP_ROWS,k),t.texSubImage2D(i.TEXTURE_2D,0,qt,k,ze,De,U,se,M.data)}I.clearUpdateRanges(),i.pixelStorei(i.UNPACK_ROW_LENGTH,Ne),i.pixelStorei(i.UNPACK_SKIP_PIXELS,Ye),i.pixelStorei(i.UNPACK_SKIP_ROWS,Ct)}}function le(I,M,U){let se=i.TEXTURE_2D;(M.isDataArrayTexture||M.isCompressedArrayTexture)&&(se=i.TEXTURE_2D_ARRAY),M.isData3DTexture&&(se=i.TEXTURE_3D);let be=gt(I,M),ce=M.source;t.bindTexture(se,I.__webglTexture,i.TEXTURE0+U);let Ke=n.get(ce);if(ce.version!==Ke.__version||be===!0){t.activeTexture(i.TEXTURE0+U);let Ne=hn.getPrimaries(hn.workingColorSpace),Ye=M.colorSpace===ic?null:hn.getPrimaries(M.colorSpace),Ct=M.colorSpace===ic||Ne===Ye?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,M.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,M.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,M.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ct);let Se=_(M.image,!1,r.maxTextureSize);Se=Mt(M,Se);let ke=o.convert(M.format,M.colorSpace),it=o.convert(M.type),ft=v(M.internalFormat,ke,it,M.colorSpace,M.isVideoTexture);mt(se,M);let je,qt=M.mipmaps,k=M.isVideoTexture!==!0,ze=Ke.__version===void 0||be===!0,De=ce.dataReady,Qe=w(M,Se);if(M.isDepthTexture)ft=y(M.format===ts,M.type),ze&&(k?t.texStorage2D(i.TEXTURE_2D,1,ft,Se.width,Se.height):t.texImage2D(i.TEXTURE_2D,0,ft,Se.width,Se.height,0,ke,it,null));else if(M.isDataTexture)if(qt.length>0){k&&ze&&t.texStorage2D(i.TEXTURE_2D,Qe,ft,qt[0].width,qt[0].height);for(let Ce=0,we=qt.length;Ce<we;Ce++)je=qt[Ce],k?De&&t.texSubImage2D(i.TEXTURE_2D,Ce,0,0,je.width,je.height,ke,it,je.data):t.texImage2D(i.TEXTURE_2D,Ce,ft,je.width,je.height,0,ke,it,je.data);M.generateMipmaps=!1}else k?(ze&&t.texStorage2D(i.TEXTURE_2D,Qe,ft,Se.width,Se.height),De&&_n(M,Se,ke,it)):t.texImage2D(i.TEXTURE_2D,0,ft,Se.width,Se.height,0,ke,it,Se.data);else if(M.isCompressedTexture)if(M.isCompressedArrayTexture){k&&ze&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Qe,ft,qt[0].width,qt[0].height,Se.depth);for(let Ce=0,we=qt.length;Ce<we;Ce++)if(je=qt[Ce],M.format!==Gr)if(ke!==null)if(k){if(De)if(M.layerUpdates.size>0){let Be=FM(je.width,je.height,M.format,M.type);for(let Xt of M.layerUpdates){let di=je.data.subarray(Xt*Be/je.data.BYTES_PER_ELEMENT,(Xt+1)*Be/je.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,Ce,0,0,Xt,je.width,je.height,1,ke,di)}M.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,Ce,0,0,0,je.width,je.height,Se.depth,ke,je.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,Ce,ft,je.width,je.height,Se.depth,0,je.data,0,0);else Ue("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else k?De&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,Ce,0,0,0,je.width,je.height,Se.depth,ke,it,je.data):t.texImage3D(i.TEXTURE_2D_ARRAY,Ce,ft,je.width,je.height,Se.depth,0,ke,it,je.data)}else{k&&ze&&t.texStorage2D(i.TEXTURE_2D,Qe,ft,qt[0].width,qt[0].height);for(let Ce=0,we=qt.length;Ce<we;Ce++)je=qt[Ce],M.format!==Gr?ke!==null?k?De&&t.compressedTexSubImage2D(i.TEXTURE_2D,Ce,0,0,je.width,je.height,ke,je.data):t.compressedTexImage2D(i.TEXTURE_2D,Ce,ft,je.width,je.height,0,je.data):Ue("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):k?De&&t.texSubImage2D(i.TEXTURE_2D,Ce,0,0,je.width,je.height,ke,it,je.data):t.texImage2D(i.TEXTURE_2D,Ce,ft,je.width,je.height,0,ke,it,je.data)}else if(M.isDataArrayTexture)if(k){if(ze&&t.texStorage3D(i.TEXTURE_2D_ARRAY,Qe,ft,Se.width,Se.height,Se.depth),De)if(M.layerUpdates.size>0){let Ce=FM(Se.width,Se.height,M.format,M.type);for(let we of M.layerUpdates){let Be=Se.data.subarray(we*Ce/Se.data.BYTES_PER_ELEMENT,(we+1)*Ce/Se.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,we,Se.width,Se.height,1,ke,it,Be)}M.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,Se.width,Se.height,Se.depth,ke,it,Se.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,ft,Se.width,Se.height,Se.depth,0,ke,it,Se.data);else if(M.isData3DTexture)k?(ze&&t.texStorage3D(i.TEXTURE_3D,Qe,ft,Se.width,Se.height,Se.depth),De&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,Se.width,Se.height,Se.depth,ke,it,Se.data)):t.texImage3D(i.TEXTURE_3D,0,ft,Se.width,Se.height,Se.depth,0,ke,it,Se.data);else if(M.isFramebufferTexture){if(ze)if(k)t.texStorage2D(i.TEXTURE_2D,Qe,ft,Se.width,Se.height);else{let Ce=Se.width,we=Se.height;for(let Be=0;Be<Qe;Be++)t.texImage2D(i.TEXTURE_2D,Be,ft,Ce,we,0,ke,it,null),Ce>>=1,we>>=1}}else if(qt.length>0){if(k&&ze){let Ce=Fe(qt[0]);t.texStorage2D(i.TEXTURE_2D,Qe,ft,Ce.width,Ce.height)}for(let Ce=0,we=qt.length;Ce<we;Ce++)je=qt[Ce],k?De&&t.texSubImage2D(i.TEXTURE_2D,Ce,0,0,ke,it,je):t.texImage2D(i.TEXTURE_2D,Ce,ft,ke,it,je);M.generateMipmaps=!1}else if(k){if(ze){let Ce=Fe(Se);t.texStorage2D(i.TEXTURE_2D,Qe,ft,Ce.width,Ce.height)}De&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,ke,it,Se)}else t.texImage2D(i.TEXTURE_2D,0,ft,ke,it,Se);m(M)&&p(se),Ke.__version=ce.version,M.onUpdate&&M.onUpdate(M)}I.__version=M.version}function _e(I,M,U){if(M.image.length!==6)return;let se=gt(I,M),be=M.source;t.bindTexture(i.TEXTURE_CUBE_MAP,I.__webglTexture,i.TEXTURE0+U);let ce=n.get(be);if(be.version!==ce.__version||se===!0){t.activeTexture(i.TEXTURE0+U);let Ke=hn.getPrimaries(hn.workingColorSpace),Ne=M.colorSpace===ic?null:hn.getPrimaries(M.colorSpace),Ye=M.colorSpace===ic||Ke===Ne?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,M.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,M.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,M.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ye);let Ct=M.isCompressedTexture||M.image[0].isCompressedTexture,Se=M.image[0]&&M.image[0].isDataTexture,ke=[];for(let we=0;we<6;we++)!Ct&&!Se?ke[we]=_(M.image[we],!0,r.maxCubemapSize):ke[we]=Se?M.image[we].image:M.image[we],ke[we]=Mt(M,ke[we]);let it=ke[0],ft=o.convert(M.format,M.colorSpace),je=o.convert(M.type),qt=v(M.internalFormat,ft,je,M.colorSpace),k=M.isVideoTexture!==!0,ze=ce.__version===void 0||se===!0,De=be.dataReady,Qe=w(M,it);mt(i.TEXTURE_CUBE_MAP,M);let Ce;if(Ct){k&&ze&&t.texStorage2D(i.TEXTURE_CUBE_MAP,Qe,qt,it.width,it.height);for(let we=0;we<6;we++){Ce=ke[we].mipmaps;for(let Be=0;Be<Ce.length;Be++){let Xt=Ce[Be];M.format!==Gr?ft!==null?k?De&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+we,Be,0,0,Xt.width,Xt.height,ft,Xt.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+we,Be,qt,Xt.width,Xt.height,0,Xt.data):Ue("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):k?De&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+we,Be,0,0,Xt.width,Xt.height,ft,je,Xt.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+we,Be,qt,Xt.width,Xt.height,0,ft,je,Xt.data)}}}else{if(Ce=M.mipmaps,k&&ze){Ce.length>0&&Qe++;let we=Fe(ke[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,Qe,qt,we.width,we.height)}for(let we=0;we<6;we++)if(Se){k?De&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+we,0,0,0,ke[we].width,ke[we].height,ft,je,ke[we].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+we,0,qt,ke[we].width,ke[we].height,0,ft,je,ke[we].data);for(let Be=0;Be<Ce.length;Be++){let di=Ce[Be].image[we].image;k?De&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+we,Be+1,0,0,di.width,di.height,ft,je,di.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+we,Be+1,qt,di.width,di.height,0,ft,je,di.data)}}else{k?De&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+we,0,0,0,ft,je,ke[we]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+we,0,qt,ft,je,ke[we]);for(let Be=0;Be<Ce.length;Be++){let Xt=Ce[Be];k?De&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+we,Be+1,0,0,ft,je,Xt.image[we]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+we,Be+1,qt,ft,je,Xt.image[we])}}}m(M)&&p(i.TEXTURE_CUBE_MAP),ce.__version=be.version,M.onUpdate&&M.onUpdate(M)}I.__version=M.version}function Le(I,M,U,se,be,ce){let Ke=o.convert(U.format,U.colorSpace),Ne=o.convert(U.type),Ye=v(U.internalFormat,Ke,Ne,U.colorSpace),Ct=n.get(M),Se=n.get(U);if(Se.__renderTarget=M,!Ct.__hasExternalTextures){let ke=Math.max(1,M.width>>ce),it=Math.max(1,M.height>>ce);be===i.TEXTURE_3D||be===i.TEXTURE_2D_ARRAY?t.texImage3D(be,ce,Ye,ke,it,M.depth,0,Ke,Ne,null):t.texImage2D(be,ce,Ye,ke,it,0,Ke,Ne,null)}t.bindFramebuffer(i.FRAMEBUFFER,I),yt(M)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,se,be,Se.__webglTexture,0,j(M)):(be===i.TEXTURE_2D||be>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&be<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,se,be,Se.__webglTexture,ce),t.bindFramebuffer(i.FRAMEBUFFER,null)}function Je(I,M,U){if(i.bindRenderbuffer(i.RENDERBUFFER,I),M.depthBuffer){let se=M.depthTexture,be=se&&se.isDepthTexture?se.type:null,ce=y(M.stencilBuffer,be),Ke=M.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;yt(M)?a.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,j(M),ce,M.width,M.height):U?i.renderbufferStorageMultisample(i.RENDERBUFFER,j(M),ce,M.width,M.height):i.renderbufferStorage(i.RENDERBUFFER,ce,M.width,M.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,Ke,i.RENDERBUFFER,I)}else{let se=M.textures;for(let be=0;be<se.length;be++){let ce=se[be],Ke=o.convert(ce.format,ce.colorSpace),Ne=o.convert(ce.type),Ye=v(ce.internalFormat,Ke,Ne,ce.colorSpace);yt(M)?a.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,j(M),Ye,M.width,M.height):U?i.renderbufferStorageMultisample(i.RENDERBUFFER,j(M),Ye,M.width,M.height):i.renderbufferStorage(i.RENDERBUFFER,Ye,M.width,M.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function Ae(I,M,U){let se=M.isWebGLCubeRenderTarget===!0;if(t.bindFramebuffer(i.FRAMEBUFFER,I),!(M.depthTexture&&M.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");let be=n.get(M.depthTexture);if(be.__renderTarget=M,(!be.__webglTexture||M.depthTexture.image.width!==M.width||M.depthTexture.image.height!==M.height)&&(M.depthTexture.image.width=M.width,M.depthTexture.image.height=M.height,M.depthTexture.needsUpdate=!0),se){if(be.__webglInit===void 0&&(be.__webglInit=!0,M.depthTexture.addEventListener("dispose",R)),be.__webglTexture===void 0){be.__webglTexture=i.createTexture(),t.bindTexture(i.TEXTURE_CUBE_MAP,be.__webglTexture),mt(i.TEXTURE_CUBE_MAP,M.depthTexture);let Ct=o.convert(M.depthTexture.format),Se=o.convert(M.depthTexture.type),ke;M.depthTexture.format===oa?ke=i.DEPTH_COMPONENT24:M.depthTexture.format===ts&&(ke=i.DEPTH24_STENCIL8);for(let it=0;it<6;it++)i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+it,0,ke,M.width,M.height,0,Ct,Se,null)}}else Y(M.depthTexture,0);let ce=be.__webglTexture,Ke=j(M),Ne=se?i.TEXTURE_CUBE_MAP_POSITIVE_X+U:i.TEXTURE_2D,Ye=M.depthTexture.format===ts?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;if(M.depthTexture.format===oa)yt(M)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Ye,Ne,ce,0,Ke):i.framebufferTexture2D(i.FRAMEBUFFER,Ye,Ne,ce,0);else if(M.depthTexture.format===ts)yt(M)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Ye,Ne,ce,0,Ke):i.framebufferTexture2D(i.FRAMEBUFFER,Ye,Ne,ce,0);else throw new Error("Unknown depthTexture format")}function wn(I){let M=n.get(I),U=I.isWebGLCubeRenderTarget===!0;if(M.__boundDepthTexture!==I.depthTexture){let se=I.depthTexture;if(M.__depthDisposeCallback&&M.__depthDisposeCallback(),se){let be=()=>{delete M.__boundDepthTexture,delete M.__depthDisposeCallback,se.removeEventListener("dispose",be)};se.addEventListener("dispose",be),M.__depthDisposeCallback=be}M.__boundDepthTexture=se}if(I.depthTexture&&!M.__autoAllocateDepthBuffer)if(U)for(let se=0;se<6;se++)Ae(M.__webglFramebuffer[se],I,se);else{let se=I.texture.mipmaps;se&&se.length>0?Ae(M.__webglFramebuffer[0],I,0):Ae(M.__webglFramebuffer,I,0)}else if(U){M.__webglDepthbuffer=[];for(let se=0;se<6;se++)if(t.bindFramebuffer(i.FRAMEBUFFER,M.__webglFramebuffer[se]),M.__webglDepthbuffer[se]===void 0)M.__webglDepthbuffer[se]=i.createRenderbuffer(),Je(M.__webglDepthbuffer[se],I,!1);else{let be=I.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,ce=M.__webglDepthbuffer[se];i.bindRenderbuffer(i.RENDERBUFFER,ce),i.framebufferRenderbuffer(i.FRAMEBUFFER,be,i.RENDERBUFFER,ce)}}else{let se=I.texture.mipmaps;if(se&&se.length>0?t.bindFramebuffer(i.FRAMEBUFFER,M.__webglFramebuffer[0]):t.bindFramebuffer(i.FRAMEBUFFER,M.__webglFramebuffer),M.__webglDepthbuffer===void 0)M.__webglDepthbuffer=i.createRenderbuffer(),Je(M.__webglDepthbuffer,I,!1);else{let be=I.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,ce=M.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,ce),i.framebufferRenderbuffer(i.FRAMEBUFFER,be,i.RENDERBUFFER,ce)}}t.bindFramebuffer(i.FRAMEBUFFER,null)}function Fn(I,M,U){let se=n.get(I);M!==void 0&&Le(se.__webglFramebuffer,I,I.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),U!==void 0&&wn(I)}function zt(I){let M=I.texture,U=n.get(I),se=n.get(M);I.addEventListener("dispose",E);let be=I.textures,ce=I.isWebGLCubeRenderTarget===!0,Ke=be.length>1;if(Ke||(se.__webglTexture===void 0&&(se.__webglTexture=i.createTexture()),se.__version=M.version,s.memory.textures++),ce){U.__webglFramebuffer=[];for(let Ne=0;Ne<6;Ne++)if(M.mipmaps&&M.mipmaps.length>0){U.__webglFramebuffer[Ne]=[];for(let Ye=0;Ye<M.mipmaps.length;Ye++)U.__webglFramebuffer[Ne][Ye]=i.createFramebuffer()}else U.__webglFramebuffer[Ne]=i.createFramebuffer()}else{if(M.mipmaps&&M.mipmaps.length>0){U.__webglFramebuffer=[];for(let Ne=0;Ne<M.mipmaps.length;Ne++)U.__webglFramebuffer[Ne]=i.createFramebuffer()}else U.__webglFramebuffer=i.createFramebuffer();if(Ke)for(let Ne=0,Ye=be.length;Ne<Ye;Ne++){let Ct=n.get(be[Ne]);Ct.__webglTexture===void 0&&(Ct.__webglTexture=i.createTexture(),s.memory.textures++)}if(I.samples>0&&yt(I)===!1){U.__webglMultisampledFramebuffer=i.createFramebuffer(),U.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,U.__webglMultisampledFramebuffer);for(let Ne=0;Ne<be.length;Ne++){let Ye=be[Ne];U.__webglColorRenderbuffer[Ne]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,U.__webglColorRenderbuffer[Ne]);let Ct=o.convert(Ye.format,Ye.colorSpace),Se=o.convert(Ye.type),ke=v(Ye.internalFormat,Ct,Se,Ye.colorSpace,I.isXRRenderTarget===!0),it=j(I);i.renderbufferStorageMultisample(i.RENDERBUFFER,it,ke,I.width,I.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ne,i.RENDERBUFFER,U.__webglColorRenderbuffer[Ne])}i.bindRenderbuffer(i.RENDERBUFFER,null),I.depthBuffer&&(U.__webglDepthRenderbuffer=i.createRenderbuffer(),Je(U.__webglDepthRenderbuffer,I,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(ce){t.bindTexture(i.TEXTURE_CUBE_MAP,se.__webglTexture),mt(i.TEXTURE_CUBE_MAP,M);for(let Ne=0;Ne<6;Ne++)if(M.mipmaps&&M.mipmaps.length>0)for(let Ye=0;Ye<M.mipmaps.length;Ye++)Le(U.__webglFramebuffer[Ne][Ye],I,M,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+Ne,Ye);else Le(U.__webglFramebuffer[Ne],I,M,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+Ne,0);m(M)&&p(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ke){for(let Ne=0,Ye=be.length;Ne<Ye;Ne++){let Ct=be[Ne],Se=n.get(Ct),ke=i.TEXTURE_2D;(I.isWebGL3DRenderTarget||I.isWebGLArrayRenderTarget)&&(ke=I.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(ke,Se.__webglTexture),mt(ke,Ct),Le(U.__webglFramebuffer,I,Ct,i.COLOR_ATTACHMENT0+Ne,ke,0),m(Ct)&&p(ke)}t.unbindTexture()}else{let Ne=i.TEXTURE_2D;if((I.isWebGL3DRenderTarget||I.isWebGLArrayRenderTarget)&&(Ne=I.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(Ne,se.__webglTexture),mt(Ne,M),M.mipmaps&&M.mipmaps.length>0)for(let Ye=0;Ye<M.mipmaps.length;Ye++)Le(U.__webglFramebuffer[Ye],I,M,i.COLOR_ATTACHMENT0,Ne,Ye);else Le(U.__webglFramebuffer,I,M,i.COLOR_ATTACHMENT0,Ne,0);m(M)&&p(Ne),t.unbindTexture()}I.depthBuffer&&wn(I)}function ye(I){let M=I.textures;for(let U=0,se=M.length;U<se;U++){let be=M[U];if(m(be)){let ce=b(I),Ke=n.get(be).__webglTexture;t.bindTexture(ce,Ke),p(ce),t.unbindTexture()}}}let Me=[],xe=[];function Ve(I){if(I.samples>0){if(yt(I)===!1){let M=I.textures,U=I.width,se=I.height,be=i.COLOR_BUFFER_BIT,ce=I.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Ke=n.get(I),Ne=M.length>1;if(Ne)for(let Ct=0;Ct<M.length;Ct++)t.bindFramebuffer(i.FRAMEBUFFER,Ke.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ct,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,Ke.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ct,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,Ke.__webglMultisampledFramebuffer);let Ye=I.texture.mipmaps;Ye&&Ye.length>0?t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ke.__webglFramebuffer[0]):t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ke.__webglFramebuffer);for(let Ct=0;Ct<M.length;Ct++){if(I.resolveDepthBuffer&&(I.depthBuffer&&(be|=i.DEPTH_BUFFER_BIT),I.stencilBuffer&&I.resolveStencilBuffer&&(be|=i.STENCIL_BUFFER_BIT)),Ne){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,Ke.__webglColorRenderbuffer[Ct]);let Se=n.get(M[Ct]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,Se,0)}i.blitFramebuffer(0,0,U,se,0,0,U,se,be,i.NEAREST),c===!0&&(Me.length=0,xe.length=0,Me.push(i.COLOR_ATTACHMENT0+Ct),I.depthBuffer&&I.resolveDepthBuffer===!1&&(Me.push(ce),xe.push(ce),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,xe)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,Me))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),Ne)for(let Ct=0;Ct<M.length;Ct++){t.bindFramebuffer(i.FRAMEBUFFER,Ke.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ct,i.RENDERBUFFER,Ke.__webglColorRenderbuffer[Ct]);let Se=n.get(M[Ct]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,Ke.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ct,i.TEXTURE_2D,Se,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ke.__webglMultisampledFramebuffer)}else if(I.depthBuffer&&I.resolveDepthBuffer===!1&&c){let M=I.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[M])}}}function j(I){return Math.min(r.maxSamples,I.samples)}function yt(I){let M=n.get(I);return I.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&M.__useRenderToTexture!==!1}function $e(I){let M=s.render.frame;u.get(I)!==M&&(u.set(I,M),I.update())}function Mt(I,M){let U=I.colorSpace,se=I.format,be=I.type;return I.isCompressedTexture===!0||I.isVideoTexture===!0||U!==nr&&U!==ic&&(hn.getTransfer(U)===kn?(se!==Gr||be!==_o)&&Ue("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):bt("WebGLTextures: Unsupported texture color space:",U)),M}function Fe(I){return typeof HTMLImageElement<"u"&&I instanceof HTMLImageElement?(l.width=I.naturalWidth||I.width,l.height=I.naturalHeight||I.height):typeof VideoFrame<"u"&&I instanceof VideoFrame?(l.width=I.displayWidth,l.height=I.displayHeight):(l.width=I.width,l.height=I.height),l}this.allocateTextureUnit=H,this.resetTextureUnits=L,this.setTexture2D=Y,this.setTexture2DArray=J,this.setTexture3D=W,this.setTextureCube=fe,this.rebindTextures=Fn,this.setupRenderTarget=zt,this.updateRenderTargetMipmap=ye,this.updateMultisampleRenderTarget=Ve,this.setupDepthRenderbuffer=wn,this.setupFrameBufferTexture=Le,this.useMultisampledRTT=yt,this.isReversedDepthBuffer=function(){return t.buffers.depth.getReversed()}}function k3(i,e){function t(n,r=ic){let o,s=hn.getTransfer(r);if(n===_o)return i.UNSIGNED_BYTE;if(n===yb)return i.UNSIGNED_SHORT_4_4_4_4;if(n===xb)return i.UNSIGNED_SHORT_5_5_5_1;if(n===RM)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===TM)return i.UNSIGNED_INT_10F_11F_11F_REV;if(n===MM)return i.BYTE;if(n===SM)return i.SHORT;if(n===tl)return i.UNSIGNED_SHORT;if(n===vb)return i.INT;if(n===es)return i.UNSIGNED_INT;if(n===tr)return i.FLOAT;if(n===An)return i.HALF_FLOAT;if(n===CM)return i.ALPHA;if(n===EM)return i.RGB;if(n===Gr)return i.RGBA;if(n===oa)return i.DEPTH_COMPONENT;if(n===ts)return i.DEPTH_STENCIL;if(n===nl)return i.RED;if(n===Lp)return i.RED_INTEGER;if(n===_u)return i.RG;if(n===wb)return i.RG_INTEGER;if(n===Mb)return i.RGBA_INTEGER;if(n===kp||n===Bp||n===Up||n===Vp)if(s===kn)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(n===kp)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===Bp)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Up)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Vp)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(n===kp)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Bp)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Up)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Vp)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===Sb||n===Rb||n===Tb||n===Cb)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(n===Sb)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Rb)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Tb)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===Cb)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===Eb||n===Db||n===Ib||n===Ab||n===Pb||n===Fb||n===Nb)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(n===Eb||n===Db)return s===kn?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(n===Ib)return s===kn?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC;if(n===Ab)return o.COMPRESSED_R11_EAC;if(n===Pb)return o.COMPRESSED_SIGNED_R11_EAC;if(n===Fb)return o.COMPRESSED_RG11_EAC;if(n===Nb)return o.COMPRESSED_SIGNED_RG11_EAC}else return null;if(n===jb||n===Ob||n===Lb||n===kb||n===Bb||n===Ub||n===Vb||n===zb||n===Hb||n===Gb||n===Wb||n===$b||n===qb||n===Xb)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(n===jb)return s===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Ob)return s===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Lb)return s===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===kb)return s===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===Bb)return s===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Ub)return s===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Vb)return s===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===zb)return s===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===Hb)return s===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Gb)return s===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Wb)return s===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===$b)return s===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===qb)return s===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===Xb)return s===kn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===Zb||n===Yb||n===Qb)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(n===Zb)return s===kn?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===Yb)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Qb)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===Kb||n===Jb||n===ev||n===tv)if(o=e.get("EXT_texture_compression_rgtc"),o!==null){if(n===Kb)return o.COMPRESSED_RED_RGTC1_EXT;if(n===Jb)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===ev)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===tv)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===_a?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}var AK=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,PK=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`,FI=class{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){let n=new fp(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){let t=e.cameras[0].viewport,n=new Nt({vertexShader:AK,fragmentShader:PK,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Pe(new la(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}},NI=class extends Ko{constructor(e,t){super();let n=this,r=null,o=1,s=null,a="local-floor",c=1,l=null,u=null,d=null,h=null,f=null,g=null,_=typeof XRWebGLBinding<"u",m=new FI,p={},b=t.getContextAttributes(),v=null,y=null,w=[],R=[],E=new z,A=null,x=new ai;x.viewport=new En;let T=new ai;T.viewport=new En;let P=[x,T],L=new ab,H=null,te=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(le){let _e=w[le];return _e===void 0&&(_e=new Jd,w[le]=_e),_e.getTargetRaySpace()},this.getControllerGrip=function(le){let _e=w[le];return _e===void 0&&(_e=new Jd,w[le]=_e),_e.getGripSpace()},this.getHand=function(le){let _e=w[le];return _e===void 0&&(_e=new Jd,w[le]=_e),_e.getHandSpace()};function Y(le){let _e=R.indexOf(le.inputSource);if(_e===-1)return;let Le=w[_e];Le!==void 0&&(Le.update(le.inputSource,le.frame,l||s),Le.dispatchEvent({type:le.type,data:le.inputSource}))}function J(){r.removeEventListener("select",Y),r.removeEventListener("selectstart",Y),r.removeEventListener("selectend",Y),r.removeEventListener("squeeze",Y),r.removeEventListener("squeezestart",Y),r.removeEventListener("squeezeend",Y),r.removeEventListener("end",J),r.removeEventListener("inputsourceschange",W);for(let le=0;le<w.length;le++){let _e=R[le];_e!==null&&(R[le]=null,w[le].disconnect(_e))}H=null,te=null,m.reset();for(let le in p)delete p[le];e.setRenderTarget(v),f=null,h=null,d=null,r=null,y=null,_n.stop(),n.isPresenting=!1,e.setPixelRatio(A),e.setSize(E.width,E.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(le){o=le,n.isPresenting===!0&&Ue("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(le){a=le,n.isPresenting===!0&&Ue("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(le){l=le},this.getBaseLayer=function(){return h!==null?h:f},this.getBinding=function(){return d===null&&_&&(d=new XRWebGLBinding(r,t)),d},this.getFrame=function(){return g},this.getSession=function(){return r},this.setSession=function(le){return Wt(this,null,function*(){if(r=le,r!==null){if(v=e.getRenderTarget(),r.addEventListener("select",Y),r.addEventListener("selectstart",Y),r.addEventListener("selectend",Y),r.addEventListener("squeeze",Y),r.addEventListener("squeezestart",Y),r.addEventListener("squeezeend",Y),r.addEventListener("end",J),r.addEventListener("inputsourceschange",W),b.xrCompatible!==!0&&(yield t.makeXRCompatible()),A=e.getPixelRatio(),e.getSize(E),_&&"createProjectionLayer"in XRWebGLBinding.prototype){let Le=null,Je=null,Ae=null;b.depth&&(Ae=b.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Le=b.stencil?ts:oa,Je=b.stencil?_a:es);let wn={colorFormat:t.RGBA8,depthFormat:Ae,scaleFactor:o};d=this.getBinding(),h=d.createProjectionLayer(wn),r.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),y=new Qt(h.textureWidth,h.textureHeight,{format:Gr,type:_o,depthTexture:new fo(h.textureWidth,h.textureHeight,Je,void 0,void 0,void 0,void 0,void 0,void 0,Le),stencilBuffer:b.stencil,colorSpace:e.outputColorSpace,samples:b.antialias?4:0,resolveDepthBuffer:h.ignoreDepthValues===!1,resolveStencilBuffer:h.ignoreDepthValues===!1})}else{let Le={antialias:b.antialias,alpha:!0,depth:b.depth,stencil:b.stencil,framebufferScaleFactor:o};f=new XRWebGLLayer(r,t,Le),r.updateRenderState({baseLayer:f}),e.setPixelRatio(1),e.setSize(f.framebufferWidth,f.framebufferHeight,!1),y=new Qt(f.framebufferWidth,f.framebufferHeight,{format:Gr,type:_o,colorSpace:e.outputColorSpace,stencilBuffer:b.stencil,resolveDepthBuffer:f.ignoreDepthValues===!1,resolveStencilBuffer:f.ignoreDepthValues===!1})}y.isXRRenderTarget=!0,this.setFoveation(c),l=null,s=yield r.requestReferenceSpace(a),_n.setContext(r),_n.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}})},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return m.getDepthTexture()};function W(le){for(let _e=0;_e<le.removed.length;_e++){let Le=le.removed[_e],Je=R.indexOf(Le);Je>=0&&(R[Je]=null,w[Je].disconnect(Le))}for(let _e=0;_e<le.added.length;_e++){let Le=le.added[_e],Je=R.indexOf(Le);if(Je===-1){for(let wn=0;wn<w.length;wn++)if(wn>=R.length){R.push(Le),Je=wn;break}else if(R[wn]===null){R[wn]=Le,Je=wn;break}if(Je===-1)break}let Ae=w[Je];Ae&&Ae.connect(Le)}}let fe=new C,ve=new C;function Re(le,_e,Le){fe.setFromMatrixPosition(_e.matrixWorld),ve.setFromMatrixPosition(Le.matrixWorld);let Je=fe.distanceTo(ve),Ae=_e.projectionMatrix.elements,wn=Le.projectionMatrix.elements,Fn=Ae[14]/(Ae[10]-1),zt=Ae[14]/(Ae[10]+1),ye=(Ae[9]+1)/Ae[5],Me=(Ae[9]-1)/Ae[5],xe=(Ae[8]-1)/Ae[0],Ve=(wn[8]+1)/wn[0],j=Fn*xe,yt=Fn*Ve,$e=Je/(-xe+Ve),Mt=$e*-xe;if(_e.matrixWorld.decompose(le.position,le.quaternion,le.scale),le.translateX(Mt),le.translateZ($e),le.matrixWorld.compose(le.position,le.quaternion,le.scale),le.matrixWorldInverse.copy(le.matrixWorld).invert(),Ae[10]===-1)le.projectionMatrix.copy(_e.projectionMatrix),le.projectionMatrixInverse.copy(_e.projectionMatrixInverse);else{let Fe=Fn+$e,I=zt+$e,M=j-Mt,U=yt+(Je-Mt),se=ye*zt/I*Fe,be=Me*zt/I*Fe;le.projectionMatrix.makePerspective(M,U,se,be,Fe,I),le.projectionMatrixInverse.copy(le.projectionMatrix).invert()}}function Te(le,_e){_e===null?le.matrixWorld.copy(le.matrix):le.matrixWorld.multiplyMatrices(_e.matrixWorld,le.matrix),le.matrixWorldInverse.copy(le.matrixWorld).invert()}this.updateCamera=function(le){if(r===null)return;let _e=le.near,Le=le.far;m.texture!==null&&(m.depthNear>0&&(_e=m.depthNear),m.depthFar>0&&(Le=m.depthFar)),L.near=T.near=x.near=_e,L.far=T.far=x.far=Le,(H!==L.near||te!==L.far)&&(r.updateRenderState({depthNear:L.near,depthFar:L.far}),H=L.near,te=L.far),L.layers.mask=le.layers.mask|6,x.layers.mask=L.layers.mask&3,T.layers.mask=L.layers.mask&5;let Je=le.parent,Ae=L.cameras;Te(L,Je);for(let wn=0;wn<Ae.length;wn++)Te(Ae[wn],Je);Ae.length===2?Re(L,x,T):L.projectionMatrix.copy(x.projectionMatrix),mt(le,L,Je)};function mt(le,_e,Le){Le===null?le.matrix.copy(_e.matrixWorld):(le.matrix.copy(Le.matrixWorld),le.matrix.invert(),le.matrix.multiply(_e.matrixWorld)),le.matrix.decompose(le.position,le.quaternion,le.scale),le.updateMatrixWorld(!0),le.projectionMatrix.copy(_e.projectionMatrix),le.projectionMatrixInverse.copy(_e.projectionMatrixInverse),le.isPerspectiveCamera&&(le.fov=Zd*2*Math.atan(1/le.projectionMatrix.elements[5]),le.zoom=1)}this.getCamera=function(){return L},this.getFoveation=function(){if(!(h===null&&f===null))return c},this.setFoveation=function(le){c=le,h!==null&&(h.fixedFoveation=le),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=le)},this.hasDepthSensing=function(){return m.texture!==null},this.getDepthSensingMesh=function(){return m.getMesh(L)},this.getCameraTexture=function(le){return p[le]};let gt=null;function dn(le,_e){if(u=_e.getViewerPose(l||s),g=_e,u!==null){let Le=u.views;f!==null&&(e.setRenderTargetFramebuffer(y,f.framebuffer),e.setRenderTarget(y));let Je=!1;Le.length!==L.cameras.length&&(L.cameras.length=0,Je=!0);for(let zt=0;zt<Le.length;zt++){let ye=Le[zt],Me=null;if(f!==null)Me=f.getViewport(ye);else{let Ve=d.getViewSubImage(h,ye);Me=Ve.viewport,zt===0&&(e.setRenderTargetTextures(y,Ve.colorTexture,Ve.depthStencilTexture),e.setRenderTarget(y))}let xe=P[zt];xe===void 0&&(xe=new ai,xe.layers.enable(zt),xe.viewport=new En,P[zt]=xe),xe.matrix.fromArray(ye.transform.matrix),xe.matrix.decompose(xe.position,xe.quaternion,xe.scale),xe.projectionMatrix.fromArray(ye.projectionMatrix),xe.projectionMatrixInverse.copy(xe.projectionMatrix).invert(),xe.viewport.set(Me.x,Me.y,Me.width,Me.height),zt===0&&(L.matrix.copy(xe.matrix),L.matrix.decompose(L.position,L.quaternion,L.scale)),Je===!0&&L.cameras.push(xe)}let Ae=r.enabledFeatures;if(Ae&&Ae.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&_){d=n.getBinding();let zt=d.getDepthInformation(Le[0]);zt&&zt.isValid&&zt.texture&&m.init(zt,r.renderState)}if(Ae&&Ae.includes("camera-access")&&_){e.state.unbindTexture(),d=n.getBinding();for(let zt=0;zt<Le.length;zt++){let ye=Le[zt].camera;if(ye){let Me=p[ye];Me||(Me=new fp,p[ye]=Me);let xe=d.getCameraImage(ye);Me.sourceTexture=xe}}}}for(let Le=0;Le<w.length;Le++){let Je=R[Le],Ae=w[Le];Je!==null&&Ae!==void 0&&Ae.update(Je,_e,l||s)}gt&&gt(le,_e),_e.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:_e}),g=null}let _n=new F3;_n.setAnimationLoop(dn),this.setAnimationLoop=function(le){gt=le},this.dispose=function(){}}},wh=new ho,FK=new Ee;function NK(i,e){function t(m,p){m.matrixAutoUpdate===!0&&m.updateMatrix(),p.value.copy(m.matrix)}function n(m,p){p.color.getRGB(m.fogColor.value,pI(i)),p.isFog?(m.fogNear.value=p.near,m.fogFar.value=p.far):p.isFogExp2&&(m.fogDensity.value=p.density)}function r(m,p,b,v,y){p.isMeshBasicMaterial||p.isMeshLambertMaterial?o(m,p):p.isMeshToonMaterial?(o(m,p),d(m,p)):p.isMeshPhongMaterial?(o(m,p),u(m,p)):p.isMeshStandardMaterial?(o(m,p),h(m,p),p.isMeshPhysicalMaterial&&f(m,p,y)):p.isMeshMatcapMaterial?(o(m,p),g(m,p)):p.isMeshDepthMaterial?o(m,p):p.isMeshDistanceMaterial?(o(m,p),_(m,p)):p.isMeshNormalMaterial?o(m,p):p.isLineBasicMaterial?(s(m,p),p.isLineDashedMaterial&&a(m,p)):p.isPointsMaterial?c(m,p,b,v):p.isSpriteMaterial?l(m,p):p.isShadowMaterial?(m.color.value.copy(p.color),m.opacity.value=p.opacity):p.isShaderMaterial&&(p.uniformsNeedUpdate=!1)}function o(m,p){m.opacity.value=p.opacity,p.color&&m.diffuse.value.copy(p.color),p.emissive&&m.emissive.value.copy(p.emissive).multiplyScalar(p.emissiveIntensity),p.map&&(m.map.value=p.map,t(p.map,m.mapTransform)),p.alphaMap&&(m.alphaMap.value=p.alphaMap,t(p.alphaMap,m.alphaMapTransform)),p.bumpMap&&(m.bumpMap.value=p.bumpMap,t(p.bumpMap,m.bumpMapTransform),m.bumpScale.value=p.bumpScale,p.side===qr&&(m.bumpScale.value*=-1)),p.normalMap&&(m.normalMap.value=p.normalMap,t(p.normalMap,m.normalMapTransform),m.normalScale.value.copy(p.normalScale),p.side===qr&&m.normalScale.value.negate()),p.displacementMap&&(m.displacementMap.value=p.displacementMap,t(p.displacementMap,m.displacementMapTransform),m.displacementScale.value=p.displacementScale,m.displacementBias.value=p.displacementBias),p.emissiveMap&&(m.emissiveMap.value=p.emissiveMap,t(p.emissiveMap,m.emissiveMapTransform)),p.specularMap&&(m.specularMap.value=p.specularMap,t(p.specularMap,m.specularMapTransform)),p.alphaTest>0&&(m.alphaTest.value=p.alphaTest);let b=e.get(p),v=b.envMap,y=b.envMapRotation;v&&(m.envMap.value=v,wh.copy(y),wh.x*=-1,wh.y*=-1,wh.z*=-1,v.isCubeTexture&&v.isRenderTargetTexture===!1&&(wh.y*=-1,wh.z*=-1),m.envMapRotation.value.setFromMatrix4(FK.makeRotationFromEuler(wh)),m.flipEnvMap.value=v.isCubeTexture&&v.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=p.reflectivity,m.ior.value=p.ior,m.refractionRatio.value=p.refractionRatio),p.lightMap&&(m.lightMap.value=p.lightMap,m.lightMapIntensity.value=p.lightMapIntensity,t(p.lightMap,m.lightMapTransform)),p.aoMap&&(m.aoMap.value=p.aoMap,m.aoMapIntensity.value=p.aoMapIntensity,t(p.aoMap,m.aoMapTransform))}function s(m,p){m.diffuse.value.copy(p.color),m.opacity.value=p.opacity,p.map&&(m.map.value=p.map,t(p.map,m.mapTransform))}function a(m,p){m.dashSize.value=p.dashSize,m.totalSize.value=p.dashSize+p.gapSize,m.scale.value=p.scale}function c(m,p,b,v){m.diffuse.value.copy(p.color),m.opacity.value=p.opacity,m.size.value=p.size*b,m.scale.value=v*.5,p.map&&(m.map.value=p.map,t(p.map,m.uvTransform)),p.alphaMap&&(m.alphaMap.value=p.alphaMap,t(p.alphaMap,m.alphaMapTransform)),p.alphaTest>0&&(m.alphaTest.value=p.alphaTest)}function l(m,p){m.diffuse.value.copy(p.color),m.opacity.value=p.opacity,m.rotation.value=p.rotation,p.map&&(m.map.value=p.map,t(p.map,m.mapTransform)),p.alphaMap&&(m.alphaMap.value=p.alphaMap,t(p.alphaMap,m.alphaMapTransform)),p.alphaTest>0&&(m.alphaTest.value=p.alphaTest)}function u(m,p){m.specular.value.copy(p.specular),m.shininess.value=Math.max(p.shininess,1e-4)}function d(m,p){p.gradientMap&&(m.gradientMap.value=p.gradientMap)}function h(m,p){m.metalness.value=p.metalness,p.metalnessMap&&(m.metalnessMap.value=p.metalnessMap,t(p.metalnessMap,m.metalnessMapTransform)),m.roughness.value=p.roughness,p.roughnessMap&&(m.roughnessMap.value=p.roughnessMap,t(p.roughnessMap,m.roughnessMapTransform)),p.envMap&&(m.envMapIntensity.value=p.envMapIntensity)}function f(m,p,b){m.ior.value=p.ior,p.sheen>0&&(m.sheenColor.value.copy(p.sheenColor).multiplyScalar(p.sheen),m.sheenRoughness.value=p.sheenRoughness,p.sheenColorMap&&(m.sheenColorMap.value=p.sheenColorMap,t(p.sheenColorMap,m.sheenColorMapTransform)),p.sheenRoughnessMap&&(m.sheenRoughnessMap.value=p.sheenRoughnessMap,t(p.sheenRoughnessMap,m.sheenRoughnessMapTransform))),p.clearcoat>0&&(m.clearcoat.value=p.clearcoat,m.clearcoatRoughness.value=p.clearcoatRoughness,p.clearcoatMap&&(m.clearcoatMap.value=p.clearcoatMap,t(p.clearcoatMap,m.clearcoatMapTransform)),p.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=p.clearcoatRoughnessMap,t(p.clearcoatRoughnessMap,m.clearcoatRoughnessMapTransform)),p.clearcoatNormalMap&&(m.clearcoatNormalMap.value=p.clearcoatNormalMap,t(p.clearcoatNormalMap,m.clearcoatNormalMapTransform),m.clearcoatNormalScale.value.copy(p.clearcoatNormalScale),p.side===qr&&m.clearcoatNormalScale.value.negate())),p.dispersion>0&&(m.dispersion.value=p.dispersion),p.iridescence>0&&(m.iridescence.value=p.iridescence,m.iridescenceIOR.value=p.iridescenceIOR,m.iridescenceThicknessMinimum.value=p.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=p.iridescenceThicknessRange[1],p.iridescenceMap&&(m.iridescenceMap.value=p.iridescenceMap,t(p.iridescenceMap,m.iridescenceMapTransform)),p.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=p.iridescenceThicknessMap,t(p.iridescenceThicknessMap,m.iridescenceThicknessMapTransform))),p.transmission>0&&(m.transmission.value=p.transmission,m.transmissionSamplerMap.value=b.texture,m.transmissionSamplerSize.value.set(b.width,b.height),p.transmissionMap&&(m.transmissionMap.value=p.transmissionMap,t(p.transmissionMap,m.transmissionMapTransform)),m.thickness.value=p.thickness,p.thicknessMap&&(m.thicknessMap.value=p.thicknessMap,t(p.thicknessMap,m.thicknessMapTransform)),m.attenuationDistance.value=p.attenuationDistance,m.attenuationColor.value.copy(p.attenuationColor)),p.anisotropy>0&&(m.anisotropyVector.value.set(p.anisotropy*Math.cos(p.anisotropyRotation),p.anisotropy*Math.sin(p.anisotropyRotation)),p.anisotropyMap&&(m.anisotropyMap.value=p.anisotropyMap,t(p.anisotropyMap,m.anisotropyMapTransform))),m.specularIntensity.value=p.specularIntensity,m.specularColor.value.copy(p.specularColor),p.specularColorMap&&(m.specularColorMap.value=p.specularColorMap,t(p.specularColorMap,m.specularColorMapTransform)),p.specularIntensityMap&&(m.specularIntensityMap.value=p.specularIntensityMap,t(p.specularIntensityMap,m.specularIntensityMapTransform))}function g(m,p){p.matcap&&(m.matcap.value=p.matcap)}function _(m,p){let b=e.get(p).light;m.referencePosition.value.setFromMatrixPosition(b.matrixWorld),m.nearDistance.value=b.shadow.camera.near,m.farDistance.value=b.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function jK(i,e,t,n){let r={},o={},s=[],a=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function c(b,v){let y=v.program;n.uniformBlockBinding(b,y)}function l(b,v){let y=r[b.id];y===void 0&&(g(b),y=u(b),r[b.id]=y,b.addEventListener("dispose",m));let w=v.program;n.updateUBOMapping(b,w);let R=e.render.frame;o[b.id]!==R&&(h(b),o[b.id]=R)}function u(b){let v=d();b.__bindingPointIndex=v;let y=i.createBuffer(),w=b.__size,R=b.usage;return i.bindBuffer(i.UNIFORM_BUFFER,y),i.bufferData(i.UNIFORM_BUFFER,w,R),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,v,y),y}function d(){for(let b=0;b<a;b++)if(s.indexOf(b)===-1)return s.push(b),b;return bt("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(b){let v=r[b.id],y=b.uniforms,w=b.__cache;i.bindBuffer(i.UNIFORM_BUFFER,v);for(let R=0,E=y.length;R<E;R++){let A=Array.isArray(y[R])?y[R]:[y[R]];for(let x=0,T=A.length;x<T;x++){let P=A[x];if(f(P,R,x,w)===!0){let L=P.__offset,H=Array.isArray(P.value)?P.value:[P.value],te=0;for(let Y=0;Y<H.length;Y++){let J=H[Y],W=_(J);typeof J=="number"||typeof J=="boolean"?(P.__data[0]=J,i.bufferSubData(i.UNIFORM_BUFFER,L+te,P.__data)):J.isMatrix3?(P.__data[0]=J.elements[0],P.__data[1]=J.elements[1],P.__data[2]=J.elements[2],P.__data[3]=0,P.__data[4]=J.elements[3],P.__data[5]=J.elements[4],P.__data[6]=J.elements[5],P.__data[7]=0,P.__data[8]=J.elements[6],P.__data[9]=J.elements[7],P.__data[10]=J.elements[8],P.__data[11]=0):(J.toArray(P.__data,te),te+=W.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,L,P.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function f(b,v,y,w){let R=b.value,E=v+"_"+y;if(w[E]===void 0)return typeof R=="number"||typeof R=="boolean"?w[E]=R:w[E]=R.clone(),!0;{let A=w[E];if(typeof R=="number"||typeof R=="boolean"){if(A!==R)return w[E]=R,!0}else if(A.equals(R)===!1)return A.copy(R),!0}return!1}function g(b){let v=b.uniforms,y=0,w=16;for(let E=0,A=v.length;E<A;E++){let x=Array.isArray(v[E])?v[E]:[v[E]];for(let T=0,P=x.length;T<P;T++){let L=x[T],H=Array.isArray(L.value)?L.value:[L.value];for(let te=0,Y=H.length;te<Y;te++){let J=H[te],W=_(J),fe=y%w,ve=fe%W.boundary,Re=fe+ve;y+=ve,Re!==0&&w-Re<W.storage&&(y+=w-Re),L.__data=new Float32Array(W.storage/Float32Array.BYTES_PER_ELEMENT),L.__offset=y,y+=W.storage}}}let R=y%w;return R>0&&(y+=w-R),b.__size=y,b.__cache={},this}function _(b){let v={boundary:0,storage:0};return typeof b=="number"||typeof b=="boolean"?(v.boundary=4,v.storage=4):b.isVector2?(v.boundary=8,v.storage=8):b.isVector3||b.isColor?(v.boundary=16,v.storage=12):b.isVector4?(v.boundary=16,v.storage=16):b.isMatrix3?(v.boundary=48,v.storage=48):b.isMatrix4?(v.boundary=64,v.storage=64):b.isTexture?Ue("WebGLRenderer: Texture samplers can not be part of an uniforms group."):Ue("WebGLRenderer: Unsupported uniform value type.",b),v}function m(b){let v=b.target;v.removeEventListener("dispose",m);let y=s.indexOf(v.__bindingPointIndex);s.splice(y,1),i.deleteBuffer(r[v.id]),delete r[v.id],delete o[v.id]}function p(){for(let b in r)i.deleteBuffer(r[b]);s=[],r={},o={}}return{bind:c,update:l,dispose:p}}var OK=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]),rc=null;function LK(){return rc===null&&(rc=new Cr(OK,16,16,_u,An),rc.name="DFG_LUT",rc.minFilter=zn,rc.magFilter=zn,rc.wrapS=jr,rc.wrapT=jr,rc.generateMipmaps=!1,rc.needsUpdate=!0),rc}var rl=class{constructor(e={}){let{canvas:t=hI(),context:n=null,depth:r=!0,stencil:o=!1,alpha:s=!1,antialias:a=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:l=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:d=!1,reversedDepthBuffer:h=!1,outputBufferType:f=_o}=e;this.isWebGLRenderer=!0;let g;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");g=n.getContextAttributes().alpha}else g=s;let _=f,m=new Set([Mb,wb,Lp]),p=new Set([_o,es,tl,_a,yb,xb]),b=new Uint32Array(4),v=new Int32Array(4),y=null,w=null,R=[],E=[],A=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Ts,this.toneMappingExposure=1,this.transmissionResolutionScale=1;let x=this,T=!1;this._outputColorSpace=Jn;let P=0,L=0,H=null,te=-1,Y=null,J=new En,W=new En,fe=null,ve=new ue(0),Re=0,Te=t.width,mt=t.height,gt=1,dn=null,_n=null,le=new En(0,0,Te,mt),_e=new En(0,0,Te,mt),Le=!1,Je=new Xc,Ae=!1,wn=!1,Fn=new Ee,zt=new C,ye=new En,Me={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},xe=!1;function Ve(){return H===null?gt:1}let j=n;function yt(D,G){return t.getContext(D,G)}try{let D={alpha:!0,depth:r,stencil:o,antialias:a,premultipliedAlpha:c,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${db}`),t.addEventListener("webglcontextlost",Xt,!1),t.addEventListener("webglcontextrestored",di,!1),t.addEventListener("webglcontextcreationerror",Gn,!1),j===null){let G="webgl2";if(j=yt(G,D),j===null)throw yt(G)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(D){throw bt("WebGLRenderer: "+D.message),D}let $e,Mt,Fe,I,M,U,se,be,ce,Ke,Ne,Ye,Ct,Se,ke,it,ft,je,qt,k,ze,De,Qe,Ce;function we(){$e=new WY(j),$e.init(),De=new k3(j,$e),Mt=new OY(j,$e,e,De),Fe=new DK(j,$e),Mt.reversedDepthBuffer&&h&&Fe.buffers.depth.setReversed(!0),I=new XY(j),M=new pK,U=new IK(j,$e,Fe,M,Mt,De,I),se=new kY(x),be=new GY(x),ce=new K7(j),Qe=new NY(j,ce),Ke=new $Y(j,ce,I,Qe),Ne=new YY(j,Ke,ce,I),qt=new ZY(j,Mt,U),it=new LY(M),Ye=new fK(x,se,be,$e,Mt,Qe,it),Ct=new NK(x,M),Se=new gK,ke=new wK($e),je=new FY(x,se,be,Fe,Ne,g,c),ft=new CK(x,Ne,Mt),Ce=new jK(j,I,Mt,Fe),k=new jY(j,$e,I),ze=new qY(j,$e,I),I.programs=Ye.programs,x.capabilities=Mt,x.extensions=$e,x.properties=M,x.renderLists=Se,x.shadowMap=ft,x.state=Fe,x.info=I}we(),_!==_o&&(A=new KY(_,t.width,t.height,r,o));let Be=new NI(x,j);this.xr=Be,this.getContext=function(){return j},this.getContextAttributes=function(){return j.getContextAttributes()},this.forceContextLoss=function(){let D=$e.get("WEBGL_lose_context");D&&D.loseContext()},this.forceContextRestore=function(){let D=$e.get("WEBGL_lose_context");D&&D.restoreContext()},this.getPixelRatio=function(){return gt},this.setPixelRatio=function(D){D!==void 0&&(gt=D,this.setSize(Te,mt,!1))},this.getSize=function(D){return D.set(Te,mt)},this.setSize=function(D,G,oe=!0){if(Be.isPresenting){Ue("WebGLRenderer: Can't change size while VR device is presenting.");return}Te=D,mt=G,t.width=Math.floor(D*gt),t.height=Math.floor(G*gt),oe===!0&&(t.style.width=D+"px",t.style.height=G+"px"),A!==null&&A.setSize(t.width,t.height),this.setViewport(0,0,D,G)},this.getDrawingBufferSize=function(D){return D.set(Te*gt,mt*gt).floor()},this.setDrawingBufferSize=function(D,G,oe){Te=D,mt=G,gt=oe,t.width=Math.floor(D*oe),t.height=Math.floor(G*oe),this.setViewport(0,0,D,G)},this.setEffects=function(D){if(_===_o){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(D){for(let G=0;G<D.length;G++)if(D[G].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}A.setEffects(D||[])},this.getCurrentViewport=function(D){return D.copy(J)},this.getViewport=function(D){return D.copy(le)},this.setViewport=function(D,G,oe,re){D.isVector4?le.set(D.x,D.y,D.z,D.w):le.set(D,G,oe,re),Fe.viewport(J.copy(le).multiplyScalar(gt).round())},this.getScissor=function(D){return D.copy(_e)},this.setScissor=function(D,G,oe,re){D.isVector4?_e.set(D.x,D.y,D.z,D.w):_e.set(D,G,oe,re),Fe.scissor(W.copy(_e).multiplyScalar(gt).round())},this.getScissorTest=function(){return Le},this.setScissorTest=function(D){Fe.setScissorTest(Le=D)},this.setOpaqueSort=function(D){dn=D},this.setTransparentSort=function(D){_n=D},this.getClearColor=function(D){return D.copy(je.getClearColor())},this.setClearColor=function(){je.setClearColor(...arguments)},this.getClearAlpha=function(){return je.getClearAlpha()},this.setClearAlpha=function(){je.setClearAlpha(...arguments)},this.clear=function(D=!0,G=!0,oe=!0){let re=0;if(D){let Z=!1;if(H!==null){let He=H.texture.format;Z=m.has(He)}if(Z){let He=H.texture.type,et=p.has(He),qe=je.getClearColor(),ct=je.getClearAlpha(),xt=qe.r,Ut=qe.g,Et=qe.b;et?(b[0]=xt,b[1]=Ut,b[2]=Et,b[3]=ct,j.clearBufferuiv(j.COLOR,0,b)):(v[0]=xt,v[1]=Ut,v[2]=Et,v[3]=ct,j.clearBufferiv(j.COLOR,0,v))}else re|=j.COLOR_BUFFER_BIT}G&&(re|=j.DEPTH_BUFFER_BIT),oe&&(re|=j.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),j.clear(re)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Xt,!1),t.removeEventListener("webglcontextrestored",di,!1),t.removeEventListener("webglcontextcreationerror",Gn,!1),je.dispose(),Se.dispose(),ke.dispose(),M.dispose(),se.dispose(),be.dispose(),Ne.dispose(),Qe.dispose(),Ce.dispose(),Ye.dispose(),Be.dispose(),Be.removeEventListener("sessionstart",$F),Be.removeEventListener("sessionend",qF),Uu.stop()};function Xt(D){D.preventDefault(),ap("WebGLRenderer: Context Lost."),T=!0}function di(){ap("WebGLRenderer: Context Restored."),T=!1;let D=I.autoReset,G=ft.enabled,oe=ft.autoUpdate,re=ft.needsUpdate,Z=ft.type;we(),I.autoReset=D,ft.enabled=G,ft.autoUpdate=oe,ft.needsUpdate=re,ft.type=Z}function Gn(D){bt("WebGLRenderer: A WebGL context could not be created. Reason: ",D.statusMessage)}function Ia(D){let G=D.target;G.removeEventListener("dispose",Ia),xc(G)}function xc(D){U4(D),M.remove(D)}function U4(D){let G=M.get(D).programs;G!==void 0&&(G.forEach(function(oe){Ye.releaseProgram(oe)}),D.isShaderMaterial&&Ye.releaseShaderCache(D))}this.renderBufferDirect=function(D,G,oe,re,Z,He){G===null&&(G=Me);let et=Z.isMesh&&Z.matrixWorld.determinant()<0,qe=z4(D,G,oe,re,Z);Fe.setMaterial(re,et);let ct=oe.index,xt=1;if(re.wireframe===!0){if(ct=Ke.getWireframeAttribute(oe),ct===void 0)return;xt=2}let Ut=oe.drawRange,Et=oe.attributes.position,bn=Ut.start*xt,Qn=(Ut.start+Ut.count)*xt;He!==null&&(bn=Math.max(bn,He.start*xt),Qn=Math.min(Qn,(He.start+He.count)*xt)),ct!==null?(bn=Math.max(bn,0),Qn=Math.min(Qn,ct.count)):Et!=null&&(bn=Math.max(bn,0),Qn=Math.min(Qn,Et.count));let Li=Qn-bn;if(Li<0||Li===1/0)return;Qe.setup(Z,re,qe,oe,ct);let ki,ii=k;if(ct!==null&&(ki=ce.get(ct),ii=ze,ii.setIndex(ki)),Z.isMesh)re.wireframe===!0?(Fe.setLineWidth(re.wireframeLinewidth*Ve()),ii.setMode(j.LINES)):ii.setMode(j.TRIANGLES);else if(Z.isLine){let Dt=re.linewidth;Dt===void 0&&(Dt=1),Fe.setLineWidth(Dt*Ve()),Z.isLineSegments?ii.setMode(j.LINES):Z.isLineLoop?ii.setMode(j.LINE_LOOP):ii.setMode(j.LINE_STRIP)}else Z.isPoints?ii.setMode(j.POINTS):Z.isSprite&&ii.setMode(j.TRIANGLES);if(Z.isBatchedMesh)if(Z._multiDrawInstances!==null)Xd("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),ii.renderMultiDrawInstances(Z._multiDrawStarts,Z._multiDrawCounts,Z._multiDrawCount,Z._multiDrawInstances);else if($e.get("WEBGL_multi_draw"))ii.renderMultiDraw(Z._multiDrawStarts,Z._multiDrawCounts,Z._multiDrawCount);else{let Dt=Z._multiDrawStarts,Wn=Z._multiDrawCounts,Nn=Z._multiDrawCount,ko=ct?ce.get(ct).bytesPerElement:1,Vh=M.get(re).currentProgram.getUniforms();for(let Bo=0;Bo<Nn;Bo++)Vh.setValue(j,"_gl_DrawID",Bo),ii.render(Dt[Bo]/ko,Wn[Bo])}else if(Z.isInstancedMesh)ii.renderInstances(bn,Li,Z.count);else if(oe.isInstancedBufferGeometry){let Dt=oe._maxInstanceCount!==void 0?oe._maxInstanceCount:1/0,Wn=Math.min(oe.instanceCount,Dt);ii.renderInstances(bn,Li,Wn)}else ii.render(bn,Li)};function WF(D,G,oe){D.transparent===!0&&D.side===rr&&D.forceSinglePass===!1?(D.side=qr,D.needsUpdate=!0,d0(D,G,oe),D.side=vs,D.needsUpdate=!0,d0(D,G,oe),D.side=rr):d0(D,G,oe)}this.compile=function(D,G,oe=null){oe===null&&(oe=D),w=ke.get(oe),w.init(G),E.push(w),oe.traverseVisible(function(Z){Z.isLight&&Z.layers.test(G.layers)&&(w.pushLight(Z),Z.castShadow&&w.pushShadow(Z))}),D!==oe&&D.traverseVisible(function(Z){Z.isLight&&Z.layers.test(G.layers)&&(w.pushLight(Z),Z.castShadow&&w.pushShadow(Z))}),w.setupLights();let re=new Set;return D.traverse(function(Z){if(!(Z.isMesh||Z.isPoints||Z.isLine||Z.isSprite))return;let He=Z.material;if(He)if(Array.isArray(He))for(let et=0;et<He.length;et++){let qe=He[et];WF(qe,oe,Z),re.add(qe)}else WF(He,oe,Z),re.add(He)}),w=E.pop(),re},this.compileAsync=function(D,G,oe=null){let re=this.compile(D,G,oe);return new Promise(Z=>{function He(){if(re.forEach(function(et){M.get(et).currentProgram.isReady()&&re.delete(et)}),re.size===0){Z(D);return}setTimeout(He,10)}$e.get("KHR_parallel_shader_compile")!==null?He():setTimeout(He,10)})};let NR=null;function V4(D){NR&&NR(D)}function $F(){Uu.stop()}function qF(){Uu.start()}let Uu=new F3;Uu.setAnimationLoop(V4),typeof self<"u"&&Uu.setContext(self),this.setAnimationLoop=function(D){NR=D,Be.setAnimationLoop(D),D===null?Uu.stop():Uu.start()},Be.addEventListener("sessionstart",$F),Be.addEventListener("sessionend",qF),this.render=function(D,G){if(G!==void 0&&G.isCamera!==!0){bt("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(T===!0)return;let oe=Be.enabled===!0&&Be.isPresenting===!0,re=A!==null&&(H===null||oe)&&A.begin(x,H);if(D.matrixWorldAutoUpdate===!0&&D.updateMatrixWorld(),G.parent===null&&G.matrixWorldAutoUpdate===!0&&G.updateMatrixWorld(),Be.enabled===!0&&Be.isPresenting===!0&&(A===null||A.isCompositing()===!1)&&(Be.cameraAutoUpdate===!0&&Be.updateCamera(G),G=Be.getCamera()),D.isScene===!0&&D.onBeforeRender(x,D,G,H),w=ke.get(D,E.length),w.init(G),E.push(w),Fn.multiplyMatrices(G.projectionMatrix,G.matrixWorldInverse),Je.setFromProjectionMatrix(Fn,Io,G.reversedDepth),wn=this.localClippingEnabled,Ae=it.init(this.clippingPlanes,wn),y=Se.get(D,R.length),y.init(),R.push(y),Be.enabled===!0&&Be.isPresenting===!0){let et=x.xr.getDepthSensingMesh();et!==null&&jR(et,G,-1/0,x.sortObjects)}jR(D,G,0,x.sortObjects),y.finish(),x.sortObjects===!0&&y.sort(dn,_n),xe=Be.enabled===!1||Be.isPresenting===!1||Be.hasDepthSensing()===!1,xe&&je.addToRenderList(y,D),this.info.render.frame++,Ae===!0&&it.beginShadows();let Z=w.state.shadowsArray;if(ft.render(Z,D,G),Ae===!0&&it.endShadows(),this.info.autoReset===!0&&this.info.reset(),(re&&A.hasRenderPass())===!1){let et=y.opaque,qe=y.transmissive;if(w.setupLights(),G.isArrayCamera){let ct=G.cameras;if(qe.length>0)for(let xt=0,Ut=ct.length;xt<Ut;xt++){let Et=ct[xt];ZF(et,qe,D,Et)}xe&&je.render(D);for(let xt=0,Ut=ct.length;xt<Ut;xt++){let Et=ct[xt];XF(y,D,Et,Et.viewport)}}else qe.length>0&&ZF(et,qe,D,G),xe&&je.render(D),XF(y,D,G)}H!==null&&L===0&&(U.updateMultisampleRenderTarget(H),U.updateRenderTargetMipmap(H)),re&&A.end(x),D.isScene===!0&&D.onAfterRender(x,D,G),Qe.resetDefaultState(),te=-1,Y=null,E.pop(),E.length>0?(w=E[E.length-1],Ae===!0&&it.setGlobalState(x.clippingPlanes,w.state.camera)):w=null,R.pop(),R.length>0?y=R[R.length-1]:y=null};function jR(D,G,oe,re){if(D.visible===!1)return;if(D.layers.test(G.layers)){if(D.isGroup)oe=D.renderOrder;else if(D.isLOD)D.autoUpdate===!0&&D.update(G);else if(D.isLight)w.pushLight(D),D.castShadow&&w.pushShadow(D);else if(D.isSprite){if(!D.frustumCulled||Je.intersectsSprite(D)){re&&ye.setFromMatrixPosition(D.matrixWorld).applyMatrix4(Fn);let et=Ne.update(D),qe=D.material;qe.visible&&y.push(D,et,qe,oe,ye.z,null)}}else if((D.isMesh||D.isLine||D.isPoints)&&(!D.frustumCulled||Je.intersectsObject(D))){let et=Ne.update(D),qe=D.material;if(re&&(D.boundingSphere!==void 0?(D.boundingSphere===null&&D.computeBoundingSphere(),ye.copy(D.boundingSphere.center)):(et.boundingSphere===null&&et.computeBoundingSphere(),ye.copy(et.boundingSphere.center)),ye.applyMatrix4(D.matrixWorld).applyMatrix4(Fn)),Array.isArray(qe)){let ct=et.groups;for(let xt=0,Ut=ct.length;xt<Ut;xt++){let Et=ct[xt],bn=qe[Et.materialIndex];bn&&bn.visible&&y.push(D,et,bn,oe,ye.z,Et)}}else qe.visible&&y.push(D,et,qe,oe,ye.z,null)}}let He=D.children;for(let et=0,qe=He.length;et<qe;et++)jR(He[et],G,oe,re)}function XF(D,G,oe,re){let{opaque:Z,transmissive:He,transparent:et}=D;w.setupLightsView(oe),Ae===!0&&it.setGlobalState(x.clippingPlanes,oe),re&&Fe.viewport(J.copy(re)),Z.length>0&&u0(Z,G,oe),He.length>0&&u0(He,G,oe),et.length>0&&u0(et,G,oe),Fe.buffers.depth.setTest(!0),Fe.buffers.depth.setMask(!0),Fe.buffers.color.setMask(!0),Fe.setPolygonOffset(!1)}function ZF(D,G,oe,re){if((oe.isScene===!0?oe.overrideMaterial:null)!==null)return;if(w.state.transmissionRenderTarget[re.id]===void 0){let bn=$e.has("EXT_color_buffer_half_float")||$e.has("EXT_color_buffer_float");w.state.transmissionRenderTarget[re.id]=new Qt(1,1,{generateMipmaps:!0,type:bn?An:_o,minFilter:Po,samples:Mt.samples,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:hn.workingColorSpace})}let He=w.state.transmissionRenderTarget[re.id],et=re.viewport||J;He.setSize(et.z*x.transmissionResolutionScale,et.w*x.transmissionResolutionScale);let qe=x.getRenderTarget(),ct=x.getActiveCubeFace(),xt=x.getActiveMipmapLevel();x.setRenderTarget(He),x.getClearColor(ve),Re=x.getClearAlpha(),Re<1&&x.setClearColor(16777215,.5),x.clear(),xe&&je.render(oe);let Ut=x.toneMapping;x.toneMapping=Ts;let Et=re.viewport;if(re.viewport!==void 0&&(re.viewport=void 0),w.setupLightsView(re),Ae===!0&&it.setGlobalState(x.clippingPlanes,re),u0(D,oe,re),U.updateMultisampleRenderTarget(He),U.updateRenderTargetMipmap(He),$e.has("WEBGL_multisampled_render_to_texture")===!1){let bn=!1;for(let Qn=0,Li=G.length;Qn<Li;Qn++){let ki=G[Qn],{object:ii,geometry:Dt,material:Wn,group:Nn}=ki;if(Wn.side===rr&&ii.layers.test(re.layers)){let ko=Wn.side;Wn.side=qr,Wn.needsUpdate=!0,YF(ii,oe,re,Dt,Wn,Nn),Wn.side=ko,Wn.needsUpdate=!0,bn=!0}}bn===!0&&(U.updateMultisampleRenderTarget(He),U.updateRenderTargetMipmap(He))}x.setRenderTarget(qe,ct,xt),x.setClearColor(ve,Re),Et!==void 0&&(re.viewport=Et),x.toneMapping=Ut}function u0(D,G,oe){let re=G.isScene===!0?G.overrideMaterial:null;for(let Z=0,He=D.length;Z<He;Z++){let et=D[Z],{object:qe,geometry:ct,group:xt}=et,Ut=et.material;Ut.allowOverride===!0&&re!==null&&(Ut=re),qe.layers.test(oe.layers)&&YF(qe,G,oe,ct,Ut,xt)}}function YF(D,G,oe,re,Z,He){D.onBeforeRender(x,G,oe,re,Z,He),D.modelViewMatrix.multiplyMatrices(oe.matrixWorldInverse,D.matrixWorld),D.normalMatrix.getNormalMatrix(D.modelViewMatrix),Z.onBeforeRender(x,G,oe,re,D,He),Z.transparent===!0&&Z.side===rr&&Z.forceSinglePass===!1?(Z.side=qr,Z.needsUpdate=!0,x.renderBufferDirect(oe,G,re,Z,D,He),Z.side=vs,Z.needsUpdate=!0,x.renderBufferDirect(oe,G,re,Z,D,He),Z.side=rr):x.renderBufferDirect(oe,G,re,Z,D,He),D.onAfterRender(x,G,oe,re,Z,He)}function d0(D,G,oe){G.isScene!==!0&&(G=Me);let re=M.get(D),Z=w.state.lights,He=w.state.shadowsArray,et=Z.state.version,qe=Ye.getParameters(D,Z.state,He,G,oe),ct=Ye.getProgramCacheKey(qe),xt=re.programs;re.environment=D.isMeshStandardMaterial?G.environment:null,re.fog=G.fog,re.envMap=(D.isMeshStandardMaterial?be:se).get(D.envMap||re.environment),re.envMapRotation=re.environment!==null&&D.envMap===null?G.environmentRotation:D.envMapRotation,xt===void 0&&(D.addEventListener("dispose",Ia),xt=new Map,re.programs=xt);let Ut=xt.get(ct);if(Ut!==void 0){if(re.currentProgram===Ut&&re.lightsStateVersion===et)return KF(D,qe),Ut}else qe.uniforms=Ye.getUniforms(D),D.onBeforeCompile(qe,x),Ut=Ye.acquireProgram(qe,ct),xt.set(ct,Ut),re.uniforms=qe.uniforms;let Et=re.uniforms;return(!D.isShaderMaterial&&!D.isRawShaderMaterial||D.clipping===!0)&&(Et.clippingPlanes=it.uniform),KF(D,qe),re.needsLights=G4(D),re.lightsStateVersion=et,re.needsLights&&(Et.ambientLightColor.value=Z.state.ambient,Et.lightProbe.value=Z.state.probe,Et.directionalLights.value=Z.state.directional,Et.directionalLightShadows.value=Z.state.directionalShadow,Et.spotLights.value=Z.state.spot,Et.spotLightShadows.value=Z.state.spotShadow,Et.rectAreaLights.value=Z.state.rectArea,Et.ltc_1.value=Z.state.rectAreaLTC1,Et.ltc_2.value=Z.state.rectAreaLTC2,Et.pointLights.value=Z.state.point,Et.pointLightShadows.value=Z.state.pointShadow,Et.hemisphereLights.value=Z.state.hemi,Et.directionalShadowMap.value=Z.state.directionalShadowMap,Et.directionalShadowMatrix.value=Z.state.directionalShadowMatrix,Et.spotShadowMap.value=Z.state.spotShadowMap,Et.spotLightMatrix.value=Z.state.spotLightMatrix,Et.spotLightMap.value=Z.state.spotLightMap,Et.pointShadowMap.value=Z.state.pointShadowMap,Et.pointShadowMatrix.value=Z.state.pointShadowMatrix),re.currentProgram=Ut,re.uniformsList=null,Ut}function QF(D){if(D.uniformsList===null){let G=D.currentProgram.getUniforms();D.uniformsList=Gp.seqWithValue(G.seq,D.uniforms)}return D.uniformsList}function KF(D,G){let oe=M.get(D);oe.outputColorSpace=G.outputColorSpace,oe.batching=G.batching,oe.batchingColor=G.batchingColor,oe.instancing=G.instancing,oe.instancingColor=G.instancingColor,oe.instancingMorph=G.instancingMorph,oe.skinning=G.skinning,oe.morphTargets=G.morphTargets,oe.morphNormals=G.morphNormals,oe.morphColors=G.morphColors,oe.morphTargetsCount=G.morphTargetsCount,oe.numClippingPlanes=G.numClippingPlanes,oe.numIntersection=G.numClipIntersection,oe.vertexAlphas=G.vertexAlphas,oe.vertexTangents=G.vertexTangents,oe.toneMapping=G.toneMapping}function z4(D,G,oe,re,Z){G.isScene!==!0&&(G=Me),U.resetTextureUnits();let He=G.fog,et=re.isMeshStandardMaterial?G.environment:null,qe=H===null?x.outputColorSpace:H.isXRRenderTarget===!0?H.texture.colorSpace:nr,ct=(re.isMeshStandardMaterial?be:se).get(re.envMap||et),xt=re.vertexColors===!0&&!!oe.attributes.color&&oe.attributes.color.itemSize===4,Ut=!!oe.attributes.tangent&&(!!re.normalMap||re.anisotropy>0),Et=!!oe.morphAttributes.position,bn=!!oe.morphAttributes.normal,Qn=!!oe.morphAttributes.color,Li=Ts;re.toneMapped&&(H===null||H.isXRRenderTarget===!0)&&(Li=x.toneMapping);let ki=oe.morphAttributes.position||oe.morphAttributes.normal||oe.morphAttributes.color,ii=ki!==void 0?ki.length:0,Dt=M.get(re),Wn=w.state.lights;if(Ae===!0&&(wn===!0||D!==Y)){let eo=D===Y&&re.id===te;it.setState(re,D,eo)}let Nn=!1;re.version===Dt.__version?(Dt.needsLights&&Dt.lightsStateVersion!==Wn.state.version||Dt.outputColorSpace!==qe||Z.isBatchedMesh&&Dt.batching===!1||!Z.isBatchedMesh&&Dt.batching===!0||Z.isBatchedMesh&&Dt.batchingColor===!0&&Z.colorTexture===null||Z.isBatchedMesh&&Dt.batchingColor===!1&&Z.colorTexture!==null||Z.isInstancedMesh&&Dt.instancing===!1||!Z.isInstancedMesh&&Dt.instancing===!0||Z.isSkinnedMesh&&Dt.skinning===!1||!Z.isSkinnedMesh&&Dt.skinning===!0||Z.isInstancedMesh&&Dt.instancingColor===!0&&Z.instanceColor===null||Z.isInstancedMesh&&Dt.instancingColor===!1&&Z.instanceColor!==null||Z.isInstancedMesh&&Dt.instancingMorph===!0&&Z.morphTexture===null||Z.isInstancedMesh&&Dt.instancingMorph===!1&&Z.morphTexture!==null||Dt.envMap!==ct||re.fog===!0&&Dt.fog!==He||Dt.numClippingPlanes!==void 0&&(Dt.numClippingPlanes!==it.numPlanes||Dt.numIntersection!==it.numIntersection)||Dt.vertexAlphas!==xt||Dt.vertexTangents!==Ut||Dt.morphTargets!==Et||Dt.morphNormals!==bn||Dt.morphColors!==Qn||Dt.toneMapping!==Li||Dt.morphTargetsCount!==ii)&&(Nn=!0):(Nn=!0,Dt.__version=re.version);let ko=Dt.currentProgram;Nn===!0&&(ko=d0(re,G,Z));let Vh=!1,Bo=!1,Um=!1,hi=ko.getUniforms(),xo=Dt.uniforms;if(Fe.useProgram(ko.program)&&(Vh=!0,Bo=!0,Um=!0),re.id!==te&&(te=re.id,Bo=!0),Vh||Y!==D){Fe.buffers.depth.getReversed()&&D.reversedDepth!==!0&&(D._reversedDepth=!0,D.updateProjectionMatrix()),hi.setValue(j,"projectionMatrix",D.projectionMatrix),hi.setValue(j,"viewMatrix",D.matrixWorldInverse);let wo=hi.map.cameraPosition;wo!==void 0&&wo.setValue(j,zt.setFromMatrixPosition(D.matrixWorld)),Mt.logarithmicDepthBuffer&&hi.setValue(j,"logDepthBufFC",2/(Math.log(D.far+1)/Math.LN2)),(re.isMeshPhongMaterial||re.isMeshToonMaterial||re.isMeshLambertMaterial||re.isMeshBasicMaterial||re.isMeshStandardMaterial||re.isShaderMaterial)&&hi.setValue(j,"isOrthographic",D.isOrthographicCamera===!0),Y!==D&&(Y=D,Bo=!0,Um=!0)}if(Dt.needsLights&&(Wn.state.directionalShadowMap.length>0&&hi.setValue(j,"directionalShadowMap",Wn.state.directionalShadowMap,U),Wn.state.spotShadowMap.length>0&&hi.setValue(j,"spotShadowMap",Wn.state.spotShadowMap,U),Wn.state.pointShadowMap.length>0&&hi.setValue(j,"pointShadowMap",Wn.state.pointShadowMap,U)),Z.isSkinnedMesh){hi.setOptional(j,Z,"bindMatrix"),hi.setOptional(j,Z,"bindMatrixInverse");let eo=Z.skeleton;eo&&(eo.boneTexture===null&&eo.computeBoneTexture(),hi.setValue(j,"boneTexture",eo.boneTexture,U))}Z.isBatchedMesh&&(hi.setOptional(j,Z,"batchingTexture"),hi.setValue(j,"batchingTexture",Z._matricesTexture,U),hi.setOptional(j,Z,"batchingIdTexture"),hi.setValue(j,"batchingIdTexture",Z._indirectTexture,U),hi.setOptional(j,Z,"batchingColorTexture"),Z._colorsTexture!==null&&hi.setValue(j,"batchingColorTexture",Z._colorsTexture,U));let as=oe.morphAttributes;if((as.position!==void 0||as.normal!==void 0||as.color!==void 0)&&qt.update(Z,oe,ko),(Bo||Dt.receiveShadow!==Z.receiveShadow)&&(Dt.receiveShadow=Z.receiveShadow,hi.setValue(j,"receiveShadow",Z.receiveShadow)),re.isMeshGouraudMaterial&&re.envMap!==null&&(xo.envMap.value=ct,xo.flipEnvMap.value=ct.isCubeTexture&&ct.isRenderTargetTexture===!1?-1:1),re.isMeshStandardMaterial&&re.envMap===null&&G.environment!==null&&(xo.envMapIntensity.value=G.environmentIntensity),xo.dfgLUT!==void 0&&(xo.dfgLUT.value=LK()),Bo&&(hi.setValue(j,"toneMappingExposure",x.toneMappingExposure),Dt.needsLights&&H4(xo,Um),He&&re.fog===!0&&Ct.refreshFogUniforms(xo,He),Ct.refreshMaterialUniforms(xo,re,gt,mt,w.state.transmissionRenderTarget[D.id]),Gp.upload(j,QF(Dt),xo,U)),re.isShaderMaterial&&re.uniformsNeedUpdate===!0&&(Gp.upload(j,QF(Dt),xo,U),re.uniformsNeedUpdate=!1),re.isSpriteMaterial&&hi.setValue(j,"center",Z.center),hi.setValue(j,"modelViewMatrix",Z.modelViewMatrix),hi.setValue(j,"normalMatrix",Z.normalMatrix),hi.setValue(j,"modelMatrix",Z.matrixWorld),re.isShaderMaterial||re.isRawShaderMaterial){let eo=re.uniformsGroups;for(let wo=0,OR=eo.length;wo<OR;wo++){let Vu=eo[wo];Ce.update(Vu,ko),Ce.bind(Vu,ko)}}return ko}function H4(D,G){D.ambientLightColor.needsUpdate=G,D.lightProbe.needsUpdate=G,D.directionalLights.needsUpdate=G,D.directionalLightShadows.needsUpdate=G,D.pointLights.needsUpdate=G,D.pointLightShadows.needsUpdate=G,D.spotLights.needsUpdate=G,D.spotLightShadows.needsUpdate=G,D.rectAreaLights.needsUpdate=G,D.hemisphereLights.needsUpdate=G}function G4(D){return D.isMeshLambertMaterial||D.isMeshToonMaterial||D.isMeshPhongMaterial||D.isMeshStandardMaterial||D.isShadowMaterial||D.isShaderMaterial&&D.lights===!0}this.getActiveCubeFace=function(){return P},this.getActiveMipmapLevel=function(){return L},this.getRenderTarget=function(){return H},this.setRenderTargetTextures=function(D,G,oe){let re=M.get(D);re.__autoAllocateDepthBuffer=D.resolveDepthBuffer===!1,re.__autoAllocateDepthBuffer===!1&&(re.__useRenderToTexture=!1),M.get(D.texture).__webglTexture=G,M.get(D.depthTexture).__webglTexture=re.__autoAllocateDepthBuffer?void 0:oe,re.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(D,G){let oe=M.get(D);oe.__webglFramebuffer=G,oe.__useDefaultFramebuffer=G===void 0};let W4=j.createFramebuffer();this.setRenderTarget=function(D,G=0,oe=0){H=D,P=G,L=oe;let re=null,Z=!1,He=!1;if(D){let qe=M.get(D);if(qe.__useDefaultFramebuffer!==void 0){Fe.bindFramebuffer(j.FRAMEBUFFER,qe.__webglFramebuffer),J.copy(D.viewport),W.copy(D.scissor),fe=D.scissorTest,Fe.viewport(J),Fe.scissor(W),Fe.setScissorTest(fe),te=-1;return}else if(qe.__webglFramebuffer===void 0)U.setupRenderTarget(D);else if(qe.__hasExternalTextures)U.rebindTextures(D,M.get(D.texture).__webglTexture,M.get(D.depthTexture).__webglTexture);else if(D.depthBuffer){let Ut=D.depthTexture;if(qe.__boundDepthTexture!==Ut){if(Ut!==null&&M.has(Ut)&&(D.width!==Ut.image.width||D.height!==Ut.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");U.setupDepthRenderbuffer(D)}}let ct=D.texture;(ct.isData3DTexture||ct.isDataArrayTexture||ct.isCompressedArrayTexture)&&(He=!0);let xt=M.get(D).__webglFramebuffer;D.isWebGLCubeRenderTarget?(Array.isArray(xt[G])?re=xt[G][oe]:re=xt[G],Z=!0):D.samples>0&&U.useMultisampledRTT(D)===!1?re=M.get(D).__webglMultisampledFramebuffer:Array.isArray(xt)?re=xt[oe]:re=xt,J.copy(D.viewport),W.copy(D.scissor),fe=D.scissorTest}else J.copy(le).multiplyScalar(gt).floor(),W.copy(_e).multiplyScalar(gt).floor(),fe=Le;if(oe!==0&&(re=W4),Fe.bindFramebuffer(j.FRAMEBUFFER,re)&&Fe.drawBuffers(D,re),Fe.viewport(J),Fe.scissor(W),Fe.setScissorTest(fe),Z){let qe=M.get(D.texture);j.framebufferTexture2D(j.FRAMEBUFFER,j.COLOR_ATTACHMENT0,j.TEXTURE_CUBE_MAP_POSITIVE_X+G,qe.__webglTexture,oe)}else if(He){let qe=G;for(let ct=0;ct<D.textures.length;ct++){let xt=M.get(D.textures[ct]);j.framebufferTextureLayer(j.FRAMEBUFFER,j.COLOR_ATTACHMENT0+ct,xt.__webglTexture,oe,qe)}}else if(D!==null&&oe!==0){let qe=M.get(D.texture);j.framebufferTexture2D(j.FRAMEBUFFER,j.COLOR_ATTACHMENT0,j.TEXTURE_2D,qe.__webglTexture,oe)}te=-1},this.readRenderTargetPixels=function(D,G,oe,re,Z,He,et,qe=0){if(!(D&&D.isWebGLRenderTarget)){bt("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ct=M.get(D).__webglFramebuffer;if(D.isWebGLCubeRenderTarget&&et!==void 0&&(ct=ct[et]),ct){Fe.bindFramebuffer(j.FRAMEBUFFER,ct);try{let xt=D.textures[qe],Ut=xt.format,Et=xt.type;if(!Mt.textureFormatReadable(Ut)){bt("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Mt.textureTypeReadable(Et)){bt("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}G>=0&&G<=D.width-re&&oe>=0&&oe<=D.height-Z&&(D.textures.length>1&&j.readBuffer(j.COLOR_ATTACHMENT0+qe),j.readPixels(G,oe,re,Z,De.convert(Ut),De.convert(Et),He))}finally{let xt=H!==null?M.get(H).__webglFramebuffer:null;Fe.bindFramebuffer(j.FRAMEBUFFER,xt)}}},this.readRenderTargetPixelsAsync=function(D,G,oe,re,Z,He,et,qe=0){return Wt(this,null,function*(){if(!(D&&D.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ct=M.get(D).__webglFramebuffer;if(D.isWebGLCubeRenderTarget&&et!==void 0&&(ct=ct[et]),ct)if(G>=0&&G<=D.width-re&&oe>=0&&oe<=D.height-Z){Fe.bindFramebuffer(j.FRAMEBUFFER,ct);let xt=D.textures[qe],Ut=xt.format,Et=xt.type;if(!Mt.textureFormatReadable(Ut))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Mt.textureTypeReadable(Et))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");let bn=j.createBuffer();j.bindBuffer(j.PIXEL_PACK_BUFFER,bn),j.bufferData(j.PIXEL_PACK_BUFFER,He.byteLength,j.STREAM_READ),D.textures.length>1&&j.readBuffer(j.COLOR_ATTACHMENT0+qe),j.readPixels(G,oe,re,Z,De.convert(Ut),De.convert(Et),0);let Qn=H!==null?M.get(H).__webglFramebuffer:null;Fe.bindFramebuffer(j.FRAMEBUFFER,Qn);let Li=j.fenceSync(j.SYNC_GPU_COMMANDS_COMPLETE,0);return j.flush(),yield n3(j,Li,4),j.bindBuffer(j.PIXEL_PACK_BUFFER,bn),j.getBufferSubData(j.PIXEL_PACK_BUFFER,0,He),j.deleteBuffer(bn),j.deleteSync(Li),He}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")})},this.copyFramebufferToTexture=function(D,G=null,oe=0){let re=Math.pow(2,-oe),Z=Math.floor(D.image.width*re),He=Math.floor(D.image.height*re),et=G!==null?G.x:0,qe=G!==null?G.y:0;U.setTexture2D(D,0),j.copyTexSubImage2D(j.TEXTURE_2D,oe,0,0,et,qe,Z,He),Fe.unbindTexture()};let $4=j.createFramebuffer(),q4=j.createFramebuffer();this.copyTextureToTexture=function(D,G,oe=null,re=null,Z=0,He=null){He===null&&(Z!==0?(Xd("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),He=Z,Z=0):He=0);let et,qe,ct,xt,Ut,Et,bn,Qn,Li,ki=D.isCompressedTexture?D.mipmaps[He]:D.image;if(oe!==null)et=oe.max.x-oe.min.x,qe=oe.max.y-oe.min.y,ct=oe.isBox3?oe.max.z-oe.min.z:1,xt=oe.min.x,Ut=oe.min.y,Et=oe.isBox3?oe.min.z:0;else{let as=Math.pow(2,-Z);et=Math.floor(ki.width*as),qe=Math.floor(ki.height*as),D.isDataArrayTexture?ct=ki.depth:D.isData3DTexture?ct=Math.floor(ki.depth*as):ct=1,xt=0,Ut=0,Et=0}re!==null?(bn=re.x,Qn=re.y,Li=re.z):(bn=0,Qn=0,Li=0);let ii=De.convert(G.format),Dt=De.convert(G.type),Wn;G.isData3DTexture?(U.setTexture3D(G,0),Wn=j.TEXTURE_3D):G.isDataArrayTexture||G.isCompressedArrayTexture?(U.setTexture2DArray(G,0),Wn=j.TEXTURE_2D_ARRAY):(U.setTexture2D(G,0),Wn=j.TEXTURE_2D),j.pixelStorei(j.UNPACK_FLIP_Y_WEBGL,G.flipY),j.pixelStorei(j.UNPACK_PREMULTIPLY_ALPHA_WEBGL,G.premultiplyAlpha),j.pixelStorei(j.UNPACK_ALIGNMENT,G.unpackAlignment);let Nn=j.getParameter(j.UNPACK_ROW_LENGTH),ko=j.getParameter(j.UNPACK_IMAGE_HEIGHT),Vh=j.getParameter(j.UNPACK_SKIP_PIXELS),Bo=j.getParameter(j.UNPACK_SKIP_ROWS),Um=j.getParameter(j.UNPACK_SKIP_IMAGES);j.pixelStorei(j.UNPACK_ROW_LENGTH,ki.width),j.pixelStorei(j.UNPACK_IMAGE_HEIGHT,ki.height),j.pixelStorei(j.UNPACK_SKIP_PIXELS,xt),j.pixelStorei(j.UNPACK_SKIP_ROWS,Ut),j.pixelStorei(j.UNPACK_SKIP_IMAGES,Et);let hi=D.isDataArrayTexture||D.isData3DTexture,xo=G.isDataArrayTexture||G.isData3DTexture;if(D.isDepthTexture){let as=M.get(D),eo=M.get(G),wo=M.get(as.__renderTarget),OR=M.get(eo.__renderTarget);Fe.bindFramebuffer(j.READ_FRAMEBUFFER,wo.__webglFramebuffer),Fe.bindFramebuffer(j.DRAW_FRAMEBUFFER,OR.__webglFramebuffer);for(let Vu=0;Vu<ct;Vu++)hi&&(j.framebufferTextureLayer(j.READ_FRAMEBUFFER,j.COLOR_ATTACHMENT0,M.get(D).__webglTexture,Z,Et+Vu),j.framebufferTextureLayer(j.DRAW_FRAMEBUFFER,j.COLOR_ATTACHMENT0,M.get(G).__webglTexture,He,Li+Vu)),j.blitFramebuffer(xt,Ut,et,qe,bn,Qn,et,qe,j.DEPTH_BUFFER_BIT,j.NEAREST);Fe.bindFramebuffer(j.READ_FRAMEBUFFER,null),Fe.bindFramebuffer(j.DRAW_FRAMEBUFFER,null)}else if(Z!==0||D.isRenderTargetTexture||M.has(D)){let as=M.get(D),eo=M.get(G);Fe.bindFramebuffer(j.READ_FRAMEBUFFER,$4),Fe.bindFramebuffer(j.DRAW_FRAMEBUFFER,q4);for(let wo=0;wo<ct;wo++)hi?j.framebufferTextureLayer(j.READ_FRAMEBUFFER,j.COLOR_ATTACHMENT0,as.__webglTexture,Z,Et+wo):j.framebufferTexture2D(j.READ_FRAMEBUFFER,j.COLOR_ATTACHMENT0,j.TEXTURE_2D,as.__webglTexture,Z),xo?j.framebufferTextureLayer(j.DRAW_FRAMEBUFFER,j.COLOR_ATTACHMENT0,eo.__webglTexture,He,Li+wo):j.framebufferTexture2D(j.DRAW_FRAMEBUFFER,j.COLOR_ATTACHMENT0,j.TEXTURE_2D,eo.__webglTexture,He),Z!==0?j.blitFramebuffer(xt,Ut,et,qe,bn,Qn,et,qe,j.COLOR_BUFFER_BIT,j.NEAREST):xo?j.copyTexSubImage3D(Wn,He,bn,Qn,Li+wo,xt,Ut,et,qe):j.copyTexSubImage2D(Wn,He,bn,Qn,xt,Ut,et,qe);Fe.bindFramebuffer(j.READ_FRAMEBUFFER,null),Fe.bindFramebuffer(j.DRAW_FRAMEBUFFER,null)}else xo?D.isDataTexture||D.isData3DTexture?j.texSubImage3D(Wn,He,bn,Qn,Li,et,qe,ct,ii,Dt,ki.data):G.isCompressedArrayTexture?j.compressedTexSubImage3D(Wn,He,bn,Qn,Li,et,qe,ct,ii,ki.data):j.texSubImage3D(Wn,He,bn,Qn,Li,et,qe,ct,ii,Dt,ki):D.isDataTexture?j.texSubImage2D(j.TEXTURE_2D,He,bn,Qn,et,qe,ii,Dt,ki.data):D.isCompressedTexture?j.compressedTexSubImage2D(j.TEXTURE_2D,He,bn,Qn,ki.width,ki.height,ii,ki.data):j.texSubImage2D(j.TEXTURE_2D,He,bn,Qn,et,qe,ii,Dt,ki);j.pixelStorei(j.UNPACK_ROW_LENGTH,Nn),j.pixelStorei(j.UNPACK_IMAGE_HEIGHT,ko),j.pixelStorei(j.UNPACK_SKIP_PIXELS,Vh),j.pixelStorei(j.UNPACK_SKIP_ROWS,Bo),j.pixelStorei(j.UNPACK_SKIP_IMAGES,Um),He===0&&G.generateMipmaps&&j.generateMipmap(Wn),Fe.unbindTexture()},this.initRenderTarget=function(D){M.get(D).__webglFramebuffer===void 0&&U.setupRenderTarget(D)},this.initTexture=function(D){D.isCubeTexture?U.setTextureCube(D,0):D.isData3DTexture?U.setTexture3D(D,0):D.isDataArrayTexture||D.isCompressedArrayTexture?U.setTexture2DArray(D,0):U.setTexture2D(D,0),Fe.unbindTexture()},this.resetState=function(){P=0,L=0,H=null,Fe.reset(),Qe.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Io}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let t=this.getContext();t.drawingBufferColorSpace=hn._getDrawingBufferColorSpace(e),t.unpackColorSpace=hn._getUnpackColorSpace()}};function jI(i){return!!(i&&i.set)}function pe(i,e){if(jI(i)){if(e===void 0)return i;if(Array.isArray(e))return i.set(...e),i;if(i.copy&&e)return i.copy(e),i;if(e!==void 0)return i.set(e),i}else return e;return i}function B3(i){return!!(i&&typeof i.dispose=="function")}function yu(i){return i!==void 0&&(i.observed||i.observers?.length>0)}var OI=class{constructor(e){this.memberMap=new Map,this.children=[],this.eventListener={},this.loaded=!1,this.add=(...t)=>(this.objRef&&this.objRef.add(...t),this.children.push(...t),this),this.remove=(...t)=>{this.objRef&&this.objRef.remove(...t);for(let n of t){let r=this.children.indexOf(n);r>=0&&(this.children=this.children.splice(r,1))}return this},this.applyToObject3D=t=>{if(this.memberMap.forEach((n,r)=>{let o=t[r];jI(o)?pe(o,n):t[r]=n}),this.children.forEach(n=>t.add(n)),this.objRef?.parent){let n=this.objRef?.parent;n.remove(this.objRef),n.add(t)}},this.addEventListener=(t,n)=>{let r=this.eventListener[t];r||(r=[],this.eventListener[t]=r),r.push(n),this.objRef&&this.objRef.addEventListener(t,n)},this.removeEventListener=(t,n)=>{let r=this.eventListener[t];if(!r)return;let o=r.indexOf(n);o>=0&&r.splice(o,1)},this.objRef=e}get(e,t,n){switch(t){case"__isProxy":return!0;case"applyToObject3D":return this.applyToObject3D;case"objRef":return this.loaded?this.objRef:void 0;case"add":return this.add;case"remove":return this.remove;case"children":return this.objRef?this.objRef.children:this.children;default:{let r=t,o=this.objRef[r];return o!==void 0&&this.memberMap.set(r,o),o}}}set(e,t,n,r){return t==="objRef"?(n&&this.applyToObject3D(n),this.loaded=!0,this.objRef=n):(this.memberMap.set(t,n),this.objRef&&(this.objRef[t]=n)),!0}};function kM(i=new wt){let e=new OI(i);return new Proxy(e,e)}function $p(i){return i.__isProxy===!0&&i.objRef===void 0}var bo=(()=>{let e=class e{set objRef(n){this.applyObjRef(n)}get objRef(){return this._objRef}constructor(){this.autoAddToParent=!0,this.autoDispose=!0}addToParent(){}removeFromParent(){}set threeEvents(n){this.removeEvents(),this.eventListeners=n,this.applyEvents()}get threeEvents(){return this.eventListeners}get onUpdate(){return this.updateEmitter||(this.updateEmitter=new dt),this.updateEmitter}get objRef$(){return this._objRef$||(this._objRef$=new Zu(1)),this._objRef$}ngOnInit(){this.objRef||(this.objRef=this.createThreeInstance(this.args))}getType(){throw new Error("derive me")}createThreeInstance(n){return Array.isArray(n)?new(this.getType())(...n):new(this.getType())(n)}ngOnChanges(n){if(this.objRef&&!$p(this.objRef)){this.emitPropertyChanges(n);return}this.objRef||(this.objRef=this.createThreeInstance(n.args?.currentValue));for(let r in n)this[r]=n[r].currentValue;this.emitPropertyChanges(n)}disposeObjRef(){B3(this.objRef)&&this.objRef.dispose()}ngOnDestroy(){this.removeEvents(),this.removeFromParent(),this.autoDispose&&this.disposeObjRef(),this.emitRemoveEvent()}applyObjRef(n){this._objRef!==n&&(this.removeFromParent(),this._objRef=n,this.autoAddToParent&&this.addToParent()),this.emitObjRefChange()}emitObjRefChange(){this._objRef&&!$p(this._objRef)&&(this._objRef.dispatchEvent?.({type:"loaded",object:this._objRef}),this._objRef$&&this._objRef$.next(this._objRef))}emitRemoveEvent(){this._objRef&&!$p(this._objRef)&&(this._objRef.dispatchEvent?.({type:"removed",object:this._objRef}),this._objRef$&&this._objRef$.next(this._objRef))}emitPropertyChanges(n){this._objRef&&this._objRef.dispatchEvent?.({type:"changes",changes:n}),this.updateEmitter&&this.updateEmitter.next(n)}removeEvents(){if(this.eventListeners&&this._objRef){for(let n of Object.entries(this.eventListeners))this._objRef.removeEventListener(n[0],n[1]);this.eventListeners=void 0}}applyEvents(){if(this.eventListeners&&this._objRef)for(let n of Object.entries(this.eventListeners))this._objRef.addEventListener(n[0],n[1])}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["th-abs-wrapper"]],inputs:{autoAddToParent:"autoAddToParent",autoDispose:"autoDispose",objRef:"objRef",args:"args",threeEvents:"threeEvents"},outputs:{onUpdate:"onUpdate",objRef$:"objRef$"},features:[$i],decls:0,vars:0,template:function(r,o){},encapsulation:2,changeDetection:0});let i=e;return i})();var kK=["*"],U3=(()=>{let e=class e extends bo{addToParent(){this._objRef&&this.parent.objRef&&(!this._objRef.parent||this._objRef.parent.uuid!==this.parent.objRef.uuid)&&this.parent.objRef.add(this._objRef)}removeFromParent(){this._objRef?.parent?.remove(this._objRef)}applyObjRef(n){(this._objRef!==n||this._objRef?.parent?.uuid!==this.parent.objRef.uuid)&&(this.removeFromParent(),this._objRef=n,this.autoAddToParent&&this.addToParent()),this.emitObjRefChange()}attachToParent(n,r){!this.parent.objRef||n===r&&r?.parent?.uuid===this.parent.objRef.uuid||(r&&r.parent&&r.parent.remove(r),n&&(!n.parent||n.parent&&n.parent.uuid!==this.parent.objRef.uuid)&&this.parent.objRef.add(n))}set lookAt(n){Promise.resolve().then(()=>{this.objRef&&(Array.isArray(n)?this.objRef.lookAt(...n):this.objRef.lookAt(n))})}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-abs-object"]],inputs:{lookAt:"lookAt"},features:[$],ngContentSelectors:kK,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var BK=["*"],va=class va extends U3{constructor(){super(...arguments),this.parent=S(va,{skipSelf:!0})}getType(){return wt}get isObject3D(){return this._objRef?.isObject3D}get id(){return this._objRef?.id}set uuid(e){this._objRef&&(this._objRef.uuid=e)}get uuid(){return this._objRef?.uuid}set name(e){this._objRef&&(this._objRef.name=e)}get name(){return this._objRef?.name}get type(){return this._objRef?.type}set children(e){this._objRef&&(this._objRef.children=e)}get children(){return this._objRef?.children}set up(e){this._objRef&&(this._objRef.up=pe(this._objRef.up,e))}get up(){return this._objRef?.up}set position(e){this._objRef&&pe(this._objRef.position,e)}get position(){return this._objRef?.position}set rotation(e){this._objRef&&pe(this._objRef.rotation,e)}get rotation(){return this._objRef?.rotation}set quaternion(e){this._objRef&&pe(this._objRef.quaternion,e)}get quaternion(){return this._objRef?.quaternion}set scale(e){this._objRef&&pe(this._objRef.scale,e)}get scale(){return this._objRef?.scale}set modelViewMatrix(e){this._objRef&&pe(this._objRef.modelViewMatrix,e)}get modelViewMatrix(){return this._objRef?.modelViewMatrix}set normalMatrix(e){this._objRef&&pe(this._objRef.normalMatrix,e)}get normalMatrix(){return this._objRef?.normalMatrix}set matrix(e){this._objRef&&(this._objRef.matrix=pe(this._objRef.matrix,e))}get matrix(){return this._objRef?.matrix}set matrixWorld(e){this._objRef&&(this._objRef.matrixWorld=pe(this._objRef.matrixWorld,e))}get matrixWorld(){return this._objRef?.matrixWorld}set matrixAutoUpdate(e){this._objRef&&(this._objRef.matrixAutoUpdate=e)}get matrixAutoUpdate(){return this._objRef?.matrixAutoUpdate}set matrixWorldAutoUpdate(e){this._objRef&&(this._objRef.matrixWorldAutoUpdate=e)}get matrixWorldAutoUpdate(){return this._objRef?.matrixWorldAutoUpdate}set matrixWorldNeedsUpdate(e){this._objRef&&(this._objRef.matrixWorldNeedsUpdate=e)}get matrixWorldNeedsUpdate(){return this._objRef?.matrixWorldNeedsUpdate}set layers(e){this._objRef&&(this._objRef.layers=pe(this._objRef.layers,e))}get layers(){return this._objRef?.layers}set visible(e){this._objRef&&(this._objRef.visible=e)}get visible(){return this._objRef?.visible}set castShadow(e){this._objRef&&(this._objRef.castShadow=e)}get castShadow(){return this._objRef?.castShadow}set receiveShadow(e){this._objRef&&(this._objRef.receiveShadow=e)}get receiveShadow(){return this._objRef?.receiveShadow}set frustumCulled(e){this._objRef&&(this._objRef.frustumCulled=e)}get frustumCulled(){return this._objRef?.frustumCulled}set renderOrder(e){this._objRef&&(this._objRef.renderOrder=e)}get renderOrder(){return this._objRef?.renderOrder}set animations(e){this._objRef&&(this._objRef.animations=e)}get animations(){return this._objRef?.animations}set userData(e){this._objRef&&(this._objRef.userData=e)}get userData(){return this._objRef?.userData}set customDepthMaterial(e){this._objRef&&(this._objRef.customDepthMaterial=e)}get customDepthMaterial(){return this._objRef?.customDepthMaterial}set customDistanceMaterial(e){this._objRef&&(this._objRef.customDistanceMaterial=e)}get customDistanceMaterial(){return this._objRef?.customDistanceMaterial}};va.DEFAULT_UP=wt.DEFAULT_UP,va.DEFAULT_MATRIX_AUTO_UPDATE=wt.DEFAULT_MATRIX_AUTO_UPDATE,va.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=wt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,va.\u0275fac=(()=>{let e;return function(n){return(e||(e=q(va)))(n||va)}})(),va.\u0275cmp=O({type:va,selectors:[["th-object3D"]],inputs:{uuid:"uuid",name:"name",children:"children",up:"up",position:"position",rotation:"rotation",quaternion:"quaternion",scale:"scale",modelViewMatrix:"modelViewMatrix",normalMatrix:"normalMatrix",matrix:"matrix",matrixWorld:"matrixWorld",matrixAutoUpdate:"matrixAutoUpdate",matrixWorldAutoUpdate:"matrixWorldAutoUpdate",matrixWorldNeedsUpdate:"matrixWorldNeedsUpdate",layers:"layers",visible:"visible",castShadow:"castShadow",receiveShadow:"receiveShadow",frustumCulled:"frustumCulled",renderOrder:"renderOrder",animations:"animations",userData:"userData",customDepthMaterial:"customDepthMaterial",customDistanceMaterial:"customDistanceMaterial"},features:[K([]),$],ngContentSelectors:BK,decls:1,vars:0,template:function(t,n){t&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});var de=va;var Sh=new me("A reference to the raycaster object",{factory:()=>new Dr}),xu=(()=>{let e=class e{constructor(){this.raycaster=S(Sh),this.selected=null,this.enabled=!0,this.groups=[],this.paused=!1,this.maxClickDistance=23,this.nid=e.instanceCnt++,this.onPointerMove=this.onPointerMove.bind(this),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerUp=this.onPointerUp.bind(this)}ngOnDestroy(){this.disable(),this.unsubscribe()}subscribe(){if(!this.canvas)throw new Error("missing canvas");this.canvas.addEventListener("pointermove",this.onPointerMove),this.canvas.addEventListener("pointerdown",this.onPointerDown),this.canvas.addEventListener("pointerup",this.onPointerUp)}unsubscribe(){if(!this.canvas)throw new Error("missing canvas");this.canvas.removeEventListener("pointermove",this.onPointerMove),this.canvas.removeEventListener("pointerdown",this.onPointerDown),this.canvas.removeEventListener("pointerup",this.onPointerUp)}enable(){this.enabled=!0}disable(){this.enabled=!1}pause(){this.paused=!0}resume(){this.paused=!1}get isEnabled(){return this.enabled}init(n,r){this.camera=n,this.canvas=r,this.subscribe()}addEventTarget(n){this.groups.push(n)}removeEventTarget(n){let r=this.groups.indexOf(n);r>=0&&this.groups.splice(r,1)}onPointerMove(n){if(!this.isReady())return;let r=this.getFirstIntersectedGroup(n.layerX,n.layerY,"mouseEnter");if((!this.selected||this.selected!==r?.target)&&(this.selected&&(this.selected.host.objRef?.dispatchEvent({type:"mouseExit",component:this.selected.host}),this.selected.emitOnMouseExit(),this.selected=null),r&&r.target)){this.selected=r.target;let o=ae({type:"mouseEnter",component:r.target.host},r);this.selected.host.objRef?.dispatchEvent(o),this.selected.emitOnMouseEnter(o)}}onPointerDown(n){if(this.maxClickDistance=n.width,this.pointerDownEvent=n,!this.isReady())return;let r=this.getFirstIntersectedGroup(n.layerX,n.layerY,"pointerDown");if(r&&r.target&&r.target.host.objRef){let o=ae({type:"pointerDown",component:r.target.host},r);r.target.host.objRef.dispatchEvent(o),r.target.emitOnPointerDown(o)}}onPointerUp(n){let r=this.pointerDownEvent;if(this.pointerDownEvent=void 0,!this.isReady())return;let o=this.getFirstIntersectedGroup(n.layerX,n.layerY,"pointerUp");if(o&&o.target&&o.target.host.objRef){let s=ae({type:"pointerUp",component:o.target.host},o);o.target.host.objRef.dispatchEvent(s),o.target.emitOnPointerUp(s)}if(!(this.calcPointerDownUpDinstance(n,r)>this.maxClickDistance)&&(o=this.getFirstIntersectedGroup(n.layerX,n.layerY,"click"),o&&o.target&&o.target.host.objRef)){let s=ae({type:"click",component:o.target.host},o);o.target.host.objRef.dispatchEvent(s),o.target.emitOnClick(s)}}isReady(n){return!!(this.enabled&&(n||!this.paused)&&this.camera&&this.camera.objRef&&this.groups&&this.groups.length>0)}calcPointerDownUpDinstance(n,r){if(!r)return Number.MAX_VALUE;let o=n.layerX-r.layerX,s=n.layerY-r.layerY;return Math.sqrt(o*o+s*s)}getFirstIntersectedGroup(n,r,o){if(!this.camera||!this.canvas||!this.camera.objRef)return;n=n/this.canvas.clientWidth*2-1,r=-(r/this.canvas.clientHeight)*2+1;let s=new z(n,r);this.raycaster.setFromCamera(s,this.camera.objRef);let a,c;for(let l of this.groups){let u=l.host.objRef;if(!l[o]||!u)continue;let d=this.raycaster.intersectObject(u,!0);d.length>0&&(!a||a.distance>d[0].distance)&&(a=d[0],c=l)}if(c&&a)return ae({target:c},a)}};e.instanceCnt=0,e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ge({token:e,factory:e.\u0275fac});let i=e;return i})();var wu=(()=>{let e=class e{get onMouseEnter(){return this.mouseEnter||(this.mouseEnter=new dt),this.mouseEnter}get onMouseExit(){return this.mouseExit||(this.mouseExit=new dt),this.mouseExit}get onClick(){return this.click||(this.click=new dt),this.click}get onPointerDown(){return this.pointerDown||(this.pointerDown=new dt),this.pointerDown}get onPointerUp(){return this.pointerUp||(this.pointerUp=new dt),this.pointerUp}constructor(){this.host=S(de,{host:!0}),this.raycasterService=S(xu),this.emitOnMouseEnter=this.emitOnMouseEnter.bind(this),this.emitOnMouseExit=this.emitOnMouseExit.bind(this),this.emitOnClick=this.emitOnClick.bind(this)}ngAfterViewInit(){this.subscribeEvents()}subscribeEvents(){this.raycasterService.addEventTarget(this)}unSubscribeEvents(){this.raycasterService.removeEventTarget(this)}emitOnMouseExit(){this.mouseExit?.emit({component:this.host,type:"mouseExit"})}emitOnMouseEnter(n){this.mouseEnter?.emit(n)}emitOnClick(n){this.click?.emit(n)}emitOnPointerDown(n){this.pointerDown?.emit(n)}emitOnPointerUp(n){this.pointerUp?.emit(n)}ngOnDestroy(){this.unSubscribeEvents()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Ge({type:e,selectors:[["","onClick",""],["","onMouseEnter",""],["","onMouseExit",""],["","onPointerDown",""],["","onPointerUp",""]],outputs:{onMouseEnter:"onMouseEnter",onMouseExit:"onMouseExit",onClick:"onClick",onPointerDown:"onPointerDown",onPointerUp:"onPointerUp"}});let i=e;return i})();var Xp=class extends wt{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new z(.5,.5),this.addEventListener("removed",function(){this.traverse(function(t){t.element&&t.element instanceof t.element.ownerDocument.defaultView.Element&&t.element.parentNode!==null&&t.element.remove()})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}},qp=new C,V3=new Ee,z3=new Ee,H3=new C,G3=new C,BM=class{constructor(e={}){let t=this,n,r,o,s,a={objects:new WeakMap},c=e.element!==void 0?e.element:document.createElement("div");c.style.overflow="hidden",this.domElement=c,this.sortObjects=!0,this.getSize=function(){return{width:n,height:r}},this.render=function(g,_){g.matrixWorldAutoUpdate===!0&&g.updateMatrixWorld(),_.parent===null&&_.matrixWorldAutoUpdate===!0&&_.updateMatrixWorld(),V3.copy(_.matrixWorldInverse),z3.multiplyMatrices(_.projectionMatrix,V3),u(g,g,_),this.sortObjects&&f(g)},this.setSize=function(g,_){n=g,r=_,o=n/2,s=r/2,c.style.width=g+"px",c.style.height=_+"px"};function l(g){g.isCSS2DObject&&(g.element.style.display="none");for(let _=0,m=g.children.length;_<m;_++)l(g.children[_])}function u(g,_,m){if(g.visible===!1){l(g);return}if(g.isCSS2DObject){qp.setFromMatrixPosition(g.matrixWorld),qp.applyMatrix4(z3);let p=qp.z>=-1&&qp.z<=1&&g.layers.test(m.layers)===!0,b=g.element;b.style.display=p===!0?"":"none",p===!0&&(g.onBeforeRender(t,_,m),b.style.transform="translate("+-100*g.center.x+"%,"+-100*g.center.y+"%)translate("+(qp.x*o+o)+"px,"+(-qp.y*s+s)+"px)",b.parentNode!==c&&c.appendChild(b),g.onAfterRender(t,_,m));let v={distanceToCameraSquared:d(m,g)};a.objects.set(g,v)}for(let p=0,b=g.children.length;p<b;p++)u(g.children[p],_,m)}function d(g,_){return H3.setFromMatrixPosition(g.matrixWorld),G3.setFromMatrixPosition(_.matrixWorld),H3.distanceToSquared(G3)}function h(g){let _=[];return g.traverseVisible(function(m){m.isCSS2DObject&&_.push(m)}),_}function f(g){let _=h(g).sort(function(p,b){if(p.renderOrder!==b.renderOrder)return b.renderOrder-p.renderOrder;let v=a.objects.get(p).distanceToCameraSquared,y=a.objects.get(b).distanceToCameraSquared;return v-y}),m=_.length;for(let p=0,b=_.length;p<b;p++)_[p].element.style.zIndex=m-p}}};var UK=["*"],W3=(()=>{let e=class e extends de{getType(){return Xp}set element(n){this._objRef&&(this._objRef.element=n)}get element(){return this._objRef?.element}set center(n){this._objRef&&(this._objRef.center=pe(this._objRef.center,n))}get center(){return this._objRef?.center}set onBeforeRender(n){this._objRef&&(this._objRef.onBeforeRender=n)}get onBeforeRender(){return this._objRef?.onBeforeRender}set onAfterRender(n){this._objRef&&(this._objRef.onAfterRender=n)}get onAfterRender(){return this._objRef?.onAfterRender}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-cSS2DObjectGen"]],inputs:{element:"element",center:"center",onBeforeRender:"onBeforeRender",onAfterRender:"onAfterRender"},features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:UK,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var VK=["*"],$3=(()=>{let e=class e extends W3{constructor(){super(...arguments),this.elementRef=S(vt)}getType(){return Xp}createThreeInstance(n){return super.createThreeInstance(n??this.elementRef?.nativeElement)}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-cSS2DObject"]],features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:VK,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},styles:["[_nghost-%COMP%]{display:inline-block}"],changeDetection:0});let i=e;return i})();var q3=new C,HK=new nn,X3=new C,Zp=class extends wt{constructor(e=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(t){t.element&&t.element instanceof t.element.ownerDocument.defaultView.Element&&t.element.parentNode!==null&&t.element.remove()})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this}};var sc=new Ee,GK=new Ee,UM=class{constructor(e={}){let t=this,n,r,o,s,a={camera:{style:""},objects:new WeakMap},c=e.element!==void 0?e.element:document.createElement("div");c.style.overflow="hidden",this.domElement=c;let l=document.createElement("div");l.style.transformOrigin="0 0",l.style.pointerEvents="none",c.appendChild(l);let u=document.createElement("div");u.style.transformStyle="preserve-3d",l.appendChild(u),this.getSize=function(){return{width:n,height:r}},this.render=function(m,p){let b=p.projectionMatrix.elements[5]*s;p.view&&p.view.enabled?(l.style.transform=`translate( ${-p.view.offsetX*(n/p.view.width)}px, ${-p.view.offsetY*(r/p.view.height)}px )`,l.style.transform+=`scale( ${p.view.fullWidth/p.view.width}, ${p.view.fullHeight/p.view.height} )`):l.style.transform="",m.matrixWorldAutoUpdate===!0&&m.updateMatrixWorld(),p.parent===null&&p.matrixWorldAutoUpdate===!0&&p.updateMatrixWorld();let v,y;p.isOrthographicCamera&&(v=-(p.right+p.left)/2,y=(p.top+p.bottom)/2);let w=p.view&&p.view.enabled?p.view.height/p.view.fullHeight:1,R=p.isOrthographicCamera?`scale( ${w} )scale(`+b+")translate("+d(v)+"px,"+d(y)+"px)"+h(p.matrixWorldInverse):`scale( ${w} )translateZ(`+b+"px)"+h(p.matrixWorldInverse),A=(p.isPerspectiveCamera?"perspective("+b+"px) ":"")+R+"translate("+o+"px,"+s+"px)";a.camera.style!==A&&(u.style.transform=A,a.camera.style=A),_(m,m,p,R)},this.setSize=function(m,p){n=m,r=p,o=n/2,s=r/2,c.style.width=m+"px",c.style.height=p+"px",l.style.width=m+"px",l.style.height=p+"px",u.style.width=m+"px",u.style.height=p+"px"};function d(m){return Math.abs(m)<1e-10?0:m}function h(m){let p=m.elements;return"matrix3d("+d(p[0])+","+d(-p[1])+","+d(p[2])+","+d(p[3])+","+d(p[4])+","+d(-p[5])+","+d(p[6])+","+d(p[7])+","+d(p[8])+","+d(-p[9])+","+d(p[10])+","+d(p[11])+","+d(p[12])+","+d(-p[13])+","+d(p[14])+","+d(p[15])+")"}function f(m){let p=m.elements;return"translate(-50%,-50%)"+("matrix3d("+d(p[0])+","+d(p[1])+","+d(p[2])+","+d(p[3])+","+d(-p[4])+","+d(-p[5])+","+d(-p[6])+","+d(-p[7])+","+d(p[8])+","+d(p[9])+","+d(p[10])+","+d(p[11])+","+d(p[12])+","+d(p[13])+","+d(p[14])+","+d(p[15])+")")}function g(m){m.isCSS3DObject&&(m.element.style.display="none");for(let p=0,b=m.children.length;p<b;p++)g(m.children[p])}function _(m,p,b,v){if(m.visible===!1){g(m);return}if(m.isCSS3DObject){let y=m.layers.test(b.layers)===!0,w=m.element;if(w.style.display=y===!0?"":"none",y===!0){m.onBeforeRender(t,p,b);let R;m.isCSS3DSprite?(sc.copy(b.matrixWorldInverse),sc.transpose(),m.rotation2D!==0&&sc.multiply(GK.makeRotationZ(m.rotation2D)),m.matrixWorld.decompose(q3,HK,X3),sc.setPosition(q3),sc.scale(X3),sc.elements[3]=0,sc.elements[7]=0,sc.elements[11]=0,sc.elements[15]=1,R=f(sc)):R=f(m.matrixWorld);let E=a.objects.get(m);if(E===void 0||E.style!==R){w.style.transform=R;let A={style:R};a.objects.set(m,A)}w.parentNode!==u&&u.appendChild(w),m.onAfterRender(t,p,b)}}for(let y=0,w=m.children.length;y<w;y++)_(m.children[y],p,b,v)}}};var WK=["*"],Z3=(()=>{let e=class e extends de{getType(){return Zp}set element(n){this._objRef&&(this._objRef.element=n)}get element(){return this._objRef?.element}set onBeforeRender(n){this._objRef&&(this._objRef.onBeforeRender=n)}get onBeforeRender(){return this._objRef?.onBeforeRender}set onAfterRender(n){this._objRef&&(this._objRef.onAfterRender=n)}get onAfterRender(){return this._objRef?.onAfterRender}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-cSS3DObjectGen"]],inputs:{element:"element",onBeforeRender:"onBeforeRender",onAfterRender:"onAfterRender"},features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:WK,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var $K=["*"],VM=(()=>{let e=class e extends Z3{constructor(){super(...arguments),this.elementRef=S(vt)}getType(){return Zp}createThreeInstance(n){return super.createThreeInstance(n??this.elementRef?.nativeElement)}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-cSS3DObject"]],features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:$K,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},styles:["[_nghost-%COMP%]{display:inline-block}"],changeDetection:0});let i=e;return i})();var qK=["*"],ol=(()=>{let e=class e extends de{getType(){return qc}get isCamera(){return this._objRef?.isCamera}get type(){return this._objRef?.type}set layers(n){this._objRef&&(this._objRef.layers=pe(this._objRef.layers,n))}get layers(){return this._objRef?.layers}set matrixWorldInverse(n){this._objRef&&(this._objRef.matrixWorldInverse=pe(this._objRef.matrixWorldInverse,n))}get matrixWorldInverse(){return this._objRef?.matrixWorldInverse}set projectionMatrix(n){this._objRef&&(this._objRef.projectionMatrix=pe(this._objRef.projectionMatrix,n))}get projectionMatrix(){return this._objRef?.projectionMatrix}set projectionMatrixInverse(n){this._objRef&&(this._objRef.projectionMatrixInverse=pe(this._objRef.projectionMatrixInverse,n))}get projectionMatrixInverse(){return this._objRef?.projectionMatrixInverse}set coordinateSystem(n){this._objRef&&(this._objRef.coordinateSystem=n)}get coordinateSystem(){return this._objRef?.coordinateSystem}set viewport(n){this._objRef&&(this._objRef.viewport=pe(this._objRef.viewport,n))}get viewport(){return this._objRef?.viewport}get reversedDepth(){return this._objRef?.reversedDepth}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-camera"]],inputs:{layers:"layers",matrixWorldInverse:"matrixWorldInverse",projectionMatrix:"projectionMatrix",projectionMatrixInverse:"projectionMatrixInverse",coordinateSystem:"coordinateSystem",viewport:"viewport"},features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:qK,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var XK=["*"],Ot=(()=>{let e=class e extends de{getType(){return th}get isScene(){return this._objRef?.isScene}set type(n){this._objRef&&(this._objRef.type=n)}get type(){return this._objRef?.type}set fog(n){this._objRef&&(this._objRef.fog=n)}get fog(){return this._objRef?.fog}set backgroundBlurriness(n){this._objRef&&(this._objRef.backgroundBlurriness=n)}get backgroundBlurriness(){return this._objRef?.backgroundBlurriness}set backgroundIntensity(n){this._objRef&&(this._objRef.backgroundIntensity=n)}get backgroundIntensity(){return this._objRef?.backgroundIntensity}set overrideMaterial(n){this._objRef&&(this._objRef.overrideMaterial=n)}get overrideMaterial(){return this._objRef?.overrideMaterial}set background(n){this._objRef&&(this._objRef.background=pe(this._objRef.background,n))}get background(){return this._objRef?.background}set backgroundRotation(n){this._objRef&&(this._objRef.backgroundRotation=pe(this._objRef.backgroundRotation,n))}get backgroundRotation(){return this._objRef?.backgroundRotation}set environment(n){this._objRef&&(this._objRef.environment=n)}get environment(){return this._objRef?.environment}set environmentIntensity(n){this._objRef&&(this._objRef.environmentIntensity=n)}get environmentIntensity(){return this._objRef?.environmentIntensity}set environmentRotation(n){this._objRef&&(this._objRef.environmentRotation=pe(this._objRef.environmentRotation,n))}get environmentRotation(){return this._objRef?.environmentRotation}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-scene"]],inputs:{type:"type",fog:"fog",backgroundBlurriness:"backgroundBlurriness",backgroundIntensity:"backgroundIntensity",overrideMaterial:"overrideMaterial",background:"background",backgroundRotation:"backgroundRotation",environment:"environment",environmentIntensity:"environmentIntensity",environmentRotation:"environmentRotation"},features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:XK,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var ZK=["*"],uv=new me("HOST_ELEMENT"),Zr=(()=>{let e=class e{constructor(){this.engServ=S(ns),this.raycaster=S(xu),this.hostElement=S(uv),this.onCurrentRendererPass=new dt,this.onRender=new dt}set contentScene(n){n&&(this.scene=n)}set effectComposer(n){this._effectComposer=n,this.configureEffectComposerRenderTarget()}get effectComposer(){return this._effectComposer}set camera(n){this._camera=n,this.initRaycaster()}get camera(){return this._camera}set contentCamera(n){n&&(this.camera=n)}set viewPort(n){this._viewPort=n,this.configureEffectComposerRenderTarget()}get viewPort(){return this._viewPort}ngOnInit(){this.initRaycaster()}initRaycaster(){this.camera&&this.raycaster.init(this.camera,this.hostElement.nativeElement)}add(n){}remove(n){}configureEffectComposerRenderTarget(){if(!(!this.viewPort||!this.effectComposer)){let n,r;this.viewPort instanceof En?(n=this.viewPort.z,r=this.viewPort?.width):(n=this.viewPort.width,r=this.viewPort.height),this.effectComposer.setSize(n,r)}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["th-view"]],contentQueries:function(r,o,s){if(r&1&&(xi(s,Ot,5),xi(s,ol,5)),r&2){let a;st(a=at())&&(o.contentScene=a.first),st(a=at())&&(o.contentCamera=a.first)}},inputs:{scene:"scene",effectComposer:"effectComposer",camera:"camera",shadow:"shadow",viewPort:"viewPort",scissor:"scissor",scissorTest:"scissorTest",clearColor:"clearColor",clearAlpha:"clearAlpha"},outputs:{onCurrentRendererPass:"onCurrentRendererPass",onRender:"onRender"},features:[K([{provide:de,useExisting:he(()=>e)},{provide:Sh,useValue:new Dr},xu])],ngContentSelectors:ZK,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var K3={alpha:!0,antialias:!0,preserveDrawingBuffer:!0},sl=new me("Renderer Providers"),J3=new me("CSS3DRenderer"),eU=new me("CSS2DRenderer"),Rh=new me("WebGLRenderer");function Mu(i){return[{provide:Rh,useFactory:()=>{let n=new rl(ae(ae({},K3),i));return Object.assign(n,ae(ae({},K3),i)),n}},{provide:sl,multi:!0,useExisting:Rh}]}function zM(i){return[{provide:J3,useFactory:()=>{let t=new UM(i),n=t.domElement.style;return n.position="absolute",n.top="0px",n.bottom="0px",n.left="0px",n.right="0px",n.overflow="hidden",t}},{provide:sl,multi:!0,useExisting:J3}]}function tU(i){return[{provide:eU,useFactory:()=>{let t=new BM(i),n=t.domElement.style;return n.position="absolute",n.top="0px",n.bottom="0px",n.left="0px",n.right="0px",n.overflow="hidden",t}},{provide:sl,multi:!0,useExisting:eU}]}var ns=(()=>{let e=class e{constructor(){this.ngZone=S(pt),this.hostElement=S(uv),this.clock=new go,this.destroyed$=new lt,this.resizeEmitter=new dt,this.beforeRenderEmitter=new dt,this.views=[],this.beforeRender$=this.beforeRenderEmitter.pipe(Pn(this.destroyed$)),this.resize$=this.resizeEmitter.pipe(Pn(this.destroyed$));let n=this.initRenderer();this.renderers=n.renderers,this.canvas=n.canvas,this.wegblRenderer=n.mainRenderer,this.initResizeObserver()}ngOnDestroy(){this.resizeObserver&&this.hostElement&&this.resizeObserver.unobserve(this.hostElement.nativeElement),this.renderers.forEach(n=>{n.dispose?.()})}initResizeObserver(){this.ngZone.runOutsideAngular(()=>{this.initCanvasSize(),this.resizeObserver||(this.resizeObserver=new ResizeObserver(()=>{this.resize()})),this.resizeObserver.observe(this.hostElement.nativeElement)})}initCanvasSize(){this.canvas?.style.setProperty("width","100%"),this.canvas?.style.setProperty("height","100%")}initRenderer(){let n=S(sl),r,o;for(let s of n)s.domElement instanceof HTMLCanvasElement&&(o=s,r=s.domElement);if(!n||n.length<1)throw new Error("missing Canvas Renderer");return{canvas:r,mainRenderer:o,renderers:n}}setViews(n){this.views=n}addView(n){this.views.push(n);let r=this.calcRendererSize();r&&this.adjustViewDimensions(n,r.width,r.height)}render(){this.beforeRenderEmitter.emit({engine:this,delta:this.clock.getDelta()});for(let n of this.views)this.renderView(n)}renderView(n){let r=n.camera,o=n.scene;if(!(!r||!o||!r.objRef||!o.objRef)){yu(n.onRender)&&this.ngZone.run(()=>n.onRender.emit({renderer:this.renderers,scene:o,camera:r}));for(let s of this.renderers)this.applyRendererParametersFromView(n,s),yu(n.onCurrentRendererPass)&&this.ngZone.run(()=>n.onCurrentRendererPass.emit({renderer:s,scene:o,camera:r,engine:this})),n.effectComposer&&s instanceof rl?n.effectComposer.render():s.render(o.objRef,r.objRef)}}applyRendererParametersFromView(n,r){n.viewPort&&r.setViewport&&(n.viewPort instanceof En?r.setViewport(n.viewPort):r.setViewport(n.viewPort.x,n.viewPort.y,n.viewPort.width,n.viewPort.height)),n.scissor&&r.setScissor&&(n.scissor instanceof En?r.setScissor(n.scissor):r.setScissor(n.scissor.x,n.scissor.y,n.scissor.width,n.scissor.height)),n.scissorTest!==void 0&&r.setScissorTest&&r.setScissorTest(n.scissorTest),n.clearColor&&r.setClearColor&&r.setClearColor(n.clearColor),n.clearAlpha!==void 0&&r.setClearAlpha&&r.setClearAlpha(n.clearAlpha),n.shadow!==void 0&&r.shadowMap&&(r.shadowMap.enabled=!0)}resize(){let{width:n,height:r}=this.calcRendererSize();this.renderers?.forEach(o=>o.setSize(n,r,!1));for(let o of this.views)this.adjustViewDimensions(o,n,r);return this.resizeEmitter.emit({width:n,height:r}),!0}calcRendererSize(){return{width:this.hostElement.nativeElement.clientWidth??0,height:this.hostElement.nativeElement.clientHeight??0}}adjustViewDimensions(n,r,o){n.viewPort||(n.camera&&n.camera.objRef.aspect&&(n.camera.objRef.aspect=r/o,n.camera.objRef.updateProjectionMatrix()),n.effectComposer?.setSize(r,o))}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ge({token:e,factory:e.\u0275fac});let i=e;return i})();var ar={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};var Si=class{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}},YK=new mo(-1,1,1,-1,0,1),kI=class extends nt{constructor(){super(),this.setAttribute("position",new Oe([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new Oe([0,2,0,0,2,0],2))}},QK=new kI,Ar=class{constructor(e){this._mesh=new Pe(QK,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,YK)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}};var Yp=class extends Si{constructor(e,t="tDiffuse"){super(),this.textureID=t,this.uniforms=null,this.material=null,e instanceof Nt?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Hn.clone(e.uniforms),this.material=new Nt({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this._fsQuad=new Ar(this.material)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this._fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this._fsQuad.render(e))}dispose(){this.material.dispose(),this._fsQuad.dispose()}};var dv=class extends Si{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,n){let r=e.getContext(),o=e.state;o.buffers.color.setMask(!1),o.buffers.depth.setMask(!1),o.buffers.color.setLocked(!0),o.buffers.depth.setLocked(!0);let s,a;this.inverse?(s=0,a=1):(s=1,a=0),o.buffers.stencil.setTest(!0),o.buffers.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),o.buffers.stencil.setFunc(r.ALWAYS,s,4294967295),o.buffers.stencil.setClear(a),o.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),o.buffers.color.setLocked(!1),o.buffers.depth.setLocked(!1),o.buffers.color.setMask(!0),o.buffers.depth.setMask(!0),o.buffers.stencil.setLocked(!1),o.buffers.stencil.setFunc(r.EQUAL,1,4294967295),o.buffers.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),o.buffers.stencil.setLocked(!0)}},HM=class extends Si{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}};var GM=class{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),t===void 0){let n=e.getSize(new z);this._width=n.width,this._height=n.height,t=new Qt(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:An}),t.texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new Yp(ar),this.copyPass.material.blending=rn,this.clock=new go}swapBuffers(){let e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){let t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());let t=this.renderer.getRenderTarget(),n=!1;for(let r=0,o=this.passes.length;r<o;r++){let s=this.passes[r];if(s.enabled!==!1){if(s.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),s.render(this.renderer,this.writeBuffer,this.readBuffer,e,n),s.needsSwap){if(n){let a=this.renderer.getContext(),c=this.renderer.state.buffers.stencil;c.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),c.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}dv!==void 0&&(s instanceof dv?n=!0:s instanceof HM&&(n=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){let t=this.renderer.getSize(new z);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;let n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(let o=0;o<this.passes.length;o++)this.passes[o].setSize(n,r)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}};var KK=["*"],nU=(()=>{let e=class e extends bo{getType(){return GM}set renderer(n){this._objRef&&(this._objRef.renderer=n)}get renderer(){return this._objRef?.renderer}set renderTarget1(n){this._objRef&&(this._objRef.renderTarget1=n)}get renderTarget1(){return this._objRef?.renderTarget1}set renderTarget2(n){this._objRef&&(this._objRef.renderTarget2=n)}get renderTarget2(){return this._objRef?.renderTarget2}set writeBuffer(n){this._objRef&&(this._objRef.writeBuffer=n)}get writeBuffer(){return this._objRef?.writeBuffer}set readBuffer(n){this._objRef&&(this._objRef.readBuffer=n)}get readBuffer(){return this._objRef?.readBuffer}set passes(n){this._objRef&&(this._objRef.passes=n)}get passes(){return this._objRef?.passes}set copyPass(n){this._objRef&&(this._objRef.copyPass=n)}get copyPass(){return this._objRef?.copyPass}set clock(n){this._objRef&&(this._objRef.clock=n)}get clock(){return this._objRef?.clock}set renderToScreen(n){this._objRef&&(this._objRef.renderToScreen=n)}get renderToScreen(){return this._objRef?.renderToScreen}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-effectComposerGen"]],inputs:{renderer:"renderer",renderTarget1:"renderTarget1",renderTarget2:"renderTarget2",writeBuffer:"writeBuffer",readBuffer:"readBuffer",passes:"passes",copyPass:"copyPass",clock:"clock",renderToScreen:"renderToScreen"},features:[K([]),$],ngContentSelectors:KK,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var JK=["*"],Su=(()=>{let e=class e extends nU{constructor(){super(...arguments),this.view=S(Zr),this.engineService=S(ns)}createThreeInstance(n){return n||(n=new Array(5)),n[0]=n[0]??this.engineService.wegblRenderer,n[1]=n[1]??this.initRenderTarget(),super.createThreeInstance(n)}initRenderTarget(){if(this.view.viewPort){let n,r;return this.view.viewPort instanceof En?(n=this.view.viewPort.z,r=this.view.viewPort?.width):(n=this.view.viewPort.width,r=this.view.viewPort.height),new Qt(n,r)}else return}addToParent(){this._objRef&&(this.view.effectComposer=this._objRef)}removeFromParent(){this.view.effectComposer=void 0}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-effectComposer"]],features:[K([]),$],ngContentSelectors:JK,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var gn=(()=>{let e=class e extends bo{constructor(){super(...arguments),this.effectComposer=S(Su,{optional:!0})}addToParent(){this._objRef&&this.effectComposer&&this.effectComposer.objRef&&this.effectComposer.objRef.addPass(this._objRef)}removeFromParent(){this._objRef&&this.effectComposer&&this.effectComposer.objRef&&this.effectComposer.objRef.removePass(this._objRef)}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-abs-control"]],features:[$],decls:0,vars:0,template:function(r,o){},encapsulation:2,changeDetection:0});let i=e;return i})();var WM=class extends Si{constructor(e,t,n=null,r=null,o=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=o,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this.isRenderPass=!0,this._oldClearColor=new ue}render(e,t,n){let r=e.autoClear;e.autoClear=!1;let o,s;this.overrideMaterial!==null&&(s=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(o=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(o),this.overrideMaterial!==null&&(this.scene.overrideMaterial=s),e.autoClear=r}};var eJ=["*"],Ln=(()=>{let e=class e extends gn{getType(){return Si}set isPass(n){this._objRef&&(this._objRef.isPass=n)}get isPass(){return this._objRef?.isPass}set enabled(n){this._objRef&&(this._objRef.enabled=n)}get enabled(){return this._objRef?.enabled}set needsSwap(n){this._objRef&&(this._objRef.needsSwap=n)}get needsSwap(){return this._objRef?.needsSwap}set clear(n){this._objRef&&(this._objRef.clear=n)}get clear(){return this._objRef?.clear}set renderToScreen(n){this._objRef&&(this._objRef.renderToScreen=n)}get renderToScreen(){return this._objRef?.renderToScreen}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-pass"]],inputs:{isPass:"isPass",enabled:"enabled",needsSwap:"needsSwap",clear:"clear",renderToScreen:"renderToScreen"},features:[K([{provide:gn,useExisting:he(()=>e)}]),$],ngContentSelectors:eJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var tJ=["*"],iU=(()=>{let e=class e extends Ln{getType(){return WM}set scene(n){this._objRef&&(this._objRef.scene=n)}get scene(){return this._objRef?.scene}set camera(n){this._objRef&&(this._objRef.camera=n)}get camera(){return this._objRef?.camera}set overrideMaterial(n){this._objRef&&(this._objRef.overrideMaterial=n)}get overrideMaterial(){return this._objRef?.overrideMaterial}set clearColor(n){this._objRef&&(this._objRef.clearColor=pe(this._objRef.clearColor,n))}get clearColor(){return this._objRef?.clearColor}set clearAlpha(n){this._objRef&&(this._objRef.clearAlpha=n)}get clearAlpha(){return this._objRef?.clearAlpha}set clear(n){this._objRef&&(this._objRef.clear=n)}get clear(){return this._objRef?.clear}set clearDepth(n){this._objRef&&(this._objRef.clearDepth=n)}get clearDepth(){return this._objRef?.clearDepth}set needsSwap(n){this._objRef&&(this._objRef.needsSwap=n)}get needsSwap(){return this._objRef?.needsSwap}get isRenderPass(){return this._objRef?.isRenderPass}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-renderPassGen"]],inputs:{scene:"scene",camera:"camera",overrideMaterial:"overrideMaterial",clearColor:"clearColor",clearAlpha:"clearAlpha",clear:"clear",clearDepth:"clearDepth",needsSwap:"needsSwap"},features:[K([{provide:gn,useExisting:he(()=>e)}]),$],ngContentSelectors:tJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var nJ=["*"],Qp=(()=>{let e=class e extends iU{constructor(){super(...arguments),this.view=S(Zr)}createThreeInstance(n){return n||(n=new Array(5)),n[0]=n[0]??this.view.scene,n[1]=n[1]??this.view.camera,n[2]=n[2]??this.overrideMaterial,n[3]=n[3]??this.clearColor,n[4]=n[4]??this.clearAlpha,super.createThreeInstance(n)}ngAfterContentChecked(){this._objRef&&(this.view.scene&&this.view.scene.objRef&&(this._objRef.scene=this.view.scene.objRef),this.view.camera&&this.view.camera.objRef&&(this._objRef.camera=this.view.camera.objRef))}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-renderPass"]],features:[K([{provide:gn,useExisting:he(()=>e)}]),$],ngContentSelectors:nJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var Th=new Dr,Yr=new C,Ru=new C,Ai=new nn,rU={X:new C(1,0,0),Y:new C(0,1,0),Z:new C(0,0,1)},VI={type:"change"},oU={type:"mouseDown",mode:null},sU={type:"mouseUp",mode:null},aU={type:"objectChange"},Kp=class extends Ir{constructor(e,t=null){super(void 0,t);let n=new HI(this);this._root=n;let r=new GI;this._gizmo=r,n.add(r);let o=new WI;this._plane=o,n.add(o);let s=this;function a(v,y){let w=y;Object.defineProperty(s,v,{get:function(){return w!==void 0?w:y},set:function(R){w!==R&&(w=R,o[v]=R,r[v]=R,s.dispatchEvent({type:v+"-changed",value:R}),s.dispatchEvent(VI))}}),s[v]=y,o[v]=y,r[v]=y}a("camera",e),a("object",void 0),a("enabled",!0),a("axis",null),a("mode","translate"),a("translationSnap",null),a("rotationSnap",null),a("scaleSnap",null),a("space","world"),a("size",1),a("dragging",!1),a("showX",!0),a("showY",!0),a("showZ",!0),a("minX",-1/0),a("maxX",1/0),a("minY",-1/0),a("maxY",1/0),a("minZ",-1/0),a("maxZ",1/0);let c=new C,l=new C,u=new nn,d=new nn,h=new C,f=new nn,g=new C,_=new C,m=new C,p=0,b=new C;a("worldPosition",c),a("worldPositionStart",l),a("worldQuaternion",u),a("worldQuaternionStart",d),a("cameraPosition",h),a("cameraQuaternion",f),a("pointStart",g),a("pointEnd",_),a("rotationAxis",m),a("rotationAngle",p),a("eye",b),this._offset=new C,this._startNorm=new C,this._endNorm=new C,this._cameraScale=new C,this._parentPosition=new C,this._parentQuaternion=new nn,this._parentQuaternionInv=new nn,this._parentScale=new C,this._worldScaleStart=new C,this._worldQuaternionInv=new nn,this._worldScale=new C,this._positionStart=new C,this._quaternionStart=new nn,this._scaleStart=new C,this._getPointer=iJ.bind(this),this._onPointerDown=oJ.bind(this),this._onPointerHover=rJ.bind(this),this._onPointerMove=sJ.bind(this),this._onPointerUp=aJ.bind(this),t!==null&&this.connect(t)}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="auto"}getHelper(){return this._root}pointerHover(e){if(this.object===void 0||this.dragging===!0)return;e!==null&&Th.setFromCamera(e,this.camera);let t=zI(this._gizmo.picker[this.mode],Th);t?this.axis=t.object.name:this.axis=null}pointerDown(e){if(!(this.object===void 0||this.dragging===!0||e!=null&&e.button!==0)&&this.axis!==null){e!==null&&Th.setFromCamera(e,this.camera);let t=zI(this._plane,Th,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,oU.mode=this.mode,this.dispatchEvent(oU)}}pointerMove(e){let t=this.axis,n=this.mode,r=this.object,o=this.space;if(n==="scale"?o="local":(t==="E"||t==="XYZE"||t==="XYZ")&&(o="world"),r===void 0||t===null||this.dragging===!1||e!==null&&e.button!==-1)return;e!==null&&Th.setFromCamera(e,this.camera);let s=zI(this._plane,Th,!0);if(s){if(this.pointEnd.copy(s.point).sub(this.worldPositionStart),n==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),o==="local"&&t!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),t.indexOf("X")===-1&&(this._offset.x=0),t.indexOf("Y")===-1&&(this._offset.y=0),t.indexOf("Z")===-1&&(this._offset.z=0),o==="local"&&t!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),r.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(o==="local"&&(r.position.applyQuaternion(Ai.copy(this._quaternionStart).invert()),t.search("X")!==-1&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.position.applyQuaternion(this._quaternionStart)),o==="world"&&(r.parent&&r.position.add(Yr.setFromMatrixPosition(r.parent.matrixWorld)),t.search("X")!==-1&&(r.position.x=Math.round(r.position.x/this.translationSnap)*this.translationSnap),t.search("Y")!==-1&&(r.position.y=Math.round(r.position.y/this.translationSnap)*this.translationSnap),t.search("Z")!==-1&&(r.position.z=Math.round(r.position.z/this.translationSnap)*this.translationSnap),r.parent&&r.position.sub(Yr.setFromMatrixPosition(r.parent.matrixWorld)))),r.position.x=Math.max(this.minX,Math.min(this.maxX,r.position.x)),r.position.y=Math.max(this.minY,Math.min(this.maxY,r.position.y)),r.position.z=Math.max(this.minZ,Math.min(this.maxZ,r.position.z));else if(n==="scale"){if(t.search("XYZ")!==-1){let a=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(a*=-1),Ru.set(a,a,a)}else Yr.copy(this.pointStart),Ru.copy(this.pointEnd),Yr.applyQuaternion(this._worldQuaternionInv),Ru.applyQuaternion(this._worldQuaternionInv),Ru.divide(Yr),t.search("X")===-1&&(Ru.x=1),t.search("Y")===-1&&(Ru.y=1),t.search("Z")===-1&&(Ru.z=1);r.scale.copy(this._scaleStart).multiply(Ru),this.scaleSnap&&(t.search("X")!==-1&&(r.scale.x=Math.round(r.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Y")!==-1&&(r.scale.y=Math.round(r.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),t.search("Z")!==-1&&(r.scale.z=Math.round(r.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(n==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);let a=20/this.worldPosition.distanceTo(Yr.setFromMatrixPosition(this.camera.matrixWorld)),c=!1;t==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(Yr.copy(this.rotationAxis).cross(this.eye))*a):(t==="X"||t==="Y"||t==="Z")&&(this.rotationAxis.copy(rU[t]),Yr.copy(rU[t]),o==="local"&&Yr.applyQuaternion(this.worldQuaternion),Yr.cross(this.eye),Yr.length()===0?c=!0:this.rotationAngle=this._offset.dot(Yr.normalize())*a),(t==="E"||c)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),o==="local"&&t!=="E"&&t!=="XYZE"?(r.quaternion.copy(this._quaternionStart),r.quaternion.multiply(Ai.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),r.quaternion.copy(Ai.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),r.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(VI),this.dispatchEvent(aU)}}pointerUp(e){e!==null&&e.button!==0||(this.dragging&&this.axis!==null&&(sU.mode=this.mode,this.dispatchEvent(sU)),this.dragging=!1,this.axis=null)}dispose(){this.disconnect(),this._root.dispose()}attach(e){return this.object=e,this._root.visible=!0,this}detach(){return this.object=void 0,this.axis=null,this._root.visible=!1,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(VI),this.dispatchEvent(aU),this.pointStart.copy(this.pointEnd))}getRaycaster(){return Th}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}setColors(e,t,n,r){let o=this._gizmo.materialLib;o.xAxis.color.set(e),o.yAxis.color.set(t),o.zAxis.color.set(n),o.active.color.set(r),o.xAxisTransparent.color.set(e),o.yAxisTransparent.color.set(t),o.zAxisTransparent.color.set(n),o.activeTransparent.color.set(r),o.xAxis._color&&o.xAxis._color.set(e),o.yAxis._color&&o.yAxis._color.set(t),o.zAxis._color&&o.zAxis._color.set(n),o.active._color&&o.active._color.set(r),o.xAxisTransparent._color&&o.xAxisTransparent._color.set(e),o.yAxisTransparent._color&&o.yAxisTransparent._color.set(t),o.zAxisTransparent._color&&o.zAxisTransparent._color.set(n),o.activeTransparent._color&&o.activeTransparent._color.set(r)}};function iJ(i){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:i.button};{let e=this.domElement.getBoundingClientRect();return{x:(i.clientX-e.left)/e.width*2-1,y:-(i.clientY-e.top)/e.height*2+1,button:i.button}}}function rJ(i){if(this.enabled)switch(i.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(i));break}}function oJ(i){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(i.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(i)),this.pointerDown(this._getPointer(i)))}function sJ(i){this.enabled&&this.pointerMove(this._getPointer(i))}function aJ(i){this.enabled&&(this.domElement.releasePointerCapture(i.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(i)))}function zI(i,e,t){let n=e.intersectObject(i,!0);for(let r=0;r<n.length;r++)if(n[r].object.visible||t)return n[r];return!1}var $M=new ho,li=new C(0,1,0),cU=new C(0,0,0),lU=new Ee,qM=new nn,ZM=new nn,ac=new C,uU=new Ee,pv=new C(1,0,0),Ch=new C(0,1,0),mv=new C(0,0,1),XM=new C,hv=new C,fv=new C,HI=class extends wt{constructor(e){super(),this.isTransformControlsRoot=!0,this.controls=e,this.visible=!1}updateMatrixWorld(e){let t=this.controls;t.object!==void 0&&(t.object.updateMatrixWorld(),t.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):t.object.parent.matrixWorld.decompose(t._parentPosition,t._parentQuaternion,t._parentScale),t.object.matrixWorld.decompose(t.worldPosition,t.worldQuaternion,t._worldScale),t._parentQuaternionInv.copy(t._parentQuaternion).invert(),t._worldQuaternionInv.copy(t.worldQuaternion).invert()),t.camera.updateMatrixWorld(),t.camera.matrixWorld.decompose(t.cameraPosition,t.cameraQuaternion,t._cameraScale),t.camera.isOrthographicCamera?t.camera.getWorldDirection(t.eye).negate():t.eye.copy(t.cameraPosition).sub(t.worldPosition).normalize(),super.updateMatrixWorld(e)}dispose(){this.traverse(function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()})}},GI=class extends wt{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";let e=new ci({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new mi({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),n=e.clone();n.opacity=.15;let r=t.clone();r.opacity=.5;let o=e.clone();o.color.setHex(16711680);let s=e.clone();s.color.setHex(65280);let a=e.clone();a.color.setHex(255);let c=e.clone();c.color.setHex(16711680),c.opacity=.5;let l=e.clone();l.color.setHex(65280),l.opacity=.5;let u=e.clone();u.color.setHex(255),u.opacity=.5;let d=e.clone();d.opacity=.25;let h=e.clone();h.color.setHex(16776960),h.opacity=.25;let f=e.clone();f.color.setHex(16776960);let g=e.clone();g.color.setHex(7895160),this.materialLib={xAxis:o,yAxis:s,zAxis:a,active:f,xAxisTransparent:c,yAxisTransparent:l,zAxisTransparent:u,activeTransparent:h};let _=new Oi(0,.04,.1,12);_.translate(0,.05,0);let m=new ei(.08,.08,.08);m.translate(0,.04,0);let p=new nt;p.setAttribute("position",new Oe([0,0,0,1,0,0],3));let b=new Oi(.0075,.0075,.5,3);b.translate(0,.25,0);function v(Y,J){let W=new ua(Y,.0075,3,64,J*Math.PI*2);return W.rotateY(Math.PI/2),W.rotateX(Math.PI/2),W}function y(){let Y=new nt;return Y.setAttribute("position",new Oe([0,0,0,1,1,1],3)),Y}let w={X:[[new Pe(_,o),[.5,0,0],[0,0,-Math.PI/2]],[new Pe(_,o),[-.5,0,0],[0,0,Math.PI/2]],[new Pe(b,o),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new Pe(_,s),[0,.5,0]],[new Pe(_,s),[0,-.5,0],[Math.PI,0,0]],[new Pe(b,s)]],Z:[[new Pe(_,a),[0,0,.5],[Math.PI/2,0,0]],[new Pe(_,a),[0,0,-.5],[-Math.PI/2,0,0]],[new Pe(b,a),null,[Math.PI/2,0,0]]],XYZ:[[new Pe(new ca(.1,0),d),[0,0,0]]],XY:[[new Pe(new ei(.15,.15,.01),u),[.15,.15,0]]],YZ:[[new Pe(new ei(.15,.15,.01),c),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Pe(new ei(.15,.15,.01),l),[.15,0,.15],[-Math.PI/2,0,0]]]},R={X:[[new Pe(new Oi(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new Pe(new Oi(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new Pe(new Oi(.2,0,.6,4),n),[0,.3,0]],[new Pe(new Oi(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new Pe(new Oi(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new Pe(new Oi(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new Pe(new ca(.2,0),n)]],XY:[[new Pe(new ei(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new Pe(new ei(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Pe(new ei(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]]},E={START:[[new Pe(new ca(.01,2),r),null,null,null,"helper"]],END:[[new Pe(new ca(.01,2),r),null,null,null,"helper"]],DELTA:[[new ti(y(),r),null,null,null,"helper"]],X:[[new ti(p,r),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new ti(p,r),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new ti(p,r),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},A={XYZE:[[new Pe(v(.5,1),g),null,[0,Math.PI/2,0]]],X:[[new Pe(v(.5,.5),o)]],Y:[[new Pe(v(.5,.5),s),null,[0,0,-Math.PI/2]]],Z:[[new Pe(v(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new Pe(v(.75,1),h),null,[0,Math.PI/2,0]]]},x={AXIS:[[new ti(p,r),[-1e3,0,0],null,[1e6,1,1],"helper"]]},T={XYZE:[[new Pe(new Ka(.25,10,8),n)]],X:[[new Pe(new ua(.5,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new Pe(new ua(.5,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new Pe(new ua(.5,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new Pe(new ua(.75,.1,2,24),n)]]},P={X:[[new Pe(m,o),[.5,0,0],[0,0,-Math.PI/2]],[new Pe(b,o),[0,0,0],[0,0,-Math.PI/2]],[new Pe(m,o),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new Pe(m,s),[0,.5,0]],[new Pe(b,s)],[new Pe(m,s),[0,-.5,0],[0,0,Math.PI]]],Z:[[new Pe(m,a),[0,0,.5],[Math.PI/2,0,0]],[new Pe(b,a),[0,0,0],[Math.PI/2,0,0]],[new Pe(m,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new Pe(new ei(.15,.15,.01),u),[.15,.15,0]]],YZ:[[new Pe(new ei(.15,.15,.01),c),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Pe(new ei(.15,.15,.01),l),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new Pe(new ei(.1,.1,.1),d)]]},L={X:[[new Pe(new Oi(.2,0,.6,4),n),[.3,0,0],[0,0,-Math.PI/2]],[new Pe(new Oi(.2,0,.6,4),n),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new Pe(new Oi(.2,0,.6,4),n),[0,.3,0]],[new Pe(new Oi(.2,0,.6,4),n),[0,-.3,0],[0,0,Math.PI]]],Z:[[new Pe(new Oi(.2,0,.6,4),n),[0,0,.3],[Math.PI/2,0,0]],[new Pe(new Oi(.2,0,.6,4),n),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new Pe(new ei(.2,.2,.01),n),[.15,.15,0]]],YZ:[[new Pe(new ei(.2,.2,.01),n),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new Pe(new ei(.2,.2,.01),n),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new Pe(new ei(.2,.2,.2),n),[0,0,0]]]},H={X:[[new ti(p,r),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new ti(p,r),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new ti(p,r),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function te(Y){let J=new wt;for(let W in Y)for(let fe=Y[W].length;fe--;){let ve=Y[W][fe][0].clone(),Re=Y[W][fe][1],Te=Y[W][fe][2],mt=Y[W][fe][3],gt=Y[W][fe][4];ve.name=W,ve.tag=gt,Re&&ve.position.set(Re[0],Re[1],Re[2]),Te&&ve.rotation.set(Te[0],Te[1],Te[2]),mt&&ve.scale.set(mt[0],mt[1],mt[2]),ve.updateMatrix();let dn=ve.geometry.clone();dn.applyMatrix4(ve.matrix),ve.geometry=dn,ve.renderOrder=1/0,ve.position.set(0,0,0),ve.rotation.set(0,0,0),ve.scale.set(1,1,1),J.add(ve)}return J}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=te(w)),this.add(this.gizmo.rotate=te(A)),this.add(this.gizmo.scale=te(P)),this.add(this.picker.translate=te(R)),this.add(this.picker.rotate=te(T)),this.add(this.picker.scale=te(L)),this.add(this.helper.translate=te(E)),this.add(this.helper.rotate=te(x)),this.add(this.helper.scale=te(H)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){let n=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:ZM;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let r=[];r=r.concat(this.picker[this.mode].children),r=r.concat(this.gizmo[this.mode].children),r=r.concat(this.helper[this.mode].children);for(let o=0;o<r.length;o++){let s=r[o];s.visible=!0,s.rotation.set(0,0,0),s.position.copy(this.worldPosition);let a;if(this.camera.isOrthographicCamera?a=(this.camera.top-this.camera.bottom)/this.camera.zoom:a=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),s.scale.set(1,1,1).multiplyScalar(a*this.size/4),s.tag==="helper"){s.visible=!1,s.name==="AXIS"?(s.visible=!!this.axis,this.axis==="X"&&(Ai.setFromEuler($M.set(0,0,0)),s.quaternion.copy(n).multiply(Ai),Math.abs(li.copy(pv).applyQuaternion(n).dot(this.eye))>.9&&(s.visible=!1)),this.axis==="Y"&&(Ai.setFromEuler($M.set(0,0,Math.PI/2)),s.quaternion.copy(n).multiply(Ai),Math.abs(li.copy(Ch).applyQuaternion(n).dot(this.eye))>.9&&(s.visible=!1)),this.axis==="Z"&&(Ai.setFromEuler($M.set(0,Math.PI/2,0)),s.quaternion.copy(n).multiply(Ai),Math.abs(li.copy(mv).applyQuaternion(n).dot(this.eye))>.9&&(s.visible=!1)),this.axis==="XYZE"&&(Ai.setFromEuler($M.set(0,Math.PI/2,0)),li.copy(this.rotationAxis),s.quaternion.setFromRotationMatrix(lU.lookAt(cU,li,Ch)),s.quaternion.multiply(Ai),s.visible=this.dragging),this.axis==="E"&&(s.visible=!1)):s.name==="START"?(s.position.copy(this.worldPositionStart),s.visible=this.dragging):s.name==="END"?(s.position.copy(this.worldPosition),s.visible=this.dragging):s.name==="DELTA"?(s.position.copy(this.worldPositionStart),s.quaternion.copy(this.worldQuaternionStart),Yr.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),Yr.applyQuaternion(this.worldQuaternionStart.clone().invert()),s.scale.copy(Yr),s.visible=this.dragging):(s.quaternion.copy(n),this.dragging?s.position.copy(this.worldPositionStart):s.position.copy(this.worldPosition),this.axis&&(s.visible=this.axis.search(s.name)!==-1));continue}s.quaternion.copy(n),this.mode==="translate"||this.mode==="scale"?(s.name==="X"&&Math.abs(li.copy(pv).applyQuaternion(n).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),s.name==="Y"&&Math.abs(li.copy(Ch).applyQuaternion(n).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),s.name==="Z"&&Math.abs(li.copy(mv).applyQuaternion(n).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),s.name==="XY"&&Math.abs(li.copy(mv).applyQuaternion(n).dot(this.eye))<.2&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),s.name==="YZ"&&Math.abs(li.copy(pv).applyQuaternion(n).dot(this.eye))<.2&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),s.name==="XZ"&&Math.abs(li.copy(Ch).applyQuaternion(n).dot(this.eye))<.2&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1)):this.mode==="rotate"&&(qM.copy(n),li.copy(this.eye).applyQuaternion(Ai.copy(n).invert()),s.name.search("E")!==-1&&s.quaternion.setFromRotationMatrix(lU.lookAt(this.eye,cU,Ch)),s.name==="X"&&(Ai.setFromAxisAngle(pv,Math.atan2(-li.y,li.z)),Ai.multiplyQuaternions(qM,Ai),s.quaternion.copy(Ai)),s.name==="Y"&&(Ai.setFromAxisAngle(Ch,Math.atan2(li.x,li.z)),Ai.multiplyQuaternions(qM,Ai),s.quaternion.copy(Ai)),s.name==="Z"&&(Ai.setFromAxisAngle(mv,Math.atan2(li.y,li.x)),Ai.multiplyQuaternions(qM,Ai),s.quaternion.copy(Ai))),s.visible=s.visible&&(s.name.indexOf("X")===-1||this.showX),s.visible=s.visible&&(s.name.indexOf("Y")===-1||this.showY),s.visible=s.visible&&(s.name.indexOf("Z")===-1||this.showZ),s.visible=s.visible&&(s.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),s.material._color=s.material._color||s.material.color.clone(),s.material._opacity=s.material._opacity||s.material.opacity,s.material.color.copy(s.material._color),s.material.opacity=s.material._opacity,this.enabled&&this.axis&&(s.name===this.axis?(s.material.color.copy(this.materialLib.active.color),s.material.opacity=1):this.axis.split("").some(function(c){return s.name===c})&&(s.material.color.copy(this.materialLib.active.color),s.material.opacity=1))}super.updateMatrixWorld(e)}},WI=class extends Pe{constructor(){super(new la(1e5,1e5,2,2),new ci({visible:!1,wireframe:!0,side:rr,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(t="local"),XM.copy(pv).applyQuaternion(t==="local"?this.worldQuaternion:ZM),hv.copy(Ch).applyQuaternion(t==="local"?this.worldQuaternion:ZM),fv.copy(mv).applyQuaternion(t==="local"?this.worldQuaternion:ZM),li.copy(hv),this.mode){case"translate":case"scale":switch(this.axis){case"X":li.copy(this.eye).cross(XM),ac.copy(XM).cross(li);break;case"Y":li.copy(this.eye).cross(hv),ac.copy(hv).cross(li);break;case"Z":li.copy(this.eye).cross(fv),ac.copy(fv).cross(li);break;case"XY":ac.copy(fv);break;case"YZ":ac.copy(XM);break;case"XZ":li.copy(fv),ac.copy(hv);break;case"XYZ":case"E":ac.set(0,0,0);break}break;case"rotate":default:ac.set(0,0,0)}ac.length()===0?this.quaternion.copy(this.cameraQuaternion):(uU.lookAt(Yr.set(0,0,0),ac,li),this.quaternion.setFromRotationMatrix(uU)),super.updateMatrixWorld(e)}};var al=(()=>{let e=class e{constructor(){this.engineService=S(ns),this.ngZone=S(pt),this.active=!0,this.destroyed$=new lt,this.beforeRender$=this.engineService.beforeRender$,this.engineService.resize$.pipe(Pn(this.destroyed$)).subscribe(()=>this.requestAnimationFrame())}ngOnDestroy(){this.stop(),this.destroyed$.next(),this.destroyed$.complete()}start(){this.active||(this.active=!0,this.requestAnimationFrame())}stop(){this.active=!1,this.frameId!==void 0&&(cancelAnimationFrame(this.frameId),this.frameId=void 0)}isActive(){return this.active}requestAnimationFrame(){this.frameId===void 0&&this.ngZone.runOutsideAngular(()=>this.frameId=requestAnimationFrame(()=>{this.frameId=void 0,this.engineService.render(),this.active&&this.requestAnimationFrame()}))}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ge({token:e,factory:e.\u0275fac});let i=e;return i})();var cJ=["*"];function lJ(i,e){i&1&&Q(0)}function uJ(){return[{provide:sl,useFactory:()=>{let i=S(sl,{skipSelf:!0,optional:!0});return i||[Mu()[0].useFactory()]}},{provide:Rh,useFactory:()=>{let i=S(Rh,{skipSelf:!0,optional:!0});if(i)return i;let e=S(sl),t=e[0];if(e.length===1&&t instanceof rl)return t}}]}var At=(()=>{let e=class e extends Zr{get obj(){return this}set views(n){this.setViews(n)}get rendererCanvas(){return this.engServ.canvas}constructor(){super(),this.engServ=S(ns),this.raycaster=S(xu),this.animationLoop=S(al),this.elementRef=S(vt),this.isDevMode=bk,this.nid=e.instanceCnt++,this.disableDefaultView=!1,this.engServ.renderers.forEach(n=>this.elementRef.nativeElement.appendChild(n.domElement))}ngAfterContentChecked(){this.animationLoop.requestAnimationFrame()}ngAfterViewInit(){this.animationLoop.requestAnimationFrame()}ngOnInit(){this.engServ.resize(),super.ngOnInit(),this.setViews()}setViews(n){this.engServ.setViews([]),this.disableDefaultView||this.engServ.addView(this),n?.forEach(r=>this.engServ.addView(r))}};e.instanceCnt=0,e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["th-canvas"]],contentQueries:function(r,o,s){if(r&1&&xi(s,Zr,4),r&2){let a;st(a=at())&&(o.views=a)}},inputs:{disableDefaultView:"disableDefaultView"},features:[K([{provide:uv,useFactory:()=>S(vt)},{provide:de,useExisting:he(()=>e)},ns,al,{provide:Sh,useValue:new Dr},he(()=>xu),{provide:Zr,useExisting:he(()=>e)},uJ()]),$],ngContentSelectors:cJ,decls:1,vars:1,template:function(r,o){r&1&&(ie(),Vi(0,lJ,1,0)),r&2&&zi(o.isDevMode()?0:-1)},styles:["[_nghost-%COMP%]{display:flex;flex:auto;line-height:0;height:100%}[_nghost-%COMP%]     canvas{flex:auto;outline:none;width:100%;height:100%;position:relative}"],changeDetection:0});let i=e;return i})();var _i=(()=>{let e=class e extends bo{constructor(){super(...arguments),this._camera=S(de),this.canvas=S(At),this.renderLoop=S(al)}set domElement(n){this._objRef&&(this._objRef.domElement=n)}get domElement(){return this._objRef?.domElement}set object(n){this._objRef&&(this._objRef.object=n)}get object(){return this._objRef?.object}set enabled(n){this._objRef&&(this._objRef.enabled=n)}get enabled(){return this._objRef?.enabled}createThreeInstance(n){n||(n=[this._camera.objRef,this.canvas?.elementRef.nativeElement]);let r=super.createThreeInstance(n);return this.patchDispatchEvent(r),this.subscribeControlUpdater(r),r}patchDispatchEvent(n){if(n.dispatchEvent){this.origDispatchEventMethod=n.dispatchEvent;let r=this.origDispatchEventMethod;n.dispatchEvent=o=>{r.call(n,o),this.renderLoop.requestAnimationFrame()}}}ngOnDestroy(){super.ngOnDestroy(),this.unpatchDispatchEvent(),this.unsubscribeControlUpdater()}unpatchDispatchEvent(){this.origDispatchEventMethod&&this._objRef&&(this._objRef.dispatchEvent=this.origDispatchEventMethod)}subscribeControlUpdater(n){n.update!==void 0&&(this.beforeRenderSubscription=this.renderLoop.beforeRender$.subscribe(r=>{n.update(r.delta)}))}unsubscribeControlUpdater(){this.beforeRenderSubscription&&this.beforeRenderSubscription.unsubscribe()}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-abs-control"]],inputs:{domElement:"domElement",object:"object",enabled:"enabled"},features:[$],decls:0,vars:0,template:function(r,o){},encapsulation:2,changeDetection:0});let i=e;return i})();var dJ=["*"],dU=(()=>{let e=class e extends _i{getType(){return Kp}set camera(n){this._objRef&&(this._objRef.camera=n)}get camera(){return this._objRef?.camera}set axis(n){this._objRef&&(this._objRef.axis=n)}get axis(){return this._objRef?.axis}set mode(n){this._objRef&&(this._objRef.mode=n)}get mode(){return this._objRef?.mode}set translationSnap(n){this._objRef&&(this._objRef.translationSnap=n)}get translationSnap(){return this._objRef?.translationSnap}set rotationSnap(n){this._objRef&&(this._objRef.rotationSnap=n)}get rotationSnap(){return this._objRef?.rotationSnap}set scaleSnap(n){this._objRef&&(this._objRef.scaleSnap=n)}get scaleSnap(){return this._objRef?.scaleSnap}set space(n){this._objRef&&(this._objRef.space=n)}get space(){return this._objRef?.space}set size(n){this._objRef&&(this._objRef.size=n)}get size(){return this._objRef?.size}set dragging(n){this._objRef&&(this._objRef.dragging=n)}get dragging(){return this._objRef?.dragging}set showX(n){this._objRef&&(this._objRef.showX=n)}get showX(){return this._objRef?.showX}set showY(n){this._objRef&&(this._objRef.showY=n)}get showY(){return this._objRef?.showY}set showZ(n){this._objRef&&(this._objRef.showZ=n)}get showZ(){return this._objRef?.showZ}set minx(n){this._objRef&&(this._objRef.minx=n)}get minx(){return this._objRef?.minx}set maxX(n){this._objRef&&(this._objRef.maxX=n)}get maxX(){return this._objRef?.maxX}set minY(n){this._objRef&&(this._objRef.minY=n)}get minY(){return this._objRef?.minY}set maxY(n){this._objRef&&(this._objRef.maxY=n)}get maxY(){return this._objRef?.maxY}set minZ(n){this._objRef&&(this._objRef.minZ=n)}get minZ(){return this._objRef?.minZ}set maxZ(n){this._objRef&&(this._objRef.maxZ=n)}get maxZ(){return this._objRef?.maxZ}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-transformControlsGen"]],inputs:{camera:"camera",axis:"axis",mode:"mode",translationSnap:"translationSnap",rotationSnap:"rotationSnap",scaleSnap:"scaleSnap",space:"space",size:"size",dragging:"dragging",showX:"showX",showY:"showY",showZ:"showZ",minx:"minx",maxX:"maxX",minY:"minY",maxY:"maxY",minZ:"minZ",maxZ:"maxZ"},features:[K([{provide:_i,useExisting:he(()=>e)}]),$],ngContentSelectors:dJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var hJ=["*"],hU=(()=>{let e=class e extends dU{constructor(){super(...arguments),this.scene=S(Ot),this.objectAdded=()=>{this.objRef&&this.targetObject!=null&&this.targetObject.parent&&this.objRef.attach(this.targetObject)},this.objectRemoved=()=>{this._objRef?.detach()}}getType(){return Kp}set object(n){this._objRef&&(this.removeObjectListeners(),this.targetObject=n,this.addObjectListeners(),n?this.objectAdded():this.objectRemoved())}addToParent(){let n=this.objRef?.getHelper();n&&this.scene?.objRef?.add(n)}removeFromParent(){this._objRef&&this.scene?.objRef?.remove(this._objRef.object)}ngOnDestroy(){this.removeObjectListeners(),this.objectRemoved(),this.targetObject=void 0}removeObjectListeners(){this.targetObject&&(this.targetObject.removeEventListener("added",this.objectAdded),this.targetObject.removeEventListener("removed",this.objectRemoved))}addObjectListeners(){this.targetObject?.addEventListener("added",this.objectAdded),this.targetObject?.addEventListener("removed",this.objectRemoved)}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-transformControls"]],inputs:{object:"object"},features:[K([{provide:_i,useExisting:he(()=>e)}]),$],ngContentSelectors:hJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var pJ=["*"],ya=(()=>{let e=class e extends de{get isLight(){return this._objRef?.isLight}get type(){return this._objRef?.type}set color(n){this._objRef&&(this._objRef.color=pe(this._objRef.color,n))}get color(){return this._objRef?.color}set intensity(n){this._objRef&&(this._objRef.intensity=n)}get intensity(){return this._objRef?.intensity}set shadow(n){this._objRef&&(this._objRef.shadow=n)}get shadow(){return this._objRef?.shadow}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-light"]],inputs:{color:"color",intensity:"intensity",shadow:"shadow"},features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:pJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var mJ=["*"],Tn=(()=>{let e=class e extends ya{getType(){return ph}get isAmbientLight(){return this._objRef?.isAmbientLight}get type(){return this._objRef?.type}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-ambientLight"]],features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:mJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var St={IDLE:Symbol(),ROTATE:Symbol(),PAN:Symbol(),SCALE:Symbol(),FOV:Symbol(),FOCUS:Symbol(),ZROTATE:Symbol(),TOUCH_MULTI:Symbol(),ANIMATION_FOCUS:Symbol(),ANIMATION_ROTATE:Symbol()},Yn={NONE:Symbol(),ONE_FINGER:Symbol(),ONE_FINGER_SWITCHED:Symbol(),TWO_FINGER:Symbol(),MULT_FINGER:Symbol(),CURSOR:Symbol()},cn={x:0,y:0},is={camera:new Ee,gizmos:new Ee},bi={type:"change"},wa={type:"start"},Cs={type:"end"},gJ=new Dr,lr=new C,fU=new Ee,pU=new Ee,xa=new C,YM=1e-6,QM=class extends Ir{constructor(e,t=null,n=null){super(e,t),this.scene=n,this.target=new C,this._currentTarget=new C,this.radiusFactor=.67,this.mouseActions=[],this._mouseOp=null,this._v2_1=new z,this._v3_1=new C,this._v3_2=new C,this._m4_1=new Ee,this._m4_2=new Ee,this._quat=new nn,this._translationMatrix=new Ee,this._rotationMatrix=new Ee,this._scaleMatrix=new Ee,this._rotationAxis=new C,this._cameraMatrixState=new Ee,this._cameraProjectionState=new Ee,this._fovState=1,this._upState=new C,this._zoomState=1,this._nearPos=0,this._farPos=0,this._gizmoMatrixState=new Ee,this._up0=new C,this._zoom0=1,this._fov0=0,this._initialNear=0,this._nearPos0=0,this._initialFar=0,this._farPos0=0,this._cameraMatrixState0=new Ee,this._gizmoMatrixState0=new Ee,this._target0=new C,this._button=-1,this._touchStart=[],this._touchCurrent=[],this._input=Yn.NONE,this._switchSensibility=32,this._startFingerDistance=0,this._currentFingerDistance=0,this._startFingerRotation=0,this._currentFingerRotation=0,this._devPxRatio=0,this._downValid=!0,this._nclicks=0,this._downEvents=[],this._downStart=0,this._clickStart=0,this._maxDownTime=250,this._maxInterval=300,this._posThreshold=24,this._movementThreshold=24,this._currentCursorPosition=new C,this._startCursorPosition=new C,this._grid=null,this._gridPosition=new C,this._gizmos=new Or,this._curvePts=128,this._timeStart=-1,this._animationId=-1,this.focusAnimationTime=500,this._timePrev=0,this._timeCurrent=0,this._anglePrev=0,this._angleCurrent=0,this._cursorPosPrev=new C,this._cursorPosCurr=new C,this._wPrev=0,this._wCurr=0,this.adjustNearFar=!1,this.scaleFactor=1.1,this.dampingFactor=25,this.wMax=20,this.enableAnimations=!0,this.enableGrid=!1,this.cursorZoom=!1,this.minFov=5,this.maxFov=90,this.rotateSpeed=1,this.enablePan=!0,this.enableRotate=!0,this.enableZoom=!0,this.enableGizmos=!0,this.enableFocus=!0,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this._tbRadius=1,this._state=St.IDLE,this.setCamera(e),this.scene!=null&&this.scene.add(this._gizmos),this.initializeMouseActions(),this._onContextMenu=bJ.bind(this),this._onWheel=MJ.bind(this),this._onPointerUp=wJ.bind(this),this._onPointerMove=xJ.bind(this),this._onPointerDown=yJ.bind(this),this._onPointerCancel=vJ.bind(this),this._onWindowResize=_J.bind(this),t!==null&&this.connect(t)}connect(e){super.connect(e),this.domElement.style.touchAction="none",this._devPxRatio=window.devicePixelRatio,this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onWheel,{passive:!1}),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerCancel),window.addEventListener("resize",this._onWindowResize)}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("wheel",this._onWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),window.removeEventListener("pointermove",this._onPointerMove),window.removeEventListener("pointerup",this._onPointerUp),window.removeEventListener("resize",this._onWindowResize)}onSinglePanStart(e,t){if(this.enabled)switch(this.dispatchEvent(wa),this.setCenter(e.clientX,e.clientY),t){case"PAN":if(!this.enablePan)return;this._animationId!=-1&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(bi)),this.updateTbState(St.PAN,!0),this._startCursorPosition.copy(this.unprojectOnTbPlane(this.object,cn.x,cn.y,this.domElement)),this.enableGrid&&(this.drawGrid(),this.dispatchEvent(bi));break;case"ROTATE":if(!this.enableRotate)return;this._animationId!=-1&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1),this.updateTbState(St.ROTATE,!0),this._startCursorPosition.copy(this.unprojectOnTbSurface(this.object,cn.x,cn.y,this.domElement,this._tbRadius)),this.activateGizmos(!0),this.enableAnimations&&(this._timePrev=this._timeCurrent=performance.now(),this._angleCurrent=this._anglePrev=0,this._cursorPosPrev.copy(this._startCursorPosition),this._cursorPosCurr.copy(this._cursorPosPrev),this._wCurr=0,this._wPrev=this._wCurr),this.dispatchEvent(bi);break;case"FOV":if(!this.object.isPerspectiveCamera||!this.enableZoom)return;this._animationId!=-1&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(bi)),this.updateTbState(St.FOV,!0),this._startCursorPosition.setY(this.getCursorNDC(cn.x,cn.y,this.domElement).y*.5),this._currentCursorPosition.copy(this._startCursorPosition);break;case"ZOOM":if(!this.enableZoom)return;this._animationId!=-1&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(bi)),this.updateTbState(St.SCALE,!0),this._startCursorPosition.setY(this.getCursorNDC(cn.x,cn.y,this.domElement).y*.5),this._currentCursorPosition.copy(this._startCursorPosition);break}}onSinglePanMove(e,t){if(this.enabled){let n=t!=this._state;switch(this.setCenter(e.clientX,e.clientY),t){case St.PAN:this.enablePan&&(n?(this.dispatchEvent(Cs),this.dispatchEvent(wa),this.updateTbState(t,!0),this._startCursorPosition.copy(this.unprojectOnTbPlane(this.object,cn.x,cn.y,this.domElement)),this.enableGrid&&this.drawGrid(),this.activateGizmos(!1)):(this._currentCursorPosition.copy(this.unprojectOnTbPlane(this.object,cn.x,cn.y,this.domElement)),this.applyTransformMatrix(this.pan(this._startCursorPosition,this._currentCursorPosition))));break;case St.ROTATE:if(this.enableRotate)if(n)this.dispatchEvent(Cs),this.dispatchEvent(wa),this.updateTbState(t,!0),this._startCursorPosition.copy(this.unprojectOnTbSurface(this.object,cn.x,cn.y,this.domElement,this._tbRadius)),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!0);else{this._currentCursorPosition.copy(this.unprojectOnTbSurface(this.object,cn.x,cn.y,this.domElement,this._tbRadius));let r=this._startCursorPosition.distanceTo(this._currentCursorPosition),o=this._startCursorPosition.angleTo(this._currentCursorPosition),s=Math.max(r/this._tbRadius,o)*this.rotateSpeed;this.applyTransformMatrix(this.rotate(this.calculateRotationAxis(this._startCursorPosition,this._currentCursorPosition),s)),this.enableAnimations&&(this._timePrev=this._timeCurrent,this._timeCurrent=performance.now(),this._anglePrev=this._angleCurrent,this._angleCurrent=s,this._cursorPosPrev.copy(this._cursorPosCurr),this._cursorPosCurr.copy(this._currentCursorPosition),this._wPrev=this._wCurr,this._wCurr=this.calculateAngularSpeed(this._anglePrev,this._angleCurrent,this._timePrev,this._timeCurrent))}break;case St.SCALE:if(this.enableZoom)if(n)this.dispatchEvent(Cs),this.dispatchEvent(wa),this.updateTbState(t,!0),this._startCursorPosition.setY(this.getCursorNDC(cn.x,cn.y,this.domElement).y*.5),this._currentCursorPosition.copy(this._startCursorPosition),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1);else{this._currentCursorPosition.setY(this.getCursorNDC(cn.x,cn.y,this.domElement).y*.5);let o=this._currentCursorPosition.y-this._startCursorPosition.y,s=1;o<0?s=1/Math.pow(this.scaleFactor,-o*8):o>0&&(s=Math.pow(this.scaleFactor,o*8)),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState),this.applyTransformMatrix(this.scale(s,this._v3_1))}break;case St.FOV:if(this.enableZoom&&this.object.isPerspectiveCamera)if(n)this.dispatchEvent(Cs),this.dispatchEvent(wa),this.updateTbState(t,!0),this._startCursorPosition.setY(this.getCursorNDC(cn.x,cn.y,this.domElement).y*.5),this._currentCursorPosition.copy(this._startCursorPosition),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1);else{this._currentCursorPosition.setY(this.getCursorNDC(cn.x,cn.y,this.domElement).y*.5);let o=this._currentCursorPosition.y-this._startCursorPosition.y,s=1;o<0?s=1/Math.pow(this.scaleFactor,-o*8):o>0&&(s=Math.pow(this.scaleFactor,o*8)),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);let a=this._v3_1.distanceTo(this._gizmos.position),c=a/s;c=Ze.clamp(c,this.minDistance,this.maxDistance);let l=a*Math.tan(Ze.DEG2RAD*this._fovState*.5),u=Ze.RAD2DEG*(Math.atan(l/c)*2);u=Ze.clamp(u,this.minFov,this.maxFov);let d=l/Math.tan(Ze.DEG2RAD*(u/2));s=a/d,this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),this.setFov(u),this.applyTransformMatrix(this.scale(s,this._v3_2,!1)),lr.copy(this._gizmos.position).sub(this.object.position).normalize().multiplyScalar(d/a),this._m4_1.makeTranslation(lr.x,lr.y,lr.z)}break}this.dispatchEvent(bi)}}onSinglePanEnd(){if(this._state==St.ROTATE){if(!this.enableRotate)return;if(this.enableAnimations)if(performance.now()-this._timeCurrent<120){let t=Math.abs((this._wPrev+this._wCurr)/2),n=this;this._animationId=window.requestAnimationFrame(function(r){n.updateTbState(St.ANIMATION_ROTATE,!0);let o=n.calculateRotationAxis(n._cursorPosPrev,n._cursorPosCurr);n.onRotationAnim(r,o,Math.min(t,n.wMax))})}else this.updateTbState(St.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(bi);else this.updateTbState(St.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(bi)}else(this._state==St.PAN||this._state==St.IDLE)&&(this.updateTbState(St.IDLE,!1),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1),this.dispatchEvent(bi));this.dispatchEvent(Cs)}onDoubleTap(e){if(this.enabled&&this.enablePan&&this.enableFocus&&this.scene!=null){this.dispatchEvent(wa),this.setCenter(e.clientX,e.clientY);let t=this.unprojectOnObj(this.getCursorNDC(cn.x,cn.y,this.domElement),this.object);if(t!=null&&this.enableAnimations){let n=this;this._animationId!=-1&&window.cancelAnimationFrame(this._animationId),this._timeStart=-1,this._animationId=window.requestAnimationFrame(function(r){n.updateTbState(St.ANIMATION_FOCUS,!0),n.onFocusAnim(r,t,n._cameraMatrixState,n._gizmoMatrixState)})}else t!=null&&!this.enableAnimations&&(this.updateTbState(St.FOCUS,!0),this.focus(t,this.scaleFactor),this.updateTbState(St.IDLE,!1),this.dispatchEvent(bi))}this.dispatchEvent(Cs)}onDoublePanStart(){this.enabled&&this.enablePan&&(this.dispatchEvent(wa),this.updateTbState(St.PAN,!0),this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._startCursorPosition.copy(this.unprojectOnTbPlane(this.object,cn.x,cn.y,this.domElement,!0)),this._currentCursorPosition.copy(this._startCursorPosition),this.activateGizmos(!1))}onDoublePanMove(){this.enabled&&this.enablePan&&(this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._state!=St.PAN&&(this.updateTbState(St.PAN,!0),this._startCursorPosition.copy(this._currentCursorPosition)),this._currentCursorPosition.copy(this.unprojectOnTbPlane(this.object,cn.x,cn.y,this.domElement,!0)),this.applyTransformMatrix(this.pan(this._startCursorPosition,this._currentCursorPosition,!0)),this.dispatchEvent(bi))}onDoublePanEnd(){this.updateTbState(St.IDLE,!1),this.dispatchEvent(Cs)}onRotateStart(){this.enabled&&this.enableRotate&&(this.dispatchEvent(wa),this.updateTbState(St.ZROTATE,!0),this._startFingerRotation=this.getAngle(this._touchCurrent[1],this._touchCurrent[0])+this.getAngle(this._touchStart[1],this._touchStart[0]),this._currentFingerRotation=this._startFingerRotation,this.object.getWorldDirection(this._rotationAxis),!this.enablePan&&!this.enableZoom&&this.activateGizmos(!0))}onRotateMove(){if(this.enabled&&this.enableRotate){this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2);let e;this._state!=St.ZROTATE&&(this.updateTbState(St.ZROTATE,!0),this._startFingerRotation=this._currentFingerRotation),this._currentFingerRotation=this.getAngle(this._touchCurrent[1],this._touchCurrent[0])+this.getAngle(this._touchStart[1],this._touchStart[0]),this.enablePan?(this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),e=this.unprojectOnTbPlane(this.object,cn.x,cn.y,this.domElement).applyQuaternion(this.object.quaternion).multiplyScalar(1/this.object.zoom).add(this._v3_2)):e=new C().setFromMatrixPosition(this._gizmoMatrixState);let t=Ze.DEG2RAD*(this._startFingerRotation-this._currentFingerRotation);this.applyTransformMatrix(this.zRotate(e,t)),this.dispatchEvent(bi)}}onRotateEnd(){this.updateTbState(St.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(Cs)}onPinchStart(){this.enabled&&this.enableZoom&&(this.dispatchEvent(wa),this.updateTbState(St.SCALE,!0),this._startFingerDistance=this.calculatePointersDistance(this._touchCurrent[0],this._touchCurrent[1]),this._currentFingerDistance=this._startFingerDistance,this.activateGizmos(!1))}onPinchMove(){if(this.enabled&&this.enableZoom){this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2);let e=12;this._state!=St.SCALE&&(this._startFingerDistance=this._currentFingerDistance,this.updateTbState(St.SCALE,!0)),this._currentFingerDistance=Math.max(this.calculatePointersDistance(this._touchCurrent[0],this._touchCurrent[1]),e*this._devPxRatio);let t=this._currentFingerDistance/this._startFingerDistance,n;this.enablePan?this.object.isOrthographicCamera?n=this.unprojectOnTbPlane(this.object,cn.x,cn.y,this.domElement).applyQuaternion(this.object.quaternion).multiplyScalar(1/this.object.zoom).add(this._gizmos.position):this.object.isPerspectiveCamera&&(n=this.unprojectOnTbPlane(this.object,cn.x,cn.y,this.domElement).applyQuaternion(this.object.quaternion).add(this._gizmos.position)):n=this._gizmos.position,this.applyTransformMatrix(this.scale(t,n)),this.dispatchEvent(bi)}}onPinchEnd(){this.updateTbState(St.IDLE,!1),this.dispatchEvent(Cs)}onTriplePanStart(){if(this.enabled&&this.enableZoom){this.dispatchEvent(wa),this.updateTbState(St.SCALE,!0);let e=0,t=0,n=this._touchCurrent.length;for(let r=0;r<n;r++)e+=this._touchCurrent[r].clientX,t+=this._touchCurrent[r].clientY;this.setCenter(e/n,t/n),this._startCursorPosition.setY(this.getCursorNDC(cn.x,cn.y,this.domElement).y*.5),this._currentCursorPosition.copy(this._startCursorPosition)}}onTriplePanMove(){if(this.enabled&&this.enableZoom){let e=0,t=0,n=this._touchCurrent.length;for(let h=0;h<n;h++)e+=this._touchCurrent[h].clientX,t+=this._touchCurrent[h].clientY;this.setCenter(e/n,t/n);let r=8;this._currentCursorPosition.setY(this.getCursorNDC(cn.x,cn.y,this.domElement).y*.5);let o=this._currentCursorPosition.y-this._startCursorPosition.y,s=1;o<0?s=1/Math.pow(this.scaleFactor,-o*r):o>0&&(s=Math.pow(this.scaleFactor,o*r)),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);let a=this._v3_1.distanceTo(this._gizmos.position),c=a/s;c=Ze.clamp(c,this.minDistance,this.maxDistance);let l=a*Math.tan(Ze.DEG2RAD*this._fovState*.5),u=Ze.RAD2DEG*(Math.atan(l/c)*2);u=Ze.clamp(u,this.minFov,this.maxFov);let d=l/Math.tan(Ze.DEG2RAD*(u/2));s=a/d,this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),this.setFov(u),this.applyTransformMatrix(this.scale(s,this._v3_2,!1)),lr.copy(this._gizmos.position).sub(this.object.position).normalize().multiplyScalar(d/a),this._m4_1.makeTranslation(lr.x,lr.y,lr.z),this.dispatchEvent(bi)}}onTriplePanEnd(){this.updateTbState(St.IDLE,!1),this.dispatchEvent(Cs)}setCenter(e,t){cn.x=e,cn.y=t}initializeMouseActions(){this.setMouseAction("PAN",0,"CTRL"),this.setMouseAction("PAN",2),this.setMouseAction("ROTATE",0),this.setMouseAction("ZOOM","WHEEL"),this.setMouseAction("ZOOM",1),this.setMouseAction("FOV","WHEEL","SHIFT"),this.setMouseAction("FOV",1,"SHIFT")}compareMouseAction(e,t){return e.operation==t.operation?e.mouse==t.mouse&&e.key==t.key:!1}setMouseAction(e,t,n=null){let r=["PAN","ROTATE","ZOOM","FOV"],o=[0,1,2,"WHEEL"],s=["CTRL","SHIFT",null],a;if(!r.includes(e)||!o.includes(t)||!s.includes(n)||t=="WHEEL"&&e!="ZOOM"&&e!="FOV")return!1;switch(e){case"PAN":a=St.PAN;break;case"ROTATE":a=St.ROTATE;break;case"ZOOM":a=St.SCALE;break;case"FOV":a=St.FOV;break}let c={operation:e,mouse:t,key:n,state:a};for(let l=0;l<this.mouseActions.length;l++)if(this.mouseActions[l].mouse==c.mouse&&this.mouseActions[l].key==c.key)return this.mouseActions.splice(l,1,c),!0;return this.mouseActions.push(c),!0}unsetMouseAction(e,t=null){for(let n=0;n<this.mouseActions.length;n++)if(this.mouseActions[n].mouse==e&&this.mouseActions[n].key==t)return this.mouseActions.splice(n,1),!0;return!1}getOpFromAction(e,t){let n;for(let r=0;r<this.mouseActions.length;r++)if(n=this.mouseActions[r],n.mouse==e&&n.key==t)return n.operation;if(t!=null){for(let r=0;r<this.mouseActions.length;r++)if(n=this.mouseActions[r],n.mouse==e&&n.key==null)return n.operation}return null}getOpStateFromAction(e,t){let n;for(let r=0;r<this.mouseActions.length;r++)if(n=this.mouseActions[r],n.mouse==e&&n.key==t)return n.state;if(t!=null){for(let r=0;r<this.mouseActions.length;r++)if(n=this.mouseActions[r],n.mouse==e&&n.key==null)return n.state}return null}getAngle(e,t){return Math.atan2(t.clientY-e.clientY,t.clientX-e.clientX)*180/Math.PI}updateTouchEvent(e){for(let t=0;t<this._touchCurrent.length;t++)if(this._touchCurrent[t].pointerId==e.pointerId){this._touchCurrent.splice(t,1,e);break}}applyTransformMatrix(e){if(e.camera!=null&&(this._m4_1.copy(this._cameraMatrixState).premultiply(e.camera),this._m4_1.decompose(this.object.position,this.object.quaternion,this.object.scale),this.object.updateMatrix(),(this._state==St.ROTATE||this._state==St.ZROTATE||this._state==St.ANIMATION_ROTATE)&&this.object.up.copy(this._upState).applyQuaternion(this.object.quaternion)),e.gizmos!=null&&(this._m4_1.copy(this._gizmoMatrixState).premultiply(e.gizmos),this._m4_1.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix()),this._state==St.SCALE||this._state==St.FOCUS||this._state==St.ANIMATION_FOCUS)if(this._tbRadius=this.calculateTbRadius(this.object),this.adjustNearFar){let t=this.object.position.distanceTo(this._gizmos.position),n=new wi;n.setFromObject(this._gizmos);let r=new Di;n.getBoundingSphere(r);let o=Math.max(this._nearPos0,r.radius+r.center.length()),s=t-this._initialNear,a=Math.min(o,s);this.object.near=t-a;let c=Math.min(this._farPos0,-r.radius+r.center.length()),l=t-this._initialFar,u=Math.min(c,l);this.object.far=t-u,this.object.updateProjectionMatrix()}else{let t=!1;this.object.near!=this._initialNear&&(this.object.near=this._initialNear,t=!0),this.object.far!=this._initialFar&&(this.object.far=this._initialFar,t=!0),t&&this.object.updateProjectionMatrix()}}calculateAngularSpeed(e,t,n,r){let o=t-e,s=(r-n)/1e3;return s==0?0:o/s}calculatePointersDistance(e,t){return Math.sqrt(Math.pow(t.clientX-e.clientX,2)+Math.pow(t.clientY-e.clientY,2))}calculateRotationAxis(e,t){return this._rotationMatrix.extractRotation(this._cameraMatrixState),this._quat.setFromRotationMatrix(this._rotationMatrix),this._rotationAxis.crossVectors(e,t).applyQuaternion(this._quat),this._rotationAxis.normalize().clone()}calculateTbRadius(e){let t=e.position.distanceTo(this._gizmos.position);if(e.type=="PerspectiveCamera"){let n=Ze.DEG2RAD*e.fov*.5,r=Math.atan(e.aspect*Math.tan(n));return Math.tan(Math.min(n,r))*t*this.radiusFactor}else if(e.type=="OrthographicCamera")return Math.min(e.top,e.right)*this.radiusFactor}focus(e,t,n=1){lr.copy(e).sub(this._gizmos.position).multiplyScalar(n),this._translationMatrix.makeTranslation(lr.x,lr.y,lr.z),fU.copy(this._gizmoMatrixState),this._gizmoMatrixState.premultiply(this._translationMatrix),this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),pU.copy(this._cameraMatrixState),this._cameraMatrixState.premultiply(this._translationMatrix),this._cameraMatrixState.decompose(this.object.position,this.object.quaternion,this.object.scale),this.enableZoom&&this.applyTransformMatrix(this.scale(t,this._gizmos.position)),this._gizmoMatrixState.copy(fU),this._cameraMatrixState.copy(pU)}drawGrid(){if(this.scene!=null){let n,r,o,s;if(this.object.isOrthographicCamera){let a=this.object.right-this.object.left,c=this.object.bottom-this.object.top;o=Math.max(a,c),s=o/20,n=o/this.object.zoom*3,r=n/s*this.object.zoom}else if(this.object.isPerspectiveCamera){let a=this.object.position.distanceTo(this._gizmos.position),c=Ze.DEG2RAD*this.object.fov*.5,l=Math.atan(this.object.aspect*Math.tan(c));o=Math.tan(Math.max(c,l))*a*2,s=o/20,n=o*3,r=n/s}this._grid==null&&(this._grid=new fu(n,r,8947848,8947848),this._grid.position.copy(this._gizmos.position),this._gridPosition.copy(this._grid.position),this._grid.quaternion.copy(this.object.quaternion),this._grid.rotateX(Math.PI*.5),this.scene.add(this._grid))}}dispose(){this._animationId!=-1&&window.cancelAnimationFrame(this._animationId),this.disconnect(),this.scene!==null&&this.scene.remove(this._gizmos),this.disposeGrid()}disposeGrid(){this._grid!=null&&this.scene!=null&&(this.scene.remove(this._grid),this._grid=null)}easeOutCubic(e){return 1-Math.pow(1-e,3)}activateGizmos(e){let t=this._gizmos.children[0],n=this._gizmos.children[1],r=this._gizmos.children[2];e?(t.material.setValues({opacity:1}),n.material.setValues({opacity:1}),r.material.setValues({opacity:1})):(t.material.setValues({opacity:.6}),n.material.setValues({opacity:.6}),r.material.setValues({opacity:.6}))}getCursorNDC(e,t,n){let r=n.getBoundingClientRect();return this._v2_1.setX((e-r.left)/r.width*2-1),this._v2_1.setY((r.bottom-t)/r.height*2-1),this._v2_1.clone()}getCursorPosition(e,t,n){return this._v2_1.copy(this.getCursorNDC(e,t,n)),this._v2_1.x*=(this.object.right-this.object.left)*.5,this._v2_1.y*=(this.object.top-this.object.bottom)*.5,this._v2_1.clone()}setCamera(e){e.lookAt(this.target),e.updateMatrix(),e.type=="PerspectiveCamera"&&(this._fov0=e.fov,this._fovState=e.fov),this._cameraMatrixState0.copy(e.matrix),this._cameraMatrixState.copy(this._cameraMatrixState0),this._cameraProjectionState.copy(e.projectionMatrix),this._zoom0=e.zoom,this._zoomState=this._zoom0,this._initialNear=e.near,this._nearPos0=e.position.distanceTo(this.target)-e.near,this._nearPos=this._initialNear,this._initialFar=e.far,this._farPos0=e.position.distanceTo(this.target)-e.far,this._farPos=this._initialFar,this._up0.copy(e.up),this._upState.copy(e.up),this.object=e,this.object.updateProjectionMatrix(),this._tbRadius=this.calculateTbRadius(e),this.makeGizmos(this.target,this._tbRadius)}setGizmosVisible(e){this._gizmos.visible=e,this.dispatchEvent(bi)}setTbRadius(e){this.radiusFactor=e,this._tbRadius=this.calculateTbRadius(this.object);let n=new Ss(0,0,this._tbRadius,this._tbRadius).getPoints(this._curvePts),r=new nt().setFromPoints(n);for(let o in this._gizmos.children)this._gizmos.children[o].geometry=r;this.dispatchEvent(bi)}makeGizmos(e,t){let r=new Ss(0,0,t,t).getPoints(this._curvePts),o=new nt().setFromPoints(r),s=new mi({color:16744576,fog:!1,transparent:!0,opacity:.6}),a=new mi({color:8454016,fog:!1,transparent:!0,opacity:.6}),c=new mi({color:8421631,fog:!1,transparent:!0,opacity:.6}),l=new ti(o,s),u=new ti(o,a),d=new ti(o,c),h=Math.PI*.5;if(l.rotation.x=h,u.rotation.y=h,this._gizmoMatrixState0.identity().setPosition(e),this._gizmoMatrixState.copy(this._gizmoMatrixState0),this.object.zoom!==1){let f=1/this.object.zoom;this._scaleMatrix.makeScale(f,f,f),this._translationMatrix.makeTranslation(-e.x,-e.y,-e.z),this._gizmoMatrixState.premultiply(this._translationMatrix).premultiply(this._scaleMatrix),this._translationMatrix.makeTranslation(e.x,e.y,e.z),this._gizmoMatrixState.premultiply(this._translationMatrix)}this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.traverse(function(f){f.isLine&&(f.geometry.dispose(),f.material.dispose())}),this._gizmos.clear(),this._gizmos.add(l),this._gizmos.add(u),this._gizmos.add(d)}onFocusAnim(e,t,n,r){if(this._timeStart==-1&&(this._timeStart=e),this._state==St.ANIMATION_FOCUS){let s=(e-this._timeStart)/this.focusAnimationTime;if(this._gizmoMatrixState.copy(r),s>=1)this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.focus(t,this.scaleFactor),this._timeStart=-1,this.updateTbState(St.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(bi);else{let a=this.easeOutCubic(s),c=1-a+this.scaleFactor*a;this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.focus(t,c,a),this.dispatchEvent(bi);let l=this;this._animationId=window.requestAnimationFrame(function(u){l.onFocusAnim(u,t,n,r.clone())})}}else this._animationId=-1,this._timeStart=-1}onRotationAnim(e,t,n){if(this._timeStart==-1&&(this._anglePrev=0,this._angleCurrent=0,this._timeStart=e),this._state==St.ANIMATION_ROTATE){let r=(e-this._timeStart)/1e3;if(n+-this.dampingFactor*r>0){this._angleCurrent=.5*-this.dampingFactor*Math.pow(r,2)+n*r+0,this.applyTransformMatrix(this.rotate(t,this._angleCurrent)),this.dispatchEvent(bi);let s=this;this._animationId=window.requestAnimationFrame(function(a){s.onRotationAnim(a,t,n)})}else this._animationId=-1,this._timeStart=-1,this.updateTbState(St.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(bi)}else this._animationId=-1,this._timeStart=-1,this._state!=St.ROTATE&&(this.activateGizmos(!1),this.dispatchEvent(bi))}pan(e,t,n=!1){let r=e.clone().sub(t);if(this.object.isOrthographicCamera)r.multiplyScalar(1/this.object.zoom);else if(this.object.isPerspectiveCamera&&n){this._v3_1.setFromMatrixPosition(this._cameraMatrixState0),this._v3_2.setFromMatrixPosition(this._gizmoMatrixState0);let o=this._v3_1.distanceTo(this._v3_2)/this.object.position.distanceTo(this._gizmos.position);r.multiplyScalar(1/o)}return this._v3_1.set(r.x,r.y,0).applyQuaternion(this.object.quaternion),this._m4_1.makeTranslation(this._v3_1.x,this._v3_1.y,this._v3_1.z),this.setTransformationMatrices(this._m4_1,this._m4_1),is}reset(){this.target.copy(this._target0),this.object.zoom=this._zoom0,this.object.isPerspectiveCamera&&(this.object.fov=this._fov0),this.object.near=this._nearPos,this.object.far=this._farPos,this._cameraMatrixState.copy(this._cameraMatrixState0),this._cameraMatrixState.decompose(this.object.position,this.object.quaternion,this.object.scale),this.object.up.copy(this._up0),this.object.updateMatrix(),this.object.updateProjectionMatrix(),this._gizmoMatrixState.copy(this._gizmoMatrixState0),this._gizmoMatrixState0.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix(),this._tbRadius=this.calculateTbRadius(this.object),this.makeGizmos(this._gizmos.position,this._tbRadius),this.object.lookAt(this._gizmos.position),this.updateTbState(St.IDLE,!1),this.dispatchEvent(bi)}rotate(e,t){let n=this._gizmos.position;return this._translationMatrix.makeTranslation(-n.x,-n.y,-n.z),this._rotationMatrix.makeRotationAxis(e,-t),this._m4_1.makeTranslation(n.x,n.y,n.z),this._m4_1.multiply(this._rotationMatrix),this._m4_1.multiply(this._translationMatrix),this.setTransformationMatrices(this._m4_1),is}copyState(){let e;this.object.isOrthographicCamera?e=JSON.stringify({arcballState:{cameraFar:this.object.far,cameraMatrix:this.object.matrix,cameraNear:this.object.near,cameraUp:this.object.up,cameraZoom:this.object.zoom,gizmoMatrix:this._gizmos.matrix,target:this.target}}):this.object.isPerspectiveCamera&&(e=JSON.stringify({arcballState:{cameraFar:this.object.far,cameraFov:this.object.fov,cameraMatrix:this.object.matrix,cameraNear:this.object.near,cameraUp:this.object.up,cameraZoom:this.object.zoom,gizmoMatrix:this._gizmos.matrix,target:this.target}})),navigator.clipboard.writeText(e)}pasteState(){let e=this;navigator.clipboard.readText().then(function(n){e.setStateFromJSON(n)})}saveState(){this.object.updateMatrix(),this._gizmos.updateMatrix(),this._target0.copy(this.target),this._cameraMatrixState0.copy(this.object.matrix),this._gizmoMatrixState0.copy(this._gizmos.matrix),this._nearPos=this.object.near,this._farPos=this.object.far,this._zoom0=this.object.zoom,this._up0.copy(this.object.up),this.object.isPerspectiveCamera&&(this._fov0=this.object.fov)}scale(e,t,n=!0){xa.copy(t);let r=1/e;if(this.object.isOrthographicCamera){this.object.zoom=this._zoomState,this.object.zoom*=e,this.object.zoom>this.maxZoom?(this.object.zoom=this.maxZoom,r=this._zoomState/this.maxZoom):this.object.zoom<this.minZoom&&(this.object.zoom=this.minZoom,r=this._zoomState/this.minZoom),this.object.updateProjectionMatrix(),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState),this._scaleMatrix.makeScale(r,r,r),this._translationMatrix.makeTranslation(-this._v3_1.x,-this._v3_1.y,-this._v3_1.z),this._m4_2.makeTranslation(this._v3_1.x,this._v3_1.y,this._v3_1.z).multiply(this._scaleMatrix),this._m4_2.multiply(this._translationMatrix),xa.sub(this._v3_1);let o=xa.clone().multiplyScalar(r);return xa.sub(o),this._m4_1.makeTranslation(xa.x,xa.y,xa.z),this._m4_2.premultiply(this._m4_1),this.setTransformationMatrices(this._m4_1,this._m4_2),is}else if(this.object.isPerspectiveCamera){this._v3_1.setFromMatrixPosition(this._cameraMatrixState),this._v3_2.setFromMatrixPosition(this._gizmoMatrixState);let o=this._v3_1.distanceTo(xa),s=o-o*r,a=o-s;if(a<this.minDistance?(r=this.minDistance/o,s=o-o*r):a>this.maxDistance&&(r=this.maxDistance/o,s=o-o*r),lr.copy(xa).sub(this._v3_1).normalize().multiplyScalar(s),this._m4_1.makeTranslation(lr.x,lr.y,lr.z),n){let c=this._v3_2;o=c.distanceTo(xa),s=o-o*r,lr.copy(xa).sub(this._v3_2).normalize().multiplyScalar(s),this._translationMatrix.makeTranslation(c.x,c.y,c.z),this._scaleMatrix.makeScale(r,r,r),this._m4_2.makeTranslation(lr.x,lr.y,lr.z).multiply(this._translationMatrix),this._m4_2.multiply(this._scaleMatrix),this._translationMatrix.makeTranslation(-c.x,-c.y,-c.z),this._m4_2.multiply(this._translationMatrix),this.setTransformationMatrices(this._m4_1,this._m4_2)}else this.setTransformationMatrices(this._m4_1);return is}}setFov(e){this.object.isPerspectiveCamera&&(this.object.fov=Ze.clamp(e,this.minFov,this.maxFov),this.object.updateProjectionMatrix())}setTransformationMatrices(e=null,t=null){e!=null?is.camera!=null?is.camera.copy(e):is.camera=e.clone():is.camera=null,t!=null?is.gizmos!=null?is.gizmos.copy(t):is.gizmos=t.clone():is.gizmos=null}zRotate(e,t){return this._rotationMatrix.makeRotationAxis(this._rotationAxis,t),this._translationMatrix.makeTranslation(-e.x,-e.y,-e.z),this._m4_1.makeTranslation(e.x,e.y,e.z),this._m4_1.multiply(this._rotationMatrix),this._m4_1.multiply(this._translationMatrix),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState).sub(e),this._v3_2.copy(this._v3_1).applyAxisAngle(this._rotationAxis,t),this._v3_2.sub(this._v3_1),this._m4_2.makeTranslation(this._v3_2.x,this._v3_2.y,this._v3_2.z),this.setTransformationMatrices(this._m4_1,this._m4_2),is}getRaycaster(){return gJ}unprojectOnObj(e,t){let n=this.getRaycaster();n.near=t.near,n.far=t.far,n.setFromCamera(e,t);let r=n.intersectObjects(this.scene.children,!0);for(let o=0;o<r.length;o++)if(r[o].object.uuid!=this._gizmos.uuid&&r[o].face!=null)return r[o].point.clone();return null}unprojectOnTbSurface(e,t,n,r,o){if(e.type=="OrthographicCamera"){this._v2_1.copy(this.getCursorPosition(t,n,r)),this._v3_1.set(this._v2_1.x,this._v2_1.y,0);let s=Math.pow(this._v2_1.x,2),a=Math.pow(this._v2_1.y,2),c=Math.pow(this._tbRadius,2);return s+a<=c*.5?this._v3_1.setZ(Math.sqrt(c-(s+a))):this._v3_1.setZ(c*.5/Math.sqrt(s+a)),this._v3_1}else if(e.type=="PerspectiveCamera"){this._v2_1.copy(this.getCursorNDC(t,n,r)),this._v3_1.set(this._v2_1.x,this._v2_1.y,-1),this._v3_1.applyMatrix4(e.projectionMatrixInverse);let s=this._v3_1.clone().normalize(),a=e.position.distanceTo(this._gizmos.position),c=Math.pow(o,2),l=this._v3_1.z,u=Math.sqrt(Math.pow(this._v3_1.x,2)+Math.pow(this._v3_1.y,2));if(u==0)return s.set(this._v3_1.x,this._v3_1.y,o),s;let d=l/u,h=a,f=Math.pow(d,2)+1,g=2*d*h,_=Math.pow(h,2)-c,m=Math.pow(g,2)-4*f*_;if(m>=0&&(this._v2_1.setX((-g-Math.sqrt(m))/(2*f)),this._v2_1.setY(d*this._v2_1.x+h),Ze.RAD2DEG*this._v2_1.angle()>=45)){let v=Math.sqrt(Math.pow(this._v2_1.x,2)+Math.pow(a-this._v2_1.y,2));return s.multiplyScalar(v),s.z+=a,s}f=d,g=h,_=-c*.5,m=Math.pow(g,2)-4*f*_,this._v2_1.setX((-g-Math.sqrt(m))/(2*f)),this._v2_1.setY(d*this._v2_1.x+h);let p=Math.sqrt(Math.pow(this._v2_1.x,2)+Math.pow(a-this._v2_1.y,2));return s.multiplyScalar(p),s.z+=a,s}}unprojectOnTbPlane(e,t,n,r,o=!1){if(e.type=="OrthographicCamera")return this._v2_1.copy(this.getCursorPosition(t,n,r)),this._v3_1.set(this._v2_1.x,this._v2_1.y,0),this._v3_1.clone();if(e.type=="PerspectiveCamera"){this._v2_1.copy(this.getCursorNDC(t,n,r)),this._v3_1.set(this._v2_1.x,this._v2_1.y,-1),this._v3_1.applyMatrix4(e.projectionMatrixInverse);let s=this._v3_1.clone().normalize(),a=this._v3_1.z,c=Math.sqrt(Math.pow(this._v3_1.x,2)+Math.pow(this._v3_1.y,2)),l;if(o?l=this._v3_1.setFromMatrixPosition(this._cameraMatrixState0).distanceTo(this._v3_2.setFromMatrixPosition(this._gizmoMatrixState0)):l=e.position.distanceTo(this._gizmos.position),c==0)return s.set(0,0,0),s;let u=a/c,d=l,h=-d/u,f=Math.sqrt(Math.pow(d,2)+Math.pow(h,2));return s.multiplyScalar(f),s.z=0,s}}updateMatrixState(){this._cameraMatrixState.copy(this.object.matrix),this._gizmoMatrixState.copy(this._gizmos.matrix),this.object.isOrthographicCamera?(this._cameraProjectionState.copy(this.object.projectionMatrix),this.object.updateProjectionMatrix(),this._zoomState=this.object.zoom):this.object.isPerspectiveCamera&&(this._fovState=this.object.fov)}updateTbState(e,t){this._state=e,t&&this.updateMatrixState()}update(){if(this.target.equals(this._currentTarget)===!1&&(this._gizmos.position.copy(this.target),this._tbRadius=this.calculateTbRadius(this.object),this.makeGizmos(this.target,this._tbRadius),this._currentTarget.copy(this.target)),this.object.isOrthographicCamera){if(this.object.zoom>this.maxZoom||this.object.zoom<this.minZoom){let e=Ze.clamp(this.object.zoom,this.minZoom,this.maxZoom);this.applyTransformMatrix(this.scale(e/this.object.zoom,this._gizmos.position,!0))}}else if(this.object.isPerspectiveCamera){let e=this.object.position.distanceTo(this._gizmos.position);if(e>this.maxDistance+YM||e<this.minDistance-YM){let n=Ze.clamp(e,this.minDistance,this.maxDistance);this.applyTransformMatrix(this.scale(n/e,this._gizmos.position)),this.updateMatrixState()}(this.object.fov<this.minFov||this.object.fov>this.maxFov)&&(this.object.fov=Ze.clamp(this.object.fov,this.minFov,this.maxFov),this.object.updateProjectionMatrix());let t=this._tbRadius;if(this._tbRadius=this.calculateTbRadius(this.object),t<this._tbRadius-YM||t>this._tbRadius+YM){let n=(this._gizmos.scale.x+this._gizmos.scale.y+this._gizmos.scale.z)/3,r=this._tbRadius/n,s=new Ss(0,0,r,r).getPoints(this._curvePts),a=new nt().setFromPoints(s);for(let c in this._gizmos.children)this._gizmos.children[c].geometry=a}}this.object.lookAt(this._gizmos.position)}setStateFromJSON(e){let t=JSON.parse(e);if(t.arcballState!=null){this.target.fromArray(t.arcballState.target),this._cameraMatrixState.fromArray(t.arcballState.cameraMatrix.elements),this._cameraMatrixState.decompose(this.object.position,this.object.quaternion,this.object.scale),this.object.up.copy(t.arcballState.cameraUp),this.object.near=t.arcballState.cameraNear,this.object.far=t.arcballState.cameraFar,this.object.zoom=t.arcballState.cameraZoom,this.object.isPerspectiveCamera&&(this.object.fov=t.arcballState.cameraFov),this._gizmoMatrixState.fromArray(t.arcballState.gizmoMatrix.elements),this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.object.updateMatrix(),this.object.updateProjectionMatrix(),this._gizmos.updateMatrix(),this._tbRadius=this.calculateTbRadius(this.object);let n=new Ee().copy(this._gizmoMatrixState0);this.makeGizmos(this._gizmos.position,this._tbRadius),this._gizmoMatrixState0.copy(n),this.object.lookAt(this._gizmos.position),this.updateTbState(St.IDLE,!1),this.dispatchEvent(bi)}}};function _J(){let i=(this._gizmos.scale.x+this._gizmos.scale.y+this._gizmos.scale.z)/3;this._tbRadius=this.calculateTbRadius(this.object);let e=this._tbRadius/i,n=new Ss(0,0,e,e).getPoints(this._curvePts),r=new nt().setFromPoints(n);for(let o in this._gizmos.children)this._gizmos.children[o].geometry=r;this.dispatchEvent(bi)}function bJ(i){if(this.enabled){for(let e=0;e<this.mouseActions.length;e++)if(this.mouseActions[e].mouse==2){i.preventDefault();break}}}function vJ(){this._touchStart.splice(0,this._touchStart.length),this._touchCurrent.splice(0,this._touchCurrent.length),this._input=Yn.NONE}function yJ(i){if(i.button==0&&i.isPrimary?(this._downValid=!0,this._downEvents.push(i),this._downStart=performance.now()):this._downValid=!1,i.pointerType=="touch"&&this._input!=Yn.CURSOR)switch(this._touchStart.push(i),this._touchCurrent.push(i),this._input){case Yn.NONE:this._input=Yn.ONE_FINGER,this.onSinglePanStart(i,"ROTATE"),window.addEventListener("pointermove",this._onPointerMove),window.addEventListener("pointerup",this._onPointerUp);break;case Yn.ONE_FINGER:case Yn.ONE_FINGER_SWITCHED:this._input=Yn.TWO_FINGER,this.onRotateStart(),this.onPinchStart(),this.onDoublePanStart();break;case Yn.TWO_FINGER:this._input=Yn.MULT_FINGER,this.onTriplePanStart(i);break}else if(i.pointerType!="touch"&&this._input==Yn.NONE){let e=null;i.ctrlKey||i.metaKey?e="CTRL":i.shiftKey&&(e="SHIFT"),this._mouseOp=this.getOpFromAction(i.button,e),this._mouseOp!=null&&(window.addEventListener("pointermove",this._onPointerMove),window.addEventListener("pointerup",this._onPointerUp),this._input=Yn.CURSOR,this._button=i.button,this.onSinglePanStart(i,this._mouseOp))}}function xJ(i){if(i.pointerType=="touch"&&this._input!=Yn.CURSOR)switch(this._input){case Yn.ONE_FINGER:this.updateTouchEvent(i),this.onSinglePanMove(i,St.ROTATE);break;case Yn.ONE_FINGER_SWITCHED:if(this.calculatePointersDistance(this._touchCurrent[0],i)*this._devPxRatio>=this._switchSensibility){this._input=Yn.ONE_FINGER,this.updateTouchEvent(i),this.onSinglePanStart(i,"ROTATE");break}break;case Yn.TWO_FINGER:this.updateTouchEvent(i),this.onRotateMove(),this.onPinchMove(),this.onDoublePanMove();break;case Yn.MULT_FINGER:this.updateTouchEvent(i),this.onTriplePanMove(i);break}else if(i.pointerType!="touch"&&this._input==Yn.CURSOR){let e=null;i.ctrlKey||i.metaKey?e="CTRL":i.shiftKey&&(e="SHIFT");let t=this.getOpStateFromAction(this._button,e);t!=null&&this.onSinglePanMove(i,t)}this._downValid&&this.calculatePointersDistance(this._downEvents[this._downEvents.length-1],i)*this._devPxRatio>this._movementThreshold&&(this._downValid=!1)}function wJ(i){if(i.pointerType=="touch"&&this._input!=Yn.CURSOR){let e=this._touchCurrent.length;for(let t=0;t<e;t++)if(this._touchCurrent[t].pointerId==i.pointerId){this._touchCurrent.splice(t,1),this._touchStart.splice(t,1);break}switch(this._input){case Yn.ONE_FINGER:case Yn.ONE_FINGER_SWITCHED:window.removeEventListener("pointermove",this._onPointerMove),window.removeEventListener("pointerup",this._onPointerUp),this._input=Yn.NONE,this.onSinglePanEnd();break;case Yn.TWO_FINGER:this.onDoublePanEnd(i),this.onPinchEnd(i),this.onRotateEnd(i),this._input=Yn.ONE_FINGER_SWITCHED;break;case Yn.MULT_FINGER:this._touchCurrent.length==0&&(window.removeEventListener("pointermove",this._onPointerMove),window.removeEventListener("pointerup",this._onPointerUp),this._input=Yn.NONE,this.onTriplePanEnd());break}}else i.pointerType!="touch"&&this._input==Yn.CURSOR&&(window.removeEventListener("pointermove",this._onPointerMove),window.removeEventListener("pointerup",this._onPointerUp),this._input=Yn.NONE,this.onSinglePanEnd(),this._button=-1);if(i.isPrimary)if(this._downValid)if(i.timeStamp-this._downEvents[this._downEvents.length-1].timeStamp<=this._maxDownTime)if(this._nclicks==0)this._nclicks=1,this._clickStart=performance.now();else{let t=i.timeStamp-this._clickStart,n=this.calculatePointersDistance(this._downEvents[1],this._downEvents[0])*this._devPxRatio;t<=this._maxInterval&&n<=this._posThreshold?(this._nclicks=0,this._downEvents.splice(0,this._downEvents.length),this.onDoubleTap(i)):(this._nclicks=1,this._downEvents.shift(),this._clickStart=performance.now())}else this._downValid=!1,this._nclicks=0,this._downEvents.splice(0,this._downEvents.length);else this._nclicks=0,this._downEvents.splice(0,this._downEvents.length)}function MJ(i){if(this.enabled&&this.enableZoom){let e=null;i.ctrlKey||i.metaKey?e="CTRL":i.shiftKey&&(e="SHIFT");let t=this.getOpFromAction("WHEEL",e);if(t!=null){i.preventDefault(),this.dispatchEvent(wa);let n=125,r=i.deltaY/n,o=1;switch(r>0?o=1/this.scaleFactor:r<0&&(o=this.scaleFactor),t){case"ZOOM":if(this.updateTbState(St.SCALE,!0),r>0?o=1/Math.pow(this.scaleFactor,r):r<0&&(o=Math.pow(this.scaleFactor,-r)),this.cursorZoom&&this.enablePan){let s;this.object.isOrthographicCamera?s=this.unprojectOnTbPlane(this.object,i.clientX,i.clientY,this.domElement).applyQuaternion(this.object.quaternion).multiplyScalar(1/this.object.zoom).add(this._gizmos.position):this.object.isPerspectiveCamera&&(s=this.unprojectOnTbPlane(this.object,i.clientX,i.clientY,this.domElement).applyQuaternion(this.object.quaternion).add(this._gizmos.position)),this.applyTransformMatrix(this.scale(o,s))}else this.applyTransformMatrix(this.scale(o,this._gizmos.position));this._grid!=null&&(this.disposeGrid(),this.drawGrid()),this.updateTbState(St.IDLE,!1),this.dispatchEvent(bi),this.dispatchEvent(Cs);break;case"FOV":if(this.object.isPerspectiveCamera){this.updateTbState(St.FOV,!0),i.deltaX!=0&&(r=i.deltaX/n,o=1,r>0?o=1/Math.pow(this.scaleFactor,r):r<0&&(o=Math.pow(this.scaleFactor,-r))),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);let s=this._v3_1.distanceTo(this._gizmos.position),a=s/o;a=Ze.clamp(a,this.minDistance,this.maxDistance);let c=s*Math.tan(Ze.DEG2RAD*this.object.fov*.5),l=Ze.RAD2DEG*(Math.atan(c/a)*2);l>this.maxFov?l=this.maxFov:l<this.minFov&&(l=this.minFov);let u=c/Math.tan(Ze.DEG2RAD*(l/2));o=s/u,this.setFov(l),this.applyTransformMatrix(this.scale(o,this._gizmos.position,!1))}this._grid!=null&&(this.disposeGrid(),this.drawGrid()),this.updateTbState(St.IDLE,!1),this.dispatchEvent(bi),this.dispatchEvent(Cs);break}}}}var SJ=["*"],mU=(()=>{let e=class e extends _i{getType(){return QM}set scene(n){this._objRef&&(this._objRef.scene=n)}get scene(){return this._objRef?.scene}set radiusFactor(n){this._objRef&&(this._objRef.radiusFactor=n)}get radiusFactor(){return this._objRef?.radiusFactor}set focusAnimationTime(n){this._objRef&&(this._objRef.focusAnimationTime=n)}get focusAnimationTime(){return this._objRef?.focusAnimationTime}set adjustNearFar(n){this._objRef&&(this._objRef.adjustNearFar=n)}get adjustNearFar(){return this._objRef?.adjustNearFar}set scaleFactor(n){this._objRef&&(this._objRef.scaleFactor=n)}get scaleFactor(){return this._objRef?.scaleFactor}set dampingFactor(n){this._objRef&&(this._objRef.dampingFactor=n)}get dampingFactor(){return this._objRef?.dampingFactor}set wMax(n){this._objRef&&(this._objRef.wMax=n)}get wMax(){return this._objRef?.wMax}set enableAnimations(n){this._objRef&&(this._objRef.enableAnimations=n)}get enableAnimations(){return this._objRef?.enableAnimations}set enableFocus(n){this._objRef&&(this._objRef.enableFocus=n)}get enableFocus(){return this._objRef?.enableFocus}set enableGrid(n){this._objRef&&(this._objRef.enableGrid=n)}get enableGrid(){return this._objRef?.enableGrid}set cursorZoom(n){this._objRef&&(this._objRef.cursorZoom=n)}get cursorZoom(){return this._objRef?.cursorZoom}set rotateSpeed(n){this._objRef&&(this._objRef.rotateSpeed=n)}get rotateSpeed(){return this._objRef?.rotateSpeed}set enablePan(n){this._objRef&&(this._objRef.enablePan=n)}get enablePan(){return this._objRef?.enablePan}set enableRotate(n){this._objRef&&(this._objRef.enableRotate=n)}get enableRotate(){return this._objRef?.enableRotate}set enableZoom(n){this._objRef&&(this._objRef.enableZoom=n)}get enableZoom(){return this._objRef?.enableZoom}set minDistance(n){this._objRef&&(this._objRef.minDistance=n)}get minDistance(){return this._objRef?.minDistance}set maxDistance(n){this._objRef&&(this._objRef.maxDistance=n)}get maxDistance(){return this._objRef?.maxDistance}set minZoom(n){this._objRef&&(this._objRef.minZoom=n)}get minZoom(){return this._objRef?.minZoom}set maxZoom(n){this._objRef&&(this._objRef.maxZoom=n)}get maxZoom(){return this._objRef?.maxZoom}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-arcballControls"]],inputs:{scene:"scene",radiusFactor:"radiusFactor",focusAnimationTime:"focusAnimationTime",adjustNearFar:"adjustNearFar",scaleFactor:"scaleFactor",dampingFactor:"dampingFactor",wMax:"wMax",enableAnimations:"enableAnimations",enableFocus:"enableFocus",enableGrid:"enableGrid",cursorZoom:"cursorZoom",rotateSpeed:"rotateSpeed",enablePan:"enablePan",enableRotate:"enableRotate",enableZoom:"enableZoom",minDistance:"minDistance",maxDistance:"maxDistance",minZoom:"minZoom",maxZoom:"maxZoom"},features:[K([{provide:_i,useExisting:he(()=>e)}]),$],ngContentSelectors:SJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var TJ=["*"],Gt=(()=>{let e=class e extends ol{getType(){return ai}get isPerspectiveCamera(){return this._objRef?.isPerspectiveCamera}get type(){return this._objRef?.type}set zoom(n){this._objRef&&(this._objRef.zoom=n)}get zoom(){return this._objRef?.zoom}set fov(n){this._objRef&&(this._objRef.fov=n)}get fov(){return this._objRef?.fov}set aspect(n){this._objRef&&(this._objRef.aspect=n)}get aspect(){return this._objRef?.aspect}set near(n){this._objRef&&(this._objRef.near=n)}get near(){return this._objRef?.near}set far(n){this._objRef&&(this._objRef.far=n)}get far(){return this._objRef?.far}set focus(n){this._objRef&&(this._objRef.focus=n)}get focus(){return this._objRef?.focus}set view(n){this._objRef&&(this._objRef.view=n)}get view(){return this._objRef?.view}set filmGauge(n){this._objRef&&(this._objRef.filmGauge=n)}get filmGauge(){return this._objRef?.filmGauge}set filmOffset(n){this._objRef&&(this._objRef.filmOffset=n)}get filmOffset(){return this._objRef?.filmOffset}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-perspectiveCamera"]],inputs:{zoom:"zoom",fov:"fov",aspect:"aspect",near:"near",far:"far",focus:"focus",view:"view",filmGauge:"filmGauge",filmOffset:"filmOffset"},features:[K([{provide:de,useExisting:he(()=>e)},{provide:ol,useExisting:he(()=>e)}]),$],ngContentSelectors:TJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var CJ=["*"],$I=(()=>{let e=class e extends de{getType(){return ti}get isLine(){return this._objRef?.isLine}get type(){return this._objRef?.type}set geometry(n){this._objRef&&(this._objRef.geometry=n)}get geometry(){return this._objRef?.geometry}set material(n){this._objRef&&(this._objRef.material=n)}get material(){return this._objRef?.material}set morphTargetInfluences(n){this._objRef&&(this._objRef.morphTargetInfluences=n)}get morphTargetInfluences(){return this._objRef?.morphTargetInfluences}set morphTargetDictionary(n){this._objRef&&(this._objRef.morphTargetDictionary=n)}get morphTargetDictionary(){return this._objRef?.morphTargetDictionary}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-line"]],inputs:{geometry:"geometry",material:"material",morphTargetInfluences:"morphTargetInfluences",morphTargetDictionary:"morphTargetDictionary"},features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:CJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var EJ=["*"],cc=(()=>{let e=class e extends $I{getType(){return Lr}get isLineSegments(){return this._objRef?.isLineSegments}get type(){return this._objRef?.type}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-lineSegments"]],features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:EJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var DJ=["*"],Cn=(()=>{let e=class e extends de{getType(){return Pe}get isMesh(){return this._objRef?.isMesh}get type(){return this._objRef?.type}set geometry(n){this._objRef&&(this._objRef.geometry=n)}get geometry(){return this._objRef?.geometry}set material(n){this._objRef&&(this._objRef.material=n)}get material(){return this._objRef?.material}set morphTargetInfluences(n){this._objRef&&(this._objRef.morphTargetInfluences=n)}get morphTargetInfluences(){return this._objRef?.morphTargetInfluences}set morphTargetDictionary(n){this._objRef&&(this._objRef.morphTargetDictionary=n)}get morphTargetDictionary(){return this._objRef?.morphTargetDictionary}set count(n){this._objRef&&(this._objRef.count=n)}get count(){return this._objRef?.count}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-mesh"]],inputs:{geometry:"geometry",material:"material",morphTargetInfluences:"morphTargetInfluences",morphTargetDictionary:"morphTargetDictionary",count:"count"},features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:DJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var IJ=["*"],gU=(()=>{let e=class e extends cc{getType(){return Ap}get type(){return this._objRef?.type}set box(n){this._objRef&&(this._objRef.box=pe(this._objRef.box,n))}get box(){return this._objRef?.box}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-box3Helper"]],inputs:{box:"box"},features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:IJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var _U=(()=>{let e=class e extends bo{constructor(){super(...arguments),this.parent=S(de)}addToParent(){this.parent.objRef&&(this.parent.objRef.geometry=this.objRef,this.parent.objRef.updateMorphTargets&&this.parent.objRef.updateMorphTargets())}removeFromParent(){this._objRef&&this.parent&&this.parent.objRef&&(this.parent.objRef.geometry=void 0)}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-abs-geometry"]],features:[$],decls:0,vars:0,template:function(r,o){},encapsulation:2,changeDetection:0});let i=e;return i})();var AJ=["*"],Kt=(()=>{let e=class e extends _U{constructor(){super(...arguments),this.parent=S(de,{skipSelf:!0})}getType(){return nt}set id(n){this._objRef&&(this._objRef.id=n)}get id(){return this._objRef?.id}set uuid(n){this._objRef&&(this._objRef.uuid=n)}get uuid(){return this._objRef?.uuid}set name(n){this._objRef&&(this._objRef.name=n)}get name(){return this._objRef?.name}get type(){return this._objRef?.type}set index(n){this._objRef&&(this._objRef.index=pe(this._objRef.index,n))}get index(){return this._objRef?.index}set indirect(n){this._objRef&&(this._objRef.indirect=pe(this._objRef.indirect,n))}get indirect(){return this._objRef?.indirect}set indirectOffset(n){this._objRef&&(this._objRef.indirectOffset=n)}get indirectOffset(){return this._objRef?.indirectOffset}set attributes(n){this._objRef&&(this._objRef.attributes=n)}get attributes(){return this._objRef?.attributes}set morphAttributes(n){this._objRef&&(this._objRef.morphAttributes=n)}get morphAttributes(){return this._objRef?.morphAttributes}set morphTargetsRelative(n){this._objRef&&(this._objRef.morphTargetsRelative=n)}get morphTargetsRelative(){return this._objRef?.morphTargetsRelative}set groups(n){this._objRef&&(this._objRef.groups=n)}get groups(){return this._objRef?.groups}set boundingBox(n){this._objRef&&(this._objRef.boundingBox=pe(this._objRef.boundingBox,n))}get boundingBox(){return this._objRef?.boundingBox}set boundingSphere(n){this._objRef&&(this._objRef.boundingSphere=pe(this._objRef.boundingSphere,n))}get boundingSphere(){return this._objRef?.boundingSphere}set drawRange(n){this._objRef&&(this._objRef.drawRange=n)}get drawRange(){return this._objRef?.drawRange}set userData(n){this._objRef&&(this._objRef.userData=n)}get userData(){return this._objRef?.userData}get isBufferGeometry(){return this._objRef?.isBufferGeometry}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-bufferGeometry"]],inputs:{id:"id",uuid:"uuid",name:"name",index:"index",indirect:"indirect",indirectOffset:"indirectOffset",attributes:"attributes",morphAttributes:"morphAttributes",morphTargetsRelative:"morphTargetsRelative",groups:"groups",boundingBox:"boundingBox",boundingSphere:"boundingSphere",drawRange:"drawRange",userData:"userData"},features:[K([]),$],ngContentSelectors:AJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var FJ=["*"],cl=(()=>{let e=class e extends Kt{getType(){return ei}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-boxGeometry"]],features:[K([{provide:Kt,useExisting:he(()=>e)}]),$],ngContentSelectors:FJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var Kr=(()=>{let e=class e extends bo{};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-abs-texture"]],features:[$],decls:0,vars:0,template:function(r,o){},encapsulation:2,changeDetection:0});let i=e;return i})();var NJ=["*"],Ma=class Ma extends Kr{getType(){return Ii}get isTexture(){return this._objRef?.isTexture}get id(){return this._objRef?.id}set uuid(e){this._objRef&&(this._objRef.uuid=e)}get uuid(){return this._objRef?.uuid}set name(e){this._objRef&&(this._objRef.name=e)}get name(){return this._objRef?.name}set source(e){this._objRef&&(this._objRef.source=e)}get source(){return this._objRef?.source}get width(){return this._objRef?.width}get height(){return this._objRef?.height}get depth(){return this._objRef?.depth}get image(){return this._objRef?.image}set image(e){this._objRef&&(this._objRef.image=e)}set mipmaps(e){this._objRef&&(this._objRef.mipmaps=e)}get mipmaps(){return this._objRef?.mipmaps}set mapping(e){this._objRef&&(this._objRef.mapping=e)}get mapping(){return this._objRef?.mapping}set channel(e){this._objRef&&(this._objRef.channel=e)}get channel(){return this._objRef?.channel}set wrapS(e){this._objRef&&(this._objRef.wrapS=e)}get wrapS(){return this._objRef?.wrapS}set wrapT(e){this._objRef&&(this._objRef.wrapT=e)}get wrapT(){return this._objRef?.wrapT}set magFilter(e){this._objRef&&(this._objRef.magFilter=e)}get magFilter(){return this._objRef?.magFilter}set minFilter(e){this._objRef&&(this._objRef.minFilter=e)}get minFilter(){return this._objRef?.minFilter}set anisotropy(e){this._objRef&&(this._objRef.anisotropy=e)}get anisotropy(){return this._objRef?.anisotropy}set format(e){this._objRef&&(this._objRef.format=e)}get format(){return this._objRef?.format}set type(e){this._objRef&&(this._objRef.type=e)}get type(){return this._objRef?.type}set internalFormat(e){this._objRef&&(this._objRef.internalFormat=e)}get internalFormat(){return this._objRef?.internalFormat}set matrix(e){this._objRef&&(this._objRef.matrix=pe(this._objRef.matrix,e))}get matrix(){return this._objRef?.matrix}set matrixAutoUpdate(e){this._objRef&&(this._objRef.matrixAutoUpdate=e)}get matrixAutoUpdate(){return this._objRef?.matrixAutoUpdate}set offset(e){this._objRef&&(this._objRef.offset=pe(this._objRef.offset,e))}get offset(){return this._objRef?.offset}set repeat(e){this._objRef&&(this._objRef.repeat=pe(this._objRef.repeat,e))}get repeat(){return this._objRef?.repeat}set center(e){this._objRef&&(this._objRef.center=pe(this._objRef.center,e))}get center(){return this._objRef?.center}set rotation(e){this._objRef&&(this._objRef.rotation=e)}get rotation(){return this._objRef?.rotation}set generateMipmaps(e){this._objRef&&(this._objRef.generateMipmaps=e)}get generateMipmaps(){return this._objRef?.generateMipmaps}set premultiplyAlpha(e){this._objRef&&(this._objRef.premultiplyAlpha=e)}get premultiplyAlpha(){return this._objRef?.premultiplyAlpha}set flipY(e){this._objRef&&(this._objRef.flipY=e)}get flipY(){return this._objRef?.flipY}set unpackAlignment(e){this._objRef&&(this._objRef.unpackAlignment=e)}get unpackAlignment(){return this._objRef?.unpackAlignment}set colorSpace(e){this._objRef&&(this._objRef.colorSpace=e)}get colorSpace(){return this._objRef?.colorSpace}set isRenderTargetTexture(e){this._objRef&&(this._objRef.isRenderTargetTexture=e)}get isRenderTargetTexture(){return this._objRef?.isRenderTargetTexture}set isArrayTexture(e){this._objRef&&(this._objRef.isArrayTexture=e)}get isArrayTexture(){return this._objRef?.isArrayTexture}set userData(e){this._objRef&&(this._objRef.userData=e)}get userData(){return this._objRef?.userData}set updateRanges(e){this._objRef&&(this._objRef.updateRanges=e)}get updateRanges(){return this._objRef?.updateRanges}set version(e){this._objRef&&(this._objRef.version=e)}get version(){return this._objRef?.version}set pmremVersion(e){this._objRef&&(this._objRef.pmremVersion=e)}get pmremVersion(){return this._objRef?.pmremVersion}set needsUpdate(e){this._objRef&&(this._objRef.needsUpdate=e)}set needsPMREMUpdate(e){this._objRef&&(this._objRef.needsPMREMUpdate=e)}set renderTarget(e){this._objRef&&(this._objRef.renderTarget=e)}get renderTarget(){return this._objRef?.renderTarget}};Ma.DEFAULT_ANISOTROPY=Ii.DEFAULT_ANISOTROPY,Ma.DEFAULT_IMAGE=Ii.DEFAULT_IMAGE,Ma.DEFAULT_MAPPING=Ii.DEFAULT_MAPPING,Ma.\u0275fac=(()=>{let e;return function(n){return(e||(e=q(Ma)))(n||Ma)}})(),Ma.\u0275cmp=O({type:Ma,selectors:[["th-texture"]],inputs:{uuid:"uuid",name:"name",source:"source",image:"image",mipmaps:"mipmaps",mapping:"mapping",channel:"channel",wrapS:"wrapS",wrapT:"wrapT",magFilter:"magFilter",minFilter:"minFilter",anisotropy:"anisotropy",format:"format",type:"type",internalFormat:"internalFormat",matrix:"matrix",matrixAutoUpdate:"matrixAutoUpdate",offset:"offset",repeat:"repeat",center:"center",rotation:"rotation",generateMipmaps:"generateMipmaps",premultiplyAlpha:"premultiplyAlpha",flipY:"flipY",unpackAlignment:"unpackAlignment",colorSpace:"colorSpace",isRenderTargetTexture:"isRenderTargetTexture",isArrayTexture:"isArrayTexture",userData:"userData",updateRanges:"updateRanges",version:"version",pmremVersion:"pmremVersion",needsUpdate:"needsUpdate",needsPMREMUpdate:"needsPMREMUpdate",renderTarget:"renderTarget"},features:[K([{provide:Kr,useExisting:he(()=>Ma)}]),$],ngContentSelectors:NJ,decls:1,vars:0,template:function(t,n){t&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});var vo=Ma;var jJ=["*"],XI=(()=>{let e=class e extends Kt{getType(){return Oi}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-cylinderGeometry"]],features:[K([{provide:Kt,useExisting:he(()=>e)}]),$],ngContentSelectors:jJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var LJ=["*"],Pr=(()=>{let e=class e extends ya{getType(){return Yc}get isDirectionalLight(){return this._objRef?.isDirectionalLight}get type(){return this._objRef?.type}set castShadow(n){this._objRef&&(this._objRef.castShadow=n)}get castShadow(){return this._objRef?.castShadow}set position(n){this._objRef&&pe(this._objRef.position,n)}get position(){return this._objRef?.position}set shadow(n){this._objRef&&(this._objRef.shadow=n)}get shadow(){return this._objRef?.shadow}set target(n){this._objRef&&(this._objRef.target=n)}get target(){return this._objRef?.target}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-directionalLight"]],inputs:{castShadow:"castShadow",position:"position",shadow:"shadow",target:"target"},features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:LJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var kJ=["*"],gv=(()=>{let e=class e extends Kt{getType(){return aa}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-polyhedronGeometry"]],features:[K([{provide:Kt,useExisting:he(()=>e)}]),$],ngContentSelectors:kJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var JM={name:"DotScreenShader",uniforms:{tDiffuse:{value:null},tSize:{value:new z(256,256)},center:{value:new z(.5,.5)},angle:{value:1.57},scale:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform vec2 center;
		uniform float angle;
		uniform float scale;
		uniform vec2 tSize;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		float pattern() {

			float s = sin( angle ), c = cos( angle );

			vec2 tex = vUv * tSize - center;
			vec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;

			return ( sin( point.x ) * sin( point.y ) ) * 4.0;

		}

		void main() {

			vec4 color = texture2D( tDiffuse, vUv );

			float average = ( color.r + color.g + color.b ) / 3.0;

			gl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );

		}`};var Jp=new Xi,ll=new z,bU=new C,ZI=new z,eS=new z,tS=new C,YI=new C,vU=new Ee,yU=new C,xU=new C,Jr=null,lc=null,ul=[],Tu={NONE:-1,PAN:0,ROTATE:1},nS=class extends Ir{constructor(e,t,n=null){super(t,n),this.objects=e,this.recursive=!0,this.transformGroup=!1,this.rotateSpeed=1,this.raycaster=new Dr,this.mouseButtons={LEFT:gi.PAN,MIDDLE:gi.PAN,RIGHT:gi.ROTATE},this.touches={ONE:$r.PAN},this._onPointerMove=BJ.bind(this),this._onPointerDown=UJ.bind(this),this._onPointerCancel=VJ.bind(this),this._onContextMenu=zJ.bind(this),n!==null&&this.connect(n)}connect(e){super.connect(e),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerCancel),this.domElement.addEventListener("pointerleave",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerCancel),this.domElement.removeEventListener("pointerleave",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto",this.domElement.style.cursor=""}dispose(){this.disconnect()}_updatePointer(e){let t=this.domElement.getBoundingClientRect();ll.x=(e.clientX-t.left)/t.width*2-1,ll.y=-(e.clientY-t.top)/t.height*2+1}_updateState(e){let t;if(e.pointerType==="touch")t=this.touches.ONE;else switch(e.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=null}switch(t){case gi.PAN:case $r.PAN:this.state=Tu.PAN;break;case gi.ROTATE:case $r.ROTATE:this.state=Tu.ROTATE;break;default:this.state=Tu.NONE}}};function BJ(i){let e=this.object,t=this.domElement,n=this.raycaster;if(this.enabled!==!1){if(this._updatePointer(i),n.setFromCamera(ll,e),Jr)this.state===Tu.PAN?n.ray.intersectPlane(Jp,tS)&&(Jr.position.copy(tS.sub(bU).applyMatrix4(vU)),this.dispatchEvent({type:"drag",object:Jr})):this.state===Tu.ROTATE&&(ZI.subVectors(ll,eS).multiplyScalar(this.rotateSpeed),Jr.rotateOnWorldAxis(yU,ZI.x),Jr.rotateOnWorldAxis(xU.normalize(),-ZI.y),this.dispatchEvent({type:"drag",object:Jr})),eS.copy(ll);else if(i.pointerType==="mouse"||i.pointerType==="pen")if(ul.length=0,n.setFromCamera(ll,e),n.intersectObjects(this.objects,this.recursive,ul),ul.length>0){let r=ul[0].object;Jp.setFromNormalAndCoplanarPoint(e.getWorldDirection(Jp.normal),YI.setFromMatrixPosition(r.matrixWorld)),lc!==r&&lc!==null&&(this.dispatchEvent({type:"hoveroff",object:lc}),t.style.cursor="auto",lc=null),lc!==r&&(this.dispatchEvent({type:"hoveron",object:r}),t.style.cursor="pointer",lc=r)}else lc!==null&&(this.dispatchEvent({type:"hoveroff",object:lc}),t.style.cursor="auto",lc=null);eS.copy(ll)}}function UJ(i){let e=this.object,t=this.domElement,n=this.raycaster;this.enabled!==!1&&(this._updatePointer(i),this._updateState(i),ul.length=0,n.setFromCamera(ll,e),n.intersectObjects(this.objects,this.recursive,ul),ul.length>0&&(this.transformGroup===!0?Jr=wU(ul[0].object):Jr=ul[0].object,Jp.setFromNormalAndCoplanarPoint(e.getWorldDirection(Jp.normal),YI.setFromMatrixPosition(Jr.matrixWorld)),n.ray.intersectPlane(Jp,tS)&&(this.state===Tu.PAN?(vU.copy(Jr.parent.matrixWorld).invert(),bU.copy(tS).sub(YI.setFromMatrixPosition(Jr.matrixWorld)),t.style.cursor="move",this.dispatchEvent({type:"dragstart",object:Jr})):this.state===Tu.ROTATE&&(yU.set(0,1,0).applyQuaternion(e.quaternion).normalize(),xU.set(1,0,0).applyQuaternion(e.quaternion).normalize(),t.style.cursor="move",this.dispatchEvent({type:"dragstart",object:Jr})))),eS.copy(ll))}function VJ(){this.enabled!==!1&&(Jr&&(this.dispatchEvent({type:"dragend",object:Jr}),Jr=null),this.domElement.style.cursor=lc?"pointer":"auto",this.state=Tu.NONE)}function zJ(i){this.enabled!==!1&&i.preventDefault()}function wU(i,e=null){return i.isGroup&&(e=i),i.parent===null?e:wU(i.parent,e)}var HJ=["*"],MU=(()=>{let e=class e extends _i{getType(){return nS}set objects(n){this._objRef&&(this._objRef.objects=n)}get objects(){return this._objRef?.objects}set recursive(n){this._objRef&&(this._objRef.recursive=n)}get recursive(){return this._objRef?.recursive}set transformGroup(n){this._objRef&&(this._objRef.transformGroup=n)}get transformGroup(){return this._objRef?.transformGroup}set rotateSpeed(n){this._objRef&&(this._objRef.rotateSpeed=n)}get rotateSpeed(){return this._objRef?.rotateSpeed}set raycaster(n){this._objRef&&(this._objRef.raycaster=pe(this._objRef.raycaster,n))}get raycaster(){return this._objRef?.raycaster}set mouseButtons(n){this._objRef&&(this._objRef.mouseButtons=n)}get mouseButtons(){return this._objRef?.mouseButtons}set touches(n){this._objRef&&(this._objRef.touches=n)}get touches(){return this._objRef?.touches}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-dragControls"]],inputs:{objects:"objects",recursive:"recursive",transformGroup:"transformGroup",rotateSpeed:"rotateSpeed",raycaster:"raycaster",mouseButtons:"mouseButtons",touches:"touches"},features:[K([{provide:_i,useExisting:he(()=>e)}]),$],ngContentSelectors:HJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var SU={name:"FilmShader",uniforms:{tDiffuse:{value:null},time:{value:0},intensity:{value:.5},grayscale:{value:!1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		#include <common>

		uniform float intensity;
		uniform bool grayscale;
		uniform float time;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 base = texture2D( tDiffuse, vUv );

			float noise = rand( fract( vUv + time ) );

			vec3 color = base.rgb + base.rgb * clamp( 0.1 + noise, 0.0, 1.0 );

			color = mix( base.rgb, color, intensity );

			if ( grayscale ) {

				color = vec3( luminance( color ) ); // assuming linear-srgb

			}

			gl_FragColor = vec4( color, base.a );

		}`};var iS=class extends Si{constructor(e=.5,t=!1){super();let n=SU;this.uniforms=Hn.clone(n.uniforms),this.material=new Nt({name:n.name,uniforms:this.uniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader}),this.uniforms.intensity.value=e,this.uniforms.grayscale.value=t,this._fsQuad=new Ar(this.material)}render(e,t,n,r){this.uniforms.tDiffuse.value=n.texture,this.uniforms.time.value+=r,this.renderToScreen?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this._fsQuad.render(e))}dispose(){this.material.dispose(),this._fsQuad.dispose()}};var WJ=["*"],RU=(()=>{let e=class e extends Ln{getType(){return iS}set uniforms(n){this._objRef&&Object.assign(this._objRef.uniforms,n)}get uniforms(){return this._objRef?.uniforms}set material(n){this._objRef&&(this._objRef.material=n)}get material(){return this._objRef?.material}set fsQuad(n){this._objRef&&(this._objRef.fsQuad=n)}get fsQuad(){return this._objRef?.fsQuad}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-filmPass"]],inputs:{uniforms:"uniforms",material:"material",fsQuad:"fsQuad"},features:[K([{provide:gn,useExisting:he(()=>e)}]),$],ngContentSelectors:WJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var TU=new C,QI=new Qc,KI=new C,CU=new C,rS=class extends Ir{constructor(e,t=null){super(e,t),this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.mouseDragOn=!1,this._autoSpeedFactor=0,this._pointerX=0,this._pointerY=0,this._moveForward=!1,this._moveBackward=!1,this._moveLeft=!1,this._moveRight=!1,this._viewHalfX=0,this._viewHalfY=0,this._lat=0,this._lon=0,this._onPointerMove=ZJ.bind(this),this._onPointerDown=qJ.bind(this),this._onPointerUp=XJ.bind(this),this._onContextMenu=KJ.bind(this),this._onKeyDown=YJ.bind(this),this._onKeyUp=QJ.bind(this),t!==null&&(this.connect(t),this.handleResize()),this._setOrientation()}connect(e){super.connect(e),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu)}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("contextmenu",this._onContextMenu)}dispose(){this.disconnect()}handleResize(){this.domElement===document?(this._viewHalfX=window.innerWidth/2,this._viewHalfY=window.innerHeight/2):(this._viewHalfX=this.domElement.offsetWidth/2,this._viewHalfY=this.domElement.offsetHeight/2)}lookAt(e,t,n){return e.isVector3?KI.copy(e):KI.set(e,t,n),this.object.lookAt(KI),this._setOrientation(),this}update(e){if(this.enabled===!1)return;if(this.heightSpeed){let l=Ze.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this._autoSpeedFactor=e*(l*this.heightCoef)}else this._autoSpeedFactor=0;let t=e*this.movementSpeed;(this._moveForward||this.autoForward&&!this._moveBackward)&&this.object.translateZ(-(t+this._autoSpeedFactor)),this._moveBackward&&this.object.translateZ(t),this._moveLeft&&this.object.translateX(-t),this._moveRight&&this.object.translateX(t),this._moveUp&&this.object.translateY(t),this._moveDown&&this.object.translateY(-t);let n=e*this.lookSpeed;this.activeLook||(n=0);let r=1;this.constrainVertical&&(r=Math.PI/(this.verticalMax-this.verticalMin)),this._lon-=this._pointerX*n,this.lookVertical&&(this._lat-=this._pointerY*n*r),this._lat=Math.max(-85,Math.min(85,this._lat));let o=Ze.degToRad(90-this._lat),s=Ze.degToRad(this._lon);this.constrainVertical&&(o=Ze.mapLinear(o,0,Math.PI,this.verticalMin,this.verticalMax));let a=this.object.position;CU.setFromSphericalCoords(1,o,s).add(a),this.object.lookAt(CU)}_setOrientation(){let e=this.object.quaternion;TU.set(0,0,-1).applyQuaternion(e),QI.setFromVector3(TU),this._lat=90-Ze.radToDeg(QI.phi),this._lon=Ze.radToDeg(QI.theta)}};function qJ(i){if(this.domElement!==document&&this.domElement.focus(),this.activeLook)switch(i.button){case 0:this._moveForward=!0;break;case 2:this._moveBackward=!0;break}this.mouseDragOn=!0}function XJ(i){if(this.activeLook)switch(i.button){case 0:this._moveForward=!1;break;case 2:this._moveBackward=!1;break}this.mouseDragOn=!1}function ZJ(i){this.domElement===document?(this._pointerX=i.pageX-this._viewHalfX,this._pointerY=i.pageY-this._viewHalfY):(this._pointerX=i.pageX-this.domElement.offsetLeft-this._viewHalfX,this._pointerY=i.pageY-this.domElement.offsetTop-this._viewHalfY)}function YJ(i){switch(i.code){case"ArrowUp":case"KeyW":this._moveForward=!0;break;case"ArrowLeft":case"KeyA":this._moveLeft=!0;break;case"ArrowDown":case"KeyS":this._moveBackward=!0;break;case"ArrowRight":case"KeyD":this._moveRight=!0;break;case"KeyR":this._moveUp=!0;break;case"KeyF":this._moveDown=!0;break}}function QJ(i){switch(i.code){case"ArrowUp":case"KeyW":this._moveForward=!1;break;case"ArrowLeft":case"KeyA":this._moveLeft=!1;break;case"ArrowDown":case"KeyS":this._moveBackward=!1;break;case"ArrowRight":case"KeyD":this._moveRight=!1;break;case"KeyR":this._moveUp=!1;break;case"KeyF":this._moveDown=!1;break}}function KJ(i){this.enabled!==!1&&i.preventDefault()}var JJ=["*"],EU=(()=>{let e=class e extends _i{getType(){return rS}set movementSpeed(n){this._objRef&&(this._objRef.movementSpeed=n)}get movementSpeed(){return this._objRef?.movementSpeed}set lookSpeed(n){this._objRef&&(this._objRef.lookSpeed=n)}get lookSpeed(){return this._objRef?.lookSpeed}set lookVertical(n){this._objRef&&(this._objRef.lookVertical=n)}get lookVertical(){return this._objRef?.lookVertical}set autoForward(n){this._objRef&&(this._objRef.autoForward=n)}get autoForward(){return this._objRef?.autoForward}set activeLook(n){this._objRef&&(this._objRef.activeLook=n)}get activeLook(){return this._objRef?.activeLook}set heightSpeed(n){this._objRef&&(this._objRef.heightSpeed=n)}get heightSpeed(){return this._objRef?.heightSpeed}set heightCoef(n){this._objRef&&(this._objRef.heightCoef=n)}get heightCoef(){return this._objRef?.heightCoef}set heightMin(n){this._objRef&&(this._objRef.heightMin=n)}get heightMin(){return this._objRef?.heightMin}set heightMax(n){this._objRef&&(this._objRef.heightMax=n)}get heightMax(){return this._objRef?.heightMax}set constrainVertical(n){this._objRef&&(this._objRef.constrainVertical=n)}get constrainVertical(){return this._objRef?.constrainVertical}set verticalMin(n){this._objRef&&(this._objRef.verticalMin=n)}get verticalMin(){return this._objRef?.verticalMin}set verticalMax(n){this._objRef&&(this._objRef.verticalMax=n)}get verticalMax(){return this._objRef?.verticalMax}set mouseDragOn(n){this._objRef&&(this._objRef.mouseDragOn=n)}get mouseDragOn(){return this._objRef?.mouseDragOn}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-firstPersonControls"]],inputs:{movementSpeed:"movementSpeed",lookSpeed:"lookSpeed",lookVertical:"lookVertical",autoForward:"autoForward",activeLook:"activeLook",heightSpeed:"heightSpeed",heightCoef:"heightCoef",heightMin:"heightMin",heightMax:"heightMax",constrainVertical:"constrainVertical",verticalMin:"verticalMin",verticalMax:"verticalMax",mouseDragOn:"mouseDragOn"},features:[K([{provide:_i,useExisting:he(()=>e)}]),$],ngContentSelectors:JJ,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var tee={type:"change"},DU=1e-6,IU=new nn,oS=class extends Ir{constructor(e,t=null){super(e,t),this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1,this._moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this._moveVector=new C(0,0,0),this._rotationVector=new C(0,0,0),this._lastQuaternion=new nn,this._lastPosition=new C,this._status=0,this._onKeyDown=nee.bind(this),this._onKeyUp=iee.bind(this),this._onPointerMove=oee.bind(this),this._onPointerDown=ree.bind(this),this._onPointerUp=see.bind(this),this._onPointerCancel=aee.bind(this),this._onContextMenu=cee.bind(this),t!==null&&this.connect(t)}connect(e){super.connect(e),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("contextmenu",this._onContextMenu)}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("contextmenu",this._onContextMenu)}dispose(){this.disconnect()}update(e){if(this.enabled===!1)return;let t=this.object,n=e*this.movementSpeed,r=e*this.rollSpeed;t.translateX(this._moveVector.x*n),t.translateY(this._moveVector.y*n),t.translateZ(this._moveVector.z*n),IU.set(this._rotationVector.x*r,this._rotationVector.y*r,this._rotationVector.z*r,1).normalize(),t.quaternion.multiply(IU),(this._lastPosition.distanceToSquared(t.position)>DU||8*(1-this._lastQuaternion.dot(t.quaternion))>DU)&&(this.dispatchEvent(tee),this._lastQuaternion.copy(t.quaternion),this._lastPosition.copy(t.position))}_updateMovementVector(){let e=this._moveState.forward||this.autoForward&&!this._moveState.back?1:0;this._moveVector.x=-this._moveState.left+this._moveState.right,this._moveVector.y=-this._moveState.down+this._moveState.up,this._moveVector.z=-e+this._moveState.back}_updateRotationVector(){this._rotationVector.x=-this._moveState.pitchDown+this._moveState.pitchUp,this._rotationVector.y=-this._moveState.yawRight+this._moveState.yawLeft,this._rotationVector.z=-this._moveState.rollRight+this._moveState.rollLeft}_getContainerDimensions(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}}};function nee(i){if(!(i.altKey||this.enabled===!1)){switch(i.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this._moveState.forward=1;break;case"KeyS":this._moveState.back=1;break;case"KeyA":this._moveState.left=1;break;case"KeyD":this._moveState.right=1;break;case"KeyR":this._moveState.up=1;break;case"KeyF":this._moveState.down=1;break;case"ArrowUp":this._moveState.pitchUp=1;break;case"ArrowDown":this._moveState.pitchDown=1;break;case"ArrowLeft":this._moveState.yawLeft=1;break;case"ArrowRight":this._moveState.yawRight=1;break;case"KeyQ":this._moveState.rollLeft=1;break;case"KeyE":this._moveState.rollRight=1;break}this._updateMovementVector(),this._updateRotationVector()}}function iee(i){if(this.enabled!==!1){switch(i.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this._moveState.forward=0;break;case"KeyS":this._moveState.back=0;break;case"KeyA":this._moveState.left=0;break;case"KeyD":this._moveState.right=0;break;case"KeyR":this._moveState.up=0;break;case"KeyF":this._moveState.down=0;break;case"ArrowUp":this._moveState.pitchUp=0;break;case"ArrowDown":this._moveState.pitchDown=0;break;case"ArrowLeft":this._moveState.yawLeft=0;break;case"ArrowRight":this._moveState.yawRight=0;break;case"KeyQ":this._moveState.rollLeft=0;break;case"KeyE":this._moveState.rollRight=0;break}this._updateMovementVector(),this._updateRotationVector()}}function ree(i){if(this.enabled!==!1)if(this.dragToLook)this._status++;else{switch(i.button){case 0:this._moveState.forward=1;break;case 2:this._moveState.back=1;break}this._updateMovementVector()}}function oee(i){if(this.enabled!==!1&&(!this.dragToLook||this._status>0)){let e=this._getContainerDimensions(),t=e.size[0]/2,n=e.size[1]/2;this._moveState.yawLeft=-(i.pageX-e.offset[0]-t)/t,this._moveState.pitchDown=(i.pageY-e.offset[1]-n)/n,this._updateRotationVector()}}function see(i){if(this.enabled!==!1){if(this.dragToLook)this._status--,this._moveState.yawLeft=this._moveState.pitchDown=0;else{switch(i.button){case 0:this._moveState.forward=0;break;case 2:this._moveState.back=0;break}this._updateMovementVector()}this._updateRotationVector()}}function aee(){this.enabled!==!1&&(this.dragToLook?(this._status=0,this._moveState.yawLeft=this._moveState.pitchDown=0):(this._moveState.forward=0,this._moveState.back=0,this._updateMovementVector()),this._updateRotationVector())}function cee(i){this.enabled!==!1&&i.preventDefault()}var lee=["*"],AU=(()=>{let e=class e extends _i{getType(){return oS}set movementSpeed(n){this._objRef&&(this._objRef.movementSpeed=n)}get movementSpeed(){return this._objRef?.movementSpeed}set rollSpeed(n){this._objRef&&(this._objRef.rollSpeed=n)}get rollSpeed(){return this._objRef?.rollSpeed}set dragToLook(n){this._objRef&&(this._objRef.dragToLook=n)}get dragToLook(){return this._objRef?.dragToLook}set autoForward(n){this._objRef&&(this._objRef.autoForward=n)}get autoForward(){return this._objRef?.autoForward}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-flyControls"]],inputs:{movementSpeed:"movementSpeed",rollSpeed:"rollSpeed",dragToLook:"dragToLook",autoForward:"autoForward"},features:[K([{provide:_i,useExisting:he(()=>e)}]),$],ngContentSelectors:lee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var sS={name:"DigitalGlitch",uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:`

		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`

		uniform int byp; //should we apply the glitch ?

		uniform sampler2D tDiffuse;
		uniform sampler2D tDisp;

		uniform float amount;
		uniform float angle;
		uniform float seed;
		uniform float seed_x;
		uniform float seed_y;
		uniform float distortion_x;
		uniform float distortion_y;
		uniform float col_s;

		varying vec2 vUv;


		float rand(vec2 co){
			return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
		}

		void main() {
			if(byp<1) {
				vec2 p = vUv;
				float xs = floor(gl_FragCoord.x / 0.5);
				float ys = floor(gl_FragCoord.y / 0.5);
				//based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch
				float disp = texture2D(tDisp, p*seed*seed).r;
				if(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {
					if(seed_x>0.){
						p.y = 1. - (p.y + distortion_y);
					}
					else {
						p.y = distortion_y;
					}
				}
				if(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {
					if(seed_y>0.){
						p.x=distortion_x;
					}
					else {
						p.x = 1. - (p.x + distortion_x);
					}
				}
				p.x+=disp*seed_x*(seed/5.);
				p.y+=disp*seed_y*(seed/5.);
				//base from RGB shift shader
				vec2 offset = amount * vec2( cos(angle), sin(angle));
				vec4 cr = texture2D(tDiffuse, p + offset);
				vec4 cga = texture2D(tDiffuse, p);
				vec4 cb = texture2D(tDiffuse, p - offset);
				gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);
				//add noise
				vec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);
				gl_FragColor = gl_FragColor+ snow;
			}
			else {
				gl_FragColor=texture2D (tDiffuse, vUv);
			}
		}`};var aS=class extends Si{constructor(e=64){super(),this.uniforms=Hn.clone(sS.uniforms),this.material=new Nt({uniforms:this.uniforms,vertexShader:sS.vertexShader,fragmentShader:sS.fragmentShader}),this.goWild=!1,this._heightMap=this._generateHeightmap(e),this.uniforms.tDisp.value=this._heightMap,this._fsQuad=new Ar(this.material),this._curF=0,this._randX=0,this._generateTrigger()}render(e,t,n){this.uniforms.tDiffuse.value=n.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this._curF%this._randX==0||this.goWild==!0?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=Ze.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=Ze.randFloat(-1,1),this.uniforms.seed_y.value=Ze.randFloat(-1,1),this.uniforms.distortion_x.value=Ze.randFloat(0,1),this.uniforms.distortion_y.value=Ze.randFloat(0,1),this._curF=0,this._generateTrigger()):this._curF%this._randX<this._randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=Ze.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=Ze.randFloat(0,1),this.uniforms.distortion_y.value=Ze.randFloat(0,1),this.uniforms.seed_x.value=Ze.randFloat(-.3,.3),this.uniforms.seed_y.value=Ze.randFloat(-.3,.3)):this.goWild==!1&&(this.uniforms.byp.value=1),this._curF++,this.renderToScreen?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this._fsQuad.render(e))}dispose(){this.material.dispose(),this._heightMap.dispose(),this._fsQuad.dispose()}_generateTrigger(){this._randX=Ze.randInt(120,240)}_generateHeightmap(e){let t=new Float32Array(e*e),n=e*e;for(let o=0;o<n;o++){let s=Ze.randFloat(0,1);t[o]=s}let r=new Cr(t,e,e,nl,tr);return r.needsUpdate=!0,r}};var dee=["*"],PU=(()=>{let e=class e extends Ln{getType(){return aS}set uniforms(n){this._objRef&&Object.assign(this._objRef.uniforms,n)}get uniforms(){return this._objRef?.uniforms}set material(n){this._objRef&&(this._objRef.material=n)}get material(){return this._objRef?.material}set fsQuad(n){this._objRef&&(this._objRef.fsQuad=n)}get fsQuad(){return this._objRef?.fsQuad}set goWild(n){this._objRef&&(this._objRef.goWild=n)}get goWild(){return this._objRef?.goWild}set curF(n){this._objRef&&(this._objRef.curF=n)}get curF(){return this._objRef?.curF}set randX(n){this._objRef&&(this._objRef.randX=n)}get randX(){return this._objRef?.randX}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-glitchPass"]],inputs:{uniforms:"uniforms",material:"material",fsQuad:"fsQuad",goWild:"goWild",curF:"curF",randX:"randX"},features:[K([{provide:gn,useExisting:he(()=>e)}]),$],ngContentSelectors:dee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var fee=["*"],dr=(()=>{let e=class e extends cc{getType(){return fu}get type(){return this._objRef?.type}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-gridHelper"]],features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:fee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var pee=["*"],uc=(()=>{let e=class e extends de{getType(){return Or}get isGroup(){return this._objRef?.isGroup}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-group"]],features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:pee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var mee=["*"],em=(()=>{let e=class e extends ya{getType(){return hh}get isHemisphereLight(){return this._objRef?.isHemisphereLight}get type(){return this._objRef?.type}set position(n){this._objRef&&pe(this._objRef.position,n)}get position(){return this._objRef?.position}set color(n){this._objRef&&(this._objRef.color=pe(this._objRef.color,n))}get color(){return this._objRef?.color}set groundColor(n){this._objRef&&(this._objRef.groundColor=pe(this._objRef.groundColor,n))}get groundColor(){return this._objRef?.groundColor}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-hemisphereLight"]],inputs:{position:"position",color:"color",groundColor:"groundColor"},features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:mee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var gee=["*"],FU=(()=>{let e=class e extends gv{getType(){return uh}get type(){return this._objRef?.type}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-icosahedronGeometry"]],features:[K([{provide:Kt,useExisting:he(()=>e)}]),$],ngContentSelectors:gee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var bee=["*"],NU=(()=>{let e=class e extends Cn{getType(){return Ms}get isInstancedMesh(){return this._objRef?.isInstancedMesh}set boundingBox(n){this._objRef&&(this._objRef.boundingBox=pe(this._objRef.boundingBox,n))}get boundingBox(){return this._objRef?.boundingBox}set boundingSphere(n){this._objRef&&(this._objRef.boundingSphere=pe(this._objRef.boundingSphere,n))}get boundingSphere(){return this._objRef?.boundingSphere}set count(n){this._objRef&&(this._objRef.count=n)}get count(){return this._objRef?.count}set instanceColor(n){this._objRef&&(this._objRef.instanceColor=pe(this._objRef.instanceColor,n))}get instanceColor(){return this._objRef?.instanceColor}set instanceMatrix(n){this._objRef&&(this._objRef.instanceMatrix=pe(this._objRef.instanceMatrix,n))}get instanceMatrix(){return this._objRef?.instanceMatrix}set morphTexture(n){this._objRef&&(this._objRef.morphTexture=n)}get morphTexture(){return this._objRef?.morphTexture}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-instancedMesh"]],inputs:{boundingBox:"boundingBox",boundingSphere:"boundingSphere",count:"count",instanceColor:"instanceColor",instanceMatrix:"instanceMatrix",morphTexture:"morphTexture"},features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:bee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var jU=(()=>{let e=class e extends bo{constructor(){super(...arguments),this.parent=S(de)}addToParent(){if(!this.parent.objRef)throw new Error("parent object doesn't hold a three js object instance");this.parent.objRef.material=this.objRef}removeFromParent(){this._objRef&&this.parent&&this.parent.objRef&&(this.parent.objRef.material=void 0)}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-abs-material"]],features:[$],decls:0,vars:0,template:function(r,o){},encapsulation:2,changeDetection:0});let i=e;return i})();var yee=["*"],Ri=(()=>{let e=class e extends jU{constructor(){super(...arguments),this.parent=S(de,{skipSelf:!0})}getType(){return Mi}get isMaterial(){return this._objRef?.isMaterial}get uuid(){return this._objRef?.uuid}set type(n){this._objRef&&(this._objRef.type=n)}get type(){return this._objRef?.type}get version(){return this._objRef?.version}set defines(n){this._objRef&&(this._objRef.defines=n)}get defines(){return this._objRef?.defines}set needsUpdate(n){this._objRef&&(this._objRef.needsUpdate=n)}set name(n){this._objRef&&(this._objRef.name=n)}get name(){return this._objRef?.name}set blending(n){this._objRef&&(this._objRef.blending=n)}get blending(){return this._objRef?.blending}set side(n){this._objRef&&(this._objRef.side=n)}get side(){return this._objRef?.side}set vertexColors(n){this._objRef&&(this._objRef.vertexColors=n)}get vertexColors(){return this._objRef?.vertexColors}set opacity(n){this._objRef&&(this._objRef.opacity=n)}get opacity(){return this._objRef?.opacity}set transparent(n){this._objRef&&(this._objRef.transparent=n)}get transparent(){return this._objRef?.transparent}set alphaHash(n){this._objRef&&(this._objRef.alphaHash=n)}get alphaHash(){return this._objRef?.alphaHash}set blendSrc(n){this._objRef&&(this._objRef.blendSrc=n)}get blendSrc(){return this._objRef?.blendSrc}set blendDst(n){this._objRef&&(this._objRef.blendDst=n)}get blendDst(){return this._objRef?.blendDst}set blendEquation(n){this._objRef&&(this._objRef.blendEquation=n)}get blendEquation(){return this._objRef?.blendEquation}set blendSrcAlpha(n){this._objRef&&(this._objRef.blendSrcAlpha=n)}get blendSrcAlpha(){return this._objRef?.blendSrcAlpha}set blendDstAlpha(n){this._objRef&&(this._objRef.blendDstAlpha=n)}get blendDstAlpha(){return this._objRef?.blendDstAlpha}set blendEquationAlpha(n){this._objRef&&(this._objRef.blendEquationAlpha=n)}get blendEquationAlpha(){return this._objRef?.blendEquationAlpha}set blendColor(n){this._objRef&&(this._objRef.blendColor=pe(this._objRef.blendColor,n))}get blendColor(){return this._objRef?.blendColor}set blendAlpha(n){this._objRef&&(this._objRef.blendAlpha=n)}get blendAlpha(){return this._objRef?.blendAlpha}set depthFunc(n){this._objRef&&(this._objRef.depthFunc=n)}get depthFunc(){return this._objRef?.depthFunc}set depthTest(n){this._objRef&&(this._objRef.depthTest=n)}get depthTest(){return this._objRef?.depthTest}set depthWrite(n){this._objRef&&(this._objRef.depthWrite=n)}get depthWrite(){return this._objRef?.depthWrite}set stencilWriteMask(n){this._objRef&&(this._objRef.stencilWriteMask=n)}get stencilWriteMask(){return this._objRef?.stencilWriteMask}set stencilFunc(n){this._objRef&&(this._objRef.stencilFunc=n)}get stencilFunc(){return this._objRef?.stencilFunc}set stencilRef(n){this._objRef&&(this._objRef.stencilRef=n)}get stencilRef(){return this._objRef?.stencilRef}set stencilFuncMask(n){this._objRef&&(this._objRef.stencilFuncMask=n)}get stencilFuncMask(){return this._objRef?.stencilFuncMask}set stencilFail(n){this._objRef&&(this._objRef.stencilFail=n)}get stencilFail(){return this._objRef?.stencilFail}set stencilZFail(n){this._objRef&&(this._objRef.stencilZFail=n)}get stencilZFail(){return this._objRef?.stencilZFail}set stencilZPass(n){this._objRef&&(this._objRef.stencilZPass=n)}get stencilZPass(){return this._objRef?.stencilZPass}set stencilWrite(n){this._objRef&&(this._objRef.stencilWrite=n)}get stencilWrite(){return this._objRef?.stencilWrite}set clippingPlanes(n){this._objRef&&(this._objRef.clippingPlanes=n)}get clippingPlanes(){return this._objRef?.clippingPlanes}set clipIntersection(n){this._objRef&&(this._objRef.clipIntersection=n)}get clipIntersection(){return this._objRef?.clipIntersection}set clipShadows(n){this._objRef&&(this._objRef.clipShadows=n)}get clipShadows(){return this._objRef?.clipShadows}set shadowSide(n){this._objRef&&(this._objRef.shadowSide=n)}get shadowSide(){return this._objRef?.shadowSide}set colorWrite(n){this._objRef&&(this._objRef.colorWrite=n)}get colorWrite(){return this._objRef?.colorWrite}set precision(n){this._objRef&&(this._objRef.precision=n)}get precision(){return this._objRef?.precision}set polygonOffset(n){this._objRef&&(this._objRef.polygonOffset=n)}get polygonOffset(){return this._objRef?.polygonOffset}set polygonOffsetFactor(n){this._objRef&&(this._objRef.polygonOffsetFactor=n)}get polygonOffsetFactor(){return this._objRef?.polygonOffsetFactor}set polygonOffsetUnits(n){this._objRef&&(this._objRef.polygonOffsetUnits=n)}get polygonOffsetUnits(){return this._objRef?.polygonOffsetUnits}set dithering(n){this._objRef&&(this._objRef.dithering=n)}get dithering(){return this._objRef?.dithering}set alphaToCoverage(n){this._objRef&&(this._objRef.alphaToCoverage=n)}get alphaToCoverage(){return this._objRef?.alphaToCoverage}set premultipliedAlpha(n){this._objRef&&(this._objRef.premultipliedAlpha=n)}get premultipliedAlpha(){return this._objRef?.premultipliedAlpha}set forceSinglePass(n){this._objRef&&(this._objRef.forceSinglePass=n)}get forceSinglePass(){return this._objRef?.forceSinglePass}set allowOverride(n){this._objRef&&(this._objRef.allowOverride=n)}get allowOverride(){return this._objRef?.allowOverride}set visible(n){this._objRef&&(this._objRef.visible=n)}get visible(){return this._objRef?.visible}set toneMapped(n){this._objRef&&(this._objRef.toneMapped=n)}get toneMapped(){return this._objRef?.toneMapped}set userData(n){this._objRef&&(this._objRef.userData=n)}get userData(){return this._objRef?.userData}set alphaTest(n){this._objRef&&(this._objRef.alphaTest=n)}get alphaTest(){return this._objRef?.alphaTest}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-material"]],inputs:{type:"type",defines:"defines",needsUpdate:"needsUpdate",name:"name",blending:"blending",side:"side",vertexColors:"vertexColors",opacity:"opacity",transparent:"transparent",alphaHash:"alphaHash",blendSrc:"blendSrc",blendDst:"blendDst",blendEquation:"blendEquation",blendSrcAlpha:"blendSrcAlpha",blendDstAlpha:"blendDstAlpha",blendEquationAlpha:"blendEquationAlpha",blendColor:"blendColor",blendAlpha:"blendAlpha",depthFunc:"depthFunc",depthTest:"depthTest",depthWrite:"depthWrite",stencilWriteMask:"stencilWriteMask",stencilFunc:"stencilFunc",stencilRef:"stencilRef",stencilFuncMask:"stencilFuncMask",stencilFail:"stencilFail",stencilZFail:"stencilZFail",stencilZPass:"stencilZPass",stencilWrite:"stencilWrite",clippingPlanes:"clippingPlanes",clipIntersection:"clipIntersection",clipShadows:"clipShadows",shadowSide:"shadowSide",colorWrite:"colorWrite",precision:"precision",polygonOffset:"polygonOffset",polygonOffsetFactor:"polygonOffsetFactor",polygonOffsetUnits:"polygonOffsetUnits",dithering:"dithering",alphaToCoverage:"alphaToCoverage",premultipliedAlpha:"premultipliedAlpha",forceSinglePass:"forceSinglePass",allowOverride:"allowOverride",visible:"visible",toneMapped:"toneMapped",userData:"userData",alphaTest:"alphaTest"},features:[K([]),$],ngContentSelectors:yee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var xee=["*"],cS=(()=>{let e=class e extends de{getType(){return nh}get isLOD(){return this._objRef?.isLOD}get type(){return this._objRef?.type}get levels(){return this._objRef?.levels}set autoUpdate(n){this._objRef&&(this._objRef.autoUpdate=n)}get autoUpdate(){return this._objRef?.autoUpdate}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-lOD"]],inputs:{autoUpdate:"autoUpdate"},features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:xee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var Mee=["*"],_v=(()=>{let e=class e extends Ln{getType(){return Yp}set textureID(n){this._objRef&&(this._objRef.textureID=n)}get textureID(){return this._objRef?.textureID}set uniforms(n){this._objRef&&Object.assign(this._objRef.uniforms,n)}get uniforms(){return this._objRef?.uniforms}set material(n){this._objRef&&(this._objRef.material=n)}get material(){return this._objRef?.material}set fsQuad(n){this._objRef&&(this._objRef.fsQuad=n)}get fsQuad(){return this._objRef?.fsQuad}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-shaderPass"]],inputs:{textureID:"textureID",uniforms:"uniforms",material:"material",fsQuad:"fsQuad"},features:[K([{provide:gn,useExisting:he(()=>e)}]),$],ngContentSelectors:Mee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var LU={type:"change"},nA={type:"start"},BU={type:"end"},lS=new sa,kU=new Xi,See=Math.cos(70*Ze.DEG2RAD),xr=new C,Fo=2*Math.PI,ni={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},tA=1e-6,tm=class extends Ir{constructor(e,t=null){super(e,t),this.state=ni.NONE,this.target=new C,this.cursor=new C,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:gi.ROTATE,MIDDLE:gi.DOLLY,RIGHT:gi.PAN},this.touches={ONE:$r.ROTATE,TWO:$r.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new C,this._lastQuaternion=new nn,this._lastTargetPosition=new C,this._quat=new nn().setFromUnitVectors(e.up,new C(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new Qc,this._sphericalDelta=new Qc,this._scale=1,this._panOffset=new C,this._rotateStart=new z,this._rotateEnd=new z,this._rotateDelta=new z,this._panStart=new z,this._panEnd=new z,this._panDelta=new z,this._dollyStart=new z,this._dollyEnd=new z,this._dollyDelta=new z,this._dollyDirection=new C,this._mouse=new z,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=Tee.bind(this),this._onPointerDown=Ree.bind(this),this._onPointerUp=Cee.bind(this),this._onContextMenu=Nee.bind(this),this._onMouseWheel=Iee.bind(this),this._onKeyDown=Aee.bind(this),this._onTouchStart=Pee.bind(this),this._onTouchMove=Fee.bind(this),this._onMouseDown=Eee.bind(this),this._onMouseMove=Dee.bind(this),this._interceptControlDown=jee.bind(this),this._interceptControlUp=Oee.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(LU),this.update(),this.state=ni.NONE}update(e=null){let t=this.object.position;xr.copy(t).sub(this.target),xr.applyQuaternion(this._quat),this._spherical.setFromVector3(xr),this.autoRotate&&this.state===ni.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(n)&&isFinite(r)&&(n<-Math.PI?n+=Fo:n>Math.PI&&(n-=Fo),r<-Math.PI?r+=Fo:r>Math.PI&&(r-=Fo),n<=r?this._spherical.theta=Math.max(n,Math.min(r,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(n+r)/2?Math.max(n,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let o=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{let s=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),o=s!=this._spherical.radius}if(xr.setFromSpherical(this._spherical),xr.applyQuaternion(this._quatInverse),t.copy(this.target).add(xr),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let s=null;if(this.object.isPerspectiveCamera){let a=xr.length();s=this._clampDistance(a*this._scale);let c=a-s;this.object.position.addScaledVector(this._dollyDirection,c),this.object.updateMatrixWorld(),o=!!c}else if(this.object.isOrthographicCamera){let a=new C(this._mouse.x,this._mouse.y,0);a.unproject(this.object);let c=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),o=c!==this.object.zoom;let l=new C(this._mouse.x,this._mouse.y,0);l.unproject(this.object),this.object.position.sub(l).add(a),this.object.updateMatrixWorld(),s=xr.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;s!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(s).add(this.object.position):(lS.origin.copy(this.object.position),lS.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(lS.direction))<See?this.object.lookAt(this.target):(kU.setFromNormalAndCoplanarPoint(this.object.up,this.target),lS.intersectPlane(kU,this.target))))}else if(this.object.isOrthographicCamera){let s=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),s!==this.object.zoom&&(this.object.updateProjectionMatrix(),o=!0)}return this._scale=1,this._performCursorZoom=!1,o||this._lastPosition.distanceToSquared(this.object.position)>tA||8*(1-this._lastQuaternion.dot(this.object.quaternion))>tA||this._lastTargetPosition.distanceToSquared(this.target)>tA?(this.dispatchEvent(LU),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?Fo/60*this.autoRotateSpeed*e:Fo/60/60*this.autoRotateSpeed}_getZoomScale(e){let t=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){xr.setFromMatrixColumn(t,0),xr.multiplyScalar(-e),this._panOffset.add(xr)}_panUp(e,t){this.screenSpacePanning===!0?xr.setFromMatrixColumn(t,1):(xr.setFromMatrixColumn(t,0),xr.crossVectors(this.object.up,xr)),xr.multiplyScalar(e),this._panOffset.add(xr)}_pan(e,t){let n=this.domElement;if(this.object.isPerspectiveCamera){let r=this.object.position;xr.copy(r).sub(this.target);let o=xr.length();o*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*o/n.clientHeight,this.object.matrix),this._panUp(2*t*o/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;let n=this.domElement.getBoundingClientRect(),r=e-n.left,o=t-n.top,s=n.width,a=n.height;this._mouse.x=r/s*2-1,this._mouse.y=-(o/a)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;this._rotateLeft(Fo*this._rotateDelta.x/t.clientHeight),this._rotateUp(Fo*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(Fo*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-Fo*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(Fo*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-Fo*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._rotateStart.set(n,r)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panStart.set(n,r)}}_handleTouchStartDolly(e){let t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,o=Math.sqrt(n*n+r*r);this._dollyStart.set(0,o)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{let n=this._getSecondPointerPosition(e),r=.5*(e.pageX+n.x),o=.5*(e.pageY+n.y);this._rotateEnd.set(r,o)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;this._rotateLeft(Fo*this._rotateDelta.x/t.clientHeight),this._rotateUp(Fo*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{let t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);this._panEnd.set(n,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){let t=this._getSecondPointerPosition(e),n=e.pageX-t.x,r=e.pageY-t.y,o=Math.sqrt(n*n+r*r);this._dollyEnd.set(0,o),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);let s=(e.pageX+t.x)*.5,a=(e.pageY+t.y)*.5;this._updateZoomParameters(s,a)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new z,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){let t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){let t=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}};function Ree(i){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(i.pointerId),this.domElement.ownerDocument.addEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(i)&&(this._addPointer(i),i.pointerType==="touch"?this._onTouchStart(i):this._onMouseDown(i)))}function Tee(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchMove(i):this._onMouseMove(i))}function Cee(i){switch(this._removePointer(i),this._pointers.length){case 0:this.domElement.releasePointerCapture(i.pointerId),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(BU),this.state=ni.NONE;break;case 1:let e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y});break}}function Eee(i){let e;switch(i.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case gi.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(i),this.state=ni.DOLLY;break;case gi.ROTATE:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=ni.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=ni.ROTATE}break;case gi.PAN:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=ni.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=ni.PAN}break;default:this.state=ni.NONE}this.state!==ni.NONE&&this.dispatchEvent(nA)}function Dee(i){switch(this.state){case ni.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(i);break;case ni.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(i);break;case ni.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(i);break}}function Iee(i){this.enabled===!1||this.enableZoom===!1||this.state!==ni.NONE||(i.preventDefault(),this.dispatchEvent(nA),this._handleMouseWheel(this._customWheelEvent(i)),this.dispatchEvent(BU))}function Aee(i){this.enabled!==!1&&this._handleKeyDown(i)}function Pee(i){switch(this._trackPointer(i),this._pointers.length){case 1:switch(this.touches.ONE){case $r.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(i),this.state=ni.TOUCH_ROTATE;break;case $r.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(i),this.state=ni.TOUCH_PAN;break;default:this.state=ni.NONE}break;case 2:switch(this.touches.TWO){case $r.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(i),this.state=ni.TOUCH_DOLLY_PAN;break;case $r.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(i),this.state=ni.TOUCH_DOLLY_ROTATE;break;default:this.state=ni.NONE}break;default:this.state=ni.NONE}this.state!==ni.NONE&&this.dispatchEvent(nA)}function Fee(i){switch(this._trackPointer(i),this.state){case ni.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(i),this.update();break;case ni.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(i),this.update();break;case ni.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(i),this.update();break;case ni.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(i),this.update();break;default:this.state=ni.NONE}}function Nee(i){this.enabled!==!1&&i.preventDefault()}function jee(i){i.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function Oee(i){i.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}var iA=new Xi,uS=new Dr,nm=new z,rA=new C,dS=class extends tm{constructor(e,t){super(e,t),this.screenSpacePanning=!1,this.mouseButtons={LEFT:gi.PAN,MIDDLE:gi.DOLLY,RIGHT:gi.ROTATE},this.touches={ONE:$r.PAN,TWO:$r.DOLLY_ROTATE},this._panWorldStart=new C}_handleMouseDownPan(e){if(super._handleMouseDownPan(e),this._panOffset.set(0,0,0),this.screenSpacePanning===!0)return;iA.setFromNormalAndCoplanarPoint(this.object.up,this.target);let n=this.domElement.getBoundingClientRect();nm.x=(e.clientX-n.left)/n.width*2-1,nm.y=-((e.clientY-n.top)/n.height)*2+1,uS.setFromCamera(nm,this.object),uS.ray.intersectPlane(iA,this._panWorldStart)}_handleMouseMovePan(e){if(this.screenSpacePanning===!0){super._handleMouseMovePan(e);return}let n=this.domElement.getBoundingClientRect();nm.x=(e.clientX-n.left)/n.width*2-1,nm.y=-((e.clientY-n.top)/n.height)*2+1,uS.setFromCamera(nm,this.object),uS.ray.intersectPlane(iA,rA)&&(rA.sub(this._panWorldStart),this._panOffset.copy(rA).negate(),this.update())}};var Lee=["*"],vi=(()=>{let e=class e extends _i{getType(){return tm}set target(n){this._objRef&&(this._objRef.target=pe(this._objRef.target,n))}get target(){return this._objRef?.target}set cursor(n){this._objRef&&(this._objRef.cursor=pe(this._objRef.cursor,n))}get cursor(){return this._objRef?.cursor}set minDistance(n){this._objRef&&(this._objRef.minDistance=n)}get minDistance(){return this._objRef?.minDistance}set maxDistance(n){this._objRef&&(this._objRef.maxDistance=n)}get maxDistance(){return this._objRef?.maxDistance}set minZoom(n){this._objRef&&(this._objRef.minZoom=n)}get minZoom(){return this._objRef?.minZoom}set maxZoom(n){this._objRef&&(this._objRef.maxZoom=n)}get maxZoom(){return this._objRef?.maxZoom}set minTargetRadius(n){this._objRef&&(this._objRef.minTargetRadius=n)}get minTargetRadius(){return this._objRef?.minTargetRadius}set maxTargetRadius(n){this._objRef&&(this._objRef.maxTargetRadius=n)}get maxTargetRadius(){return this._objRef?.maxTargetRadius}set minPolarAngle(n){this._objRef&&(this._objRef.minPolarAngle=n)}get minPolarAngle(){return this._objRef?.minPolarAngle}set maxPolarAngle(n){this._objRef&&(this._objRef.maxPolarAngle=n)}get maxPolarAngle(){return this._objRef?.maxPolarAngle}set minAzimuthAngle(n){this._objRef&&(this._objRef.minAzimuthAngle=n)}get minAzimuthAngle(){return this._objRef?.minAzimuthAngle}set maxAzimuthAngle(n){this._objRef&&(this._objRef.maxAzimuthAngle=n)}get maxAzimuthAngle(){return this._objRef?.maxAzimuthAngle}set enableDamping(n){this._objRef&&(this._objRef.enableDamping=n)}get enableDamping(){return this._objRef?.enableDamping}set dampingFactor(n){this._objRef&&(this._objRef.dampingFactor=n)}get dampingFactor(){return this._objRef?.dampingFactor}set enableZoom(n){this._objRef&&(this._objRef.enableZoom=n)}get enableZoom(){return this._objRef?.enableZoom}set zoomSpeed(n){this._objRef&&(this._objRef.zoomSpeed=n)}get zoomSpeed(){return this._objRef?.zoomSpeed}set enableRotate(n){this._objRef&&(this._objRef.enableRotate=n)}get enableRotate(){return this._objRef?.enableRotate}set rotateSpeed(n){this._objRef&&(this._objRef.rotateSpeed=n)}get rotateSpeed(){return this._objRef?.rotateSpeed}set keyRotateSpeed(n){this._objRef&&(this._objRef.keyRotateSpeed=n)}get keyRotateSpeed(){return this._objRef?.keyRotateSpeed}set enablePan(n){this._objRef&&(this._objRef.enablePan=n)}get enablePan(){return this._objRef?.enablePan}set panSpeed(n){this._objRef&&(this._objRef.panSpeed=n)}get panSpeed(){return this._objRef?.panSpeed}set screenSpacePanning(n){this._objRef&&(this._objRef.screenSpacePanning=n)}get screenSpacePanning(){return this._objRef?.screenSpacePanning}set keyPanSpeed(n){this._objRef&&(this._objRef.keyPanSpeed=n)}get keyPanSpeed(){return this._objRef?.keyPanSpeed}set zoomToCursor(n){this._objRef&&(this._objRef.zoomToCursor=n)}get zoomToCursor(){return this._objRef?.zoomToCursor}set autoRotate(n){this._objRef&&(this._objRef.autoRotate=n)}get autoRotate(){return this._objRef?.autoRotate}set autoRotateSpeed(n){this._objRef&&(this._objRef.autoRotateSpeed=n)}get autoRotateSpeed(){return this._objRef?.autoRotateSpeed}set keys(n){this._objRef&&(this._objRef.keys=n)}get keys(){return this._objRef?.keys}set mouseButtons(n){this._objRef&&(this._objRef.mouseButtons=n)}get mouseButtons(){return this._objRef?.mouseButtons}set touches(n){this._objRef&&(this._objRef.touches=n)}get touches(){return this._objRef?.touches}set target0(n){this._objRef&&(this._objRef.target0=pe(this._objRef.target0,n))}get target0(){return this._objRef?.target0}set position0(n){this._objRef&&(this._objRef.position0=pe(this._objRef.position0,n))}get position0(){return this._objRef?.position0}set zoom0(n){this._objRef&&(this._objRef.zoom0=n)}get zoom0(){return this._objRef?.zoom0}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-orbitControls"]],inputs:{target:"target",cursor:"cursor",minDistance:"minDistance",maxDistance:"maxDistance",minZoom:"minZoom",maxZoom:"maxZoom",minTargetRadius:"minTargetRadius",maxTargetRadius:"maxTargetRadius",minPolarAngle:"minPolarAngle",maxPolarAngle:"maxPolarAngle",minAzimuthAngle:"minAzimuthAngle",maxAzimuthAngle:"maxAzimuthAngle",enableDamping:"enableDamping",dampingFactor:"dampingFactor",enableZoom:"enableZoom",zoomSpeed:"zoomSpeed",enableRotate:"enableRotate",rotateSpeed:"rotateSpeed",keyRotateSpeed:"keyRotateSpeed",enablePan:"enablePan",panSpeed:"panSpeed",screenSpacePanning:"screenSpacePanning",keyPanSpeed:"keyPanSpeed",zoomToCursor:"zoomToCursor",autoRotate:"autoRotate",autoRotateSpeed:"autoRotateSpeed",keys:"keys",mouseButtons:"mouseButtons",touches:"touches",target0:"target0",position0:"position0",zoom0:"zoom0"},features:[K([{provide:_i,useExisting:he(()=>e)}]),$],ngContentSelectors:Lee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var kee=["*"],UU=(()=>{let e=class e extends vi{getType(){return dS}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-mapControls"]],features:[K([{provide:_i,useExisting:he(()=>e)}]),$],ngContentSelectors:kee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var Uee=["*"],dc=(()=>{let e=class e extends Ri{getType(){return ci}get isMeshBasicMaterial(){return this._objRef?.isMeshBasicMaterial}set color(n){this._objRef&&(this._objRef.color=pe(this._objRef.color,n))}get color(){return this._objRef?.color}set map(n){this._objRef&&(this._objRef.map=n)}get map(){return this._objRef?.map}set lightMap(n){this._objRef&&(this._objRef.lightMap=n)}get lightMap(){return this._objRef?.lightMap}set lightMapIntensity(n){this._objRef&&(this._objRef.lightMapIntensity=n)}get lightMapIntensity(){return this._objRef?.lightMapIntensity}set aoMap(n){this._objRef&&(this._objRef.aoMap=n)}get aoMap(){return this._objRef?.aoMap}set aoMapIntensity(n){this._objRef&&(this._objRef.aoMapIntensity=n)}get aoMapIntensity(){return this._objRef?.aoMapIntensity}set specularMap(n){this._objRef&&(this._objRef.specularMap=n)}get specularMap(){return this._objRef?.specularMap}set alphaMap(n){this._objRef&&(this._objRef.alphaMap=n)}get alphaMap(){return this._objRef?.alphaMap}set envMap(n){this._objRef&&(this._objRef.envMap=n)}get envMap(){return this._objRef?.envMap}set envMapRotation(n){this._objRef&&(this._objRef.envMapRotation=pe(this._objRef.envMapRotation,n))}get envMapRotation(){return this._objRef?.envMapRotation}set combine(n){this._objRef&&(this._objRef.combine=n)}get combine(){return this._objRef?.combine}set reflectivity(n){this._objRef&&(this._objRef.reflectivity=n)}get reflectivity(){return this._objRef?.reflectivity}set refractionRatio(n){this._objRef&&(this._objRef.refractionRatio=n)}get refractionRatio(){return this._objRef?.refractionRatio}set wireframe(n){this._objRef&&(this._objRef.wireframe=n)}get wireframe(){return this._objRef?.wireframe}set wireframeLinewidth(n){this._objRef&&(this._objRef.wireframeLinewidth=n)}get wireframeLinewidth(){return this._objRef?.wireframeLinewidth}set wireframeLinecap(n){this._objRef&&(this._objRef.wireframeLinecap=n)}get wireframeLinecap(){return this._objRef?.wireframeLinecap}set wireframeLinejoin(n){this._objRef&&(this._objRef.wireframeLinejoin=n)}get wireframeLinejoin(){return this._objRef?.wireframeLinejoin}set fog(n){this._objRef&&(this._objRef.fog=n)}get fog(){return this._objRef?.fog}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-meshBasicMaterial"]],inputs:{color:"color",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",specularMap:"specularMap",alphaMap:"alphaMap",envMap:"envMap",envMapRotation:"envMapRotation",combine:"combine",reflectivity:"reflectivity",refractionRatio:"refractionRatio",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",fog:"fog"},features:[K([{provide:Ri,useExisting:he(()=>e)}]),$],ngContentSelectors:Uee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var Vee=["*"],No=(()=>{let e=class e extends Ri{getType(){return dh}get isMeshPhongMaterial(){return this._objRef?.isMeshPhongMaterial}set color(n){this._objRef&&(this._objRef.color=pe(this._objRef.color,n))}get color(){return this._objRef?.color}set specular(n){this._objRef&&(this._objRef.specular=pe(this._objRef.specular,n))}get specular(){return this._objRef?.specular}set shininess(n){this._objRef&&(this._objRef.shininess=n)}get shininess(){return this._objRef?.shininess}set map(n){this._objRef&&(this._objRef.map=n)}get map(){return this._objRef?.map}set lightMap(n){this._objRef&&(this._objRef.lightMap=n)}get lightMap(){return this._objRef?.lightMap}set lightMapIntensity(n){this._objRef&&(this._objRef.lightMapIntensity=n)}get lightMapIntensity(){return this._objRef?.lightMapIntensity}set aoMap(n){this._objRef&&(this._objRef.aoMap=n)}get aoMap(){return this._objRef?.aoMap}set aoMapIntensity(n){this._objRef&&(this._objRef.aoMapIntensity=n)}get aoMapIntensity(){return this._objRef?.aoMapIntensity}set emissive(n){this._objRef&&(this._objRef.emissive=pe(this._objRef.emissive,n))}get emissive(){return this._objRef?.emissive}set emissiveIntensity(n){this._objRef&&(this._objRef.emissiveIntensity=n)}get emissiveIntensity(){return this._objRef?.emissiveIntensity}set emissiveMap(n){this._objRef&&(this._objRef.emissiveMap=n)}get emissiveMap(){return this._objRef?.emissiveMap}set bumpMap(n){this._objRef&&(this._objRef.bumpMap=n)}get bumpMap(){return this._objRef?.bumpMap}set bumpScale(n){this._objRef&&(this._objRef.bumpScale=n)}get bumpScale(){return this._objRef?.bumpScale}set normalMap(n){this._objRef&&(this._objRef.normalMap=n)}get normalMap(){return this._objRef?.normalMap}set normalMapType(n){this._objRef&&(this._objRef.normalMapType=n)}get normalMapType(){return this._objRef?.normalMapType}set normalScale(n){this._objRef&&(this._objRef.normalScale=pe(this._objRef.normalScale,n))}get normalScale(){return this._objRef?.normalScale}set displacementMap(n){this._objRef&&(this._objRef.displacementMap=n)}get displacementMap(){return this._objRef?.displacementMap}set displacementScale(n){this._objRef&&(this._objRef.displacementScale=n)}get displacementScale(){return this._objRef?.displacementScale}set displacementBias(n){this._objRef&&(this._objRef.displacementBias=n)}get displacementBias(){return this._objRef?.displacementBias}set specularMap(n){this._objRef&&(this._objRef.specularMap=n)}get specularMap(){return this._objRef?.specularMap}set alphaMap(n){this._objRef&&(this._objRef.alphaMap=n)}get alphaMap(){return this._objRef?.alphaMap}set envMap(n){this._objRef&&(this._objRef.envMap=n)}get envMap(){return this._objRef?.envMap}set envMapRotation(n){this._objRef&&(this._objRef.envMapRotation=pe(this._objRef.envMapRotation,n))}get envMapRotation(){return this._objRef?.envMapRotation}set combine(n){this._objRef&&(this._objRef.combine=n)}get combine(){return this._objRef?.combine}set reflectivity(n){this._objRef&&(this._objRef.reflectivity=n)}get reflectivity(){return this._objRef?.reflectivity}set refractionRatio(n){this._objRef&&(this._objRef.refractionRatio=n)}get refractionRatio(){return this._objRef?.refractionRatio}set wireframe(n){this._objRef&&(this._objRef.wireframe=n)}get wireframe(){return this._objRef?.wireframe}set wireframeLinewidth(n){this._objRef&&(this._objRef.wireframeLinewidth=n)}get wireframeLinewidth(){return this._objRef?.wireframeLinewidth}set wireframeLinecap(n){this._objRef&&(this._objRef.wireframeLinecap=n)}get wireframeLinecap(){return this._objRef?.wireframeLinecap}set wireframeLinejoin(n){this._objRef&&(this._objRef.wireframeLinejoin=n)}get wireframeLinejoin(){return this._objRef?.wireframeLinejoin}set flatShading(n){this._objRef&&(this._objRef.flatShading=n)}get flatShading(){return this._objRef?.flatShading}set fog(n){this._objRef&&(this._objRef.fog=n)}get fog(){return this._objRef?.fog}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-meshPhongMaterial"]],inputs:{color:"color",specular:"specular",shininess:"shininess",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",emissive:"emissive",emissiveIntensity:"emissiveIntensity",emissiveMap:"emissiveMap",bumpMap:"bumpMap",bumpScale:"bumpScale",normalMap:"normalMap",normalMapType:"normalMapType",normalScale:"normalScale",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",specularMap:"specularMap",alphaMap:"alphaMap",envMap:"envMap",envMapRotation:"envMapRotation",combine:"combine",reflectivity:"reflectivity",refractionRatio:"refractionRatio",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",flatShading:"flatShading",fog:"fog"},features:[K([{provide:Ri,useExisting:he(()=>e)}]),$],ngContentSelectors:Vee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var zee=["*"],Dh=(()=>{let e=class e extends Ri{getType(){return kr}get isMeshStandardMaterial(){return this._objRef?.isMeshStandardMaterial}set color(n){this._objRef&&(this._objRef.color=pe(this._objRef.color,n))}get color(){return this._objRef?.color}set roughness(n){this._objRef&&(this._objRef.roughness=n)}get roughness(){return this._objRef?.roughness}set metalness(n){this._objRef&&(this._objRef.metalness=n)}get metalness(){return this._objRef?.metalness}set map(n){this._objRef&&(this._objRef.map=n)}get map(){return this._objRef?.map}set lightMap(n){this._objRef&&(this._objRef.lightMap=n)}get lightMap(){return this._objRef?.lightMap}set lightMapIntensity(n){this._objRef&&(this._objRef.lightMapIntensity=n)}get lightMapIntensity(){return this._objRef?.lightMapIntensity}set aoMap(n){this._objRef&&(this._objRef.aoMap=n)}get aoMap(){return this._objRef?.aoMap}set aoMapIntensity(n){this._objRef&&(this._objRef.aoMapIntensity=n)}get aoMapIntensity(){return this._objRef?.aoMapIntensity}set emissive(n){this._objRef&&(this._objRef.emissive=pe(this._objRef.emissive,n))}get emissive(){return this._objRef?.emissive}set emissiveIntensity(n){this._objRef&&(this._objRef.emissiveIntensity=n)}get emissiveIntensity(){return this._objRef?.emissiveIntensity}set emissiveMap(n){this._objRef&&(this._objRef.emissiveMap=n)}get emissiveMap(){return this._objRef?.emissiveMap}set bumpMap(n){this._objRef&&(this._objRef.bumpMap=n)}get bumpMap(){return this._objRef?.bumpMap}set bumpScale(n){this._objRef&&(this._objRef.bumpScale=n)}get bumpScale(){return this._objRef?.bumpScale}set normalMap(n){this._objRef&&(this._objRef.normalMap=n)}get normalMap(){return this._objRef?.normalMap}set normalMapType(n){this._objRef&&(this._objRef.normalMapType=n)}get normalMapType(){return this._objRef?.normalMapType}set normalScale(n){this._objRef&&(this._objRef.normalScale=pe(this._objRef.normalScale,n))}get normalScale(){return this._objRef?.normalScale}set displacementMap(n){this._objRef&&(this._objRef.displacementMap=n)}get displacementMap(){return this._objRef?.displacementMap}set displacementScale(n){this._objRef&&(this._objRef.displacementScale=n)}get displacementScale(){return this._objRef?.displacementScale}set displacementBias(n){this._objRef&&(this._objRef.displacementBias=n)}get displacementBias(){return this._objRef?.displacementBias}set roughnessMap(n){this._objRef&&(this._objRef.roughnessMap=n)}get roughnessMap(){return this._objRef?.roughnessMap}set metalnessMap(n){this._objRef&&(this._objRef.metalnessMap=n)}get metalnessMap(){return this._objRef?.metalnessMap}set alphaMap(n){this._objRef&&(this._objRef.alphaMap=n)}get alphaMap(){return this._objRef?.alphaMap}set envMap(n){this._objRef&&(this._objRef.envMap=n)}get envMap(){return this._objRef?.envMap}set envMapRotation(n){this._objRef&&(this._objRef.envMapRotation=pe(this._objRef.envMapRotation,n))}get envMapRotation(){return this._objRef?.envMapRotation}set envMapIntensity(n){this._objRef&&(this._objRef.envMapIntensity=n)}get envMapIntensity(){return this._objRef?.envMapIntensity}set wireframe(n){this._objRef&&(this._objRef.wireframe=n)}get wireframe(){return this._objRef?.wireframe}set wireframeLinewidth(n){this._objRef&&(this._objRef.wireframeLinewidth=n)}get wireframeLinewidth(){return this._objRef?.wireframeLinewidth}set wireframeLinecap(n){this._objRef&&(this._objRef.wireframeLinecap=n)}get wireframeLinecap(){return this._objRef?.wireframeLinecap}set wireframeLinejoin(n){this._objRef&&(this._objRef.wireframeLinejoin=n)}get wireframeLinejoin(){return this._objRef?.wireframeLinejoin}set flatShading(n){this._objRef&&(this._objRef.flatShading=n)}get flatShading(){return this._objRef?.flatShading}set fog(n){this._objRef&&(this._objRef.fog=n)}get fog(){return this._objRef?.fog}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-meshStandardMaterial"]],inputs:{color:"color",roughness:"roughness",metalness:"metalness",map:"map",lightMap:"lightMap",lightMapIntensity:"lightMapIntensity",aoMap:"aoMap",aoMapIntensity:"aoMapIntensity",emissive:"emissive",emissiveIntensity:"emissiveIntensity",emissiveMap:"emissiveMap",bumpMap:"bumpMap",bumpScale:"bumpScale",normalMap:"normalMap",normalMapType:"normalMapType",normalScale:"normalScale",displacementMap:"displacementMap",displacementScale:"displacementScale",displacementBias:"displacementBias",roughnessMap:"roughnessMap",metalnessMap:"metalnessMap",alphaMap:"alphaMap",envMap:"envMap",envMapRotation:"envMapRotation",envMapIntensity:"envMapIntensity",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",wireframeLinecap:"wireframeLinecap",wireframeLinejoin:"wireframeLinejoin",flatShading:"flatShading",fog:"fog"},features:[K([{provide:Ri,useExisting:he(()=>e)}]),$],ngContentSelectors:zee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var rm=class i extends Si{constructor(e,t,n,r){super(),this.renderScene=t,this.renderCamera=n,this.selectedObjects=r!==void 0?r:[],this.visibleEdgeColor=new ue(1,1,1),this.hiddenEdgeColor=new ue(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.patternTexture=null,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,this._visibilityCache=new Map,this._selectionCache=new Set,this.resolution=e!==void 0?new z(e.x,e.y):new z(256,256);let o=Math.round(this.resolution.x/this.downSampleRatio),s=Math.round(this.resolution.y/this.downSampleRatio);this.renderTargetMaskBuffer=new Qt(this.resolution.x,this.resolution.y),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new du,this.depthMaterial.side=rr,this.depthMaterial.depthPacking=AM,this.depthMaterial.blending=rn,this.prepareMaskMaterial=this._getPrepareMaskMaterial(),this.prepareMaskMaterial.side=rr,this.prepareMaskMaterial.fragmentShader=u(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new Qt(this.resolution.x,this.resolution.y,{type:An}),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new Qt(o,s,{type:An}),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new Qt(o,s,{type:An}),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new Qt(Math.round(o/2),Math.round(s/2),{type:An}),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this._getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new Qt(o,s,{type:An}),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new Qt(Math.round(o/2),Math.round(s/2),{type:An}),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1;let a=4,c=4;this.separableBlurMaterial1=this._getSeparableBlurMaterial(a),this.separableBlurMaterial1.uniforms.texSize.value.set(o,s),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this._getSeparableBlurMaterial(c),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(o/2),Math.round(s/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=c,this.overlayMaterial=this._getOverlayMaterial();let l=ar;this.copyUniforms=Hn.clone(l.uniforms),this.materialCopy=new Nt({uniforms:this.copyUniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader,blending:rn,depthTest:!1,depthWrite:!1}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new ue,this.oldClearAlpha=1,this._fsQuad=new Ar(null),this.tempPulseColor1=new ue,this.tempPulseColor2=new ue,this.textureMatrix=new Ee;function u(d,h){let f=h.isPerspectiveCamera?"perspective":"orthographic";return d.replace(/DEPTH_TO_VIEW_Z/g,f+"DepthToViewZ")}}dispose(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose(),this.depthMaterial.dispose(),this.prepareMaskMaterial.dispose(),this.edgeDetectionMaterial.dispose(),this.separableBlurMaterial1.dispose(),this.separableBlurMaterial2.dispose(),this.overlayMaterial.dispose(),this.materialCopy.dispose(),this._fsQuad.dispose()}setSize(e,t){this.renderTargetMaskBuffer.setSize(e,t),this.renderTargetDepthBuffer.setSize(e,t);let n=Math.round(e/this.downSampleRatio),r=Math.round(t/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(n,r),this.renderTargetBlurBuffer1.setSize(n,r),this.renderTargetEdgeBuffer1.setSize(n,r),this.separableBlurMaterial1.uniforms.texSize.value.set(n,r),n=Math.round(n/2),r=Math.round(r/2),this.renderTargetBlurBuffer2.setSize(n,r),this.renderTargetEdgeBuffer2.setSize(n,r),this.separableBlurMaterial2.uniforms.texSize.value.set(n,r)}render(e,t,n,r,o){if(this.selectedObjects.length>0){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();let s=e.autoClear;e.autoClear=!1,o&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this._updateSelectionCache(),this._changeVisibilityOfSelectedObjects(!1);let a=this.renderScene.background,c=this.renderScene.overrideMaterial;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this._changeVisibilityOfSelectedObjects(!0),this._visibilityCache.clear(),this._updateTextureMatrix(),this._changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this._changeVisibilityOfNonSelectedObjects(!0),this._visibilityCache.clear(),this._selectionCache.clear(),this.renderScene.background=a,this.renderScene.overrideMaterial=c,this._fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this._fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){let l=.625+Math.cos(performance.now()*.01/this.pulsePeriod)*.75/2;this.tempPulseColor1.multiplyScalar(l),this.tempPulseColor2.multiplyScalar(l)}this._fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this._fsQuad.render(e),this._fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=i.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this._fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=i.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this._fsQuad.render(e),this._fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=i.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this._fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=i.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this._fsQuad.render(e),this._fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,o&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(n),this._fsQuad.render(e),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=s}this.renderToScreen&&(this._fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=n.texture,e.setRenderTarget(null),this._fsQuad.render(e))}_updateSelectionCache(){let e=this._selectionCache;function t(n){n.isMesh&&e.add(n)}e.clear();for(let n=0;n<this.selectedObjects.length;n++)this.selectedObjects[n].traverse(t)}_changeVisibilityOfSelectedObjects(e){let t=this._visibilityCache;for(let n of this._selectionCache)e===!0?n.visible=t.get(n):(t.set(n,n.visible),n.visible=e)}_changeVisibilityOfNonSelectedObjects(e){let t=this._visibilityCache,n=this._selectionCache;function r(o){if(o.isPoints||o.isLine||o.isLine2)e===!0?o.visible=t.get(o):(t.set(o,o.visible),o.visible=e);else if((o.isMesh||o.isSprite)&&!n.has(o)){let s=o.visible;(e===!1||t.get(o)===!0)&&(o.visible=e),t.set(o,s)}}this.renderScene.traverse(r)}_updateTextureMatrix(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)}_getPrepareMaskMaterial(){return new Nt({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new z(.5,.5)},textureMatrix:{value:null}},vertexShader:`#include <batching_pars_vertex>
				#include <morphtarget_pars_vertex>
				#include <skinning_pars_vertex>

				varying vec4 projTexCoord;
				varying vec4 vPosition;
				uniform mat4 textureMatrix;

				void main() {

					#include <batching_vertex>
					#include <skinbase_vertex>
					#include <begin_vertex>
					#include <morphtarget_vertex>
					#include <skinning_vertex>
					#include <project_vertex>

					vPosition = mvPosition;

					vec4 worldPosition = vec4( transformed, 1.0 );

					#ifdef USE_INSTANCING

						worldPosition = instanceMatrix * worldPosition;

					#endif

					worldPosition = modelMatrix * worldPosition;

					projTexCoord = textureMatrix * worldPosition;

				}`,fragmentShader:`#include <packing>
				varying vec4 vPosition;
				varying vec4 projTexCoord;
				uniform sampler2D depthTexture;
				uniform vec2 cameraNearFar;

				void main() {

					float depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));
					float viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );
					float depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;
					gl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);

				}`})}_getEdgeDetectionMaterial(){return new Nt({uniforms:{maskTexture:{value:null},texSize:{value:new z(.5,.5)},visibleEdgeColor:{value:new C(1,1,1)},hiddenEdgeColor:{value:new C(1,1,1)}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;

				uniform sampler2D maskTexture;
				uniform vec2 texSize;
				uniform vec3 visibleEdgeColor;
				uniform vec3 hiddenEdgeColor;

				void main() {
					vec2 invSize = 1.0 / texSize;
					vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);
					vec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);
					vec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);
					vec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);
					vec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);
					float diff1 = (c1.r - c2.r)*0.5;
					float diff2 = (c3.r - c4.r)*0.5;
					float d = length( vec2(diff1, diff2) );
					float a1 = min(c1.g, c2.g);
					float a2 = min(c3.g, c4.g);
					float visibilityFactor = min(a1, a2);
					vec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;
					gl_FragColor = vec4(edgeColor, 1.0) * vec4(d);
				}`})}_getSeparableBlurMaterial(e){return new Nt({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new z(.5,.5)},direction:{value:new z(.5,.5)},kernelRadius:{value:1}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;
				uniform vec2 direction;
				uniform float kernelRadius;

				float gaussianPdf(in float x, in float sigma) {
					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;
				}

				void main() {
					vec2 invSize = 1.0 / texSize;
					float sigma = kernelRadius/2.0;
					float weightSum = gaussianPdf(0.0, sigma);
					vec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;
					vec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);
					vec2 uvOffset = delta;
					for( int i = 1; i <= MAX_RADIUS; i ++ ) {
						float x = kernelRadius * float(i) / float(MAX_RADIUS);
						float w = gaussianPdf(x, sigma);
						vec4 sample1 = texture2D( colorTexture, vUv + uvOffset);
						vec4 sample2 = texture2D( colorTexture, vUv - uvOffset);
						diffuseSum += ((sample1 + sample2) * w);
						weightSum += (2.0 * w);
						uvOffset += delta;
					}
					gl_FragColor = diffuseSum/weightSum;
				}`})}_getOverlayMaterial(){return new Nt({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:`varying vec2 vUv;

				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;

				uniform sampler2D maskTexture;
				uniform sampler2D edgeTexture1;
				uniform sampler2D edgeTexture2;
				uniform sampler2D patternTexture;
				uniform float edgeStrength;
				uniform float edgeGlow;
				uniform bool usePatternTexture;

				void main() {
					vec4 edgeValue1 = texture2D(edgeTexture1, vUv);
					vec4 edgeValue2 = texture2D(edgeTexture2, vUv);
					vec4 maskColor = texture2D(maskTexture, vUv);
					vec4 patternColor = texture2D(patternTexture, 6.0 * vUv);
					float visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;
					vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;
					vec4 finalColor = edgeStrength * maskColor.r * edgeValue;
					if(usePatternTexture)
						finalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);
					gl_FragColor = finalColor;
				}`,blending:pu,depthTest:!1,depthWrite:!1,transparent:!0})}};rm.BlurDirectionX=new z(1,0);rm.BlurDirectionY=new z(0,1);var Hee=["*"],VU=(()=>{let e=class e extends Ln{getType(){return rm}set renderScene(n){this._objRef&&(this._objRef.renderScene=n)}get renderScene(){return this._objRef?.renderScene}set renderCamera(n){this._objRef&&(this._objRef.renderCamera=n)}get renderCamera(){return this._objRef?.renderCamera}set selectedObjects(n){this._objRef&&(this._objRef.selectedObjects=n)}get selectedObjects(){return this._objRef?.selectedObjects}set visibleEdgeColor(n){this._objRef&&(this._objRef.visibleEdgeColor=pe(this._objRef.visibleEdgeColor,n))}get visibleEdgeColor(){return this._objRef?.visibleEdgeColor}set hiddenEdgeColor(n){this._objRef&&(this._objRef.hiddenEdgeColor=pe(this._objRef.hiddenEdgeColor,n))}get hiddenEdgeColor(){return this._objRef?.hiddenEdgeColor}set edgeGlow(n){this._objRef&&(this._objRef.edgeGlow=n)}get edgeGlow(){return this._objRef?.edgeGlow}set usePatternTexture(n){this._objRef&&(this._objRef.usePatternTexture=n)}get usePatternTexture(){return this._objRef?.usePatternTexture}set edgeThickness(n){this._objRef&&(this._objRef.edgeThickness=n)}get edgeThickness(){return this._objRef?.edgeThickness}set edgeStrength(n){this._objRef&&(this._objRef.edgeStrength=n)}get edgeStrength(){return this._objRef?.edgeStrength}set downSampleRatio(n){this._objRef&&(this._objRef.downSampleRatio=n)}get downSampleRatio(){return this._objRef?.downSampleRatio}set pulsePeriod(n){this._objRef&&(this._objRef.pulsePeriod=n)}get pulsePeriod(){return this._objRef?.pulsePeriod}set resolution(n){this._objRef&&(this._objRef.resolution=pe(this._objRef.resolution,n))}get resolution(){return this._objRef?.resolution}set patternTexture(n){this._objRef&&(this._objRef.patternTexture=n)}get patternTexture(){return this._objRef?.patternTexture}set maskBufferMaterial(n){this._objRef&&(this._objRef.maskBufferMaterial=n)}get maskBufferMaterial(){return this._objRef?.maskBufferMaterial}set renderTargetMaskBuffer(n){this._objRef&&(this._objRef.renderTargetMaskBuffer=n)}get renderTargetMaskBuffer(){return this._objRef?.renderTargetMaskBuffer}set depthMaterial(n){this._objRef&&(this._objRef.depthMaterial=n)}get depthMaterial(){return this._objRef?.depthMaterial}set prepareMaskMaterial(n){this._objRef&&(this._objRef.prepareMaskMaterial=n)}get prepareMaskMaterial(){return this._objRef?.prepareMaskMaterial}set renderTargetDepthBuffer(n){this._objRef&&(this._objRef.renderTargetDepthBuffer=n)}get renderTargetDepthBuffer(){return this._objRef?.renderTargetDepthBuffer}set renderTargetMaskDownSampleBuffer(n){this._objRef&&(this._objRef.renderTargetMaskDownSampleBuffer=n)}get renderTargetMaskDownSampleBuffer(){return this._objRef?.renderTargetMaskDownSampleBuffer}set renderTargetBlurBuffer1(n){this._objRef&&(this._objRef.renderTargetBlurBuffer1=n)}get renderTargetBlurBuffer1(){return this._objRef?.renderTargetBlurBuffer1}set renderTargetBlurBuffer2(n){this._objRef&&(this._objRef.renderTargetBlurBuffer2=n)}get renderTargetBlurBuffer2(){return this._objRef?.renderTargetBlurBuffer2}set edgeDetectionMaterial(n){this._objRef&&(this._objRef.edgeDetectionMaterial=n)}get edgeDetectionMaterial(){return this._objRef?.edgeDetectionMaterial}set renderTargetEdgeBuffer1(n){this._objRef&&(this._objRef.renderTargetEdgeBuffer1=n)}get renderTargetEdgeBuffer1(){return this._objRef?.renderTargetEdgeBuffer1}set renderTargetEdgeBuffer2(n){this._objRef&&(this._objRef.renderTargetEdgeBuffer2=n)}get renderTargetEdgeBuffer2(){return this._objRef?.renderTargetEdgeBuffer2}set separableBlurMaterial1(n){this._objRef&&(this._objRef.separableBlurMaterial1=n)}get separableBlurMaterial1(){return this._objRef?.separableBlurMaterial1}set separableBlurMaterial2(n){this._objRef&&(this._objRef.separableBlurMaterial2=n)}get separableBlurMaterial2(){return this._objRef?.separableBlurMaterial2}set overlayMaterial(n){this._objRef&&(this._objRef.overlayMaterial=n)}get overlayMaterial(){return this._objRef?.overlayMaterial}set copyUniforms(n){this._objRef&&(this._objRef.copyUniforms=n)}get copyUniforms(){return this._objRef?.copyUniforms}set materialCopy(n){this._objRef&&(this._objRef.materialCopy=n)}get materialCopy(){return this._objRef?.materialCopy}set oldClearColor(n){this._objRef&&(this._objRef.oldClearColor=pe(this._objRef.oldClearColor,n))}get oldClearColor(){return this._objRef?.oldClearColor}set oldClearAlpha(n){this._objRef&&(this._objRef.oldClearAlpha=n)}get oldClearAlpha(){return this._objRef?.oldClearAlpha}set fsQuad(n){this._objRef&&(this._objRef.fsQuad=n)}get fsQuad(){return this._objRef?.fsQuad}set tempPulseColor1(n){this._objRef&&(this._objRef.tempPulseColor1=pe(this._objRef.tempPulseColor1,n))}get tempPulseColor1(){return this._objRef?.tempPulseColor1}set tempPulseColor2(n){this._objRef&&(this._objRef.tempPulseColor2=pe(this._objRef.tempPulseColor2,n))}get tempPulseColor2(){return this._objRef?.tempPulseColor2}set textureMatrix(n){this._objRef&&(this._objRef.textureMatrix=pe(this._objRef.textureMatrix,n))}get textureMatrix(){return this._objRef?.textureMatrix}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-outlinePass"]],inputs:{renderScene:"renderScene",renderCamera:"renderCamera",selectedObjects:"selectedObjects",visibleEdgeColor:"visibleEdgeColor",hiddenEdgeColor:"hiddenEdgeColor",edgeGlow:"edgeGlow",usePatternTexture:"usePatternTexture",edgeThickness:"edgeThickness",edgeStrength:"edgeStrength",downSampleRatio:"downSampleRatio",pulsePeriod:"pulsePeriod",resolution:"resolution",patternTexture:"patternTexture",maskBufferMaterial:"maskBufferMaterial",renderTargetMaskBuffer:"renderTargetMaskBuffer",depthMaterial:"depthMaterial",prepareMaskMaterial:"prepareMaskMaterial",renderTargetDepthBuffer:"renderTargetDepthBuffer",renderTargetMaskDownSampleBuffer:"renderTargetMaskDownSampleBuffer",renderTargetBlurBuffer1:"renderTargetBlurBuffer1",renderTargetBlurBuffer2:"renderTargetBlurBuffer2",edgeDetectionMaterial:"edgeDetectionMaterial",renderTargetEdgeBuffer1:"renderTargetEdgeBuffer1",renderTargetEdgeBuffer2:"renderTargetEdgeBuffer2",separableBlurMaterial1:"separableBlurMaterial1",separableBlurMaterial2:"separableBlurMaterial2",overlayMaterial:"overlayMaterial",copyUniforms:"copyUniforms",materialCopy:"materialCopy",oldClearColor:"oldClearColor",oldClearAlpha:"oldClearAlpha",fsQuad:"fsQuad",tempPulseColor1:"tempPulseColor1",tempPulseColor2:"tempPulseColor2",textureMatrix:"textureMatrix"},features:[K([{provide:gn,useExisting:he(()=>e)}]),$],ngContentSelectors:Hee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var Wee=["*"],Ds=(()=>{let e=class e extends Kt{getType(){return la}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-planeGeometry"]],features:[K([{provide:Kt,useExisting:he(()=>e)}]),$],ngContentSelectors:Wee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var $ee=["*"],Gi=(()=>{let e=class e extends ya{getType(){return Zc}get isPointLight(){return this._objRef?.isPointLight}set type(n){this._objRef&&(this._objRef.type=n)}get type(){return this._objRef?.type}set intensity(n){this._objRef&&(this._objRef.intensity=n)}get intensity(){return this._objRef?.intensity}set distance(n){this._objRef&&(this._objRef.distance=n)}get distance(){return this._objRef?.distance}set castShadow(n){this._objRef&&(this._objRef.castShadow=n)}get castShadow(){return this._objRef?.castShadow}set decay(n){this._objRef&&(this._objRef.decay=n)}get decay(){return this._objRef?.decay}set shadow(n){this._objRef&&(this._objRef.shadow=n)}get shadow(){return this._objRef?.shadow}set power(n){this._objRef&&(this._objRef.power=n)}get power(){return this._objRef?.power}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-pointLight"]],inputs:{type:"type",intensity:"intensity",distance:"distance",castShadow:"castShadow",decay:"decay",shadow:"shadow",power:"power"},features:[K([{provide:de,useExisting:he(()=>e)}]),$],ngContentSelectors:$ee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var qee=["*"],aA=(()=>{let e=class e extends Ri{getType(){return Nt}get isShaderMaterial(){return this._objRef?.isShaderMaterial}set defines(n){this._objRef&&(this._objRef.defines=n)}get defines(){return this._objRef?.defines}set uniforms(n){this._objRef&&(this._objRef.uniforms=n)}get uniforms(){return this._objRef?.uniforms}set uniformsGroups(n){this._objRef&&(this._objRef.uniformsGroups=n)}get uniformsGroups(){return this._objRef?.uniformsGroups}set vertexShader(n){this._objRef&&(this._objRef.vertexShader=n)}get vertexShader(){return this._objRef?.vertexShader}set fragmentShader(n){this._objRef&&(this._objRef.fragmentShader=n)}get fragmentShader(){return this._objRef?.fragmentShader}set linewidth(n){this._objRef&&(this._objRef.linewidth=n)}get linewidth(){return this._objRef?.linewidth}set wireframe(n){this._objRef&&(this._objRef.wireframe=n)}get wireframe(){return this._objRef?.wireframe}set wireframeLinewidth(n){this._objRef&&(this._objRef.wireframeLinewidth=n)}get wireframeLinewidth(){return this._objRef?.wireframeLinewidth}set fog(n){this._objRef&&(this._objRef.fog=n)}get fog(){return this._objRef?.fog}set lights(n){this._objRef&&(this._objRef.lights=n)}get lights(){return this._objRef?.lights}set clipping(n){this._objRef&&(this._objRef.clipping=n)}get clipping(){return this._objRef?.clipping}set extensions(n){this._objRef&&(this._objRef.extensions=n)}get extensions(){return this._objRef?.extensions}set defaultAttributeValues(n){this._objRef&&(this._objRef.defaultAttributeValues=n)}get defaultAttributeValues(){return this._objRef?.defaultAttributeValues}set index0AttributeName(n){this._objRef&&(this._objRef.index0AttributeName=n)}get index0AttributeName(){return this._objRef?.index0AttributeName}set uniformsNeedUpdate(n){this._objRef&&(this._objRef.uniformsNeedUpdate=n)}get uniformsNeedUpdate(){return this._objRef?.uniformsNeedUpdate}set glslVersion(n){this._objRef&&(this._objRef.glslVersion=n)}get glslVersion(){return this._objRef?.glslVersion}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-shaderMaterial"]],inputs:{defines:"defines",uniforms:"uniforms",uniformsGroups:"uniformsGroups",vertexShader:"vertexShader",fragmentShader:"fragmentShader",linewidth:"linewidth",wireframe:"wireframe",wireframeLinewidth:"wireframeLinewidth",fog:"fog",lights:"lights",clipping:"clipping",extensions:"extensions",defaultAttributeValues:"defaultAttributeValues",index0AttributeName:"index0AttributeName",uniformsNeedUpdate:"uniformsNeedUpdate",glslVersion:"glslVersion"},features:[K([{provide:Ri,useExisting:he(()=>e)}]),$],ngContentSelectors:qee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var vv={name:"SAOShader",defines:{NUM_SAMPLES:7,NUM_RINGS:4,DIFFUSE_TEXTURE:0,PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},tDiffuse:{value:null},tNormal:{value:null},size:{value:new z(512,512)},cameraNear:{value:1},cameraFar:{value:100},cameraProjectionMatrix:{value:new Ee},cameraInverseProjectionMatrix:{value:new Ee},scale:{value:1},intensity:{value:.1},bias:{value:.5},minResolution:{value:0},kernelRadius:{value:100},randomSeed:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`
		#include <common>

		varying vec2 vUv;

		#if DIFFUSE_TEXTURE == 1
		uniform sampler2D tDiffuse;
		#endif

		uniform highp sampler2D tDepth;
		uniform highp sampler2D tNormal;

		uniform float cameraNear;
		uniform float cameraFar;
		uniform mat4 cameraProjectionMatrix;
		uniform mat4 cameraInverseProjectionMatrix;

		uniform float scale;
		uniform float intensity;
		uniform float bias;
		uniform float kernelRadius;
		uniform float minResolution;
		uniform vec2 size;
		uniform float randomSeed;

		// RGBA depth

		#include <packing>

		vec4 getDefaultColor( const in vec2 screenPosition ) {
			#if DIFFUSE_TEXTURE == 1
			return texture2D( tDiffuse, vUv );
			#else
			return vec4( 1.0 );
			#endif
		}

		float getDepth( const in vec2 screenPosition ) {
			return texture2D( tDepth, screenPosition ).x;
		}

		float getViewZ( const in float depth ) {
			#if PERSPECTIVE_CAMERA == 1
			return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );
			#else
			return orthographicDepthToViewZ( depth, cameraNear, cameraFar );
			#endif
		}

		vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {
			float clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];
			vec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );
			clipPosition *= clipW; // unprojection.

			return ( cameraInverseProjectionMatrix * clipPosition ).xyz;
		}

		vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {
			return unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );
		}

		float scaleDividedByCameraFar;
		float minResolutionMultipliedByCameraFar;

		float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {
			vec3 viewDelta = sampleViewPosition - centerViewPosition;
			float viewDistance = length( viewDelta );
			float scaledScreenDistance = scaleDividedByCameraFar * viewDistance;

			return max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );
		}

		// moving costly divides into consts
		const float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );
		const float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );

		float getAmbientOcclusion( const in vec3 centerViewPosition ) {
			// precompute some variables require in getOcclusion.
			scaleDividedByCameraFar = scale / cameraFar;
			minResolutionMultipliedByCameraFar = minResolution * cameraFar;
			vec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );

			// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/
			float angle = rand( vUv + randomSeed ) * PI2;
			vec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES ) / size;
			vec2 radiusStep = radius;

			float occlusionSum = 0.0;
			float weightSum = 0.0;

			for( int i = 0; i < NUM_SAMPLES; i ++ ) {
				vec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;
				radius += radiusStep;
				angle += ANGLE_STEP;

				float sampleDepth = getDepth( sampleUv );
				if( sampleDepth >= ( 1.0 - EPSILON ) ) {
					continue;
				}

				float sampleViewZ = getViewZ( sampleDepth );
				vec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );
				occlusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );
				weightSum += 1.0;
			}

			if( weightSum == 0.0 ) discard;

			return occlusionSum * ( intensity / weightSum );
		}

		void main() {
			float centerDepth = getDepth( vUv );
			if( centerDepth >= ( 1.0 - EPSILON ) ) {
				discard;
			}

			float centerViewZ = getViewZ( centerDepth );
			vec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );

			float ambientOcclusion = getAmbientOcclusion( viewPosition );

			gl_FragColor = getDefaultColor( vUv );
			gl_FragColor.xyz *=  1.0 - ambientOcclusion;
		}`};var hl={name:"DepthLimitedBlurShader",defines:{KERNEL_RADIUS:4,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDiffuse:{value:null},size:{value:new z(512,512)},sampleUvOffsets:{value:[new z(0,0)]},sampleWeights:{value:[1]},tDepth:{value:null},cameraNear:{value:10},cameraFar:{value:1e3},depthCutoff:{value:10}},vertexShader:`

		#include <common>

		uniform vec2 size;

		varying vec2 vUv;
		varying vec2 vInvSize;

		void main() {
			vUv = uv;
			vInvSize = 1.0 / size;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`

		#include <common>
		#include <packing>

		uniform sampler2D tDiffuse;
		uniform sampler2D tDepth;

		uniform float cameraNear;
		uniform float cameraFar;
		uniform float depthCutoff;

		uniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];
		uniform float sampleWeights[ KERNEL_RADIUS + 1 ];

		varying vec2 vUv;
		varying vec2 vInvSize;

		float getDepth( const in vec2 screenPosition ) {
			#if DEPTH_PACKING == 1
			return unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );
			#else
			return texture2D( tDepth, screenPosition ).x;
			#endif
		}

		float getViewZ( const in float depth ) {
			#if PERSPECTIVE_CAMERA == 1
			return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );
			#else
			return orthographicDepthToViewZ( depth, cameraNear, cameraFar );
			#endif
		}

		void main() {
			float depth = getDepth( vUv );
			if( depth >= ( 1.0 - EPSILON ) ) {
				discard;
			}

			float centerViewZ = -getViewZ( depth );
			bool rBreak = false, lBreak = false;

			float weightSum = sampleWeights[0];
			vec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;

			for( int i = 1; i <= KERNEL_RADIUS; i ++ ) {

				float sampleWeight = sampleWeights[i];
				vec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;

				vec2 sampleUv = vUv + sampleUvOffset;
				float viewZ = -getViewZ( getDepth( sampleUv ) );

				if( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;

				if( ! rBreak ) {
					diffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;
					weightSum += sampleWeight;
				}

				sampleUv = vUv - sampleUvOffset;
				viewZ = -getViewZ( getDepth( sampleUv ) );

				if( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;

				if( ! lBreak ) {
					diffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;
					weightSum += sampleWeight;
				}

			}

			gl_FragColor = diffuseSum / weightSum;
		}`},yv={createSampleWeights:function(i,e){let t=[];for(let n=0;n<=i;n++)t.push(Xee(n,e));return t},createSampleOffsets:function(i,e){let t=[];for(let n=0;n<=i;n++)t.push(e.clone().multiplyScalar(n));return t},configure:function(i,e,t,n){i.defines.KERNEL_RADIUS=e,i.uniforms.sampleUvOffsets.value=yv.createSampleOffsets(e,n),i.uniforms.sampleWeights.value=yv.createSampleWeights(e,t),i.needsUpdate=!0}};function Xee(i,e){return Math.exp(-(i*i)/(2*(e*e)))/(Math.sqrt(2*Math.PI)*e)}var cA=(()=>{class i extends Si{constructor(t,n,r=new z(256,256)){super(),this.scene=t,this.camera=n,this.clear=!0,this.needsSwap=!1,this._originalClearColor=new ue,this._oldClearColor=new ue,this._oldClearAlpha=1,this.params={output:0,saoBias:.5,saoIntensity:.18,saoScale:1,saoKernelRadius:100,saoMinResolution:0,saoBlur:!0,saoBlurRadius:8,saoBlurStdDev:4,saoBlurDepthCutoff:.01},this.resolution=new z(r.x,r.y),this.saoRenderTarget=new Qt(this.resolution.x,this.resolution.y,{type:An}),this.blurIntermediateRenderTarget=this.saoRenderTarget.clone();let o=new fo;o.format=ts,o.type=_a,this.normalRenderTarget=new Qt(this.resolution.x,this.resolution.y,{minFilter:Zt,magFilter:Zt,type:An,depthTexture:o}),this.normalMaterial=new da,this.normalMaterial.blending=rn,this.saoMaterial=new Nt({defines:Object.assign({},vv.defines),fragmentShader:vv.fragmentShader,vertexShader:vv.vertexShader,uniforms:Hn.clone(vv.uniforms)}),this.saoMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.saoMaterial.uniforms.tDepth.value=o,this.saoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.saoMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.blending=rn,this.vBlurMaterial=new Nt({uniforms:Hn.clone(hl.uniforms),defines:Object.assign({},hl.defines),vertexShader:hl.vertexShader,fragmentShader:hl.fragmentShader}),this.vBlurMaterial.defines.DEPTH_PACKING=0,this.vBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.vBlurMaterial.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.vBlurMaterial.uniforms.tDepth.value=o,this.vBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.vBlurMaterial.blending=rn,this.hBlurMaterial=new Nt({uniforms:Hn.clone(hl.uniforms),defines:Object.assign({},hl.defines),vertexShader:hl.vertexShader,fragmentShader:hl.fragmentShader}),this.hBlurMaterial.defines.DEPTH_PACKING=0,this.hBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.hBlurMaterial.uniforms.tDiffuse.value=this.blurIntermediateRenderTarget.texture,this.hBlurMaterial.uniforms.tDepth.value=o,this.hBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.hBlurMaterial.blending=rn,this.materialCopy=new Nt({uniforms:Hn.clone(ar.uniforms),vertexShader:ar.vertexShader,fragmentShader:ar.fragmentShader,blending:rn}),this.materialCopy.transparent=!0,this.materialCopy.depthTest=!1,this.materialCopy.depthWrite=!1,this.materialCopy.blending=mu,this.materialCopy.blendSrc=_h,this.materialCopy.blendDst=Kc,this.materialCopy.blendEquation=Er,this.materialCopy.blendSrcAlpha=gh,this.materialCopy.blendDstAlpha=Kc,this.materialCopy.blendEquationAlpha=Er,this.fsQuad=new Ar(null)}render(t,n,r){this.renderToScreen&&(this.materialCopy.blending=rn,this.materialCopy.uniforms.tDiffuse.value=r.texture,this.materialCopy.needsUpdate=!0,this._renderPass(t,this.materialCopy,null)),t.getClearColor(this._oldClearColor),this._oldClearAlpha=t.getClearAlpha();let o=t.autoClear;t.autoClear=!1,this.saoMaterial.uniforms.bias.value=this.params.saoBias,this.saoMaterial.uniforms.intensity.value=this.params.saoIntensity,this.saoMaterial.uniforms.scale.value=this.params.saoScale,this.saoMaterial.uniforms.kernelRadius.value=this.params.saoKernelRadius,this.saoMaterial.uniforms.minResolution.value=this.params.saoMinResolution,this.saoMaterial.uniforms.cameraNear.value=this.camera.near,this.saoMaterial.uniforms.cameraFar.value=this.camera.far;let s=this.params.saoBlurDepthCutoff*(this.camera.far-this.camera.near);this.vBlurMaterial.uniforms.depthCutoff.value=s,this.hBlurMaterial.uniforms.depthCutoff.value=s,this.vBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.vBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.hBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.hBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.params.saoBlurRadius=Math.floor(this.params.saoBlurRadius),(this.prevStdDev!==this.params.saoBlurStdDev||this.prevNumSamples!==this.params.saoBlurRadius)&&(yv.configure(this.vBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new z(0,1)),yv.configure(this.hBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new z(1,0)),this.prevStdDev=this.params.saoBlurStdDev,this.prevNumSamples=this.params.saoBlurRadius),this._renderOverride(t,this.normalMaterial,this.normalRenderTarget,7829503,1),this._renderPass(t,this.saoMaterial,this.saoRenderTarget,16777215,1),this.params.saoBlur&&(this._renderPass(t,this.vBlurMaterial,this.blurIntermediateRenderTarget,16777215,1),this._renderPass(t,this.hBlurMaterial,this.saoRenderTarget,16777215,1));let a=this.materialCopy;this.params.output===i.OUTPUT.Normal?(this.materialCopy.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.materialCopy.needsUpdate=!0):(this.materialCopy.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.materialCopy.needsUpdate=!0),this.params.output===i.OUTPUT.Default?a.blending=mu:a.blending=rn,this._renderPass(t,a,this.renderToScreen?null:r),t.setClearColor(this._oldClearColor,this._oldClearAlpha),t.autoClear=o}setSize(t,n){this.saoRenderTarget.setSize(t,n),this.blurIntermediateRenderTarget.setSize(t,n),this.normalRenderTarget.setSize(t,n),this.saoMaterial.uniforms.size.value.set(t,n),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.needsUpdate=!0,this.vBlurMaterial.uniforms.size.value.set(t,n),this.vBlurMaterial.needsUpdate=!0,this.hBlurMaterial.uniforms.size.value.set(t,n),this.hBlurMaterial.needsUpdate=!0}dispose(){this.saoRenderTarget.dispose(),this.blurIntermediateRenderTarget.dispose(),this.normalRenderTarget.dispose(),this.normalMaterial.dispose(),this.saoMaterial.dispose(),this.vBlurMaterial.dispose(),this.hBlurMaterial.dispose(),this.materialCopy.dispose(),this.fsQuad.dispose()}_renderPass(t,n,r,o,s){t.getClearColor(this._originalClearColor);let a=t.getClearAlpha(),c=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,o!=null&&(t.setClearColor(o),t.setClearAlpha(s||0),t.clear()),this.fsQuad.material=n,this.fsQuad.render(t),t.autoClear=c,t.setClearColor(this._originalClearColor),t.setClearAlpha(a)}_renderOverride(t,n,r,o,s){t.getClearColor(this._originalClearColor);let a=t.getClearAlpha(),c=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,o=n.clearColor||o,s=n.clearAlpha||s,o!=null&&(t.setClearColor(o),t.setClearAlpha(s||0),t.clear()),this.scene.overrideMaterial=n,t.render(this.scene,this.camera),this.scene.overrideMaterial=null,t.autoClear=c,t.setClearColor(this._originalClearColor),t.setClearAlpha(a)}}return i.OUTPUT={Default:0,SAO:1,Normal:2},i})();var Zee=["*"],fl=class fl extends Ln{getType(){return cA}set scene(e){this._objRef&&(this._objRef.scene=e)}get scene(){return this._objRef?.scene}set camera(e){this._objRef&&(this._objRef.camera=e)}get camera(){return this._objRef?.camera}set originalClearColor(e){this._objRef&&(this._objRef.originalClearColor=pe(this._objRef.originalClearColor,e))}get originalClearColor(){return this._objRef?.originalClearColor}set oldClearColor(e){this._objRef&&(this._objRef.oldClearColor=pe(this._objRef.oldClearColor,e))}get oldClearColor(){return this._objRef?.oldClearColor}set oldClearAlpha(e){this._objRef&&(this._objRef.oldClearAlpha=e)}get oldClearAlpha(){return this._objRef?.oldClearAlpha}set resolution(e){this._objRef&&(this._objRef.resolution=pe(this._objRef.resolution,e))}get resolution(){return this._objRef?.resolution}set saoRenderTarget(e){this._objRef&&(this._objRef.saoRenderTarget=e)}get saoRenderTarget(){return this._objRef?.saoRenderTarget}set blurIntermediateRenderTarget(e){this._objRef&&(this._objRef.blurIntermediateRenderTarget=e)}get blurIntermediateRenderTarget(){return this._objRef?.blurIntermediateRenderTarget}set normalRenderTarget(e){this._objRef&&(this._objRef.normalRenderTarget=e)}get normalRenderTarget(){return this._objRef?.normalRenderTarget}set normalMaterial(e){this._objRef&&(this._objRef.normalMaterial=e)}get normalMaterial(){return this._objRef?.normalMaterial}set saoMaterial(e){this._objRef&&(this._objRef.saoMaterial=e)}get saoMaterial(){return this._objRef?.saoMaterial}set vBlurMaterial(e){this._objRef&&(this._objRef.vBlurMaterial=e)}get vBlurMaterial(){return this._objRef?.vBlurMaterial}set hBlurMaterial(e){this._objRef&&(this._objRef.hBlurMaterial=e)}get hBlurMaterial(){return this._objRef?.hBlurMaterial}set materialCopy(e){this._objRef&&(this._objRef.materialCopy=e)}get materialCopy(){return this._objRef?.materialCopy}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}set params(e){this._objRef&&(this._objRef.params=e)}get params(){return this._objRef?.params}};fl.OUTPUT=cA.OUTPUT,fl.\u0275fac=(()=>{let e;return function(n){return(e||(e=q(fl)))(n||fl)}})(),fl.\u0275cmp=O({type:fl,selectors:[["th-sAOPass"]],inputs:{scene:"scene",camera:"camera",originalClearColor:"originalClearColor",oldClearColor:"oldClearColor",oldClearAlpha:"oldClearAlpha",resolution:"resolution",saoRenderTarget:"saoRenderTarget",blurIntermediateRenderTarget:"blurIntermediateRenderTarget",normalRenderTarget:"normalRenderTarget",normalMaterial:"normalMaterial",saoMaterial:"saoMaterial",vBlurMaterial:"vBlurMaterial",hBlurMaterial:"hBlurMaterial",materialCopy:"materialCopy",fsQuad:"fsQuad",params:"params"},features:[K([{provide:gn,useExisting:he(()=>fl)}]),$],ngContentSelectors:Zee,decls:1,vars:0,template:function(t,n){t&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});var zU=fl;var Yee=["*"],fc=(()=>{let e=class e extends Kt{getType(){return Ka}get type(){return this._objRef?.type}get parameters(){return this._objRef?.parameters}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-sphereGeometry"]],features:[K([{provide:Kt,useExisting:he(()=>e)}]),$],ngContentSelectors:Yee,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var fS=class{constructor(e=Math){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(let t=0;t<256;t++)this.p[t]=Math.floor(e.random()*256);this.perm=[];for(let t=0;t<512;t++)this.perm[t]=this.p[t&255];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}noise(e,t){let n,r,o,s=.5*(Math.sqrt(3)-1),a=(e+t)*s,c=Math.floor(e+a),l=Math.floor(t+a),u=(3-Math.sqrt(3))/6,d=(c+l)*u,h=c-d,f=l-d,g=e-h,_=t-f,m,p;g>_?(m=1,p=0):(m=0,p=1);let b=g-m+u,v=_-p+u,y=g-1+2*u,w=_-1+2*u,R=c&255,E=l&255,A=this.perm[R+this.perm[E]]%12,x=this.perm[R+m+this.perm[E+p]]%12,T=this.perm[R+1+this.perm[E+1]]%12,P=.5-g*g-_*_;P<0?n=0:(P*=P,n=P*P*this._dot(this.grad3[A],g,_));let L=.5-b*b-v*v;L<0?r=0:(L*=L,r=L*L*this._dot(this.grad3[x],b,v));let H=.5-y*y-w*w;return H<0?o=0:(H*=H,o=H*H*this._dot(this.grad3[T],y,w)),70*(n+r+o)}noise3d(e,t,n){let r,o,s,a,l=(e+t+n)*.3333333333333333,u=Math.floor(e+l),d=Math.floor(t+l),h=Math.floor(n+l),f=1/6,g=(u+d+h)*f,_=u-g,m=d-g,p=h-g,b=e-_,v=t-m,y=n-p,w,R,E,A,x,T;b>=v?v>=y?(w=1,R=0,E=0,A=1,x=1,T=0):b>=y?(w=1,R=0,E=0,A=1,x=0,T=1):(w=0,R=0,E=1,A=1,x=0,T=1):v<y?(w=0,R=0,E=1,A=0,x=1,T=1):b<y?(w=0,R=1,E=0,A=0,x=1,T=1):(w=0,R=1,E=0,A=1,x=1,T=0);let P=b-w+f,L=v-R+f,H=y-E+f,te=b-A+2*f,Y=v-x+2*f,J=y-T+2*f,W=b-1+3*f,fe=v-1+3*f,ve=y-1+3*f,Re=u&255,Te=d&255,mt=h&255,gt=this.perm[Re+this.perm[Te+this.perm[mt]]]%12,dn=this.perm[Re+w+this.perm[Te+R+this.perm[mt+E]]]%12,_n=this.perm[Re+A+this.perm[Te+x+this.perm[mt+T]]]%12,le=this.perm[Re+1+this.perm[Te+1+this.perm[mt+1]]]%12,_e=.6-b*b-v*v-y*y;_e<0?r=0:(_e*=_e,r=_e*_e*this._dot3(this.grad3[gt],b,v,y));let Le=.6-P*P-L*L-H*H;Le<0?o=0:(Le*=Le,o=Le*Le*this._dot3(this.grad3[dn],P,L,H));let Je=.6-te*te-Y*Y-J*J;Je<0?s=0:(Je*=Je,s=Je*Je*this._dot3(this.grad3[_n],te,Y,J));let Ae=.6-W*W-fe*fe-ve*ve;return Ae<0?a=0:(Ae*=Ae,a=Ae*Ae*this._dot3(this.grad3[le],W,fe,ve)),32*(r+o+s+a)}noise4d(e,t,n,r){let o=this.grad4,s=this.simplex,a=this.perm,c=(Math.sqrt(5)-1)/4,l=(5-Math.sqrt(5))/20,u,d,h,f,g,_=(e+t+n+r)*c,m=Math.floor(e+_),p=Math.floor(t+_),b=Math.floor(n+_),v=Math.floor(r+_),y=(m+p+b+v)*l,w=m-y,R=p-y,E=b-y,A=v-y,x=e-w,T=t-R,P=n-E,L=r-A,H=x>T?32:0,te=x>P?16:0,Y=T>P?8:0,J=x>L?4:0,W=T>L?2:0,fe=P>L?1:0,ve=H+te+Y+J+W+fe,Re=s[ve][0]>=3?1:0,Te=s[ve][1]>=3?1:0,mt=s[ve][2]>=3?1:0,gt=s[ve][3]>=3?1:0,dn=s[ve][0]>=2?1:0,_n=s[ve][1]>=2?1:0,le=s[ve][2]>=2?1:0,_e=s[ve][3]>=2?1:0,Le=s[ve][0]>=1?1:0,Je=s[ve][1]>=1?1:0,Ae=s[ve][2]>=1?1:0,wn=s[ve][3]>=1?1:0,Fn=x-Re+l,zt=T-Te+l,ye=P-mt+l,Me=L-gt+l,xe=x-dn+2*l,Ve=T-_n+2*l,j=P-le+2*l,yt=L-_e+2*l,$e=x-Le+3*l,Mt=T-Je+3*l,Fe=P-Ae+3*l,I=L-wn+3*l,M=x-1+4*l,U=T-1+4*l,se=P-1+4*l,be=L-1+4*l,ce=m&255,Ke=p&255,Ne=b&255,Ye=v&255,Ct=a[ce+a[Ke+a[Ne+a[Ye]]]]%32,Se=a[ce+Re+a[Ke+Te+a[Ne+mt+a[Ye+gt]]]]%32,ke=a[ce+dn+a[Ke+_n+a[Ne+le+a[Ye+_e]]]]%32,it=a[ce+Le+a[Ke+Je+a[Ne+Ae+a[Ye+wn]]]]%32,ft=a[ce+1+a[Ke+1+a[Ne+1+a[Ye+1]]]]%32,je=.6-x*x-T*T-P*P-L*L;je<0?u=0:(je*=je,u=je*je*this._dot4(o[Ct],x,T,P,L));let qt=.6-Fn*Fn-zt*zt-ye*ye-Me*Me;qt<0?d=0:(qt*=qt,d=qt*qt*this._dot4(o[Se],Fn,zt,ye,Me));let k=.6-xe*xe-Ve*Ve-j*j-yt*yt;k<0?h=0:(k*=k,h=k*k*this._dot4(o[ke],xe,Ve,j,yt));let ze=.6-$e*$e-Mt*Mt-Fe*Fe-I*I;ze<0?f=0:(ze*=ze,f=ze*ze*this._dot4(o[it],$e,Mt,Fe,I));let De=.6-M*M-U*U-se*se-be*be;return De<0?g=0:(De*=De,g=De*De*this._dot4(o[ft],M,U,se,be)),27*(u+d+h+f+g)}_dot(e,t,n){return e[0]*t+e[1]*n}_dot3(e,t,n,r){return e[0]*t+e[1]*n+e[2]*r}_dot4(e,t,n,r,o){return e[0]*t+e[1]*n+e[2]*r+e[3]*o}};var xv={name:"SSAOShader",defines:{PERSPECTIVE_CAMERA:1,KERNEL_SIZE:32},uniforms:{tNormal:{value:null},tDepth:{value:null},tNoise:{value:null},kernel:{value:null},cameraNear:{value:null},cameraFar:{value:null},resolution:{value:new z},cameraProjectionMatrix:{value:new Ee},cameraInverseProjectionMatrix:{value:new Ee},kernelRadius:{value:8},minDistance:{value:.005},maxDistance:{value:.05}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`
		uniform highp sampler2D tNormal;
		uniform highp sampler2D tDepth;
		uniform sampler2D tNoise;

		uniform vec3 kernel[ KERNEL_SIZE ];

		uniform vec2 resolution;

		uniform float cameraNear;
		uniform float cameraFar;
		uniform mat4 cameraProjectionMatrix;
		uniform mat4 cameraInverseProjectionMatrix;

		uniform float kernelRadius;
		uniform float minDistance; // avoid artifacts caused by neighbour fragments with minimal depth difference
		uniform float maxDistance; // avoid the influence of fragments which are too far away

		varying vec2 vUv;

		#include <packing>

		float getDepth( const in vec2 screenPosition ) {

			return texture2D( tDepth, screenPosition ).x;

		}

		float getLinearDepth( const in vec2 screenPosition ) {

			#if PERSPECTIVE_CAMERA == 1

				float fragCoordZ = texture2D( tDepth, screenPosition ).x;
				float viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );
				return viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );

			#else

				return texture2D( tDepth, screenPosition ).x;

			#endif

		}

		float getViewZ( const in float depth ) {

			#if PERSPECTIVE_CAMERA == 1

				return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );

			#else

				return orthographicDepthToViewZ( depth, cameraNear, cameraFar );

			#endif

		}

		vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {

			float clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];

			vec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );

			clipPosition *= clipW; // unprojection.

			return ( cameraInverseProjectionMatrix * clipPosition ).xyz;

		}

		vec3 getViewNormal( const in vec2 screenPosition ) {

			return unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );

		}

		void main() {

			float depth = getDepth( vUv );

			if ( depth == 1.0 ) {

				gl_FragColor = vec4( 1.0 ); // don't influence background

			} else {

				float viewZ = getViewZ( depth );

				vec3 viewPosition = getViewPosition( vUv, depth, viewZ );
				vec3 viewNormal = getViewNormal( vUv );

				vec2 noiseScale = vec2( resolution.x / 4.0, resolution.y / 4.0 );
				vec3 random = vec3( texture2D( tNoise, vUv * noiseScale ).r );

				// compute matrix used to reorient a kernel vector

				vec3 tangent = normalize( random - viewNormal * dot( random, viewNormal ) );
				vec3 bitangent = cross( viewNormal, tangent );
				mat3 kernelMatrix = mat3( tangent, bitangent, viewNormal );

				float occlusion = 0.0;

				for ( int i = 0; i < KERNEL_SIZE; i ++ ) {

					vec3 sampleVector = kernelMatrix * kernel[ i ]; // reorient sample vector in view space
					vec3 samplePoint = viewPosition + ( sampleVector * kernelRadius ); // calculate sample point

					vec4 samplePointNDC = cameraProjectionMatrix * vec4( samplePoint, 1.0 ); // project point and calculate NDC
					samplePointNDC /= samplePointNDC.w;

					vec2 samplePointUv = samplePointNDC.xy * 0.5 + 0.5; // compute uv coordinates

					float realDepth = getLinearDepth( samplePointUv ); // get linear depth from depth texture
					float sampleDepth = viewZToOrthographicDepth( samplePoint.z, cameraNear, cameraFar ); // compute linear depth of the sample view Z value
					float delta = sampleDepth - realDepth;

					if ( delta > minDistance && delta < maxDistance ) { // if fragment is before sample point, increase occlusion

						occlusion += 1.0;

					}

				}

				occlusion = clamp( occlusion / float( KERNEL_SIZE ), 0.0, 1.0 );

				gl_FragColor = vec4( vec3( 1.0 - occlusion ), 1.0 );

			}

		}`},wv={name:"SSAODepthShader",defines:{PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null}},vertexShader:`varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`uniform sampler2D tDepth;

		uniform float cameraNear;
		uniform float cameraFar;

		varying vec2 vUv;

		#include <packing>

		float getLinearDepth( const in vec2 screenPosition ) {

			#if PERSPECTIVE_CAMERA == 1

				float fragCoordZ = texture2D( tDepth, screenPosition ).x;
				float viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );
				return viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );

			#else

				return texture2D( tDepth, screenPosition ).x;

			#endif

		}

		void main() {

			float depth = getLinearDepth( vUv );
			gl_FragColor = vec4( vec3( 1.0 - depth ), 1.0 );

		}`},Mv={name:"SSAOBlurShader",uniforms:{tDiffuse:{value:null},resolution:{value:new z}},vertexShader:`varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`uniform sampler2D tDiffuse;

		uniform vec2 resolution;

		varying vec2 vUv;

		void main() {

			vec2 texelSize = ( 1.0 / resolution );
			float result = 0.0;

			for ( int i = - 2; i <= 2; i ++ ) {

				for ( int j = - 2; j <= 2; j ++ ) {

					vec2 offset = ( vec2( float( i ), float( j ) ) ) * texelSize;
					result += texture2D( tDiffuse, vUv + offset ).r;

				}

			}

			gl_FragColor = vec4( vec3( result / ( 5.0 * 5.0 ) ), 1.0 );

		}`};var lA=(()=>{class i extends Si{constructor(t,n,r=512,o=512,s=32){super(),this.width=r,this.height=o,this.clear=!0,this.needsSwap=!1,this.camera=n,this.scene=t,this.kernelRadius=8,this.kernel=[],this.noiseTexture=null,this.output=0,this.minDistance=.005,this.maxDistance=.1,this._visibilityCache=[],this._generateSampleKernel(s),this._generateRandomKernelRotations();let a=new fo;a.format=ts,a.type=_a,this.normalRenderTarget=new Qt(this.width,this.height,{minFilter:Zt,magFilter:Zt,type:An,depthTexture:a}),this.ssaoRenderTarget=new Qt(this.width,this.height,{type:An}),this.blurRenderTarget=this.ssaoRenderTarget.clone(),this.ssaoMaterial=new Nt({defines:Object.assign({},xv.defines),uniforms:Hn.clone(xv.uniforms),vertexShader:xv.vertexShader,fragmentShader:xv.fragmentShader,blending:rn}),this.ssaoMaterial.defines.KERNEL_SIZE=s,this.ssaoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.ssaoMaterial.uniforms.tDepth.value=this.normalRenderTarget.depthTexture,this.ssaoMaterial.uniforms.tNoise.value=this.noiseTexture,this.ssaoMaterial.uniforms.kernel.value=this.kernel,this.ssaoMaterial.uniforms.cameraNear.value=this.camera.near,this.ssaoMaterial.uniforms.cameraFar.value=this.camera.far,this.ssaoMaterial.uniforms.resolution.value.set(this.width,this.height),this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.normalMaterial=new da,this.normalMaterial.blending=rn,this.blurMaterial=new Nt({defines:Object.assign({},Mv.defines),uniforms:Hn.clone(Mv.uniforms),vertexShader:Mv.vertexShader,fragmentShader:Mv.fragmentShader}),this.blurMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.blurMaterial.uniforms.resolution.value.set(this.width,this.height),this.depthRenderMaterial=new Nt({defines:Object.assign({},wv.defines),uniforms:Hn.clone(wv.uniforms),vertexShader:wv.vertexShader,fragmentShader:wv.fragmentShader,blending:rn}),this.depthRenderMaterial.uniforms.tDepth.value=this.normalRenderTarget.depthTexture,this.depthRenderMaterial.uniforms.cameraNear.value=this.camera.near,this.depthRenderMaterial.uniforms.cameraFar.value=this.camera.far,this.copyMaterial=new Nt({uniforms:Hn.clone(ar.uniforms),vertexShader:ar.vertexShader,fragmentShader:ar.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:_h,blendDst:Kc,blendEquation:Er,blendSrcAlpha:gh,blendDstAlpha:Kc,blendEquationAlpha:Er}),this._fsQuad=new Ar(null),this._originalClearColor=new ue}dispose(){this.normalRenderTarget.dispose(),this.ssaoRenderTarget.dispose(),this.blurRenderTarget.dispose(),this.normalMaterial.dispose(),this.blurMaterial.dispose(),this.copyMaterial.dispose(),this.depthRenderMaterial.dispose(),this._fsQuad.dispose()}render(t,n,r){switch(this._overrideVisibility(),this._renderOverride(t,this.normalMaterial,this.normalRenderTarget,7829503,1),this._restoreVisibility(),this.ssaoMaterial.uniforms.kernelRadius.value=this.kernelRadius,this.ssaoMaterial.uniforms.minDistance.value=this.minDistance,this.ssaoMaterial.uniforms.maxDistance.value=this.maxDistance,this._renderPass(t,this.ssaoMaterial,this.ssaoRenderTarget),this._renderPass(t,this.blurMaterial,this.blurRenderTarget),this.output){case i.OUTPUT.SSAO:this.copyMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.copyMaterial.blending=rn,this._renderPass(t,this.copyMaterial,this.renderToScreen?null:r);break;case i.OUTPUT.Blur:this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=rn,this._renderPass(t,this.copyMaterial,this.renderToScreen?null:r);break;case i.OUTPUT.Depth:this._renderPass(t,this.depthRenderMaterial,this.renderToScreen?null:r);break;case i.OUTPUT.Normal:this.copyMaterial.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.copyMaterial.blending=rn,this._renderPass(t,this.copyMaterial,this.renderToScreen?null:r);break;case i.OUTPUT.Default:this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=mu,this._renderPass(t,this.copyMaterial,this.renderToScreen?null:r);break;default:console.warn("THREE.SSAOPass: Unknown output type.")}}setSize(t,n){this.width=t,this.height=n,this.ssaoRenderTarget.setSize(t,n),this.normalRenderTarget.setSize(t,n),this.blurRenderTarget.setSize(t,n),this.ssaoMaterial.uniforms.resolution.value.set(t,n),this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.blurMaterial.uniforms.resolution.value.set(t,n)}_renderPass(t,n,r,o,s){t.getClearColor(this._originalClearColor);let a=t.getClearAlpha(),c=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,o!=null&&(t.setClearColor(o),t.setClearAlpha(s||0),t.clear()),this._fsQuad.material=n,this._fsQuad.render(t),t.autoClear=c,t.setClearColor(this._originalClearColor),t.setClearAlpha(a)}_renderOverride(t,n,r,o,s){t.getClearColor(this._originalClearColor);let a=t.getClearAlpha(),c=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,o=n.clearColor||o,s=n.clearAlpha||s,o!=null&&(t.setClearColor(o),t.setClearAlpha(s||0),t.clear()),this.scene.overrideMaterial=n,t.render(this.scene,this.camera),this.scene.overrideMaterial=null,t.autoClear=c,t.setClearColor(this._originalClearColor),t.setClearAlpha(a)}_generateSampleKernel(t){let n=this.kernel;for(let r=0;r<t;r++){let o=new C;o.x=Math.random()*2-1,o.y=Math.random()*2-1,o.z=Math.random(),o.normalize();let s=r/t;s=Ze.lerp(.1,1,s*s),o.multiplyScalar(s),n.push(o)}}_generateRandomKernelRotations(){let r=new fS,o=4*4,s=new Float32Array(o);for(let a=0;a<o;a++){let c=Math.random()*2-1,l=Math.random()*2-1,u=0;s[a]=r.noise3d(c,l,u)}this.noiseTexture=new Cr(s,4,4,nl,tr),this.noiseTexture.wrapS=Qo,this.noiseTexture.wrapT=Qo,this.noiseTexture.needsUpdate=!0}_overrideVisibility(){let t=this.scene,n=this._visibilityCache;t.traverse(function(r){(r.isPoints||r.isLine||r.isLine2)&&r.visible&&(r.visible=!1,n.push(r))})}_restoreVisibility(){let t=this._visibilityCache;for(let n=0;n<t.length;n++)t[n].visible=!0;t.length=0}}return i.OUTPUT={Default:0,SSAO:1,Blur:2,Depth:3,Normal:4},i})();var Qee=["*"],pl=class pl extends Ln{getType(){return lA}set scene(e){this._objRef&&(this._objRef.scene=e)}get scene(){return this._objRef?.scene}set camera(e){this._objRef&&(this._objRef.camera=e)}get camera(){return this._objRef?.camera}set width(e){this._objRef&&(this._objRef.width=e)}get width(){return this._objRef?.width}set height(e){this._objRef&&(this._objRef.height=e)}get height(){return this._objRef?.height}set clear(e){this._objRef&&(this._objRef.clear=e)}get clear(){return this._objRef?.clear}set kernelRadius(e){this._objRef&&(this._objRef.kernelRadius=e)}get kernelRadius(){return this._objRef?.kernelRadius}set kernel(e){this._objRef&&(this._objRef.kernel=e)}get kernel(){return this._objRef?.kernel}set noiseTexture(e){this._objRef&&(this._objRef.noiseTexture=e)}get noiseTexture(){return this._objRef?.noiseTexture}set output(e){this._objRef&&(this._objRef.output=e)}get output(){return this._objRef?.output}set minDistance(e){this._objRef&&(this._objRef.minDistance=e)}get minDistance(){return this._objRef?.minDistance}set maxDistance(e){this._objRef&&(this._objRef.maxDistance=e)}get maxDistance(){return this._objRef?.maxDistance}set normalRenderTarget(e){this._objRef&&(this._objRef.normalRenderTarget=e)}get normalRenderTarget(){return this._objRef?.normalRenderTarget}set ssaoRenderTarget(e){this._objRef&&(this._objRef.ssaoRenderTarget=e)}get ssaoRenderTarget(){return this._objRef?.ssaoRenderTarget}set blurRenderTarget(e){this._objRef&&(this._objRef.blurRenderTarget=e)}get blurRenderTarget(){return this._objRef?.blurRenderTarget}set ssaoMaterial(e){this._objRef&&(this._objRef.ssaoMaterial=e)}get ssaoMaterial(){return this._objRef?.ssaoMaterial}set normalMaterial(e){this._objRef&&(this._objRef.normalMaterial=e)}get normalMaterial(){return this._objRef?.normalMaterial}set blurMaterial(e){this._objRef&&(this._objRef.blurMaterial=e)}get blurMaterial(){return this._objRef?.blurMaterial}set depthRenderMaterial(e){this._objRef&&(this._objRef.depthRenderMaterial=e)}get depthRenderMaterial(){return this._objRef?.depthRenderMaterial}set copyMaterial(e){this._objRef&&(this._objRef.copyMaterial=e)}get copyMaterial(){return this._objRef?.copyMaterial}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}set originalClearColor(e){this._objRef&&(this._objRef.originalClearColor=pe(this._objRef.originalClearColor,e))}get originalClearColor(){return this._objRef?.originalClearColor}};pl.OUTPUT=lA.OUTPUT,pl.\u0275fac=(()=>{let e;return function(n){return(e||(e=q(pl)))(n||pl)}})(),pl.\u0275cmp=O({type:pl,selectors:[["th-sSAOPass"]],inputs:{scene:"scene",camera:"camera",width:"width",height:"height",clear:"clear",kernelRadius:"kernelRadius",kernel:"kernel",noiseTexture:"noiseTexture",output:"output",minDistance:"minDistance",maxDistance:"maxDistance",normalRenderTarget:"normalRenderTarget",ssaoRenderTarget:"ssaoRenderTarget",blurRenderTarget:"blurRenderTarget",ssaoMaterial:"ssaoMaterial",normalMaterial:"normalMaterial",blurMaterial:"blurMaterial",depthRenderMaterial:"depthRenderMaterial",copyMaterial:"copyMaterial",fsQuad:"fsQuad",originalClearColor:"originalClearColor"},features:[K([{provide:gn,useExisting:he(()=>pl)}]),$],ngContentSelectors:Qee,decls:1,vars:0,template:function(t,n){t&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});var HU=pl;var Ra={name:"SSRShader",defines:{MAX_STEP:0,PERSPECTIVE_CAMERA:!0,DISTANCE_ATTENUATION:!0,FRESNEL:!0,INFINITE_THICK:!1,SELECTIVE:!1},uniforms:{tDiffuse:{value:null},tNormal:{value:null},tMetalness:{value:null},tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null},resolution:{value:new z},cameraProjectionMatrix:{value:new Ee},cameraInverseProjectionMatrix:{value:new Ee},opacity:{value:.5},maxDistance:{value:180},cameraRange:{value:0},thickness:{value:.018}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}

	`,fragmentShader:`
		// precision highp float;
		precision highp sampler2D;
		varying vec2 vUv;
		uniform sampler2D tDepth;
		uniform sampler2D tNormal;
		uniform sampler2D tMetalness;
		uniform sampler2D tDiffuse;
		uniform float cameraRange;
		uniform vec2 resolution;
		uniform float opacity;
		uniform float cameraNear;
		uniform float cameraFar;
		uniform float maxDistance;
		uniform float thickness;
		uniform mat4 cameraProjectionMatrix;
		uniform mat4 cameraInverseProjectionMatrix;
		#include <packing>
		float pointToLineDistance(vec3 x0, vec3 x1, vec3 x2) {
			//x0: point, x1: linePointA, x2: linePointB
			//https://mathworld.wolfram.com/Point-LineDistance3-Dimensional.html
			return length(cross(x0-x1,x0-x2))/length(x2-x1);
		}
		float pointPlaneDistance(vec3 point,vec3 planePoint,vec3 planeNormal){
			// https://mathworld.wolfram.com/Point-PlaneDistance.html
			//// https://en.wikipedia.org/wiki/Plane_(geometry)
			//// http://paulbourke.net/geometry/pointlineplane/
			float a=planeNormal.x,b=planeNormal.y,c=planeNormal.z;
			float x0=point.x,y0=point.y,z0=point.z;
			float x=planePoint.x,y=planePoint.y,z=planePoint.z;
			float d=-(a*x+b*y+c*z);
			float distance=(a*x0+b*y0+c*z0+d)/sqrt(a*a+b*b+c*c);
			return distance;
		}
		float getDepth( const in vec2 uv ) {
			return texture2D( tDepth, uv ).x;
		}
		float getViewZ( const in float depth ) {
			#ifdef PERSPECTIVE_CAMERA
				return perspectiveDepthToViewZ( depth, cameraNear, cameraFar );
			#else
				return orthographicDepthToViewZ( depth, cameraNear, cameraFar );
			#endif
		}
		vec3 getViewPosition( const in vec2 uv, const in float depth/*clip space*/, const in float clipW ) {
			vec4 clipPosition = vec4( ( vec3( uv, depth ) - 0.5 ) * 2.0, 1.0 );//ndc
			clipPosition *= clipW; //clip
			return ( cameraInverseProjectionMatrix * clipPosition ).xyz;//view
		}
		vec3 getViewNormal( const in vec2 uv ) {
			return unpackRGBToNormal( texture2D( tNormal, uv ).xyz );
		}
		vec2 viewPositionToXY(vec3 viewPosition){
			vec2 xy;
			vec4 clip=cameraProjectionMatrix*vec4(viewPosition,1);
			xy=clip.xy;//clip
			float clipW=clip.w;
			xy/=clipW;//NDC
			xy=(xy+1.)/2.;//uv
			xy*=resolution;//screen
			return xy;
		}
		void main(){
			#ifdef SELECTIVE
				float metalness=texture2D(tMetalness,vUv).r;
				if(metalness==0.) return;
			#endif

			float depth = getDepth( vUv );
			float viewZ = getViewZ( depth );
			if(-viewZ>=cameraFar) return;

			float clipW = cameraProjectionMatrix[2][3] * viewZ+cameraProjectionMatrix[3][3];
			vec3 viewPosition=getViewPosition( vUv, depth, clipW );

			vec2 d0=gl_FragCoord.xy;
			vec2 d1;

			vec3 viewNormal=getViewNormal( vUv );

			#ifdef PERSPECTIVE_CAMERA
				vec3 viewIncidentDir=normalize(viewPosition);
				vec3 viewReflectDir=reflect(viewIncidentDir,viewNormal);
			#else
				vec3 viewIncidentDir=vec3(0,0,-1);
				vec3 viewReflectDir=reflect(viewIncidentDir,viewNormal);
			#endif

			float maxReflectRayLen=maxDistance/dot(-viewIncidentDir,viewNormal);
			// dot(a,b)==length(a)*length(b)*cos(theta) // https://www.mathsisfun.com/algebra/vectors-dot-product.html
			// if(a.isNormalized&&b.isNormalized) dot(a,b)==cos(theta)
			// maxDistance/maxReflectRayLen=cos(theta)
			// maxDistance/maxReflectRayLen==dot(a,b)
			// maxReflectRayLen==maxDistance/dot(a,b)

			vec3 d1viewPosition=viewPosition+viewReflectDir*maxReflectRayLen;
			#ifdef PERSPECTIVE_CAMERA
				if(d1viewPosition.z>-cameraNear){
					//https://tutorial.math.lamar.edu/Classes/CalcIII/EqnsOfLines.aspx
					float t=(-cameraNear-viewPosition.z)/viewReflectDir.z;
					d1viewPosition=viewPosition+viewReflectDir*t;
				}
			#endif
			d1=viewPositionToXY(d1viewPosition);

			float totalLen=length(d1-d0);
			float xLen=d1.x-d0.x;
			float yLen=d1.y-d0.y;
			float totalStep=max(abs(xLen),abs(yLen));
			float xSpan=xLen/totalStep;
			float ySpan=yLen/totalStep;
			for(float i=0.;i<float(MAX_STEP);i++){
				if(i>=totalStep) break;
				vec2 xy=vec2(d0.x+i*xSpan,d0.y+i*ySpan);
				if(xy.x<0.||xy.x>resolution.x||xy.y<0.||xy.y>resolution.y) break;
				float s=length(xy-d0)/totalLen;
				vec2 uv=xy/resolution;

				float d = getDepth(uv);
				float vZ = getViewZ( d );
				if(-vZ>=cameraFar) continue;
				float cW = cameraProjectionMatrix[2][3] * vZ+cameraProjectionMatrix[3][3];
				vec3 vP=getViewPosition( uv, d, cW );

				#ifdef PERSPECTIVE_CAMERA
					// https://comp.nus.edu.sg/~lowkl/publications/lowk_persp_interp_techrep.pdf
					float recipVPZ=1./viewPosition.z;
					float viewReflectRayZ=1./(recipVPZ+s*(1./d1viewPosition.z-recipVPZ));
				#else
					float viewReflectRayZ=viewPosition.z+s*(d1viewPosition.z-viewPosition.z);
				#endif

				// if(viewReflectRayZ>vZ) continue; // will cause "npm run make-screenshot webgl_postprocessing_ssr" high probability hang.
				// https://github.com/mrdoob/three.js/pull/21539#issuecomment-821061164
				if(viewReflectRayZ<=vZ){

					bool hit;
					#ifdef INFINITE_THICK
						hit=true;
					#else
						float away=pointToLineDistance(vP,viewPosition,d1viewPosition);

						float minThickness;
						vec2 xyNeighbor=xy;
						xyNeighbor.x+=1.;
						vec2 uvNeighbor=xyNeighbor/resolution;
						vec3 vPNeighbor=getViewPosition(uvNeighbor,d,cW);
						minThickness=vPNeighbor.x-vP.x;
						minThickness*=3.;
						float tk=max(minThickness,thickness);

						hit=away<=tk;
					#endif

					if(hit){
						vec3 vN=getViewNormal( uv );
						if(dot(viewReflectDir,vN)>=0.) continue;
						float distance=pointPlaneDistance(vP,viewPosition,viewNormal);
						if(distance>maxDistance) break;
						float op=opacity;
						#ifdef DISTANCE_ATTENUATION
							float ratio=1.-(distance/maxDistance);
							float attenuation=ratio*ratio;
							op=opacity*attenuation;
						#endif
						#ifdef FRESNEL
							float fresnelCoe=(dot(viewIncidentDir,viewReflectDir)+1.)/2.;
							op*=fresnelCoe;
						#endif
						vec4 reflectColor=texture2D(tDiffuse,uv);
						gl_FragColor.xyz=reflectColor.xyz;
						gl_FragColor.a=op;
						break;
					}
				}
			}
		}
	`},Sv={name:"SSRDepthShader",defines:{PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}

	`,fragmentShader:`

		uniform sampler2D tDepth;

		uniform float cameraNear;
		uniform float cameraFar;

		varying vec2 vUv;

		#include <packing>

		float getLinearDepth( const in vec2 uv ) {

			#if PERSPECTIVE_CAMERA == 1

				float fragCoordZ = texture2D( tDepth, uv ).x;
				float viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );
				return viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );

			#else

				return texture2D( tDepth, uv ).x;

			#endif

		}

		void main() {

			float depth = getLinearDepth( vUv );
			float d = 1.0 - depth;
			// d=(d-.999)*1000.;
			gl_FragColor = vec4( vec3( d ), 1.0 );

		}

	`},ml={name:"SSRBlurShader",uniforms:{tDiffuse:{value:null},resolution:{value:new z},opacity:{value:.5}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}

	`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec2 resolution;
		varying vec2 vUv;
		void main() {
			//reverse engineering from PhotoShop blur filter, then change coefficient

			vec2 texelSize = ( 1.0 / resolution );

			vec4 c=texture2D(tDiffuse,vUv);

			vec2 offset;

			offset=(vec2(-1,0))*texelSize;
			vec4 cl=texture2D(tDiffuse,vUv+offset);

			offset=(vec2(1,0))*texelSize;
			vec4 cr=texture2D(tDiffuse,vUv+offset);

			offset=(vec2(0,-1))*texelSize;
			vec4 cb=texture2D(tDiffuse,vUv+offset);

			offset=(vec2(0,1))*texelSize;
			vec4 ct=texture2D(tDiffuse,vUv+offset);

			// float coeCenter=.5;
			// float coeSide=.125;
			float coeCenter=.2;
			float coeSide=.2;
			float a=c.a*coeCenter+cl.a*coeSide+cr.a*coeSide+cb.a*coeSide+ct.a*coeSide;
			vec3 rgb=(c.rgb*c.a*coeCenter+cl.rgb*cl.a*coeSide+cr.rgb*cr.a*coeSide+cb.rgb*cb.a*coeSide+ct.rgb*ct.a*coeSide)/a;
			gl_FragColor=vec4(rgb,a);

		}
	`};var uA=(()=>{class i extends Si{constructor({renderer:t,scene:n,camera:r,width:o=512,height:s=512,selects:a=null,bouncing:c=!1,groundReflector:l=null}){super(),this.width=o,this.height=s,this.clear=!0,this.renderer=t,this.scene=n,this.camera=r,this.groundReflector=l,this.opacity=Ra.uniforms.opacity.value,this.output=0,this.maxDistance=Ra.uniforms.maxDistance.value,this.thickness=Ra.uniforms.thickness.value,this.tempColor=new ue,this._selects=a,this._resolutionScale=1,this.selective=Array.isArray(this._selects),Object.defineProperty(this,"selects",{get(){return this._selects},set(d){this._selects!==d&&(this._selects=d,Array.isArray(d)?(this.selective=!0,this.ssrMaterial.defines.SELECTIVE=!0,this.ssrMaterial.needsUpdate=!0):(this.selective=!1,this.ssrMaterial.defines.SELECTIVE=!1,this.ssrMaterial.needsUpdate=!0))}}),this._bouncing=c,Object.defineProperty(this,"bouncing",{get(){return this._bouncing},set(d){this._bouncing!==d&&(this._bouncing=d,d?this.ssrMaterial.uniforms.tDiffuse.value=this.prevRenderTarget.texture:this.ssrMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture)}}),this.blur=!0,this._distanceAttenuation=Ra.defines.DISTANCE_ATTENUATION,Object.defineProperty(this,"distanceAttenuation",{get(){return this._distanceAttenuation},set(d){this._distanceAttenuation!==d&&(this._distanceAttenuation=d,this.ssrMaterial.defines.DISTANCE_ATTENUATION=d,this.ssrMaterial.needsUpdate=!0)}}),this._fresnel=Ra.defines.FRESNEL,Object.defineProperty(this,"fresnel",{get(){return this._fresnel},set(d){this._fresnel!==d&&(this._fresnel=d,this.ssrMaterial.defines.FRESNEL=d,this.ssrMaterial.needsUpdate=!0)}}),this._infiniteThick=Ra.defines.INFINITE_THICK,Object.defineProperty(this,"infiniteThick",{get(){return this._infiniteThick},set(d){this._infiniteThick!==d&&(this._infiniteThick=d,this.ssrMaterial.defines.INFINITE_THICK=d,this.ssrMaterial.needsUpdate=!0)}});let u=new fo;u.type=tl,u.minFilter=Zt,u.magFilter=Zt,this.beautyRenderTarget=new Qt(this.width,this.height,{minFilter:Zt,magFilter:Zt,type:An,depthTexture:u,depthBuffer:!0}),this.prevRenderTarget=new Qt(this.width,this.height,{minFilter:Zt,magFilter:Zt}),this.normalRenderTarget=new Qt(this.width,this.height,{minFilter:Zt,magFilter:Zt,type:An}),this.metalnessRenderTarget=new Qt(this.width,this.height,{minFilter:Zt,magFilter:Zt,type:An}),this.ssrRenderTarget=new Qt(this.width,this.height,{minFilter:Zt,magFilter:Zt}),this.blurRenderTarget=this.ssrRenderTarget.clone(),this.blurRenderTarget2=this.ssrRenderTarget.clone(),this.ssrMaterial=new Nt({defines:Object.assign({},Ra.defines,{MAX_STEP:Math.sqrt(this.width*this.width+this.height*this.height)}),uniforms:Hn.clone(Ra.uniforms),vertexShader:Ra.vertexShader,fragmentShader:Ra.fragmentShader,blending:rn}),this.ssrMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.ssrMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.ssrMaterial.defines.SELECTIVE=this.selective,this.ssrMaterial.needsUpdate=!0,this.ssrMaterial.uniforms.tMetalness.value=this.metalnessRenderTarget.texture,this.ssrMaterial.uniforms.tDepth.value=this.beautyRenderTarget.depthTexture,this.ssrMaterial.uniforms.cameraNear.value=this.camera.near,this.ssrMaterial.uniforms.cameraFar.value=this.camera.far,this.ssrMaterial.uniforms.thickness.value=this.thickness,this.ssrMaterial.uniforms.resolution.value.set(this.width,this.height),this.ssrMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssrMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.normalMaterial=new da,this.normalMaterial.blending=rn,this.metalnessOnMaterial=new ci({color:"white"}),this.metalnessOffMaterial=new ci({color:"black"}),this.blurMaterial=new Nt({defines:Object.assign({},ml.defines),uniforms:Hn.clone(ml.uniforms),vertexShader:ml.vertexShader,fragmentShader:ml.fragmentShader}),this.blurMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.blurMaterial.uniforms.resolution.value.set(this.width,this.height),this.blurMaterial2=new Nt({defines:Object.assign({},ml.defines),uniforms:Hn.clone(ml.uniforms),vertexShader:ml.vertexShader,fragmentShader:ml.fragmentShader}),this.blurMaterial2.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.blurMaterial2.uniforms.resolution.value.set(this.width,this.height),this.depthRenderMaterial=new Nt({defines:Object.assign({},Sv.defines),uniforms:Hn.clone(Sv.uniforms),vertexShader:Sv.vertexShader,fragmentShader:Sv.fragmentShader,blending:rn}),this.depthRenderMaterial.uniforms.tDepth.value=this.beautyRenderTarget.depthTexture,this.depthRenderMaterial.uniforms.cameraNear.value=this.camera.near,this.depthRenderMaterial.uniforms.cameraFar.value=this.camera.far,this.copyMaterial=new Nt({uniforms:Hn.clone(ar.uniforms),vertexShader:ar.vertexShader,fragmentShader:ar.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:eu,blendDst:tu,blendEquation:Er,blendSrcAlpha:eu,blendDstAlpha:tu,blendEquationAlpha:Er}),this.fsQuad=new Ar(null),this.originalClearColor=new ue}get resolutionScale(){return this._resolutionScale}set resolutionScale(t){this._resolutionScale=t,this.setSize(this.width,this.height)}dispose(){this.beautyRenderTarget.dispose(),this.prevRenderTarget.dispose(),this.normalRenderTarget.dispose(),this.metalnessRenderTarget.dispose(),this.ssrRenderTarget.dispose(),this.blurRenderTarget.dispose(),this.blurRenderTarget2.dispose(),this.normalMaterial.dispose(),this.metalnessOnMaterial.dispose(),this.metalnessOffMaterial.dispose(),this.blurMaterial.dispose(),this.blurMaterial2.dispose(),this.copyMaterial.dispose(),this.depthRenderMaterial.dispose(),this.fsQuad.dispose()}render(t,n){switch(t.setRenderTarget(this.beautyRenderTarget),t.clear(),this.groundReflector&&(this.groundReflector.visible=!1,this.groundReflector.doRender(this.renderer,this.scene,this.camera),this.groundReflector.visible=!0),t.render(this.scene,this.camera),this.groundReflector&&(this.groundReflector.visible=!1),this._renderOverride(t,this.normalMaterial,this.normalRenderTarget,0,0),this.selective&&this._renderMetalness(t,this.metalnessOnMaterial,this.metalnessRenderTarget,0,0),this.ssrMaterial.uniforms.opacity.value=this.opacity,this.ssrMaterial.uniforms.maxDistance.value=this.maxDistance,this.ssrMaterial.uniforms.thickness.value=this.thickness,this._renderPass(t,this.ssrMaterial,this.ssrRenderTarget),this.blur&&(this._renderPass(t,this.blurMaterial,this.blurRenderTarget),this._renderPass(t,this.blurMaterial2,this.blurRenderTarget2)),this.output){case i.OUTPUT.Default:this.bouncing?(this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=rn,this._renderPass(t,this.copyMaterial,this.prevRenderTarget),this.blur?this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget2.texture:this.copyMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.copyMaterial.blending=ys,this._renderPass(t,this.copyMaterial,this.prevRenderTarget),this.copyMaterial.uniforms.tDiffuse.value=this.prevRenderTarget.texture,this.copyMaterial.blending=rn,this._renderPass(t,this.copyMaterial,this.renderToScreen?null:n)):(this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=rn,this._renderPass(t,this.copyMaterial,this.renderToScreen?null:n),this.blur?this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget2.texture:this.copyMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.copyMaterial.blending=ys,this._renderPass(t,this.copyMaterial,this.renderToScreen?null:n));break;case i.OUTPUT.SSR:this.blur?this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget2.texture:this.copyMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.copyMaterial.blending=rn,this._renderPass(t,this.copyMaterial,this.renderToScreen?null:n),this.bouncing&&(this.blur?this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget2.texture:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=rn,this._renderPass(t,this.copyMaterial,this.prevRenderTarget),this.copyMaterial.uniforms.tDiffuse.value=this.ssrRenderTarget.texture,this.copyMaterial.blending=ys,this._renderPass(t,this.copyMaterial,this.prevRenderTarget));break;case i.OUTPUT.Beauty:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=rn,this._renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Depth:this._renderPass(t,this.depthRenderMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Normal:this.copyMaterial.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.copyMaterial.blending=rn,this._renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;case i.OUTPUT.Metalness:this.copyMaterial.uniforms.tDiffuse.value=this.metalnessRenderTarget.texture,this.copyMaterial.blending=rn,this._renderPass(t,this.copyMaterial,this.renderToScreen?null:n);break;default:console.warn("THREE.SSRPass: Unknown output type.")}}setSize(t,n){this.width=t,this.height=n;let r=Math.round(this.resolutionScale*t),o=Math.round(this.resolutionScale*n);this.ssrMaterial.defines.MAX_STEP=Math.sqrt(r*r+o*o),this.ssrMaterial.needsUpdate=!0,this.beautyRenderTarget.setSize(t,n),this.normalRenderTarget.setSize(t,n),this.metalnessRenderTarget.setSize(t,n),this.ssrRenderTarget.setSize(r,o),this.prevRenderTarget.setSize(r,o),this.blurRenderTarget.setSize(r,o),this.blurRenderTarget2.setSize(r,o),this.ssrMaterial.uniforms.resolution.value.set(r,o),this.ssrMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssrMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.blurMaterial.uniforms.resolution.value.set(r,o),this.blurMaterial2.uniforms.resolution.value.set(r,o)}_renderPass(t,n,r,o,s){this.originalClearColor.copy(t.getClearColor(this.tempColor));let a=t.getClearAlpha(this.tempColor),c=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,o!=null&&(t.setClearColor(o),t.setClearAlpha(s||0),t.clear()),this.fsQuad.material=n,this.fsQuad.render(t),t.autoClear=c,t.setClearColor(this.originalClearColor),t.setClearAlpha(a)}_renderOverride(t,n,r,o,s){this.originalClearColor.copy(t.getClearColor(this.tempColor));let a=t.getClearAlpha(this.tempColor),c=t.autoClear;t.setRenderTarget(r),t.autoClear=!1,o=n.clearColor||o,s=n.clearAlpha||s,o!=null&&(t.setClearColor(o),t.setClearAlpha(s||0),t.clear()),this.scene.overrideMaterial=n,t.render(this.scene,this.camera),this.scene.overrideMaterial=null,t.autoClear=c,t.setClearColor(this.originalClearColor),t.setClearAlpha(a)}_renderMetalness(t,n,r,o,s){this.originalClearColor.copy(t.getClearColor(this.tempColor));let a=t.getClearAlpha(this.tempColor),c=t.autoClear,l=this.scene.background,u=this.scene.fog;t.setRenderTarget(r),t.autoClear=!1,this.scene.background=null,this.scene.fog=null,o=n.clearColor||o,s=n.clearAlpha||s,o!=null&&(t.setClearColor(o),t.setClearAlpha(s||0),t.clear()),this.scene.traverseVisible(d=>{d._SSRPassBackupMaterial=d.material,this._selects.includes(d)?d.material=this.metalnessOnMaterial:d.material=this.metalnessOffMaterial}),t.render(this.scene,this.camera),this.scene.traverseVisible(d=>{d.material=d._SSRPassBackupMaterial}),t.autoClear=c,t.setClearColor(this.originalClearColor),t.setClearAlpha(a),this.scene.background=l,this.scene.fog=u}}return i.OUTPUT={Default:0,SSR:1,Beauty:3,Depth:4,Normal:5,Metalness:7},i})();var Kee=["*"],gl=class gl extends Ln{getType(){return uA}set width(e){this._objRef&&(this._objRef.width=e)}get width(){return this._objRef?.width}set height(e){this._objRef&&(this._objRef.height=e)}get height(){return this._objRef?.height}set clear(e){this._objRef&&(this._objRef.clear=e)}get clear(){return this._objRef?.clear}set renderer(e){this._objRef&&(this._objRef.renderer=e)}get renderer(){return this._objRef?.renderer}set scene(e){this._objRef&&(this._objRef.scene=e)}get scene(){return this._objRef?.scene}set camera(e){this._objRef&&(this._objRef.camera=e)}get camera(){return this._objRef?.camera}set groundReflector(e){this._objRef&&(this._objRef.groundReflector=e)}get groundReflector(){return this._objRef?.groundReflector}set opacity(e){this._objRef&&(this._objRef.opacity=e)}get opacity(){return this._objRef?.opacity}set output(e){this._objRef&&(this._objRef.output=e)}get output(){return this._objRef?.output}set maxDistance(e){this._objRef&&(this._objRef.maxDistance=e)}get maxDistance(){return this._objRef?.maxDistance}set thickness(e){this._objRef&&(this._objRef.thickness=e)}get thickness(){return this._objRef?.thickness}set tempColor(e){this._objRef&&(this._objRef.tempColor=pe(this._objRef.tempColor,e))}get tempColor(){return this._objRef?.tempColor}get selects(){return this._objRef?.selects}set selects(e){this._objRef&&(this._objRef.selects=e)}set selective(e){this._objRef&&(this._objRef.selective=e)}get selective(){return this._objRef?.selective}get bouncing(){return this._objRef?.bouncing}set bouncing(e){this._objRef&&(this._objRef.bouncing=e)}set blur(e){this._objRef&&(this._objRef.blur=e)}get blur(){return this._objRef?.blur}get distanceAttenuation(){return this._objRef?.distanceAttenuation}set distanceAttenuation(e){this._objRef&&(this._objRef.distanceAttenuation=e)}get fresnel(){return this._objRef?.fresnel}set fresnel(e){this._objRef&&(this._objRef.fresnel=e)}get infiniteThick(){return this._objRef?.infiniteThick}set infiniteThick(e){this._objRef&&(this._objRef.infiniteThick=e)}set beautyRenderTarget(e){this._objRef&&(this._objRef.beautyRenderTarget=e)}get beautyRenderTarget(){return this._objRef?.beautyRenderTarget}set prevRenderTarget(e){this._objRef&&(this._objRef.prevRenderTarget=e)}get prevRenderTarget(){return this._objRef?.prevRenderTarget}set normalRenderTarget(e){this._objRef&&(this._objRef.normalRenderTarget=e)}get normalRenderTarget(){return this._objRef?.normalRenderTarget}set metalnessRenderTarget(e){this._objRef&&(this._objRef.metalnessRenderTarget=e)}get metalnessRenderTarget(){return this._objRef?.metalnessRenderTarget}set ssrRenderTarget(e){this._objRef&&(this._objRef.ssrRenderTarget=e)}get ssrRenderTarget(){return this._objRef?.ssrRenderTarget}set blurRenderTarget(e){this._objRef&&(this._objRef.blurRenderTarget=e)}get blurRenderTarget(){return this._objRef?.blurRenderTarget}set blurRenderTarget2(e){this._objRef&&(this._objRef.blurRenderTarget2=e)}get blurRenderTarget2(){return this._objRef?.blurRenderTarget2}set ssrMaterial(e){this._objRef&&(this._objRef.ssrMaterial=e)}get ssrMaterial(){return this._objRef?.ssrMaterial}set normalMaterial(e){this._objRef&&(this._objRef.normalMaterial=e)}get normalMaterial(){return this._objRef?.normalMaterial}set metalnessOnMaterial(e){this._objRef&&(this._objRef.metalnessOnMaterial=e)}get metalnessOnMaterial(){return this._objRef?.metalnessOnMaterial}set metalnessOffMaterial(e){this._objRef&&(this._objRef.metalnessOffMaterial=e)}get metalnessOffMaterial(){return this._objRef?.metalnessOffMaterial}set blurMaterial(e){this._objRef&&(this._objRef.blurMaterial=e)}get blurMaterial(){return this._objRef?.blurMaterial}set blurMaterial2(e){this._objRef&&(this._objRef.blurMaterial2=e)}get blurMaterial2(){return this._objRef?.blurMaterial2}set depthRenderMaterial(e){this._objRef&&(this._objRef.depthRenderMaterial=e)}get depthRenderMaterial(){return this._objRef?.depthRenderMaterial}set copyMaterial(e){this._objRef&&(this._objRef.copyMaterial=e)}get copyMaterial(){return this._objRef?.copyMaterial}set fsQuad(e){this._objRef&&(this._objRef.fsQuad=e)}get fsQuad(){return this._objRef?.fsQuad}set originalClearColor(e){this._objRef&&(this._objRef.originalClearColor=pe(this._objRef.originalClearColor,e))}get originalClearColor(){return this._objRef?.originalClearColor}get resolutionScale(){return this._objRef?.resolutionScale}set resolutionScale(e){this._objRef&&(this._objRef.resolutionScale=e)}};gl.OUTPUT=uA.OUTPUT,gl.\u0275fac=(()=>{let e;return function(n){return(e||(e=q(gl)))(n||gl)}})(),gl.\u0275cmp=O({type:gl,selectors:[["th-sSRPass"]],inputs:{width:"width",height:"height",clear:"clear",renderer:"renderer",scene:"scene",camera:"camera",groundReflector:"groundReflector",opacity:"opacity",output:"output",maxDistance:"maxDistance",thickness:"thickness",tempColor:"tempColor",selects:"selects",selective:"selective",bouncing:"bouncing",blur:"blur",distanceAttenuation:"distanceAttenuation",fresnel:"fresnel",infiniteThick:"infiniteThick",beautyRenderTarget:"beautyRenderTarget",prevRenderTarget:"prevRenderTarget",normalRenderTarget:"normalRenderTarget",metalnessRenderTarget:"metalnessRenderTarget",ssrRenderTarget:"ssrRenderTarget",blurRenderTarget:"blurRenderTarget",blurRenderTarget2:"blurRenderTarget2",ssrMaterial:"ssrMaterial",normalMaterial:"normalMaterial",metalnessOnMaterial:"metalnessOnMaterial",metalnessOffMaterial:"metalnessOffMaterial",blurMaterial:"blurMaterial",blurMaterial2:"blurMaterial2",depthRenderMaterial:"depthRenderMaterial",copyMaterial:"copyMaterial",fsQuad:"fsQuad",originalClearColor:"originalClearColor",resolutionScale:"resolutionScale"},features:[K([{provide:gn,useExisting:he(()=>gl)}]),$],ngContentSelectors:Kee,decls:1,vars:0,template:function(t,n){t&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});var GU=gl;var dA={type:"change"},pA={type:"start"},mA={type:"end"},WU=1e-6,Bn={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4},pS=new z,Cu=new z,Jee=new C,mS=new C,hA=new C,om=new nn,$U=new C,gS=new C,fA=new C,_S=new C,bS=class extends Ir{constructor(e,t=null){super(e,t),this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:gi.ROTATE,MIDDLE:gi.DOLLY,RIGHT:gi.PAN},this.target=new C,this.state=Bn.NONE,this.keyState=Bn.NONE,this._lastPosition=new C,this._lastZoom=1,this._touchZoomDistanceStart=0,this._touchZoomDistanceEnd=0,this._lastAngle=0,this._eye=new C,this._movePrev=new z,this._moveCurr=new z,this._lastAxis=new C,this._zoomStart=new z,this._zoomEnd=new z,this._panStart=new z,this._panEnd=new z,this._pointers=[],this._pointerPositions={},this._onPointerMove=tte.bind(this),this._onPointerDown=ete.bind(this),this._onPointerUp=nte.bind(this),this._onPointerCancel=ite.bind(this),this._onContextMenu=ute.bind(this),this._onMouseWheel=lte.bind(this),this._onKeyDown=ote.bind(this),this._onKeyUp=rte.bind(this),this._onTouchStart=dte.bind(this),this._onTouchMove=hte.bind(this),this._onTouchEnd=fte.bind(this),this._onMouseDown=ste.bind(this),this._onMouseMove=ate.bind(this),this._onMouseUp=cte.bind(this),this._target0=this.target.clone(),this._position0=this.object.position.clone(),this._up0=this.object.up.clone(),this._zoom0=this.object.zoom,t!==null&&(this.connect(t),this.handleResize()),this.update()}connect(e){super.connect(e),window.addEventListener("keydown",this._onKeyDown),window.addEventListener("keyup",this._onKeyUp),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerCancel),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="none"}disconnect(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}handleResize(){let e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}update(){this._eye.subVectors(this.object.position,this.target),this.noRotate||this._rotateCamera(),this.noZoom||this._zoomCamera(),this.noPan||this._panCamera(),this.object.position.addVectors(this.target,this._eye),this.object.isPerspectiveCamera?(this._checkDistances(),this.object.lookAt(this.target),this._lastPosition.distanceToSquared(this.object.position)>WU&&(this.dispatchEvent(dA),this._lastPosition.copy(this.object.position))):this.object.isOrthographicCamera?(this.object.lookAt(this.target),(this._lastPosition.distanceToSquared(this.object.position)>WU||this._lastZoom!==this.object.zoom)&&(this.dispatchEvent(dA),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type.")}reset(){this.state=Bn.NONE,this.keyState=Bn.NONE,this.target.copy(this._target0),this.object.position.copy(this._position0),this.object.up.copy(this._up0),this.object.zoom=this._zoom0,this.object.updateProjectionMatrix(),this._eye.subVectors(this.object.position,this.target),this.object.lookAt(this.target),this.dispatchEvent(dA),this._lastPosition.copy(this.object.position),this._lastZoom=this.object.zoom}_panCamera(){if(Cu.copy(this._panEnd).sub(this._panStart),Cu.lengthSq()){if(this.object.isOrthographicCamera){let e=(this.object.right-this.object.left)/this.object.zoom/this.domElement.clientWidth,t=(this.object.top-this.object.bottom)/this.object.zoom/this.domElement.clientWidth;Cu.x*=e,Cu.y*=t}Cu.multiplyScalar(this._eye.length()*this.panSpeed),mS.copy(this._eye).cross(this.object.up).setLength(Cu.x),mS.add(Jee.copy(this.object.up).setLength(Cu.y)),this.object.position.add(mS),this.target.add(mS),this.staticMoving?this._panStart.copy(this._panEnd):this._panStart.add(Cu.subVectors(this._panEnd,this._panStart).multiplyScalar(this.dynamicDampingFactor))}}_rotateCamera(){_S.set(this._moveCurr.x-this._movePrev.x,this._moveCurr.y-this._movePrev.y,0);let e=_S.length();e?(this._eye.copy(this.object.position).sub(this.target),$U.copy(this._eye).normalize(),gS.copy(this.object.up).normalize(),fA.crossVectors(gS,$U).normalize(),gS.setLength(this._moveCurr.y-this._movePrev.y),fA.setLength(this._moveCurr.x-this._movePrev.x),_S.copy(gS.add(fA)),hA.crossVectors(_S,this._eye).normalize(),e*=this.rotateSpeed,om.setFromAxisAngle(hA,e),this._eye.applyQuaternion(om),this.object.up.applyQuaternion(om),this._lastAxis.copy(hA),this._lastAngle=e):!this.staticMoving&&this._lastAngle&&(this._lastAngle*=Math.sqrt(1-this.dynamicDampingFactor),this._eye.copy(this.object.position).sub(this.target),om.setFromAxisAngle(this._lastAxis,this._lastAngle),this._eye.applyQuaternion(om),this.object.up.applyQuaternion(om)),this._movePrev.copy(this._moveCurr)}_zoomCamera(){let e;this.state===Bn.TOUCH_ZOOM_PAN?(e=this._touchZoomDistanceStart/this._touchZoomDistanceEnd,this._touchZoomDistanceStart=this._touchZoomDistanceEnd,this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=Ze.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(e=1+(this._zoomEnd.y-this._zoomStart.y)*this.zoomSpeed,e!==1&&e>0&&(this.object.isPerspectiveCamera?this._eye.multiplyScalar(e):this.object.isOrthographicCamera?(this.object.zoom=Ze.clamp(this.object.zoom/e,this.minZoom,this.maxZoom),this._lastZoom!==this.object.zoom&&this.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),this.staticMoving?this._zoomStart.copy(this._zoomEnd):this._zoomStart.y+=(this._zoomEnd.y-this._zoomStart.y)*this.dynamicDampingFactor)}_getMouseOnScreen(e,t){return pS.set((e-this.screen.left)/this.screen.width,(t-this.screen.top)/this.screen.height),pS}_getMouseOnCircle(e,t){return pS.set((e-this.screen.width*.5-this.screen.left)/(this.screen.width*.5),(this.screen.height+2*(this.screen.top-t))/this.screen.width),pS}_addPointer(e){this._pointers.push(e)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t].pointerId==e.pointerId){this._pointers.splice(t,1);return}}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new z,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){let t=e.pointerId===this._pointers[0].pointerId?this._pointers[1]:this._pointers[0];return this._pointerPositions[t.pointerId]}_checkDistances(){(!this.noZoom||!this.noPan)&&(this._eye.lengthSq()>this.maxDistance*this.maxDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.maxDistance)),this._zoomStart.copy(this._zoomEnd)),this._eye.lengthSq()<this.minDistance*this.minDistance&&(this.object.position.addVectors(this.target,this._eye.setLength(this.minDistance)),this._zoomStart.copy(this._zoomEnd)))}};function ete(i){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(i.pointerId),this.domElement.ownerDocument.addEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this._onPointerUp)),this._addPointer(i),i.pointerType==="touch"?this._onTouchStart(i):this._onMouseDown(i))}function tte(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchMove(i):this._onMouseMove(i))}function nte(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchEnd(i):this._onMouseUp(),this._removePointer(i),this._pointers.length===0&&(this.domElement.releasePointerCapture(i.pointerId),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp)))}function ite(i){this._removePointer(i)}function rte(){this.enabled!==!1&&(this.keyState=Bn.NONE,window.addEventListener("keydown",this._onKeyDown))}function ote(i){this.enabled!==!1&&(window.removeEventListener("keydown",this._onKeyDown),this.keyState===Bn.NONE&&(i.code===this.keys[Bn.ROTATE]&&!this.noRotate?this.keyState=Bn.ROTATE:i.code===this.keys[Bn.ZOOM]&&!this.noZoom?this.keyState=Bn.ZOOM:i.code===this.keys[Bn.PAN]&&!this.noPan&&(this.keyState=Bn.PAN)))}function ste(i){let e;switch(i.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case gi.DOLLY:this.state=Bn.ZOOM;break;case gi.ROTATE:this.state=Bn.ROTATE;break;case gi.PAN:this.state=Bn.PAN;break;default:this.state=Bn.NONE}let t=this.keyState!==Bn.NONE?this.keyState:this.state;t===Bn.ROTATE&&!this.noRotate?(this._moveCurr.copy(this._getMouseOnCircle(i.pageX,i.pageY)),this._movePrev.copy(this._moveCurr)):t===Bn.ZOOM&&!this.noZoom?(this._zoomStart.copy(this._getMouseOnScreen(i.pageX,i.pageY)),this._zoomEnd.copy(this._zoomStart)):t===Bn.PAN&&!this.noPan&&(this._panStart.copy(this._getMouseOnScreen(i.pageX,i.pageY)),this._panEnd.copy(this._panStart)),this.dispatchEvent(pA)}function ate(i){let e=this.keyState!==Bn.NONE?this.keyState:this.state;e===Bn.ROTATE&&!this.noRotate?(this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(i.pageX,i.pageY))):e===Bn.ZOOM&&!this.noZoom?this._zoomEnd.copy(this._getMouseOnScreen(i.pageX,i.pageY)):e===Bn.PAN&&!this.noPan&&this._panEnd.copy(this._getMouseOnScreen(i.pageX,i.pageY))}function cte(){this.state=Bn.NONE,this.dispatchEvent(mA)}function lte(i){if(this.enabled!==!1&&this.noZoom!==!0){switch(i.preventDefault(),i.deltaMode){case 2:this._zoomStart.y-=i.deltaY*.025;break;case 1:this._zoomStart.y-=i.deltaY*.01;break;default:this._zoomStart.y-=i.deltaY*25e-5;break}this.dispatchEvent(pA),this.dispatchEvent(mA)}}function ute(i){this.enabled!==!1&&i.preventDefault()}function dte(i){switch(this._trackPointer(i),this._pointers.length){case 1:this.state=Bn.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(this._pointers[0].pageX,this._pointers[0].pageY)),this._movePrev.copy(this._moveCurr);break;default:this.state=Bn.TOUCH_ZOOM_PAN;let e=this._pointers[0].pageX-this._pointers[1].pageX,t=this._pointers[0].pageY-this._pointers[1].pageY;this._touchZoomDistanceEnd=this._touchZoomDistanceStart=Math.sqrt(e*e+t*t);let n=(this._pointers[0].pageX+this._pointers[1].pageX)/2,r=(this._pointers[0].pageY+this._pointers[1].pageY)/2;this._panStart.copy(this._getMouseOnScreen(n,r)),this._panEnd.copy(this._panStart);break}this.dispatchEvent(pA)}function hte(i){switch(this._trackPointer(i),this._pointers.length){case 1:this._movePrev.copy(this._moveCurr),this._moveCurr.copy(this._getMouseOnCircle(i.pageX,i.pageY));break;default:let e=this._getSecondPointerPosition(i),t=i.pageX-e.x,n=i.pageY-e.y;this._touchZoomDistanceEnd=Math.sqrt(t*t+n*n);let r=(i.pageX+e.x)/2,o=(i.pageY+e.y)/2;this._panEnd.copy(this._getMouseOnScreen(r,o));break}}function fte(i){switch(this._pointers.length){case 0:this.state=Bn.NONE;break;case 1:this.state=Bn.TOUCH_ROTATE,this._moveCurr.copy(this._getMouseOnCircle(i.pageX,i.pageY)),this._movePrev.copy(this._moveCurr);break;case 2:this.state=Bn.TOUCH_ZOOM_PAN;for(let e=0;e<this._pointers.length;e++)if(this._pointers[e].pointerId!==i.pointerId){let t=this._pointerPositions[this._pointers[e].pointerId];this._moveCurr.copy(this._getMouseOnCircle(t.x,t.y)),this._movePrev.copy(this._moveCurr);break}break}this.dispatchEvent(mA)}var pte=["*"],vS=(()=>{let e=class e extends _i{getType(){return bS}set screen(n){this._objRef&&(this._objRef.screen=n)}get screen(){return this._objRef?.screen}set rotateSpeed(n){this._objRef&&(this._objRef.rotateSpeed=n)}get rotateSpeed(){return this._objRef?.rotateSpeed}set zoomSpeed(n){this._objRef&&(this._objRef.zoomSpeed=n)}get zoomSpeed(){return this._objRef?.zoomSpeed}set panSpeed(n){this._objRef&&(this._objRef.panSpeed=n)}get panSpeed(){return this._objRef?.panSpeed}set noRotate(n){this._objRef&&(this._objRef.noRotate=n)}get noRotate(){return this._objRef?.noRotate}set noZoom(n){this._objRef&&(this._objRef.noZoom=n)}get noZoom(){return this._objRef?.noZoom}set noPan(n){this._objRef&&(this._objRef.noPan=n)}get noPan(){return this._objRef?.noPan}set staticMoving(n){this._objRef&&(this._objRef.staticMoving=n)}get staticMoving(){return this._objRef?.staticMoving}set dynamicDampingFactor(n){this._objRef&&(this._objRef.dynamicDampingFactor=n)}get dynamicDampingFactor(){return this._objRef?.dynamicDampingFactor}set minDistance(n){this._objRef&&(this._objRef.minDistance=n)}get minDistance(){return this._objRef?.minDistance}set maxDistance(n){this._objRef&&(this._objRef.maxDistance=n)}get maxDistance(){return this._objRef?.maxDistance}set minZoom(n){this._objRef&&(this._objRef.minZoom=n)}get minZoom(){return this._objRef?.minZoom}set maxZoom(n){this._objRef&&(this._objRef.maxZoom=n)}get maxZoom(){return this._objRef?.maxZoom}set keys(n){this._objRef&&(this._objRef.keys=n)}get keys(){return this._objRef?.keys}set mouseButtons(n){this._objRef&&(this._objRef.mouseButtons=n)}get mouseButtons(){return this._objRef?.mouseButtons}set target(n){this._objRef&&(this._objRef.target=pe(this._objRef.target,n))}get target(){return this._objRef?.target}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-trackballControls"]],inputs:{screen:"screen",rotateSpeed:"rotateSpeed",zoomSpeed:"zoomSpeed",panSpeed:"panSpeed",noRotate:"noRotate",noZoom:"noZoom",noPan:"noPan",staticMoving:"staticMoving",dynamicDampingFactor:"dynamicDampingFactor",minDistance:"minDistance",maxDistance:"maxDistance",minZoom:"minZoom",maxZoom:"maxZoom",keys:"keys",mouseButtons:"mouseButtons",target:"target"},features:[K([{provide:_i,useExisting:he(()=>e)}]),$],ngContentSelectors:pte,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var XU={name:"LuminosityHighPassShader",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new ue(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			float v = luminance( texel.xyz );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};var sm=class i extends Si{constructor(e,t=1,n,r){super(),this.strength=t,this.radius=n,this.threshold=r,this.resolution=e!==void 0?new z(e.x,e.y):new z(256,256),this.clearColor=new ue(0,0,0),this.needsSwap=!1,this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let o=Math.round(this.resolution.x/2),s=Math.round(this.resolution.y/2);this.renderTargetBright=new Qt(o,s,{type:An}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let u=0;u<this.nMips;u++){let d=new Qt(o,s,{type:An});d.texture.name="UnrealBloomPass.h"+u,d.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(d);let h=new Qt(o,s,{type:An});h.texture.name="UnrealBloomPass.v"+u,h.texture.generateMipmaps=!1,this.renderTargetsVertical.push(h),o=Math.round(o/2),s=Math.round(s/2)}let a=XU;this.highPassUniforms=Hn.clone(a.uniforms),this.highPassUniforms.luminosityThreshold.value=r,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new Nt({uniforms:this.highPassUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader}),this.separableBlurMaterials=[];let c=[6,10,14,18,22];o=Math.round(this.resolution.x/2),s=Math.round(this.resolution.y/2);for(let u=0;u<this.nMips;u++)this.separableBlurMaterials.push(this._getSeparableBlurMaterial(c[u])),this.separableBlurMaterials[u].uniforms.invSize.value=new z(1/o,1/s),o=Math.round(o/2),s=Math.round(s/2);this.compositeMaterial=this._getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1;let l=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=l,this.bloomTintColors=[new C(1,1,1),new C(1,1,1),new C(1,1,1),new C(1,1,1),new C(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,this.copyUniforms=Hn.clone(ar.uniforms),this.blendMaterial=new Nt({uniforms:this.copyUniforms,vertexShader:ar.vertexShader,fragmentShader:ar.fragmentShader,premultipliedAlpha:!0,blending:pu,depthTest:!1,depthWrite:!1,transparent:!0}),this._oldClearColor=new ue,this._oldClearAlpha=1,this._basic=new ci,this._fsQuad=new Ar(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose();for(let e=0;e<this.separableBlurMaterials.length;e++)this.separableBlurMaterials[e].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this._basic.dispose(),this._fsQuad.dispose()}setSize(e,t){let n=Math.round(e/2),r=Math.round(t/2);this.renderTargetBright.setSize(n,r);for(let o=0;o<this.nMips;o++)this.renderTargetsHorizontal[o].setSize(n,r),this.renderTargetsVertical[o].setSize(n,r),this.separableBlurMaterials[o].uniforms.invSize.value=new z(1/n,1/r),n=Math.round(n/2),r=Math.round(r/2)}render(e,t,n,r,o){e.getClearColor(this._oldClearColor),this._oldClearAlpha=e.getClearAlpha();let s=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),o&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this._fsQuad.material=this._basic,this._basic.map=n.texture,e.setRenderTarget(null),e.clear(),this._fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=n.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this._fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this._fsQuad.render(e);let a=this.renderTargetBright;for(let c=0;c<this.nMips;c++)this._fsQuad.material=this.separableBlurMaterials[c],this.separableBlurMaterials[c].uniforms.colorTexture.value=a.texture,this.separableBlurMaterials[c].uniforms.direction.value=i.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[c]),e.clear(),this._fsQuad.render(e),this.separableBlurMaterials[c].uniforms.colorTexture.value=this.renderTargetsHorizontal[c].texture,this.separableBlurMaterials[c].uniforms.direction.value=i.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[c]),e.clear(),this._fsQuad.render(e),a=this.renderTargetsVertical[c];this._fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this._fsQuad.render(e),this._fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,o&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this._fsQuad.render(e)):(e.setRenderTarget(n),this._fsQuad.render(e)),e.setClearColor(this._oldClearColor,this._oldClearAlpha),e.autoClear=s}_getSeparableBlurMaterial(e){let t=[],n=e/3;for(let r=0;r<e;r++)t.push(.39894*Math.exp(-.5*r*r/(n*n))/n);return new Nt({defines:{KERNEL_RADIUS:e},uniforms:{colorTexture:{value:null},invSize:{value:new z(.5,.5)},direction:{value:new z(.5,.5)},gaussianCoefficients:{value:t}},vertexShader:`

				varying vec2 vUv;

				void main() {

					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

				}`,fragmentShader:`

				#include <common>

				varying vec2 vUv;

				uniform sampler2D colorTexture;
				uniform vec2 invSize;
				uniform vec2 direction;
				uniform float gaussianCoefficients[KERNEL_RADIUS];

				void main() {

					float weightSum = gaussianCoefficients[0];
					vec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;

					for ( int i = 1; i < KERNEL_RADIUS; i ++ ) {

						float x = float( i );
						float w = gaussianCoefficients[i];
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;
						diffuseSum += ( sample1 + sample2 ) * w;

					}

					gl_FragColor = vec4( diffuseSum, 1.0 );

				}`})}_getCompositeMaterial(e){return new Nt({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`

				varying vec2 vUv;

				void main() {

					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

				}`,fragmentShader:`

				varying vec2 vUv;

				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor( const in float factor ) {

					float mirrorFactor = 1.2 - factor;
					return mix( factor, mirrorFactor, bloomRadius );

				}

				void main() {

					// 3.0 for backwards compatibility with previous alpha-based intensity
					vec3 bloom = 3.0 * bloomStrength * (
						lerpBloomFactor( bloomFactors[ 0 ] ) * bloomTintColors[ 0 ] * texture2D( blurTexture1, vUv ).rgb +
						lerpBloomFactor( bloomFactors[ 1 ] ) * bloomTintColors[ 1 ] * texture2D( blurTexture2, vUv ).rgb +
						lerpBloomFactor( bloomFactors[ 2 ] ) * bloomTintColors[ 2 ] * texture2D( blurTexture3, vUv ).rgb +
						lerpBloomFactor( bloomFactors[ 3 ] ) * bloomTintColors[ 3 ] * texture2D( blurTexture4, vUv ).rgb +
						lerpBloomFactor( bloomFactors[ 4 ] ) * bloomTintColors[ 4 ] * texture2D( blurTexture5, vUv ).rgb
					);

					float bloomAlpha = max( bloom.r, max( bloom.g, bloom.b ) );
					gl_FragColor = vec4( bloom, bloomAlpha );

				}`})}};sm.BlurDirectionX=new z(1,0);sm.BlurDirectionY=new z(0,1);var mte=["*"],yS=(()=>{let e=class e extends Ln{getType(){return sm}set resolution(n){this._objRef&&(this._objRef.resolution=pe(this._objRef.resolution,n))}get resolution(){return this._objRef?.resolution}set strength(n){this._objRef&&(this._objRef.strength=n)}get strength(){return this._objRef?.strength}set radius(n){this._objRef&&(this._objRef.radius=n)}get radius(){return this._objRef?.radius}set threshold(n){this._objRef&&(this._objRef.threshold=n)}get threshold(){return this._objRef?.threshold}set clearColor(n){this._objRef&&(this._objRef.clearColor=pe(this._objRef.clearColor,n))}get clearColor(){return this._objRef?.clearColor}set renderTargetsHorizontal(n){this._objRef&&(this._objRef.renderTargetsHorizontal=n)}get renderTargetsHorizontal(){return this._objRef?.renderTargetsHorizontal}set renderTargetsVertical(n){this._objRef&&(this._objRef.renderTargetsVertical=n)}get renderTargetsVertical(){return this._objRef?.renderTargetsVertical}set nMips(n){this._objRef&&(this._objRef.nMips=n)}get nMips(){return this._objRef?.nMips}set renderTargetBright(n){this._objRef&&(this._objRef.renderTargetBright=n)}get renderTargetBright(){return this._objRef?.renderTargetBright}set highPassUniforms(n){this._objRef&&(this._objRef.highPassUniforms=n)}get highPassUniforms(){return this._objRef?.highPassUniforms}set materialHighPassFilter(n){this._objRef&&(this._objRef.materialHighPassFilter=n)}get materialHighPassFilter(){return this._objRef?.materialHighPassFilter}set separableBlurMaterials(n){this._objRef&&(this._objRef.separableBlurMaterials=n)}get separableBlurMaterials(){return this._objRef?.separableBlurMaterials}set compositeMaterial(n){this._objRef&&(this._objRef.compositeMaterial=n)}get compositeMaterial(){return this._objRef?.compositeMaterial}set bloomTintColors(n){this._objRef&&(this._objRef.bloomTintColors=n)}get bloomTintColors(){return this._objRef?.bloomTintColors}set copyUniforms(n){this._objRef&&(this._objRef.copyUniforms=n)}get copyUniforms(){return this._objRef?.copyUniforms}set blendMaterial(n){this._objRef&&(this._objRef.blendMaterial=n)}get blendMaterial(){return this._objRef?.blendMaterial}set oldClearColor(n){this._objRef&&(this._objRef.oldClearColor=pe(this._objRef.oldClearColor,n))}get oldClearColor(){return this._objRef?.oldClearColor}set oldClearAlpha(n){this._objRef&&(this._objRef.oldClearAlpha=n)}get oldClearAlpha(){return this._objRef?.oldClearAlpha}set basic(n){this._objRef&&(this._objRef.basic=n)}get basic(){return this._objRef?.basic}set fsQuad(n){this._objRef&&(this._objRef.fsQuad=n)}get fsQuad(){return this._objRef?.fsQuad}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-unrealBloomPass"]],inputs:{resolution:"resolution",strength:"strength",radius:"radius",threshold:"threshold",clearColor:"clearColor",renderTargetsHorizontal:"renderTargetsHorizontal",renderTargetsVertical:"renderTargetsVertical",nMips:"nMips",renderTargetBright:"renderTargetBright",highPassUniforms:"highPassUniforms",materialHighPassFilter:"materialHighPassFilter",separableBlurMaterials:"separableBlurMaterials",compositeMaterial:"compositeMaterial",bloomTintColors:"bloomTintColors",copyUniforms:"copyUniforms",blendMaterial:"blendMaterial",oldClearColor:"oldClearColor",oldClearAlpha:"oldClearAlpha",basic:"basic",fsQuad:"fsQuad"},features:[K([{provide:gn,useExisting:he(()=>e)}]),$],ngContentSelectors:mte,decls:1,vars:0,template:function(r,o){r&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0});let i=e;return i})();var gA=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Mn({type:e}),e.\u0275inj=xn({});let i=e;return i})();var am=class{setCrossOrigin(e){this.crossOrigin=e}setWithCredentials(e){this.withCredentials=e}createLoaderInstance(){let e=new this.clazz;return this.crossOrigin&&e.setCrossOrigin(this.crossOrigin),this.withCredentials!==void 0&&e.setWithCredentials(this.withCredentials),e}};var jo=class extends am{load(...e){return this.createLoaderInstance().load(...e)}};function QU(i,e=!1){let t=i[0].index!==null,n=new Set(Object.keys(i[0].attributes)),r=new Set(Object.keys(i[0].morphAttributes)),o={},s={},a=i[0].morphTargetsRelative,c=new nt,l=0;for(let u=0;u<i.length;++u){let d=i[u],h=0;if(t!==(d.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let f in d.attributes){if(!n.has(f))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+f+'" attribute exists among all geometries, or in none of them.'),null;o[f]===void 0&&(o[f]=[]),o[f].push(d.attributes[f]),h++}if(h!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(a!==d.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let f in d.morphAttributes){if(!r.has(f))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;s[f]===void 0&&(s[f]=[]),s[f].push(d.morphAttributes[f])}if(e){let f;if(t)f=d.index.count;else if(d.attributes.position!==void 0)f=d.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;c.addGroup(l,f,u),l+=f}}if(t){let u=0,d=[];for(let h=0;h<i.length;++h){let f=i[h].index;for(let g=0;g<f.count;++g)d.push(f.getX(g)+u);u+=i[h].attributes.position.count}c.setIndex(d)}for(let u in o){let d=YU(o[u]);if(!d)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+u+" attribute."),null;c.setAttribute(u,d)}for(let u in s){let d=s[u][0].length;if(d===0)break;c.morphAttributes=c.morphAttributes||{},c.morphAttributes[u]=[];for(let h=0;h<d;++h){let f=[];for(let _=0;_<s[u].length;++_)f.push(s[u][_][h]);let g=YU(f);if(!g)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+u+" morphAttribute."),null;c.morphAttributes[u].push(g)}}return c}function YU(i){let e,t,n,r=-1,o=0;for(let l=0;l<i.length;++l){let u=i[l];if(e===void 0&&(e=u.array.constructor),e!==u.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=u.itemSize),t!==u.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(n===void 0&&(n=u.normalized),n!==u.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(r===-1&&(r=u.gpuType),r!==u.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;o+=u.count*t}let s=new e(o),a=new pn(s,t,n),c=0;for(let l=0;l<i.length;++l){let u=i[l];if(u.isInterleavedBufferAttribute){let d=c/t;for(let h=0,f=u.count;h<f;h++)for(let g=0;g<t;g++){let _=u.getComponent(h,g);a.setComponent(h+d,g,_)}}else s.set(u.array,c);c+=u.count*t}return r!==void 0&&(a.gpuType=r),a}function bA(i,e){if(e===IM)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===vh||e===zp){let t=i.getIndex();if(t===null){let s=[],a=i.getAttribute("position");if(a!==void 0){for(let c=0;c<a.count;c++)s.push(c);i.setIndex(s),t=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}let n=t.count-2,r=[];if(e===vh)for(let s=1;s<=n;s++)r.push(t.getX(0)),r.push(t.getX(s)),r.push(t.getX(s+1));else for(let s=0;s<n;s++)s%2===0?(r.push(t.getX(s)),r.push(t.getX(s+1)),r.push(t.getX(s+2))):(r.push(t.getX(s+2)),r.push(t.getX(s+1)),r.push(t.getX(s)));r.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let o=i.clone();return o.setIndex(r),o.clearGroups(),o}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}var xS=class extends or{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new RA(t)}),this.register(function(t){return new TA(t)}),this.register(function(t){return new jA(t)}),this.register(function(t){return new OA(t)}),this.register(function(t){return new LA(t)}),this.register(function(t){return new EA(t)}),this.register(function(t){return new DA(t)}),this.register(function(t){return new IA(t)}),this.register(function(t){return new AA(t)}),this.register(function(t){return new SA(t)}),this.register(function(t){return new PA(t)}),this.register(function(t){return new CA(t)}),this.register(function(t){return new NA(t)}),this.register(function(t){return new FA(t)}),this.register(function(t){return new wA(t)}),this.register(function(t){return new kA(t)}),this.register(function(t){return new BA(t)})}load(e,t,n,r){let o=this,s;if(this.resourcePath!=="")s=this.resourcePath;else if(this.path!==""){let l=Rs.extractUrlBase(e);s=Rs.resolveURL(l,this.path)}else s=Rs.extractUrlBase(e);this.manager.itemStart(e);let a=function(l){r?r(l):console.error(l),o.manager.itemError(e),o.manager.itemEnd(e)},c=new ir(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(l){try{o.parse(l,s,function(u){t(u),o.manager.itemEnd(e)},a)}catch(u){a(u)}},n,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let o,s={},a={},c=new TextDecoder;if(typeof e=="string")o=JSON.parse(e);else if(e instanceof ArrayBuffer)if(c.decode(new Uint8Array(e,0,4))===nV){try{s[Sn.KHR_BINARY_GLTF]=new UA(e)}catch(d){r&&r(d);return}o=JSON.parse(s[Sn.KHR_BINARY_GLTF].content)}else o=JSON.parse(c.decode(e));else o=e;if(o.asset===void 0||o.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let l=new qA(o,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){let d=this.pluginCallbacks[u](l);d.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),a[d.name]=d,s[d.name]=!0}if(o.extensionsUsed)for(let u=0;u<o.extensionsUsed.length;++u){let d=o.extensionsUsed[u],h=o.extensionsRequired||[];switch(d){case Sn.KHR_MATERIALS_UNLIT:s[d]=new MA;break;case Sn.KHR_DRACO_MESH_COMPRESSION:s[d]=new VA(o,this.dracoLoader);break;case Sn.KHR_TEXTURE_TRANSFORM:s[d]=new zA;break;case Sn.KHR_MESH_QUANTIZATION:s[d]=new HA;break;default:h.indexOf(d)>=0&&a[d]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}l.setExtensions(s),l.setPlugins(a),l.parse(n,r)}parseAsync(e,t){let n=this;return new Promise(function(r,o){n.parse(e,t,r,o)})}};function _te(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}var Sn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"},wA=class{constructor(e){this.parser=e,this.name=Sn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){let o=t[n];o.extensions&&o.extensions[this.name]&&o.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,o.extensions[this.name].light)}}_loadLight(e){let t=this.parser,n="light:"+e,r=t.cache.get(n);if(r)return r;let o=t.json,c=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e],l,u=new ue(16777215);c.color!==void 0&&u.setRGB(c.color[0],c.color[1],c.color[2],nr);let d=c.range!==void 0?c.range:0;switch(c.type){case"directional":l=new Yc(u),l.target.position.set(0,0,-1),l.add(l.target);break;case"point":l=new Zc(u),l.distance=d;break;case"spot":l=new fh(u),l.distance=d,c.spot=c.spot||{},c.spot.innerConeAngle=c.spot.innerConeAngle!==void 0?c.spot.innerConeAngle:0,c.spot.outerConeAngle=c.spot.outerConeAngle!==void 0?c.spot.outerConeAngle:Math.PI/4,l.angle=c.spot.outerConeAngle,l.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,l.target.position.set(0,0,-1),l.add(l.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return l.position.set(0,0,0),pc(l,c),c.intensity!==void 0&&(l.intensity=c.intensity),l.name=t.createUniqueName(c.name||"light_"+e),r=Promise.resolve(l),t.cache.add(n,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){let t=this,n=this.parser,o=n.json.nodes[e],a=(o.extensions&&o.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(c){return n._getNodeRef(t.cache,a,c)})}},MA=class{constructor(){this.name=Sn.KHR_MATERIALS_UNLIT}getMaterialType(){return ci}extendParams(e,t,n){let r=[];e.color=new ue(1,1,1),e.opacity=1;let o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){let s=o.baseColorFactor;e.color.setRGB(s[0],s[1],s[2],nr),e.opacity=s[3]}o.baseColorTexture!==void 0&&r.push(n.assignTexture(e,"map",o.baseColorTexture,Jn))}return Promise.all(r)}},SA=class{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let o=r.extensions[this.name].emissiveStrength;return o!==void 0&&(t.emissiveIntensity=o),Promise.resolve()}},RA=class{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Wr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let o=[],s=r.extensions[this.name];if(s.clearcoatFactor!==void 0&&(t.clearcoat=s.clearcoatFactor),s.clearcoatTexture!==void 0&&o.push(n.assignTexture(t,"clearcoatMap",s.clearcoatTexture)),s.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=s.clearcoatRoughnessFactor),s.clearcoatRoughnessTexture!==void 0&&o.push(n.assignTexture(t,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),s.clearcoatNormalTexture!==void 0&&(o.push(n.assignTexture(t,"clearcoatNormalMap",s.clearcoatNormalTexture)),s.clearcoatNormalTexture.scale!==void 0)){let a=s.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new z(a,a)}return Promise.all(o)}},TA=class{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_DISPERSION}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Wr}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let o=r.extensions[this.name];return t.dispersion=o.dispersion!==void 0?o.dispersion:0,Promise.resolve()}},CA=class{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Wr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let o=[],s=r.extensions[this.name];return s.iridescenceFactor!==void 0&&(t.iridescence=s.iridescenceFactor),s.iridescenceTexture!==void 0&&o.push(n.assignTexture(t,"iridescenceMap",s.iridescenceTexture)),s.iridescenceIor!==void 0&&(t.iridescenceIOR=s.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),s.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=s.iridescenceThicknessMinimum),s.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=s.iridescenceThicknessMaximum),s.iridescenceThicknessTexture!==void 0&&o.push(n.assignTexture(t,"iridescenceThicknessMap",s.iridescenceThicknessTexture)),Promise.all(o)}},EA=class{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_SHEEN}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Wr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let o=[];t.sheenColor=new ue(0,0,0),t.sheenRoughness=0,t.sheen=1;let s=r.extensions[this.name];if(s.sheenColorFactor!==void 0){let a=s.sheenColorFactor;t.sheenColor.setRGB(a[0],a[1],a[2],nr)}return s.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=s.sheenRoughnessFactor),s.sheenColorTexture!==void 0&&o.push(n.assignTexture(t,"sheenColorMap",s.sheenColorTexture,Jn)),s.sheenRoughnessTexture!==void 0&&o.push(n.assignTexture(t,"sheenRoughnessMap",s.sheenRoughnessTexture)),Promise.all(o)}},DA=class{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Wr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let o=[],s=r.extensions[this.name];return s.transmissionFactor!==void 0&&(t.transmission=s.transmissionFactor),s.transmissionTexture!==void 0&&o.push(n.assignTexture(t,"transmissionMap",s.transmissionTexture)),Promise.all(o)}},IA=class{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_VOLUME}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Wr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let o=[],s=r.extensions[this.name];t.thickness=s.thicknessFactor!==void 0?s.thicknessFactor:0,s.thicknessTexture!==void 0&&o.push(n.assignTexture(t,"thicknessMap",s.thicknessTexture)),t.attenuationDistance=s.attenuationDistance||1/0;let a=s.attenuationColor||[1,1,1];return t.attenuationColor=new ue().setRGB(a[0],a[1],a[2],nr),Promise.all(o)}},AA=class{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_IOR}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Wr}extendMaterialParams(e,t){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let o=r.extensions[this.name];return t.ior=o.ior!==void 0?o.ior:1.5,Promise.resolve()}},PA=class{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_SPECULAR}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Wr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let o=[],s=r.extensions[this.name];t.specularIntensity=s.specularFactor!==void 0?s.specularFactor:1,s.specularTexture!==void 0&&o.push(n.assignTexture(t,"specularIntensityMap",s.specularTexture));let a=s.specularColorFactor||[1,1,1];return t.specularColor=new ue().setRGB(a[0],a[1],a[2],nr),s.specularColorTexture!==void 0&&o.push(n.assignTexture(t,"specularColorMap",s.specularColorTexture,Jn)),Promise.all(o)}},FA=class{constructor(e){this.parser=e,this.name=Sn.EXT_MATERIALS_BUMP}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Wr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let o=[],s=r.extensions[this.name];return t.bumpScale=s.bumpFactor!==void 0?s.bumpFactor:1,s.bumpTexture!==void 0&&o.push(n.assignTexture(t,"bumpMap",s.bumpTexture)),Promise.all(o)}},NA=class{constructor(e){this.parser=e,this.name=Sn.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){let n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Wr}extendMaterialParams(e,t){let n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let o=[],s=r.extensions[this.name];return s.anisotropyStrength!==void 0&&(t.anisotropy=s.anisotropyStrength),s.anisotropyRotation!==void 0&&(t.anisotropyRotation=s.anisotropyRotation),s.anisotropyTexture!==void 0&&o.push(n.assignTexture(t,"anisotropyMap",s.anisotropyTexture)),Promise.all(o)}},jA=class{constructor(e){this.parser=e,this.name=Sn.KHR_TEXTURE_BASISU}loadTexture(e){let t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;let o=r.extensions[this.name],s=t.options.ktx2Loader;if(!s){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o.source,s)}},OA=class{constructor(e){this.parser=e,this.name=Sn.EXT_TEXTURE_WEBP}loadTexture(e){let t=this.name,n=this.parser,r=n.json,o=r.textures[e];if(!o.extensions||!o.extensions[t])return null;let s=o.extensions[t],a=r.images[s.source],c=n.textureLoader;if(a.uri){let l=n.options.manager.getHandler(a.uri);l!==null&&(c=l)}return n.loadTextureImage(e,s.source,c)}},LA=class{constructor(e){this.parser=e,this.name=Sn.EXT_TEXTURE_AVIF}loadTexture(e){let t=this.name,n=this.parser,r=n.json,o=r.textures[e];if(!o.extensions||!o.extensions[t])return null;let s=o.extensions[t],a=r.images[s.source],c=n.textureLoader;if(a.uri){let l=n.options.manager.getHandler(a.uri);l!==null&&(c=l)}return n.loadTextureImage(e,s.source,c)}},kA=class{constructor(e){this.name=Sn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){let t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){let r=n.extensions[this.name],o=this.parser.getDependency("buffer",r.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return o.then(function(a){let c=r.byteOffset||0,l=r.byteLength||0,u=r.count,d=r.byteStride,h=new Uint8Array(a,c,l);return s.decodeGltfBufferAsync?s.decodeGltfBufferAsync(u,d,h,r.mode,r.filter).then(function(f){return f.buffer}):s.ready.then(function(){let f=new ArrayBuffer(u*d);return s.decodeGltfBuffer(new Uint8Array(f),u,d,h,r.mode,r.filter),f})})}else return null}},BA=class{constructor(e){this.name=Sn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){let t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;let r=t.meshes[n.mesh];for(let l of r.primitives)if(l.mode!==Is.TRIANGLES&&l.mode!==Is.TRIANGLE_STRIP&&l.mode!==Is.TRIANGLE_FAN&&l.mode!==void 0)return null;let s=n.extensions[this.name].attributes,a=[],c={};for(let l in s)a.push(this.parser.getDependency("accessor",s[l]).then(u=>(c[l]=u,c[l])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(l=>{let u=l.pop(),d=u.isGroup?u.children:[u],h=l[0].count,f=[];for(let g of d){let _=new Ee,m=new C,p=new nn,b=new C(1,1,1),v=new Ms(g.geometry,g.material,h);for(let y=0;y<h;y++)c.TRANSLATION&&m.fromBufferAttribute(c.TRANSLATION,y),c.ROTATION&&p.fromBufferAttribute(c.ROTATION,y),c.SCALE&&b.fromBufferAttribute(c.SCALE,y),v.setMatrixAt(y,_.compose(m,p,b));for(let y in c)if(y==="_COLOR_0"){let w=c[y];v.instanceColor=new ws(w.array,w.itemSize,w.normalized)}else y!=="TRANSLATION"&&y!=="ROTATION"&&y!=="SCALE"&&g.geometry.setAttribute(y,c[y]);wt.prototype.copy.call(v,g),this.parser.assignFinalMaterial(v),f.push(v)}return u.isGroup?(u.clear(),u.add(...f),u):f[0]}))}},nV="glTF",Rv=12,KU={JSON:1313821514,BIN:5130562},UA=class{constructor(e){this.name=Sn.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,Rv),n=new TextDecoder;if(this.header={magic:n.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==nV)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");let r=this.header.length-Rv,o=new DataView(e,Rv),s=0;for(;s<r;){let a=o.getUint32(s,!0);s+=4;let c=o.getUint32(s,!0);if(s+=4,c===KU.JSON){let l=new Uint8Array(e,Rv+s,a);this.content=n.decode(l)}else if(c===KU.BIN){let l=Rv+s;this.body=e.slice(l,l+a)}s+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},VA=class{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Sn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){let n=this.json,r=this.dracoLoader,o=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,a={},c={},l={};for(let u in s){let d=WA[u]||u.toLowerCase();a[d]=s[u]}for(let u in e.attributes){let d=WA[u]||u.toLowerCase();if(s[u]!==void 0){let h=n.accessors[e.attributes[u]],f=cm[h.componentType];l[d]=f.name,c[d]=h.normalized===!0}}return t.getDependency("bufferView",o).then(function(u){return new Promise(function(d,h){r.decodeDracoFile(u,function(f){for(let g in f.attributes){let _=f.attributes[g],m=c[g];m!==void 0&&(_.normalized=m)}d(f)},a,l,nr,h)})})}},zA=class{constructor(){this.name=Sn.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}},HA=class{constructor(){this.name=Sn.KHR_MESH_QUANTIZATION}},wS=class extends Ja{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){let t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=e*r*3+r;for(let s=0;s!==r;s++)t[s]=n[o+s];return t}interpolate_(e,t,n,r){let o=this.resultBuffer,s=this.sampleValues,a=this.valueSize,c=a*2,l=a*3,u=r-t,d=(n-t)/u,h=d*d,f=h*d,g=e*l,_=g-l,m=-2*f+3*h,p=f-h,b=1-m,v=p-h+d;for(let y=0;y!==a;y++){let w=s[_+y+a],R=s[_+y+c]*u,E=s[g+y+a],A=s[g+y]*u;o[y]=b*w+v*R+m*E+p*A}return o}},bte=new nn,GA=class extends wS{interpolate_(e,t,n,r){let o=super.interpolate_(e,t,n,r);return bte.fromArray(o).normalize().toArray(o),o}},Is={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},cm={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},JU={9728:Zt,9729:zn,9984:Op,9985:gu,9986:el,9987:Po},eV={33071:jr,33648:iu,10497:Qo},vA={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},WA={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Eu={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},vte={CUBICSPLINE:void 0,LINEAR:ou,STEP:ru},yA={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function yte(i){return i.DefaultMaterial===void 0&&(i.DefaultMaterial=new kr({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:vs})),i.DefaultMaterial}function Ih(i,e,t){for(let n in t.extensions)i[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function pc(i,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function xte(i,e,t){let n=!1,r=!1,o=!1;for(let l=0,u=e.length;l<u;l++){let d=e[l];if(d.POSITION!==void 0&&(n=!0),d.NORMAL!==void 0&&(r=!0),d.COLOR_0!==void 0&&(o=!0),n&&r&&o)break}if(!n&&!r&&!o)return Promise.resolve(i);let s=[],a=[],c=[];for(let l=0,u=e.length;l<u;l++){let d=e[l];if(n){let h=d.POSITION!==void 0?t.getDependency("accessor",d.POSITION):i.attributes.position;s.push(h)}if(r){let h=d.NORMAL!==void 0?t.getDependency("accessor",d.NORMAL):i.attributes.normal;a.push(h)}if(o){let h=d.COLOR_0!==void 0?t.getDependency("accessor",d.COLOR_0):i.attributes.color;c.push(h)}}return Promise.all([Promise.all(s),Promise.all(a),Promise.all(c)]).then(function(l){let u=l[0],d=l[1],h=l[2];return n&&(i.morphAttributes.position=u),r&&(i.morphAttributes.normal=d),o&&(i.morphAttributes.color=h),i.morphTargetsRelative=!0,i})}function wte(i,e){if(i.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){let t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Mte(i){let e,t=i.extensions&&i.extensions[Sn.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+xA(t.attributes):e=i.indices+":"+xA(i.attributes)+":"+i.mode,i.targets!==void 0)for(let n=0,r=i.targets.length;n<r;n++)e+=":"+xA(i.targets[n]);return e}function xA(i){let e="",t=Object.keys(i).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+i[t[n]]+";";return e}function $A(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Ste(i){return i.search(/\.jpe?g($|\?)/i)>0||i.search(/^data\:image\/jpeg/)===0?"image/jpeg":i.search(/\.webp($|\?)/i)>0||i.search(/^data\:image\/webp/)===0?"image/webp":i.search(/\.ktx2($|\?)/i)>0||i.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}var Rte=new Ee,qA=class{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new _te,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,r=-1,o=!1,s=-1;if(typeof navigator<"u"){let a=navigator.userAgent;n=/^((?!chrome|android).)*safari/i.test(a)===!0;let c=a.match(/Version\/(\d+)/);r=n&&c?parseInt(c[1],10):-1,o=a.indexOf("Firefox")>-1,s=o?a.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||n&&r<17||o&&s<98?this.textureLoader=new Tp(this.options.manager):this.textureLoader=new Ep(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new ir(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let n=this,r=this.json,o=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(s){return s._markDefs&&s._markDefs()}),Promise.all(this._invokeAll(function(s){return s.beforeRoot&&s.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(s){let a={scene:s[0][r.scene||0],scenes:s[0],animations:s[1],cameras:s[2],asset:r.asset,parser:n,userData:{}};return Ih(o,a,r),pc(a,r),Promise.all(n._invokeAll(function(c){return c.afterRoot&&c.afterRoot(a)})).then(function(){for(let c of a.scenes)c.updateMatrixWorld();e(a)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,o=t.length;r<o;r++){let s=t[r].joints;for(let a=0,c=s.length;a<c;a++)e[s[a]].isBone=!0}for(let r=0,o=e.length;r<o;r++){let s=e[r];s.mesh!==void 0&&(this._addNodeRef(this.meshCache,s.mesh),s.skin!==void 0&&(n[s.mesh].isSkinnedMesh=!0)),s.camera!==void 0&&this._addNodeRef(this.cameraCache,s.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;let r=n.clone(),o=(s,a)=>{let c=this.associations.get(s);c!=null&&this.associations.set(a,c);for(let[l,u]of s.children.entries())o(u,a.children[l])};return o(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){let r=e(t[n]);if(r)return r}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let n=[];for(let r=0;r<t.length;r++){let o=e(t[r]);o&&n.push(o)}return n}getDependency(e,t){let n=e+":"+t,r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(o){return o.loadNode&&o.loadNode(t)});break;case"mesh":r=this._invokeOne(function(o){return o.loadMesh&&o.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(o){return o.loadBufferView&&o.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(o){return o.loadMaterial&&o.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(o){return o.loadTexture&&o.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(o){return o.loadAnimation&&o.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(o){return o!=this&&o.getDependency&&o.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){let n=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(o,s){return n.getDependency(e,s)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Sn.KHR_BINARY_GLTF].body);let r=this.options;return new Promise(function(o,s){n.load(Rs.resolveURL(t.uri,r.path),o,void 0,function(){s(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){let r=t.byteLength||0,o=t.byteOffset||0;return n.slice(o,o+r)})}loadAccessor(e){let t=this,n=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){let s=vA[r.type],a=cm[r.componentType],c=r.normalized===!0,l=new a(r.count*s);return Promise.resolve(new pn(l,s,c))}let o=[];return r.bufferView!==void 0?o.push(this.getDependency("bufferView",r.bufferView)):o.push(null),r.sparse!==void 0&&(o.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(o).then(function(s){let a=s[0],c=vA[r.type],l=cm[r.componentType],u=l.BYTES_PER_ELEMENT,d=u*c,h=r.byteOffset||0,f=r.bufferView!==void 0?n.bufferViews[r.bufferView].byteStride:void 0,g=r.normalized===!0,_,m;if(f&&f!==d){let p=Math.floor(h/f),b="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+p+":"+r.count,v=t.cache.get(b);v||(_=new l(a,p*f,r.count*f/u),v=new xs(_,f/u),t.cache.add(b,v)),m=new Jo(v,c,h%f/u,g)}else a===null?_=new l(r.count*c):_=new l(a,h,r.count*c),m=new pn(_,c,g);if(r.sparse!==void 0){let p=vA.SCALAR,b=cm[r.sparse.indices.componentType],v=r.sparse.indices.byteOffset||0,y=r.sparse.values.byteOffset||0,w=new b(s[1],v,r.sparse.count*p),R=new l(s[2],y,r.sparse.count*c);a!==null&&(m=new pn(m.array.slice(),m.itemSize,m.normalized)),m.normalized=!1;for(let E=0,A=w.length;E<A;E++){let x=w[E];if(m.setX(x,R[E*c]),c>=2&&m.setY(x,R[E*c+1]),c>=3&&m.setZ(x,R[E*c+2]),c>=4&&m.setW(x,R[E*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}m.normalized=g}return m})}loadTexture(e){let t=this.json,n=this.options,o=t.textures[e].source,s=t.images[o],a=this.textureLoader;if(s.uri){let c=n.manager.getHandler(s.uri);c!==null&&(a=c)}return this.loadTextureImage(e,o,a)}loadTextureImage(e,t,n){let r=this,o=this.json,s=o.textures[e],a=o.images[t],c=(a.uri||a.bufferView)+":"+s.sampler;if(this.textureCache[c])return this.textureCache[c];let l=this.loadImageSource(t,n).then(function(u){u.flipY=!1,u.name=s.name||a.name||"",u.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(u.name=a.uri);let h=(o.samplers||{})[s.sampler]||{};return u.magFilter=JU[h.magFilter]||zn,u.minFilter=JU[h.minFilter]||Po,u.wrapS=eV[h.wrapS]||Qo,u.wrapT=eV[h.wrapT]||Qo,u.generateMipmaps=!u.isCompressedTexture&&u.minFilter!==Zt&&u.minFilter!==zn,r.associations.set(u,{textures:e}),u}).catch(function(){return null});return this.textureCache[c]=l,l}loadImageSource(e,t){let n=this,r=this.json,o=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(d=>d.clone());let s=r.images[e],a=self.URL||self.webkitURL,c=s.uri||"",l=!1;if(s.bufferView!==void 0)c=n.getDependency("bufferView",s.bufferView).then(function(d){l=!0;let h=new Blob([d],{type:s.mimeType});return c=a.createObjectURL(h),c});else if(s.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let u=Promise.resolve(c).then(function(d){return new Promise(function(h,f){let g=h;t.isImageBitmapLoader===!0&&(g=function(_){let m=new Ii(_);m.needsUpdate=!0,h(m)}),t.load(Rs.resolveURL(d,o.path),g,void 0,f)})}).then(function(d){return l===!0&&a.revokeObjectURL(c),pc(d,s),d.userData.mimeType=s.mimeType||Ste(s.uri),d}).catch(function(d){throw console.error("THREE.GLTFLoader: Couldn't load texture",c),d});return this.sourceCache[e]=u,u}assignTexture(e,t,n,r){let o=this;return this.getDependency("texture",n.index).then(function(s){if(!s)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(s=s.clone(),s.channel=n.texCoord),o.extensions[Sn.KHR_TEXTURE_TRANSFORM]){let a=n.extensions!==void 0?n.extensions[Sn.KHR_TEXTURE_TRANSFORM]:void 0;if(a){let c=o.associations.get(s);s=o.extensions[Sn.KHR_TEXTURE_TRANSFORM].extendTexture(s,a),o.associations.set(s,c)}}return r!==void 0&&(s.colorSpace=r),e[t]=s,s})}assignFinalMaterial(e){let t=e.geometry,n=e.material,r=t.attributes.tangent===void 0,o=t.attributes.color!==void 0,s=t.attributes.normal===void 0;if(e.isPoints){let a="PointsMaterial:"+n.uuid,c=this.cache.get(a);c||(c=new lu,Mi.prototype.copy.call(c,n),c.color.copy(n.color),c.map=n.map,c.sizeAttenuation=!1,this.cache.add(a,c)),n=c}else if(e.isLine){let a="LineBasicMaterial:"+n.uuid,c=this.cache.get(a);c||(c=new mi,Mi.prototype.copy.call(c,n),c.color.copy(n.color),c.map=n.map,this.cache.add(a,c)),n=c}if(r||o||s){let a="ClonedMaterial:"+n.uuid+":";r&&(a+="derivative-tangents:"),o&&(a+="vertex-colors:"),s&&(a+="flat-shading:");let c=this.cache.get(a);c||(c=n.clone(),o&&(c.vertexColors=!0),s&&(c.flatShading=!0),r&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(a,c),this.associations.set(c,this.associations.get(n))),n=c}e.material=n}getMaterialType(){return kr}loadMaterial(e){let t=this,n=this.json,r=this.extensions,o=n.materials[e],s,a={},c=o.extensions||{},l=[];if(c[Sn.KHR_MATERIALS_UNLIT]){let d=r[Sn.KHR_MATERIALS_UNLIT];s=d.getMaterialType(),l.push(d.extendParams(a,o,t))}else{let d=o.pbrMetallicRoughness||{};if(a.color=new ue(1,1,1),a.opacity=1,Array.isArray(d.baseColorFactor)){let h=d.baseColorFactor;a.color.setRGB(h[0],h[1],h[2],nr),a.opacity=h[3]}d.baseColorTexture!==void 0&&l.push(t.assignTexture(a,"map",d.baseColorTexture,Jn)),a.metalness=d.metallicFactor!==void 0?d.metallicFactor:1,a.roughness=d.roughnessFactor!==void 0?d.roughnessFactor:1,d.metallicRoughnessTexture!==void 0&&(l.push(t.assignTexture(a,"metalnessMap",d.metallicRoughnessTexture)),l.push(t.assignTexture(a,"roughnessMap",d.metallicRoughnessTexture))),s=this._invokeOne(function(h){return h.getMaterialType&&h.getMaterialType(e)}),l.push(Promise.all(this._invokeAll(function(h){return h.extendMaterialParams&&h.extendMaterialParams(e,a)})))}o.doubleSided===!0&&(a.side=rr);let u=o.alphaMode||yA.OPAQUE;if(u===yA.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,u===yA.MASK&&(a.alphaTest=o.alphaCutoff!==void 0?o.alphaCutoff:.5)),o.normalTexture!==void 0&&s!==ci&&(l.push(t.assignTexture(a,"normalMap",o.normalTexture)),a.normalScale=new z(1,1),o.normalTexture.scale!==void 0)){let d=o.normalTexture.scale;a.normalScale.set(d,d)}if(o.occlusionTexture!==void 0&&s!==ci&&(l.push(t.assignTexture(a,"aoMap",o.occlusionTexture)),o.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=o.occlusionTexture.strength)),o.emissiveFactor!==void 0&&s!==ci){let d=o.emissiveFactor;a.emissive=new ue().setRGB(d[0],d[1],d[2],nr)}return o.emissiveTexture!==void 0&&s!==ci&&l.push(t.assignTexture(a,"emissiveMap",o.emissiveTexture,Jn)),Promise.all(l).then(function(){let d=new s(a);return o.name&&(d.name=o.name),pc(d,o),t.associations.set(d,{materials:e}),o.extensions&&Ih(r,d,o),d})}createUniqueName(e){let t=Zn.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){let t=this,n=this.extensions,r=this.primitiveCache;function o(a){return n[Sn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,t).then(function(c){return tV(c,a,t)})}let s=[];for(let a=0,c=e.length;a<c;a++){let l=e[a],u=Mte(l),d=r[u];if(d)s.push(d.promise);else{let h;l.extensions&&l.extensions[Sn.KHR_DRACO_MESH_COMPRESSION]?h=o(l):h=tV(new nt,l,t),r[u]={primitive:l,promise:h},s.push(h)}}return Promise.all(s)}loadMesh(e){let t=this,n=this.json,r=this.extensions,o=n.meshes[e],s=o.primitives,a=[];for(let c=0,l=s.length;c<l;c++){let u=s[c].material===void 0?yte(this.cache):this.getDependency("material",s[c].material);a.push(u)}return a.push(t.loadGeometries(s)),Promise.all(a).then(function(c){let l=c.slice(0,c.length-1),u=c[c.length-1],d=[];for(let f=0,g=u.length;f<g;f++){let _=u[f],m=s[f],p,b=l[f];if(m.mode===Is.TRIANGLES||m.mode===Is.TRIANGLE_STRIP||m.mode===Is.TRIANGLE_FAN||m.mode===void 0)p=o.isSkinnedMesh===!0?new ih(_,b):new Pe(_,b),p.isSkinnedMesh===!0&&p.normalizeSkinWeights(),m.mode===Is.TRIANGLE_STRIP?p.geometry=bA(p.geometry,zp):m.mode===Is.TRIANGLE_FAN&&(p.geometry=bA(p.geometry,vh));else if(m.mode===Is.LINES)p=new Lr(_,b);else if(m.mode===Is.LINE_STRIP)p=new ti(_,b);else if(m.mode===Is.LINE_LOOP)p=new oh(_,b);else if(m.mode===Is.POINTS)p=new sh(_,b);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+m.mode);Object.keys(p.geometry.morphAttributes).length>0&&wte(p,o),p.name=t.createUniqueName(o.name||"mesh_"+e),pc(p,o),m.extensions&&Ih(r,p,m),t.assignFinalMaterial(p),d.push(p)}for(let f=0,g=d.length;f<g;f++)t.associations.set(d[f],{meshes:e,primitives:f});if(d.length===1)return o.extensions&&Ih(r,d[0],o),d[0];let h=new Or;o.extensions&&Ih(r,h,o),t.associations.set(h,{meshes:e});for(let f=0,g=d.length;f<g;f++)h.add(d[f]);return h})}loadCamera(e){let t,n=this.json.cameras[e],r=n[n.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new ai(Ze.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):n.type==="orthographic"&&(t=new mo(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),pc(t,n),Promise.resolve(t)}loadSkin(e){let t=this.json.skins[e],n=[];for(let r=0,o=t.joints.length;r<o;r++)n.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(r){let o=r.pop(),s=r,a=[],c=[];for(let l=0,u=s.length;l<u;l++){let d=s[l];if(d){a.push(d);let h=new Ee;o!==null&&h.fromArray(o.array,l*16),c.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[l])}return new rh(a,c)})}loadAnimation(e){let t=this.json,n=this,r=t.animations[e],o=r.name?r.name:"animation_"+e,s=[],a=[],c=[],l=[],u=[];for(let d=0,h=r.channels.length;d<h;d++){let f=r.channels[d],g=r.samplers[f.sampler],_=f.target,m=_.node,p=r.parameters!==void 0?r.parameters[g.input]:g.input,b=r.parameters!==void 0?r.parameters[g.output]:g.output;_.node!==void 0&&(s.push(this.getDependency("node",m)),a.push(this.getDependency("accessor",p)),c.push(this.getDependency("accessor",b)),l.push(g),u.push(_))}return Promise.all([Promise.all(s),Promise.all(a),Promise.all(c),Promise.all(l),Promise.all(u)]).then(function(d){let h=d[0],f=d[1],g=d[2],_=d[3],m=d[4],p=[];for(let v=0,y=h.length;v<y;v++){let w=h[v],R=f[v],E=g[v],A=_[v],x=m[v];if(w===void 0)continue;w.updateMatrix&&w.updateMatrix();let T=n._createAnimationTracks(w,R,E,A,x);if(T)for(let P=0;P<T.length;P++)p.push(T[P])}let b=new nc(o,void 0,p);return pc(b,r),b})}createNodeMesh(e){let t=this.json,n=this,r=t.nodes[e];return r.mesh===void 0?null:n.getDependency("mesh",r.mesh).then(function(o){let s=n._getNodeRef(n.meshCache,r.mesh,o);return r.weights!==void 0&&s.traverse(function(a){if(a.isMesh)for(let c=0,l=r.weights.length;c<l;c++)a.morphTargetInfluences[c]=r.weights[c]}),s})}loadNode(e){let t=this.json,n=this,r=t.nodes[e],o=n._loadNodeShallow(e),s=[],a=r.children||[];for(let l=0,u=a.length;l<u;l++)s.push(n.getDependency("node",a[l]));let c=r.skin===void 0?Promise.resolve(null):n.getDependency("skin",r.skin);return Promise.all([o,Promise.all(s),c]).then(function(l){let u=l[0],d=l[1],h=l[2];h!==null&&u.traverse(function(f){f.isSkinnedMesh&&f.bind(h,Rte)});for(let f=0,g=d.length;f<g;f++)u.add(d[f]);return u})}_loadNodeShallow(e){let t=this.json,n=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];let o=t.nodes[e],s=o.name?r.createUniqueName(o.name):"",a=[],c=r._invokeOne(function(l){return l.createNodeMesh&&l.createNodeMesh(e)});return c&&a.push(c),o.camera!==void 0&&a.push(r.getDependency("camera",o.camera).then(function(l){return r._getNodeRef(r.cameraCache,o.camera,l)})),r._invokeAll(function(l){return l.createNodeAttachment&&l.createNodeAttachment(e)}).forEach(function(l){a.push(l)}),this.nodeCache[e]=Promise.all(a).then(function(l){let u;if(o.isBone===!0?u=new cu:l.length>1?u=new Or:l.length===1?u=l[0]:u=new wt,u!==l[0])for(let d=0,h=l.length;d<h;d++)u.add(l[d]);if(o.name&&(u.userData.name=o.name,u.name=s),pc(u,o),o.extensions&&Ih(n,u,o),o.matrix!==void 0){let d=new Ee;d.fromArray(o.matrix),u.applyMatrix4(d)}else o.translation!==void 0&&u.position.fromArray(o.translation),o.rotation!==void 0&&u.quaternion.fromArray(o.rotation),o.scale!==void 0&&u.scale.fromArray(o.scale);if(!r.associations.has(u))r.associations.set(u,{});else if(o.mesh!==void 0&&r.meshCache.refs[o.mesh]>1){let d=r.associations.get(u);r.associations.set(u,ae({},d))}return r.associations.get(u).nodes=e,u}),this.nodeCache[e]}loadScene(e){let t=this.extensions,n=this.json.scenes[e],r=this,o=new Or;n.name&&(o.name=r.createUniqueName(n.name)),pc(o,n),n.extensions&&Ih(t,o,n);let s=n.nodes||[],a=[];for(let c=0,l=s.length;c<l;c++)a.push(r.getDependency("node",s[c]));return Promise.all(a).then(function(c){for(let u=0,d=c.length;u<d;u++)o.add(c[u]);let l=u=>{let d=new Map;for(let[h,f]of r.associations)(h instanceof Mi||h instanceof Ii)&&d.set(h,f);return u.traverse(h=>{let f=r.associations.get(h);f!=null&&d.set(h,f)}),d};return r.associations=l(o),o})}_createAnimationTracks(e,t,n,r,o){let s=[],a=e.name?e.name:e.uuid,c=[];Eu[o.path]===Eu.weights?e.traverse(function(h){h.morphTargetInfluences&&c.push(h.name?h.name:h.uuid)}):c.push(a);let l;switch(Eu[o.path]){case Eu.weights:l=ha;break;case Eu.rotation:l=fa;break;case Eu.translation:case Eu.scale:l=pa;break;default:switch(n.itemSize){case 1:l=ha;break;case 2:case 3:default:l=pa;break}break}let u=r.interpolation!==void 0?vte[r.interpolation]:ou,d=this._getArrayFromAccessor(n);for(let h=0,f=c.length;h<f;h++){let g=new l(c[h]+"."+Eu[o.path],t.array,d,u);r.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(g),s.push(g)}return s}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){let n=$A(t.constructor),r=new Float32Array(t.length);for(let o=0,s=t.length;o<s;o++)r[o]=t[o]*n;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){let r=this instanceof fa?GA:wS;return new r(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function Tte(i,e,t){let n=e.attributes,r=new wi;if(n.POSITION!==void 0){let a=t.json.accessors[n.POSITION],c=a.min,l=a.max;if(c!==void 0&&l!==void 0){if(r.set(new C(c[0],c[1],c[2]),new C(l[0],l[1],l[2])),a.normalized){let u=$A(cm[a.componentType]);r.min.multiplyScalar(u),r.max.multiplyScalar(u)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;let o=e.targets;if(o!==void 0){let a=new C,c=new C;for(let l=0,u=o.length;l<u;l++){let d=o[l];if(d.POSITION!==void 0){let h=t.json.accessors[d.POSITION],f=h.min,g=h.max;if(f!==void 0&&g!==void 0){if(c.setX(Math.max(Math.abs(f[0]),Math.abs(g[0]))),c.setY(Math.max(Math.abs(f[1]),Math.abs(g[1]))),c.setZ(Math.max(Math.abs(f[2]),Math.abs(g[2]))),h.normalized){let _=$A(cm[h.componentType]);c.multiplyScalar(_)}a.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}i.boundingBox=r;let s=new Di;r.getCenter(s.center),s.radius=r.min.distanceTo(r.max)/2,i.boundingSphere=s}function tV(i,e,t){let n=e.attributes,r=[];function o(s,a){return t.getDependency("accessor",s).then(function(c){i.setAttribute(a,c)})}for(let s in n){let a=WA[s]||s.toLowerCase();a in i.attributes||r.push(o(n[s],a))}if(e.indices!==void 0&&!i.index){let s=t.getDependency("accessor",e.indices).then(function(a){i.setIndex(a)});r.push(s)}return hn.workingColorSpace!==nr&&"COLOR_0"in n&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${hn.workingColorSpace}" not supported.`),pc(i,e),Tte(i,e,t),Promise.all(r).then(function(){return e.targets!==void 0?xte(i,e.targets,t):i})}var XA=new WeakMap,MS=class extends or{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,r){let o=new ir(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,s=>{this.parse(s,t,r)},n,r)}parse(e,t,n=()=>{}){this.decodeDracoFile(e,t,null,null,Jn,n).catch(n)}decodeDracoFile(e,t,n,r,o=nr,s=()=>{}){let a={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n,vertexColorSpace:o};return this.decodeGeometry(e,a).then(t).catch(s)}decodeGeometry(e,t){let n=JSON.stringify(t);if(XA.has(e)){let c=XA.get(e);if(c.key===n)return c.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r,o=this.workerNextTaskID++,s=e.byteLength,a=this._getWorker(o,s).then(c=>(r=c,new Promise((l,u)=>{r._callbacks[o]={resolve:l,reject:u},r.postMessage({type:"decode",id:o,taskConfig:t,buffer:e},[e])}))).then(c=>this._createGeometry(c.geometry));return a.catch(()=>!0).then(()=>{r&&o&&this._releaseTask(r,o)}),XA.set(e,{key:n,promise:a}),a}_createGeometry(e){let t=new nt;e.index&&t.setIndex(new pn(e.index.array,1));for(let n=0;n<e.attributes.length;n++){let{name:r,array:o,itemSize:s,stride:a,vertexColorSpace:c}=e.attributes[n],l;if(s===a)l=new pn(o,s);else{let u=new xs(o,a);l=new Jo(u,s,0)}r==="color"&&(this._assignVertexColorSpace(l,c),l.normalized=!(o instanceof Float32Array)),t.setAttribute(r,l)}return t}_assignVertexColorSpace(e,t){if(t!==Jn)return;let n=new ue;for(let r=0,o=e.count;r<o;r++)n.fromBufferAttribute(e,r),hn.colorSpaceToWorking(n,Jn),e.setXYZ(r,n.r,n.g,n.b)}_loadLibrary(e,t){let n=new ir(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((r,o)=>{n.load(e,r,void 0,o)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{let r=n[0];e||(this.decoderConfig.wasmBinary=n[1]);let o=Cte.toString(),s=["/* draco decoder */",r,"","/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(o){let s=o.data;switch(s.type){case"decode":r._callbacks[s.id].resolve(s);break;case"error":r._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,o){return r._taskLoad>o._taskLoad?-1:1});let n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function Cte(){let i,e;onmessage=function(s){let a=s.data;switch(a.type){case"init":i=a.decoderConfig,e=new Promise(function(u){i.onModuleLoaded=function(d){u({draco:d})},DracoDecoderModule(i)});break;case"decode":let c=a.buffer,l=a.taskConfig;e.then(u=>{let d=u.draco,h=new d.Decoder;try{let f=t(d,h,new Int8Array(c),l),g=f.attributes.map(_=>_.array.buffer);f.index&&g.push(f.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:f},g)}catch(f){console.error(f),self.postMessage({type:"error",id:a.id,error:f.message})}finally{d.destroy(h)}});break}};function t(s,a,c,l){let u=l.attributeIDs,d=l.attributeTypes,h,f,g=a.GetEncodedGeometryType(c);if(g===s.TRIANGULAR_MESH)h=new s.Mesh,f=a.DecodeArrayToMesh(c,c.byteLength,h);else if(g===s.POINT_CLOUD)h=new s.PointCloud,f=a.DecodeArrayToPointCloud(c,c.byteLength,h);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||h.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());let _={index:null,attributes:[]};for(let m in u){let p=self[d[m]],b,v;if(l.useUniqueIDs)v=u[m],b=a.GetAttributeByUniqueId(h,v);else{if(v=a.GetAttributeId(h,s[u[m]]),v===-1)continue;b=a.GetAttribute(h,v)}let y=r(s,a,h,m,p,b);m==="color"&&(y.vertexColorSpace=l.vertexColorSpace),_.attributes.push(y)}return g===s.TRIANGULAR_MESH&&(_.index=n(s,a,h)),s.destroy(h),_}function n(s,a,c){let u=c.num_faces()*3,d=u*4,h=s._malloc(d);a.GetTrianglesUInt32Array(c,d,h);let f=new Uint32Array(s.HEAPF32.buffer,h,u).slice();return s._free(h),{array:f,itemSize:1}}function r(s,a,c,l,u,d){let h=c.num_points(),f=d.num_components(),g=o(s,u),_=f*u.BYTES_PER_ELEMENT,m=Math.ceil(_/4)*4,p=m/u.BYTES_PER_ELEMENT,b=h*_,v=h*m,y=s._malloc(b);a.GetAttributeDataArrayForAllPoints(c,d,g,b,y);let w=new u(s.HEAPF32.buffer,y,b/u.BYTES_PER_ELEMENT),R;if(_===m)R=w.slice();else{R=new u(v/u.BYTES_PER_ELEMENT);let E=0;for(let A=0,x=w.length;A<x;A++){for(let T=0;T<f;T++)R[E+T]=w[A*f+T];E+=p}}return s._free(y),{name:l,count:h,itemSize:f,array:R,stride:p}}function o(s,a){switch(a){case Float32Array:return s.DT_FLOAT32;case Int8Array:return s.DT_INT8;case Int16Array:return s.DT_INT16;case Int32Array:return s.DT_INT32;case Uint8Array:return s.DT_UINT8;case Uint16Array:return s.DT_UINT16;case Uint32Array:return s.DT_UINT32}}}var Du=(()=>{let e=class e extends jo{constructor(){super(...arguments),this.clazz=MS,this.decoderPath="",this.reuseInstance=!0}setDecoderPath(n){this.decoderPath=n}setDecoderConfig(n){this.decoderConfig=n}setWorkerLimit(n){this.workerLimit=n}setReuseInstance(n){this.reuseInstance=n}createLoaderInstance(){if(this.reuseInstance&&this.instance)return this.instance;let n=super.createLoaderInstance();return n.setDecoderPath(this.decoderPath),this.decoderConfig&&n.setDecoderConfig(this.decoderConfig),this.workerLimit&&n.setWorkerLimit(this.workerLimit),this.reuseInstance&&(this.instance=n),n}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275prov=ge({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var lm=(()=>{let e=class e extends am{load(...n){return this.createLoaderInstance().loadAsync(...n)}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275prov=ge({token:e,factory:e.\u0275fac});let i=e;return i})();var um=(()=>{let e=class e{injectHost(){return S(de,{host:!0})}set url(n){this._url=n,this.load()}get url(){return this._url}get onLoaded(){return this.onLoaded$||(this.onLoaded$=new dt),this.onLoaded$}get onProgress(){return this.onProgress$||(this.onProgress$=new dt),this.onProgress$}constructor(){this.zone=S(pt),this.animationLoop=S(al),this.initialized=!1,this.proxy=kM(),this._host=this.injectHost(),this._host.objRef=this.proxy}ngOnInit(){this.initialized=!0,this.load()}load(){return Wt(this,null,function*(){if(!this.initialized)return;if(this._url===void 0)throw new Error("missing url");if(!this.proxy)return;let n=this._url,r=yu(this.onProgress$)?s=>{this.zone.run(()=>{this.onProgress$?.next(s)})}:void 0,o=yield this.zone.runOutsideAngular(()=>this.service.load(n,r));this.animationLoop.requestAnimationFrame(),this.proxy.objRef=this.getRefFromResponse(o),this._host.objRef=this.proxy,this.onLoaded$&&o!=null&&this.zone.run(()=>this.onLoaded$?.next(o))})}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Ge({type:e,inputs:{url:"url"},outputs:{onLoaded:"onLoaded",onProgress:"onProgress"}});let i=e;return i})();var Ete=new me("MeshoptDecoderToken");var YA=(()=>{let e=class e extends lm{constructor(){super(...arguments),this.dracoLoaderService=S(Du),this.meshoptDecoder=S(Ete,{optional:!0}),this.clazz=xS}createLoaderInstance(){let n=super.createLoaderInstance();return n.setDRACOLoader(this.dracoLoaderService.createLoaderInstance()),this.meshoptDecoder&&n.setMeshoptDecoder(this.meshoptDecoder),n}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275prov=ge({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var hr=(()=>{let e=class e extends um{constructor(){super(...arguments),this.service=S(YA)}getRefFromResponse(n){return n.scene}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275dir=Ge({type:e,selectors:[["","loadGLTF",""]],features:[$]});let i=e;return i})();var As=(()=>{let e=class e{transform(n){return Array.isArray(n)?new ue(...n):new ue(n)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275pipe=$o({name:"color",type:e,pure:!0});let i=e;return i})();var SS=(()=>{let e=class e{transform(n){return new eh(...n)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275pipe=$o({name:"fog",type:e,pure:!0});let i=e;return i})();var dm=(()=>{let e=class e{constructor(){this.engineService=S(ns),this.animationLoopService=S(al)}get beforeRender(){return this.engineService.beforeRender$}get onResize(){return this.engineService.resize$}set renderOnDemand(n){n?this.animationLoopService.stop():this.animationLoopService.start()}get renderOnDemand(){return!this.animationLoopService.isActive()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Ge({type:e,selectors:[["","beforeRender",""],["","onResize",""],["","renderOnDemand",""]],inputs:{renderOnDemand:"renderOnDemand"},outputs:{beforeRender:"beforeRender",onResize:"onResize"}});let i=e;return i})();var Cv=function(){var i=0,e=document.createElement("div");e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(u){u.preventDefault(),n(++i%e.children.length)},!1);function t(u){return e.appendChild(u.dom),u}function n(u){for(var d=0;d<e.children.length;d++)e.children[d].style.display=d===u?"block":"none";i=u}var r=(performance||Date).now(),o=r,s=0,a=t(new Cv.Panel("FPS","#0ff","#002")),c=t(new Cv.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var l=t(new Cv.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:e,addPanel:t,showPanel:n,begin:function(){r=(performance||Date).now()},end:function(){s++;var u=(performance||Date).now();if(c.update(u-r,200),u>=o+1e3&&(a.update(s*1e3/(u-o),100),o=u,s=0,l)){var d=performance.memory;l.update(d.usedJSHeapSize/1048576,d.jsHeapSizeLimit/1048576)}return u},update:function(){r=this.end()},domElement:e,setMode:n}};Cv.Panel=function(i,e,t){var n=1/0,r=0,o=Math.round,s=o(window.devicePixelRatio||1),a=80*s,c=48*s,l=3*s,u=2*s,d=3*s,h=15*s,f=74*s,g=30*s,_=document.createElement("canvas");_.width=a,_.height=c,_.style.cssText="width:80px;height:48px";var m=_.getContext("2d");return m.font="bold "+9*s+"px Helvetica,Arial,sans-serif",m.textBaseline="top",m.fillStyle=t,m.fillRect(0,0,a,c),m.fillStyle=e,m.fillText(i,l,u),m.fillRect(d,h,f,g),m.fillStyle=t,m.globalAlpha=.9,m.fillRect(d,h,f,g),{dom:_,update:function(p,b){n=Math.min(n,p),r=Math.max(r,p),m.fillStyle=t,m.globalAlpha=1,m.fillRect(0,0,a,h),m.fillStyle=e,m.fillText(o(p)+" "+i+" ("+o(n)+"-"+o(r)+")",l,u),m.drawImage(_,d+s,h,f-s,g,d,h,f-s,g),m.fillRect(d+f-s,h,s,g),m.fillStyle=t,m.globalAlpha=.9,m.fillRect(d+f-s,h,s,o((1-p/b)*g))}}};var rV=Cv;var yi=(()=>{let e=class e{constructor(){this.engineService=S(ns),this.canvas=S(At),this.stats=new rV}ngOnDestroy(){this.renderSubscription&&this.renderSubscription.unsubscribe()}ngOnInit(){if(!this.canvas.elementRef)throw new Error("No canvas present");let n=this.canvas.elementRef.nativeElement;n&&(n.style.position="relative",this.stats.dom.style.position="absolute",this.stats.showPanel(0),n.appendChild(this.stats.dom),this.renderSubscription=this.engineService.beforeRender$.subscribe(()=>{this.stats.update()}))}set thStats(n){n?this.stats.dom.style.visibility="visible":this.stats.dom.style.visibility="hidden"}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Ge({type:e,selectors:[["","thStats",""]],inputs:{thStats:"thStats"}});let i=e;return i})();var Oo=new ue,RS=class extends or{constructor(e){super(e),this.propertyNameMapping={},this.customPropertyMapping={}}load(e,t,n,r){let o=this,s=new ir(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(a){try{t(o.parse(a))}catch(c){r?r(c):console.error(c),o.manager.itemError(e)}},n,r)}setPropertyNameMapping(e){this.propertyNameMapping=e}setCustomPropertyNameMapping(e){this.customPropertyMapping=e}parse(e){function t(m,p=0){let b=/^ply([\s\S]*)end_header(\r\n|\r|\n)/,v="",y=b.exec(m);y!==null&&(v=y[1]);let w={comments:[],elements:[],headerLength:p,objInfo:""},R=v.split(/\r\n|\r|\n/),E;function A(x,T){let P={type:x[0]};return P.type==="list"?(P.name=x[3],P.countType=x[1],P.itemType=x[2]):P.name=x[1],P.name in T&&(P.name=T[P.name]),P}for(let x=0;x<R.length;x++){let T=R[x];if(T=T.trim(),T==="")continue;let P=T.split(/\s+/),L=P.shift();switch(T=P.join(" "),L){case"format":w.format=P[0],w.version=P[1];break;case"comment":w.comments.push(T);break;case"element":E!==void 0&&w.elements.push(E),E={},E.name=P[0],E.count=parseInt(P[1]),E.properties=[];break;case"property":E.properties.push(A(P,_.propertyNameMapping));break;case"obj_info":w.objInfo=T;break;default:console.log("unhandled",L,P)}}return E!==void 0&&w.elements.push(E),w}function n(m,p){switch(p){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(m);case"float":case"double":case"float32":case"float64":return parseFloat(m)}}function r(m,p){let b={};for(let v=0;v<m.length;v++){if(p.empty())return null;if(m[v].type==="list"){let y=[],w=n(p.next(),m[v].countType);for(let R=0;R<w;R++){if(p.empty())return null;y.push(n(p.next(),m[v].itemType))}b[m[v].name]=y}else b[m[v].name]=n(p.next(),m[v].type)}return b}function o(){let m={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[],faceVertexColors:[]};for(let p of Object.keys(_.customPropertyMapping))m[p]=[];return m}function s(m){let p=m.map(v=>v.name);function b(v){for(let y=0,w=v.length;y<w;y++){let R=v[y];if(p.includes(R))return R}return null}return{attrX:b(["x","px","posx"])||"x",attrY:b(["y","py","posy"])||"y",attrZ:b(["z","pz","posz"])||"z",attrNX:b(["nx","normalx"]),attrNY:b(["ny","normaly"]),attrNZ:b(["nz","normalz"]),attrS:b(["s","u","texture_u","tx"]),attrT:b(["t","v","texture_v","ty"]),attrR:b(["red","diffuse_red","r","diffuse_r"]),attrG:b(["green","diffuse_green","g","diffuse_g"]),attrB:b(["blue","diffuse_blue","b","diffuse_b"])}}function a(m,p){let b=o(),v=/end_header\s+(\S[\s\S]*\S|\S)\s*$/,y,w;(w=v.exec(m))!==null?y=w[1].split(/\s+/):y=[];let R=new KA(y);e:for(let E=0;E<p.elements.length;E++){let A=p.elements[E],x=s(A.properties);for(let T=0;T<A.count;T++){let P=r(A.properties,R);if(!P)break e;l(b,A.name,P,x)}}return c(b)}function c(m){let p=new nt;m.indices.length>0&&p.setIndex(m.indices),p.setAttribute("position",new Oe(m.vertices,3)),m.normals.length>0&&p.setAttribute("normal",new Oe(m.normals,3)),m.uvs.length>0&&p.setAttribute("uv",new Oe(m.uvs,2)),m.colors.length>0&&p.setAttribute("color",new Oe(m.colors,3)),(m.faceVertexUvs.length>0||m.faceVertexColors.length>0)&&(p=p.toNonIndexed(),m.faceVertexUvs.length>0&&p.setAttribute("uv",new Oe(m.faceVertexUvs,2)),m.faceVertexColors.length>0&&p.setAttribute("color",new Oe(m.faceVertexColors,3)));for(let b of Object.keys(_.customPropertyMapping))m[b].length>0&&p.setAttribute(b,new Oe(m[b],_.customPropertyMapping[b].length));return p.computeBoundingSphere(),p}function l(m,p,b,v){if(p==="vertex"){m.vertices.push(b[v.attrX],b[v.attrY],b[v.attrZ]),v.attrNX!==null&&v.attrNY!==null&&v.attrNZ!==null&&m.normals.push(b[v.attrNX],b[v.attrNY],b[v.attrNZ]),v.attrS!==null&&v.attrT!==null&&m.uvs.push(b[v.attrS],b[v.attrT]),v.attrR!==null&&v.attrG!==null&&v.attrB!==null&&(Oo.setRGB(b[v.attrR]/255,b[v.attrG]/255,b[v.attrB]/255,Jn),m.colors.push(Oo.r,Oo.g,Oo.b));for(let y of Object.keys(_.customPropertyMapping))for(let w of _.customPropertyMapping[y])m[y].push(b[w])}else if(p==="face"){let y=b.vertex_indices||b.vertex_index,w=b.texcoord;y.length===3?(m.indices.push(y[0],y[1],y[2]),w&&w.length===6&&(m.faceVertexUvs.push(w[0],w[1]),m.faceVertexUvs.push(w[2],w[3]),m.faceVertexUvs.push(w[4],w[5]))):y.length===4&&(m.indices.push(y[0],y[1],y[3]),m.indices.push(y[1],y[2],y[3])),v.attrR!==null&&v.attrG!==null&&v.attrB!==null&&(Oo.setRGB(b[v.attrR]/255,b[v.attrG]/255,b[v.attrB]/255,Jn),m.faceVertexColors.push(Oo.r,Oo.g,Oo.b),m.faceVertexColors.push(Oo.r,Oo.g,Oo.b),m.faceVertexColors.push(Oo.r,Oo.g,Oo.b))}}function u(m,p){let b={},v=0;for(let y=0;y<p.length;y++){let w=p[y],R=w.valueReader;if(w.type==="list"){let E=[],A=w.countReader.read(m+v);v+=w.countReader.size;for(let x=0;x<A;x++)E.push(R.read(m+v)),v+=R.size;b[w.name]=E}else b[w.name]=R.read(m+v),v+=R.size}return[b,v]}function d(m,p,b){function v(y,w,R){switch(w){case"int8":case"char":return{read:E=>y.getInt8(E),size:1};case"uint8":case"uchar":return{read:E=>y.getUint8(E),size:1};case"int16":case"short":return{read:E=>y.getInt16(E,R),size:2};case"uint16":case"ushort":return{read:E=>y.getUint16(E,R),size:2};case"int32":case"int":return{read:E=>y.getInt32(E,R),size:4};case"uint32":case"uint":return{read:E=>y.getUint32(E,R),size:4};case"float32":case"float":return{read:E=>y.getFloat32(E,R),size:4};case"float64":case"double":return{read:E=>y.getFloat64(E,R),size:8}}}for(let y=0,w=m.length;y<w;y++){let R=m[y];R.type==="list"?(R.countReader=v(p,R.countType,b),R.valueReader=v(p,R.itemType,b)):R.valueReader=v(p,R.type,b)}}function h(m,p){let b=o(),v=p.format==="binary_little_endian",y=new DataView(m,p.headerLength),w,R=0;for(let E=0;E<p.elements.length;E++){let A=p.elements[E],x=A.properties,T=s(x);d(x,y,v);for(let P=0;P<A.count;P++){w=u(R,x),R+=w[1];let L=w[0];l(b,A.name,L,T)}}return c(b)}function f(m){let p=0,b=!0,v="",y=[],w=new TextDecoder().decode(m.subarray(0,5)),R=/^ply\r\n/.test(w);do{let E=String.fromCharCode(m[p++]);E!==`
`&&E!=="\r"?v+=E:(v==="end_header"&&(b=!1),v!==""&&(y.push(v),v=""))}while(b&&p<m.length);return R===!0&&p++,{headerText:y.join("\r")+"\r",headerLength:p}}let g,_=this;if(e instanceof ArrayBuffer){let m=new Uint8Array(e),{headerText:p,headerLength:b}=f(m),v=t(p,b);if(v.format==="ascii"){let y=new TextDecoder().decode(m);g=a(y,v)}else g=h(e,v)}else g=a(e,t(e));return g}},KA=class{constructor(e){this.arr=e,this.i=0}empty(){return this.i>=this.arr.length}next(){return this.arr[this.i++]}};var Dte=(()=>{let e=class e extends lm{constructor(){super(...arguments),this.clazz=RS}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275prov=ge({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var oV=(()=>{let e=class e extends um{constructor(){super(...arguments),this.service=S(Dte)}injectHost(){return S(Kt,{host:!0})}getRefFromResponse(n){return n.computeVertexNormals(),n}load(){return Wt(this,null,function*(){if(!this.initialized)return;if(this._url===void 0)throw new Error("missing url");let n=this._url,r=yu(this.onProgress$)?s=>{this.onProgress$?.next(s)}:void 0,o=yield this.zone.runOutsideAngular(()=>this.service.load(n,r));this._host.objRef=this.getRefFromResponse(o),this.onLoaded$&&o!==void 0&&this.onLoaded$?.next(o)})}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275dir=Ge({type:e,selectors:[["","loadPLY",""]],features:[$]});let i=e;return i})();var sV=(()=>{let e=class e{transform(n,r){return n.bind(r)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275pipe=$o({name:"bind",type:e,pure:!0});let i=e;return i})();var Pte=["outerRef"],Fte=["innerRef"],Nte=["*"];function jte(i,e){i&1&&Rd(0)}function Ote(i,e){if(i&1){let t=en();B(0,"div",5,1),Ie("onResize",function(){rt(t);let r=$t();return ot(r.onResize())}),B(2,"div",null,2)(4,"div",6),fs(5,jte,1,0,"ng-container",7),X()()()}if(i&2){let t=$t(),n=Ft(3);zl(t.styles),F(2),zl(t.transformInnerStyles),F(2),zl(t.style),N("className",t.className),F(),N("ngTemplateOutlet",n)}}function Lte(i,e){i&1&&Rd(0)}function kte(i,e){if(i&1&&(B(0,"div",6,1),fs(2,Lte,1,0,"ng-container",7),X()),i&2){let t=$t(),n=Ft(3);zl(t.styles),N("className",t.className),F(2),N("ngTemplateOutlet",n)}}function Bte(i,e){i&1&&Q(0)}var Ev=new C,eP=new C,Ute=new C;function Vte(i,e,t){let n=Ev.setFromMatrixPosition(i.matrixWorld);n.project(e);let r=t.width/2,o=t.height/2;return[n.x*r+r,-(n.y*o)+o]}function zte(i,e){let t=Ev.setFromMatrixPosition(i.matrixWorld),n=eP.setFromMatrixPosition(e.matrixWorld),r=t.sub(n),o=e.getWorldDirection(Ute);return r.angleTo(o)>Math.PI/2}function Hte(i,e,t,n){let r=Ev.setFromMatrixPosition(i.matrixWorld),o=r.clone();o.project(e),t.setFromCamera(o,e);let s=t.intersectObjects(n,!0);if(s.length){let a=s[0].distance;return r.distanceTo(t.ray.origin)<a}return!0}function Gte(i,e){if(e instanceof mo)return e.zoom;if(e instanceof ai){let t=Ev.setFromMatrixPosition(i.matrixWorld),n=eP.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,o=t.distanceTo(n);return 1/(2*Math.tan(r/2)*o)}else return 1}function Wte(i,e,t){if(e instanceof ai||e instanceof mo){let n=Ev.setFromMatrixPosition(i.matrixWorld),r=eP.setFromMatrixPosition(e.matrixWorld),o=n.distanceTo(r),s=(t[1]-t[0])/(e.far-e.near),a=t[1]-s*e.far;return Math.round(s*o+a)}}var JA=i=>Math.abs(i)<1e-10?0:i;function aV(i,e,t=""){let n="matrix3d(";for(let r=0;r!==16;r++)n+=JA(e[r]*i.elements[r])+(r!==15?",":")");return t+n}var $te=(i=>e=>aV(e,i))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),qte=(i=>(e,t)=>aV(e,i(t),"translate(-50%,-50%)"))(i=>[1/i,1/i,1/i,1,-1/i,-1/i,-1/i,-1,1/i,1/i,1/i,1,1,1,1,1]),cV=(()=>{let e=class e extends uc{constructor(){super(...arguments),this.view=S(Zr),this.DoubleSide=rr,this.FRAGMENT_SHADER=Zte,this.VERTEX_SHADER=Xte,this.prepend=!1,this.center=!1,this.fullscreen=!1,this.eps=.001,this.sprite=!1,this.transform=!1,this.zIndexRange=[16777271,0],this.onOcclude=new dt,this.calculatePosition=Vte,this.as="div",this.pointerEvents="auto",this.transformInnerStyles=this.computeInnerStyles(),this.styles=null,this.oldZoom=0,this.oldPosition=[0,0],this.notOccluded=!0,this.raycaster=S(Sh)}ngOnInit(){super.ngOnInit(),this.styles=this.computeStyles()}ngAfterViewInit(){this.el=document.createElement(this.as),this.frameSubscription=this.view.onRender.subscribe(()=>this.onFrame()),this.transformOuterRef&&this.el.appendChild(this.transformOuterRef.nativeElement),this.el&&!this.target&&this.appendElement(this.el)}onResize(){this.styles=this.computeStyles()}ngOnChanges(n){super.ngOnChanges(n)}appendElement(n){if(!(!this.el||!this.objRef||!this.view.hostElement||!this.view.camera)){if(this.target=this.portal??this.view.hostElement.nativeElement,this.view.scene?.objRef?.updateMatrixWorld(),this.transform)n.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{let r=this.calculatePosition(this.objRef,this.view.camera.objRef,this.getSize());n.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${r[0]}px,${r[1]}px,0);transform-origin:0 0;`}this.target&&(this.prepend?this.target.prepend(n):this.target.appendChild(n))}}onFrame(){let n=this.view.camera?.objRef,r=this.view.scene?.objRef,o=this._objRef,s=this.getSize();if(!n||!o||!r||!this.el)return;n.updateMatrixWorld(),o.updateWorldMatrix(!0,!1);let a=this.transform?this.oldPosition:this.calculatePosition(o,n,s);if(this.transform||Math.abs(this.oldZoom-n.zoom)>this.eps||Math.abs(this.oldPosition[0]-a[0])>this.eps||Math.abs(this.oldPosition[1]-a[1])>this.eps){let c=zte(o,n),l=!1;typeof this.occlude=="boolean"?this.occlude===!0&&(l=[r]):Array.isArray(this.occlude)&&(l=this.occlude.map(d=>d.objRef??d));let u=this.notOccluded;if(l?this.notOccluded=!c&&Hte(o,n,this.raycaster,l):this.notOccluded=!c,u!==this.notOccluded&&(this.onOcclude.length>0?this.onOcclude.next(!this.notOccluded):this.el.style.display=this.notOccluded?"block":"none"),this.el.style.zIndex=`${Wte(o,n,this.zIndexRange)}`,this.transform){let[d,h]=[s.width/2,s.height/2],f=n.projectionMatrix.elements[5]*h,{isOrthographicCamera:g,top:_,left:m,bottom:p,right:b}=n,v=$te(n.matrixWorldInverse),y=g?`scale(${f})translate(${JA(-(b+m)/2)}px,${JA((_+p)/2)}px)`:`translateZ(${f}px)`,w=o.matrixWorld;this.sprite&&(w=n.matrixWorldInverse.clone().transpose().copyPosition(w).scale(o.scale),w.elements[3]=w.elements[7]=w.elements[11]=0,w.elements[15]=1),this.el.style.width=s.width+"px",this.el.style.height=s.height+"px",this.el.style.perspective=g?"":`${f}px`,this.transformOuterRef&&this.transformInnerRef&&(this.transformOuterRef.nativeElement.style.transform=`${y}${v}translate(${d}px,${h}px)`,this.transformInnerRef.nativeElement.style.transform=qte(w,1/((this.distanceFactor||10)/400)))}else{let d=this.distanceFactor===void 0?1:Gte(o,n)*this.distanceFactor;this.el.style.transform=`translate3d(${a[0]}px,${a[1]}px,0) scale(${d})`}this.oldPosition=a,this.oldZoom=n.zoom}}ngOnDestroy(){this.el?.remove(),this.frameSubscription?.unsubscribe()}computeStyles(){let n=this.getSize();return this.transform?{position:"absolute",top:0,left:0,width:n.width+"px",height:n.height+"px",transformStyle:"preserve-3d",pointerEvents:"none"}:ae(ae({position:"absolute",transform:this.center?"translate3d(-50%,-50%,0)":"none"},this.fullscreen&&{top:-n.height/2+"px",left:-n.width/2+"px",width:n.width+"px",height:n.height+"px"}),this.style)}computeInnerStyles(){return{position:"absolute",pointerEvents:this.pointerEvents}}getSize(){return this.view.viewPort??this.view.hostElement.nativeElement.getBoundingClientRect()??{width:0,height:0}}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-html"]],viewQuery:function(r,o){if(r&1&&(tn(Pte,5),tn(Fte,5)),r&2){let s;st(s=at())&&(o.transformOuterRef=s.first),st(s=at())&&(o.transformInnerRef=s.first)}},inputs:{prepend:"prepend",center:"center",fullscreen:"fullscreen",portal:"portal",distanceFactor:"distanceFactor",sprite:"sprite",transform:"transform",zIndexRange:"zIndexRange",style:"style",className:"className",occlude:"occlude",calculatePosition:"calculatePosition",as:"as",wrapperClass:"wrapperClass",pointerEvents:"pointerEvents"},outputs:{onOcclude:"onOcclude"},features:[$,$i],ngContentSelectors:Nte,decls:4,vars:1,consts:[["tempOutlet",""],["outerRef",""],["innerRef",""],[3,"style"],[3,"style","className"],[3,"onResize"],[3,"className"],[4,"ngTemplateOutlet"]],template:function(r,o){r&1&&(ie(),Vi(0,Ote,6,8,"div",3)(1,kte,3,4,"div",4),fs(2,Bte,1,0,"ng-template",null,0,ox)),r&2&&zi(o.transform?0:1)},dependencies:[fD],encapsulation:2,changeDetection:0});let i=e;return i})(),Xte=`
/*
  This shader is from the THREE's SpriteMaterial.
  We need to turn the backing plane into a Sprite
  (make it always face the camera) if "transfrom" 
  is false. 
*/
#include <common>
void main() {
  vec2 center = vec2(0., 1.);
  float rotation = 0.0;
  
  // This is somewhat arbitrary, but it seems to work well
  // Need to figure out how to derive this dynamically if it even matters
  float size = 0.03;
  vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
  vec2 scale;
  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
  bool isPerspective = isPerspectiveMatrix( projectionMatrix );
  if ( isPerspective ) scale *= - mvPosition.z;
  vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
  vec2 rotatedPosition;
  rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
  rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
  mvPosition.xy += rotatedPosition;
  gl_Position = projectionMatrix * mvPosition;
}
`,Zte=`
void main() {
  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
}
`;var hm=(()=>{let e=class e{constructor(){this.host=S(de,{self:!0}),this.parent=S(de,{skipSelf:!0}),this.host.autoAddToParent=!1,this.host.autoDispose=!1,this.host.objRef=kM()}set refById(n){this.id=n,this.subscription?.unsubscribe(),this.subscription=this.parent.objRef$.subscribe(r=>{this.parentObj=r,this.applyRef()})}applyRef(){if(!this.parentObj||this.id===void 0)return;let n=this.findById(this.parentObj,this.id);n&&this.setRef(this.host,n)}findById(n,r){if((n.name??n.uuid)===r)return n;for(let o of n.children){let s=this.findById(o,r);if(s!==void 0)return s}}setRef(n,r){let o=n.objRef;o&&$p(o)&&(o.objRef=r,n.objRef=o)}ngOnDestroy(){this.subscription?.unsubscribe()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Ge({type:e,selectors:[["","refById",""]],inputs:{refById:"refById"}});let i=e;return i})();var uV=(()=>{let e=class e{constructor(){this.lod=S(cS,{skipSelf:!0}),this.target=S(de,{self:!0})}ngOnInit(){this.lodLevel||this.setLevel()}ngOnChanges(){this.setLevel()}ngOnDestroy(){this.removeLevel()}setLevel(){let n=this.target.objRef,r=this.lod.objRef;r&&n&&(this.removeLevel(),r.addLevel(n,this.lodLevel?.distance,this.lodLevel?.hysteresis))}removeLevel(){let n=this.target.objRef,r=this.lod.objRef;if(r&&n){let o=r.levels.find(s=>s.object===n);o&&r.removeLevel(o.distance)}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Ge({type:e,selectors:[["","lodLevel",""]],inputs:{lodLevel:"lodLevel"},features:[$i]});let i=e;return i})();var ln=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Mn({type:e}),e.\u0275inj=xn({imports:[gA,fx,gA]});let i=e;return i})();function dV(i){return[{provide:de,useExisting:he(()=>i)}]}function Kte(i){let e=[];return i.updateMatrixWorld(!0),i.traverse(t=>{if(t?.isMesh){let n=t;if(n.isSkinnedMesh)return;let r=n.geometry.clone();r.applyMatrix4(n.matrixWorld),r.attributes.normal||r.computeVertexNormals(),e.push({geometry:r,material:n.material})}}),e}function Jte(i){let e=new Map;return i.forEach(({geometry:t,material:n})=>{let r=n?.uuid??n.type,o=e.get(r);o?o.geometries.push(t):e.set(r,{material:n,geometries:[t]})}),e}function ene(i){let e=[];for(let{material:t,geometries:n}of i.values()){let r=QU(n,!1);r?e.push({material:t,geometry:r}):e.push({material:t,geometry:n[0]})}return e}function hV(i,e){let t=Kte(i),n=Jte(t),r=ene(n),o=new wt;return r.forEach(({material:s,geometry:a})=>{let c=new Ms(a,s,e),l=new Ee;for(let u=0;u<e;u++)c.setMatrixAt(u,l);c.instanceMatrix.needsUpdate=!0,o.add(c)}),o}function fV(i,e,t){i.traverse(n=>{n instanceof Ms&&e>=0&&e<n.count&&(n.setMatrixAt(e,t),n.instanceMatrix.needsUpdate=!0)})}var TS="https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/assets/",ui="assets/";var pV=(()=>{let e=class e{constructor(){this.assetPath=ui+"RobotExpressive.glb",this.states=["Idle","Walking","Running","Dance","Death","Sitting","Standing"],this.emotes=["Jump","Yes","No","Wave","Punch","ThumbsUp"],this.actions={}}onInit(n){this.animationMixer=new Ip(n.scene),n.scene.traverse(r=>{r.isMesh&&(r.castShadow=!0,r.receiveShadow=!0)});for(let r of n.animations){let o=this.animationMixer.clipAction(r);this.actions[r.name]=o,(this.emotes.indexOf(r.name)>=0||this.states.indexOf(r.name)>=4)&&(o.clampWhenFinished=!0,o.loop=nv)}this.activeAction=this.actions.Walking,this.activeAction.play()}beforeRender(n){this.animationMixer&&this.animationMixer.update(n.delta)}fadeToAction(n,r){this.previousAction=this.activeAction,this.activeAction=this.actions[n],this.previousAction&&this.previousAction!==this.activeAction&&this.previousAction.fadeOut(r),this.activeAction.reset().setEffectiveTimeScale(1).setEffectiveWeight(1).fadeIn(r).play()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-robot"]],decls:1,vars:2,consts:[["loadGLTF","",3,"onLoaded","beforeRender","url","castShadow"]],template:function(r,o){r&1&&(B(0,"th-mesh",0),Ie("onLoaded",function(a){return o.onInit(a)})("beforeRender",function(a){return o.beforeRender(a)}),X()),r&2&&N("url",o.assetPath)("castShadow",!0)},dependencies:[ln,Cn,hr,dm],encapsulation:2,changeDetection:0});let i=e;return i})();var tne=["gridHelper"],nne=()=>["#e0e0e0"],ine=()=>["#e0e0e0",20,100],rne=()=>[45,2,.25,100],one=i=>[i,5,10],sne=()=>[0,2,0],ane=()=>["#ffffff","#444444"],cne=()=>[0,20,0],lne=()=>["#ffffff"],une=()=>[0,20,10],dne=i=>[i,0,0],hne=()=>[2e3,2e3],fne=()=>({color:"#999999",depthWrite:!1}),pne=()=>[200,40,"#000000","#000000"],mV=(()=>{let e=class e{constructor(){this.Math=Math}ngAfterViewInit(){let n=this.gridHelper?.objRef?.material;n&&(n.opacity=.2,n.transparent=!0)}onBeforeRender(){}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-animation-example"]],viewQuery:function(r,o){if(r&1&&tn(tne,7),r&2){let s;st(s=at())&&(o.gridHelper=s.first)}},decls:12,vars:37,consts:[["gridHelper",""],[3,"onRender","thStats","shadow"],[3,"background","fog"],[3,"args","position","lookAt"],[3,"args","position","intensity"],[3,"args","position","castShadow","intensity"],[3,"rotation","receiveShadow"],[3,"args"],[3,"args","receiveShadow"]],template:function(r,o){if(r&1){let s=en();B(0,"th-canvas",1),Ie("onRender",function(){return rt(s),ot(o.onBeforeRender())}),B(1,"th-scene",2),In(2,"fog"),ne(3,"th-perspectiveCamera",3)(4,"th-hemisphereLight",4)(5,"th-directionalLight",5),B(6,"th-mesh",6),ne(7,"th-planeGeometry",7)(8,"th-meshPhongMaterial",7),X(),ne(9,"th-gridHelper",8,0)(11,"app-robot"),X()()}r&2&&(N("thStats",!0)("shadow",!0),F(),N("background",V(22,nne))("fog",jn(2,20,V(23,ine))),F(2),N("args",V(24,rne))("position",_t(25,one,-5))("lookAt",V(27,sne)),F(),N("args",V(28,ane))("position",V(29,cne))("intensity",3),F(),N("args",V(30,lne))("position",V(31,une))("castShadow",!0)("intensity",3),F(),N("rotation",_t(32,dne,-.5*o.Math.PI))("receiveShadow",!0),F(),N("args",V(34,hne)),F(),N("args",V(35,fne)),F(),N("args",V(36,pne))("receiveShadow",!0))},dependencies:[ln,Gt,dr,Pr,em,Cn,Ot,No,Ds,At,yi,pV,SS],encapsulation:2,changeDetection:0});let i=e;return i})();var mne=()=>({color:"purple"}),gne=()=>[75,2,.1,1e3],_ne=()=>[1,1,5],gV=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-basic-example"]],decls:7,vars:6,consts:[[3,"args"],[3,"args","position"]],template:function(r,o){r&1&&(B(0,"th-canvas")(1,"th-scene")(2,"th-mesh"),ne(3,"th-boxGeometry")(4,"th-meshBasicMaterial",0),X(),ne(5,"th-ambientLight")(6,"th-perspectiveCamera",1),X()()),r&2&&(F(4),N("args",V(3,mne)),F(2),N("args",V(4,gne))("position",V(5,_ne)))},dependencies:[ln,Gt,Tn,Cn,Ot,dc,cl,At],encapsulation:2,changeDetection:0});let i=e;return i})();var bne=()=>[2,2,2],vne=()=>[1,1,1],yne=()=>[10,10],_V=()=>[10,10,10],xne=()=>[45,2,.1,100],wne=()=>[0,0,0],bV=(()=>{let e=class e{constructor(){this.selected=!1,this.glbPath=`${ui}DamagedHelmet.glb`}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-controls-example"]],decls:8,vars:17,consts:[[3,"thStats"],[3,"intensity"],["loadGLTF","",3,"onClick","url","scale"],[3,"args"],[3,"position","intensity"],[3,"args","position","lookAt"]],template:function(r,o){r&1&&(B(0,"th-canvas",0)(1,"th-scene"),ne(2,"th-ambientLight",1),B(3,"th-object3D",2),Ie("onClick",function(){return o.selected=!o.selected}),X(),ne(4,"th-gridHelper",3)(5,"th-pointLight",4),B(6,"th-perspectiveCamera",5),ne(7,"th-orbitControls"),X()()()),r&2&&(N("thStats",!0),F(2),N("intensity",3),F(),N("url",o.glbPath)("scale",o.selected?V(10,bne):V(11,vne)),F(),N("args",V(12,yne)),F(),N("position",V(13,_V))("intensity",3),F(),N("args",V(14,xne))("position",V(15,_V))("lookAt",V(16,wne)))},dependencies:[ln,vi,Gt,de,dr,Tn,Gi,Ot,At,hr,wu,yi],encapsulation:2,changeDetection:0});let i=e;return i})();var Mne=()=>[10,10,10],Sne=()=>[45,2,1,1e4],Rne=()=>[0,0,3e3],Tne=()=>[0,0,0];function Cne(i,e){if(i&1&&(B(0,"th-cSS3DObject",8)(1,"div",12)(2,"div",13),Vt(3),X(),B(4,"div",14),Vt(5),X(),B(6,"div",15),Vt(7),ne(8,"br"),Vt(9),X()()()),i&2){let t=e.$implicit,n=e.$index,r=$t();N("position",r.poses[n].position),F(),qs("background","rgba(0,127,127,"+(r.Math.random()*.5+.25)+")"),F(2),ms(" ",n+1," "),F(2),ms(" ",t[0]," "),F(2),ms(" ",t[1]," "),F(2),ms(" ",t[2]," ")}}var vV=(()=>{let e=class e{constructor(){this.Math=Math,this.table=[["H","Hydrogen","1.00794",1,1],["He","Helium","4.002602",18,1],["Li","Lithium","6.941",1,2],["Be","Beryllium","9.012182",2,2],["B","Boron","10.811",13,2],["C","Carbon","12.0107",14,2],["N","Nitrogen","14.0067",15,2],["O","Oxygen","15.9994",16,2],["F","Fluorine","18.9984032",17,2],["Ne","Neon","20.1797",18,2],["Na","Sodium","22.98976...",1,3],["Mg","Magnesium","24.305",2,3],["Al","Aluminium","26.9815386",13,3],["Si","Silicon","28.0855",14,3],["P","Phosphorus","30.973762",15,3],["S","Sulfur","32.065",16,3],["Cl","Chlorine","35.453",17,3],["Ar","Argon","39.948",18,3],["K","Potassium","39.948",1,4],["Ca","Calcium","40.078",2,4],["Sc","Scandium","44.955912",3,4],["Ti","Titanium","47.867",4,4],["V","Vanadium","50.9415",5,4],["Cr","Chromium","51.9961",6,4],["Mn","Manganese","54.938045",7,4],["Fe","Iron","55.845",8,4],["Co","Cobalt","58.933195",9,4],["Ni","Nickel","58.6934",10,4],["Cu","Copper","63.546",11,4],["Zn","Zinc","65.38",12,4],["Ga","Gallium","69.723",13,4],["Ge","Germanium","72.63",14,4],["As","Arsenic","74.9216",15,4],["Se","Selenium","78.96",16,4],["Br","Bromine","79.904",17,4],["Kr","Krypton","83.798",18,4],["Rb","Rubidium","85.4678",1,5],["Sr","Strontium","87.62",2,5],["Y","Yttrium","88.90585",3,5],["Zr","Zirconium","91.224",4,5],["Nb","Niobium","92.90628",5,5],["Mo","Molybdenum","95.96",6,5],["Tc","Technetium","(98)",7,5],["Ru","Ruthenium","101.07",8,5],["Rh","Rhodium","102.9055",9,5],["Pd","Palladium","106.42",10,5],["Ag","Silver","107.8682",11,5],["Cd","Cadmium","112.411",12,5],["In","Indium","114.818",13,5],["Sn","Tin","118.71",14,5],["Sb","Antimony","121.76",15,5],["Te","Tellurium","127.6",16,5],["I","Iodine","126.90447",17,5],["Xe","Xenon","131.293",18,5],["Cs","Caesium","132.9054",1,6],["Ba","Barium","132.9054",2,6],["La","Lanthanum","138.90547",4,9],["Ce","Cerium","140.116",5,9],["Pr","Praseodymium","140.90765",6,9],["Nd","Neodymium","144.242",7,9],["Pm","Promethium","(145)",8,9],["Sm","Samarium","150.36",9,9],["Eu","Europium","151.964",10,9],["Gd","Gadolinium","157.25",11,9],["Tb","Terbium","158.92535",12,9],["Dy","Dysprosium","162.5",13,9],["Ho","Holmium","164.93032",14,9],["Er","Erbium","167.259",15,9],["Tm","Thulium","168.93421",16,9],["Yb","Ytterbium","173.054",17,9],["Lu","Lutetium","174.9668",18,9],["Hf","Hafnium","178.49",4,6],["Ta","Tantalum","180.94788",5,6],["W","Tungsten","183.84",6,6],["Re","Rhenium","186.207",7,6],["Os","Osmium","190.23",8,6],["Ir","Iridium","192.217",9,6],["Pt","Platinum","195.084",10,6],["Au","Gold","196.966569",11,6],["Hg","Mercury","200.59",12,6],["Tl","Thallium","204.3833",13,6],["Pb","Lead","207.2",14,6],["Bi","Bismuth","208.9804",15,6],["Po","Polonium","(209)",16,6],["At","Astatine","(210)",17,6],["Rn","Radon","(222)",18,6],["Fr","Francium","(223)",1,7],["Ra","Radium","(226)",2,7],["Ac","Actinium","(227)",4,10],["Th","Thorium","232.03806",5,10],["Pa","Protactinium","231.0588",6,10],["U","Uranium","238.02891",7,10],["Np","Neptunium","(237)",8,10],["Pu","Plutonium","(244)",9,10],["Am","Americium","(243)",10,10],["Cm","Curium","(247)",11,10],["Bk","Berkelium","(247)",12,10],["Cf","Californium","(251)",13,10],["Es","Einstenium","(252)",14,10],["Fm","Fermium","(257)",15,10],["Md","Mendelevium","(258)",16,10],["No","Nobelium","(259)",17,10],["Lr","Lawrencium","(262)",18,10],["Rf","Rutherfordium","(267)",4,7],["Db","Dubnium","(268)",5,7],["Sg","Seaborgium","(271)",6,7],["Bh","Bohrium","(272)",7,7],["Hs","Hassium","(270)",8,7],["Mt","Meitnerium","(276)",9,7],["Ds","Darmstadium","(281)",10,7],["Rg","Roentgenium","(280)",11,7],["Cn","Copernicium","(285)",12,7],["Nh","Nihonium","(286)",13,7],["Fl","Flerovium","(289)",14,7],["Mc","Moscovium","(290)",15,7],["Lv","Livermorium","(293)",16,7],["Ts","Tennessine","(294)",17,7],["Og","Oganesson","(294)",18,7]],this.poses=[],this.createRandomPoses()}createRandomPoses(){this.poses=[];for(let n=0;n<this.table.length;n++){let r=new wt;r.position.set(Math.random()*4e3-2e3,Math.random()*4e3-2e3,Math.random()*4e3-2e3),this.poses.push(r)}}createTablePoses(){this.poses=this.table.map(n=>{let r=new wt;return r.position.x=n[3]*140-1330,r.position.y=-(n[4]*180)+990,r})}createSpherePoses(){let n=new C,r=this.table.length;this.poses=this.table.map((o,s)=>{let a=Math.acos(-1+2*s/r),c=Math.sqrt(r*Math.PI)*a,l=new wt;return l.position.setFromSphericalCoords(800,a,c),n.copy(l.position).multiplyScalar(2),l.lookAt(n),l})}createHelixPoses(){let n=new C;this.poses=this.table.map((r,o)=>{let s=o*.175+Math.PI,a=-(o*8)+450,c=new wt;return c.position.setFromCylindricalCoords(900,s,a),n.x=c.position.x*2,n.y=c.position.y,n.z=c.position.z*2,c.lookAt(n),c})}createGridPoses(){this.poses=this.table.map((n,r)=>{let o=new wt;return o.position.x=r%5*400-800,o.position.y=-(Math.floor(r/5)%5)*400+800,o.position.z=Math.floor(r/25)*1e3-2e3,o})}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-css3d-multi-renderer-example"]],features:[K([zM()])],decls:17,vars:14,consts:[["id","menu"],["id","table",3,"click"],["id","sphere",3,"click"],["id","helix",3,"click"],["id","grid",3,"click"],[1,"canvas-background",3,"renderOnDemand"],[3,"thStats"],[3,"intensity"],[3,"position"],[3,"position","intensity"],[3,"args","position","lookAt"],[3,"minDistance","maxDistance"],[1,"element"],[1,"number"],[1,"symbol"],[1,"details"]],template:function(r,o){r&1&&(B(0,"div",0)(1,"button",1),Ie("click",function(){return o.createTablePoses()}),Vt(2,"TABLE"),X(),B(3,"button",2),Ie("click",function(){return o.createSpherePoses()}),Vt(4,"SPHERE"),X(),B(5,"button",3),Ie("click",function(){return o.createHelixPoses()}),Vt(6,"HELIX"),X(),B(7,"button",4),Ie("click",function(){return o.createGridPoses()}),Vt(8,"GRID"),X()(),B(9,"th-canvas",5)(10,"th-scene",6),ne(11,"th-ambientLight",7),Ki(12,Cne,10,7,"th-cSS3DObject",8,Qi),ne(14,"th-pointLight",9),B(15,"th-perspectiveCamera",10),ne(16,"th-trackballControls",11),X()()()),r&2&&(F(9),N("renderOnDemand",!0),F(),N("thStats",!0),F(),N("intensity",3),F(),Ji(o.table),F(2),N("position",V(10,Mne))("intensity",3),F(),N("args",V(11,Sne))("position",V(12,Rne))("lookAt",V(13,Tne)),F(),N("minDistance",500)("maxDistance",6e3))},dependencies:[ln,vS,Gt,Tn,Gi,Ot,VM,At,dm,yi],styles:[".canvas-background[_ngcontent-%COMP%]{background-color:#000}a[_ngcontent-%COMP%]{color:#8ff}#menu[_ngcontent-%COMP%]{position:absolute;bottom:20px;width:100%;text-align:center;z-index:10}.element[_ngcontent-%COMP%]{width:120px;height:160px;box-shadow:0 0 12px #00ffff80;border:1px solid rgba(127,255,255,.25);font-family:Helvetica,sans-serif;text-align:center;line-height:normal;cursor:default}.element[_ngcontent-%COMP%]:hover{box-shadow:0 0 12px #00ffffbf;border:1px solid rgba(127,255,255,.75)}.element[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{position:absolute;top:20px;right:20px;font-size:12px;color:#7fffffbf}.element[_ngcontent-%COMP%]   .symbol[_ngcontent-%COMP%]{position:absolute;top:40px;left:0;right:0;font-size:60px;font-weight:700;color:#ffffffbf;text-shadow:0 0 10px rgba(0,255,255,.95)}.element[_ngcontent-%COMP%]   .details[_ngcontent-%COMP%]{position:absolute;bottom:15px;left:0;right:0;font-size:12px;color:#7fffffbf}button[_ngcontent-%COMP%]{color:#7fffffbf;background:transparent;outline:1px solid rgba(127,255,255,.75);border:0px;padding:5px 10px;cursor:pointer}button[_ngcontent-%COMP%]:hover{background-color:#00ffff80}button[_ngcontent-%COMP%]:active{color:#000;background-color:#00ffffbf}"],changeDetection:0});let i=e;return i})();var Ene=()=>[0,1,0],Dne=()=>[10,10],yV=()=>[10,10,10],Ine=()=>[45,2,.1,100],Ane=()=>[0,0,0],xV=(()=>{let e=class e{constructor(){this.cdref=S(Ni),this.modelScale=[1,1,1],this.rotation=[0,0,0],this.modelUrl1=`${ui}DamagedHelmet.glb`,this.modelUrl2=`${ui}BoomBox.glb`,this.modelUrl=this.toggleModel(),this.intervalHandle=window.setInterval(()=>this.toggleModel(),3e3)}toggleModel(){return this.modelUrl!==this.modelUrl1?this.modelUrl=this.modelUrl1:this.modelUrl=this.modelUrl2,this.cdref.markForCheck(),this.modelUrl}onLoaded(){this.modelUrl!==this.modelUrl1?this.modelScale=[100,100,100]:this.modelScale=[1,1,1]}onRefChange(n){}onBeforeRender(){this.rotation=[0,this.rotation[1]+.01,0]}ngOnDestroy(){window.clearInterval(this.intervalHandle)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-dynamic-loader-example"]],decls:7,vars:17,consts:[[3,"onRender"],[3,"intensity"],["loadGLTF","",3,"onLoaded","objRef$","url","scale","rotation","position"],[3,"args"],[3,"position","intensity"],[3,"args","position","lookAt"]],template:function(r,o){r&1&&(B(0,"th-canvas",0),Ie("onRender",function(){return o.onBeforeRender()}),B(1,"th-scene"),ne(2,"th-ambientLight",1),B(3,"th-object3D",2),Ie("onLoaded",function(){return o.onLoaded()})("objRef$",function(a){return o.onRefChange(a)}),X(),ne(4,"th-gridHelper",3)(5,"th-pointLight",4)(6,"th-perspectiveCamera",5),X()()),r&2&&(F(2),N("intensity",3),F(),N("url",o.modelUrl)("scale",o.modelScale)("rotation",o.rotation)("position",V(11,Ene)),F(),N("args",V(12,Dne)),F(),N("position",V(13,yV))("intensity",3),F(),N("args",V(14,Ine))("position",V(15,yV))("lookAt",V(16,Ane)))},dependencies:[ln,Gt,de,dr,Tn,Gi,Ot,At,hr],encapsulation:2,changeDetection:0});let i=e;return i})();var Pne=()=>[10,10],wV=()=>[10,10,10],Fne=()=>[45,2,.1,100],Nne=()=>[0,0,0],jne=(i,e)=>({change:i,end:e});function One(i,e){if(i&1&&(B(0,"li"),Vt(1),X()),i&2){let t=e.$implicit;F(),ms(" ",t," ")}}var MV=(()=>{let e=class e{constructor(){this.cdref=S(Ni),this.id="CID",this.changes=[],this.rotation=[0,0,0],this.position=[0,1,0],this.assetPath=`${ui}DamagedHelmet.glb`,this.onOrbitControlEnd=()=>{this.pushToChangesArray(`${this.id}: orbit control end`)},window.setInterval(()=>{this.rotation=[0,this.rotation[1]+.05,0],this.cdref.markForCheck()},1500),window.setInterval(()=>{this.position=[0,(this.position[1]+1)%5,0],this.cdref.markForCheck()},3e3)}logUpdates(n){this.pushToChangesArray(Object.keys(n).toString())}onLoaded(){this.changes.push("Model loaded")}onOrbitControlChange(){this.pushToChangesArray(`${this.id}: orbit control change`)}pushToChangesArray(n){this.changes.length>=20&&this.changes.shift(),this.changes.push(n)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-events-example"]],decls:15,vars:22,consts:[[3,"intensity"],["loadGLTF","",3,"onUpdate","onLoaded","url","rotation","position"],[3,"args"],[3,"position","intensity"],[3,"args","position","lookAt"],[3,"threeEvents"],[1,"change-list"]],template:function(r,o){r&1&&(B(0,"th-canvas")(1,"th-scene"),ne(2,"th-ambientLight",0),B(3,"th-object3D",1),Ie("onUpdate",function(a){return o.logUpdates(a)})("onLoaded",function(){return o.onLoaded()}),X(),ne(4,"th-gridHelper",2)(5,"th-pointLight",3),B(6,"th-perspectiveCamera",4),ne(7,"th-orbitControls",5),In(8,"bind"),X()()(),B(9,"div",6)(10,"h1"),Vt(11,"Updates"),X(),B(12,"ol"),Ki(13,One,2,1,"li",null,Qi),X()()),r&2&&(F(2),N("intensity",3),F(),N("url",o.assetPath)("rotation",o.rotation)("position",o.position),F(),N("args",V(14,Pne)),F(),N("position",V(15,wV))("intensity",3),F(),N("args",V(16,Fne))("position",V(17,wV))("lookAt",V(18,Nne)),F(),N("threeEvents",br(19,jne,HE(8,11,o.onOrbitControlChange,o),o.onOrbitControlEnd)),F(6),Ji(o.changes))},dependencies:[ln,vi,Gt,de,dr,Tn,Gi,Ot,At,hr,sV],styles:[".change-list[_ngcontent-%COMP%]{padding:1em;box-shadow:0 4px 8px #0003;transition:.3s}[_nghost-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr)}"],changeDetection:0});let i=e;return i})();var un="primary",Vv=Symbol("RouteTitle"),oP=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Fh(i){return new oP(i)}function AV(i,e,t){let n=t.path.split("/");if(n.length>i.length||t.pathMatch==="full"&&(e.hasChildren()||n.length<i.length))return null;let r={};for(let o=0;o<n.length;o++){let s=n[o],a=i[o];if(s[0]===":")r[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:i.slice(0,n.length),posParams:r}}function Lne(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;++t)if(!mc(i[t],e[t]))return!1;return!0}function mc(i,e){let t=i?sP(i):void 0,n=e?sP(e):void 0;if(!t||!n||t.length!=n.length)return!1;let r;for(let o=0;o<t.length;o++)if(r=t[o],!PV(i[r],e[r]))return!1;return!0}function sP(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}function PV(i,e){if(Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;let t=[...i].sort(),n=[...e].sort();return t.every((r,o)=>n[o]===r)}else return i===e}function FV(i){return i.length>0?i[i.length-1]:null}function yl(i){return U0(i)?i:Lc(i)?qn(Promise.resolve(i)):ut(i)}var kne={exact:jV,subset:OV},NV={exact:Bne,subset:Une,ignored:()=>!0};function SV(i,e,t){return kne[t.paths](i.root,e.root,t.matrixParams)&&NV[t.queryParams](i.queryParams,e.queryParams)&&!(t.fragment==="exact"&&i.fragment!==e.fragment)}function Bne(i,e){return mc(i,e)}function jV(i,e,t){if(!Ah(i.segments,e.segments)||!DS(i.segments,e.segments,t)||i.numberOfChildren!==e.numberOfChildren)return!1;for(let n in e.children)if(!i.children[n]||!jV(i.children[n],e.children[n],t))return!1;return!0}function Une(i,e){return Object.keys(e).length<=Object.keys(i).length&&Object.keys(e).every(t=>PV(i[t],e[t]))}function OV(i,e,t){return LV(i,e,e.segments,t)}function LV(i,e,t,n){if(i.segments.length>t.length){let r=i.segments.slice(0,t.length);return!(!Ah(r,t)||e.hasChildren()||!DS(r,t,n))}else if(i.segments.length===t.length){if(!Ah(i.segments,t)||!DS(i.segments,t,n))return!1;for(let r in e.children)if(!i.children[r]||!OV(i.children[r],e.children[r],n))return!1;return!0}else{let r=t.slice(0,i.segments.length),o=t.slice(i.segments.length);return!Ah(i.segments,r)||!DS(i.segments,r,n)||!i.children[un]?!1:LV(i.children[un],e,o,n)}}function DS(i,e,t){return e.every((n,r)=>NV[t](i[r].parameters,n.parameters))}var _c=class{root;queryParams;fragment;_queryParamMap;constructor(e=new Un([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap??=Fh(this.queryParams),this._queryParamMap}toString(){return Hne.serialize(this)}},Un=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return IS(this)}},Iu=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Fh(this.parameters),this._parameterMap}toString(){return BV(this)}};function Vne(i,e){return Ah(i,e)&&i.every((t,n)=>mc(t.parameters,e[n].parameters))}function Ah(i,e){return i.length!==e.length?!1:i.every((t,n)=>t.path===e[n].path)}function zne(i,e){let t=[];return Object.entries(i.children).forEach(([n,r])=>{n===un&&(t=t.concat(e(r,n)))}),Object.entries(i.children).forEach(([n,r])=>{n!==un&&(t=t.concat(e(r,n)))}),t}var Nh=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:()=>new Au,providedIn:"root"})}return i})(),Au=class{parse(e){let t=new cP(e);return new _c(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Dv(e.root,!0)}`,n=$ne(e.queryParams),r=typeof e.fragment=="string"?`#${Gne(e.fragment)}`:"";return`${t}${n}${r}`}},Hne=new Au;function IS(i){return i.segments.map(e=>BV(e)).join("/")}function Dv(i,e){if(!i.hasChildren())return IS(i);if(e){let t=i.children[un]?Dv(i.children[un],!1):"",n=[];return Object.entries(i.children).forEach(([r,o])=>{r!==un&&n.push(`${r}:${Dv(o,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}else{let t=zne(i,(n,r)=>r===un?[Dv(i.children[un],!1)]:[`${r}:${Dv(n,!1)}`]);return Object.keys(i.children).length===1&&i.children[un]!=null?`${IS(i)}/${t[0]}`:`${IS(i)}/(${t.join("//")})`}}function kV(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function CS(i){return kV(i).replace(/%3B/gi,";")}function Gne(i){return encodeURI(i)}function aP(i){return kV(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function AS(i){return decodeURIComponent(i)}function RV(i){return AS(i.replace(/\+/g,"%20"))}function BV(i){return`${aP(i.path)}${Wne(i.parameters)}`}function Wne(i){return Object.entries(i).map(([e,t])=>`;${aP(e)}=${aP(t)}`).join("")}function $ne(i){let e=Object.entries(i).map(([t,n])=>Array.isArray(n)?n.map(r=>`${CS(t)}=${CS(r)}`).join("&"):`${CS(t)}=${CS(n)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var qne=/^[^\/()?;#]+/;function tP(i){let e=i.match(qne);return e?e[0]:""}var Xne=/^[^\/()?;=#]+/;function Zne(i){let e=i.match(Xne);return e?e[0]:""}var Yne=/^[^=?&#]+/;function Qne(i){let e=i.match(Yne);return e?e[0]:""}var Kne=/^[^&#]+/;function Jne(i){let e=i.match(Kne);return e?e[0]:""}var cP=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Un([],{}):new Un([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[un]=new Un(e,t)),n}parseSegment(){let e=tP(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Xe(4009,!1);return this.capture(e),new Iu(AS(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=Zne(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let r=tP(this.remaining);r&&(n=r,this.capture(n))}e[AS(t)]=AS(n)}parseQueryParam(e){let t=Qne(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let s=Jne(this.remaining);s&&(n=s,this.capture(n))}let r=RV(t),o=RV(n);if(e.hasOwnProperty(r)){let s=e[r];Array.isArray(s)||(s=[s],e[r]=s),s.push(o)}else e[r]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let n=tP(this.remaining),r=this.remaining[n.length];if(r!=="/"&&r!==")"&&r!==";")throw new Xe(4010,!1);let o;n.indexOf(":")>-1?(o=n.slice(0,n.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=un);let s=this.parseChildren();t[o]=Object.keys(s).length===1?s[un]:new Un([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Xe(4011,!1)}};function UV(i){return i.segments.length>0?new Un([],{[un]:i}):i}function VV(i){let e={};for(let[n,r]of Object.entries(i.children)){let o=VV(r);if(n===un&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[n]=o)}let t=new Un(i.segments,e);return eie(t)}function eie(i){if(i.numberOfChildren===1&&i.children[un]){let e=i.children[un];return new Un(i.segments.concat(e.segments),e.children)}return i}function Pu(i){return i instanceof _c}function zV(i,e,t=null,n=null){let r=HV(i);return GV(r,e,t,n)}function HV(i){let e;function t(o){let s={};for(let c of o.children){let l=t(c);s[c.outlet]=l}let a=new Un(o.url,s);return o===i&&(e=a),a}let n=t(i.root),r=UV(n);return e??r}function GV(i,e,t,n){let r=i;for(;r.parent;)r=r.parent;if(e.length===0)return nP(r,r,r,t,n);let o=tie(e);if(o.toRoot())return nP(r,r,new Un([],{}),t,n);let s=nie(o,r,i),a=s.processChildren?Av(s.segmentGroup,s.index,o.commands):$V(s.segmentGroup,s.index,o.commands);return nP(r,s.segmentGroup,a,t,n)}function PS(i){return typeof i=="object"&&i!=null&&!i.outlets&&!i.segmentPath}function Fv(i){return typeof i=="object"&&i!=null&&i.outlets}function nP(i,e,t,n,r){let o={};n&&Object.entries(n).forEach(([c,l])=>{o[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`});let s;i===e?s=t:s=WV(i,e,t);let a=UV(VV(s));return new _c(a,o,r)}function WV(i,e,t){let n={};return Object.entries(i.children).forEach(([r,o])=>{o===e?n[r]=t:n[r]=WV(o,e,t)}),new Un(i.segments,n)}var FS=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&PS(n[0]))throw new Xe(4003,!1);let r=n.find(Fv);if(r&&r!==FV(n))throw new Xe(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function tie(i){if(typeof i[0]=="string"&&i.length===1&&i[0]==="/")return new FS(!0,0,i);let e=0,t=!1,n=i.reduce((r,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...r,{outlets:a}]}if(o.segmentPath)return[...r,o.segmentPath]}return typeof o!="string"?[...r,o]:s===0?(o.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,o]},[]);return new FS(t,e,n)}var mm=class{segmentGroup;processChildren;index;constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}};function nie(i,e,t){if(i.isAbsolute)return new mm(e,!0,0);if(!t)return new mm(e,!1,NaN);if(t.parent===null)return new mm(t,!0,0);let n=PS(i.commands[0])?0:1,r=t.segments.length-1+n;return iie(t,r,i.numberOfDoubleDots)}function iie(i,e,t){let n=i,r=e,o=t;for(;o>r;){if(o-=r,n=n.parent,!n)throw new Xe(4005,!1);r=n.segments.length}return new mm(n,!1,r-o)}function rie(i){return Fv(i[0])?i[0].outlets:{[un]:i}}function $V(i,e,t){if(i??=new Un([],{}),i.segments.length===0&&i.hasChildren())return Av(i,e,t);let n=oie(i,e,t),r=t.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){let o=new Un(i.segments.slice(0,n.pathIndex),{});return o.children[un]=new Un(i.segments.slice(n.pathIndex),i.children),Av(o,0,r)}else return n.match&&r.length===0?new Un(i.segments,{}):n.match&&!i.hasChildren()?lP(i,e,t):n.match?Av(i,0,r):lP(i,e,t)}function Av(i,e,t){if(t.length===0)return new Un(i.segments,{});{let n=rie(t),r={};if(Object.keys(n).some(o=>o!==un)&&i.children[un]&&i.numberOfChildren===1&&i.children[un].segments.length===0){let o=Av(i.children[un],e,t);return new Un(i.segments,o.children)}return Object.entries(n).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(r[o]=$V(i.children[o],e,s))}),Object.entries(i.children).forEach(([o,s])=>{n[o]===void 0&&(r[o]=s)}),new Un(i.segments,r)}}function oie(i,e,t){let n=0,r=e,o={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=t.length)return o;let s=i.segments[r],a=t[n];if(Fv(a))break;let c=`${a}`,l=n<t.length-1?t[n+1]:null;if(r>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!CV(c,l,s))return o;n+=2}else{if(!CV(c,{},s))return o;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}function lP(i,e,t){let n=i.segments.slice(0,e),r=0;for(;r<t.length;){let o=t[r];if(Fv(o)){let c=sie(o.outlets);return new Un(n,c)}if(r===0&&PS(t[0])){let c=i.segments[e];n.push(new Iu(c.path,TV(t[0]))),r++;continue}let s=Fv(o)?o.outlets[un]:`${o}`,a=r<t.length-1?t[r+1]:null;s&&a&&PS(a)?(n.push(new Iu(s,TV(a))),r+=2):(n.push(new Iu(s,{})),r++)}return new Un(n,{})}function sie(i){let e={};return Object.entries(i).forEach(([t,n])=>{typeof n=="string"&&(n=[n]),n!==null&&(e[t]=lP(new Un([],{}),0,n))}),e}function TV(i){let e={};return Object.entries(i).forEach(([t,n])=>e[t]=`${n}`),e}function CV(i,e,t){return i==t.path&&mc(e,t.parameters)}var gm="imperative",wr=function(i){return i[i.NavigationStart=0]="NavigationStart",i[i.NavigationEnd=1]="NavigationEnd",i[i.NavigationCancel=2]="NavigationCancel",i[i.NavigationError=3]="NavigationError",i[i.RoutesRecognized=4]="RoutesRecognized",i[i.ResolveStart=5]="ResolveStart",i[i.ResolveEnd=6]="ResolveEnd",i[i.GuardsCheckStart=7]="GuardsCheckStart",i[i.GuardsCheckEnd=8]="GuardsCheckEnd",i[i.RouteConfigLoadStart=9]="RouteConfigLoadStart",i[i.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",i[i.ChildActivationStart=11]="ChildActivationStart",i[i.ChildActivationEnd=12]="ChildActivationEnd",i[i.ActivationStart=13]="ActivationStart",i[i.ActivationEnd=14]="ActivationEnd",i[i.Scroll=15]="Scroll",i[i.NavigationSkipped=16]="NavigationSkipped",i}(wr||{}),os=class{id;url;constructor(e,t){this.id=e,this.url=t}},Fu=class extends os{type=wr.NavigationStart;navigationTrigger;restoredState;constructor(e,t,n="imperative",r=null){super(e,t),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Fs=class extends os{urlAfterRedirects;type=wr.NavigationEnd;constructor(e,t,n){super(e,t),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},yo=function(i){return i[i.Redirect=0]="Redirect",i[i.SupersededByNewNavigation=1]="SupersededByNewNavigation",i[i.NoDataFromResolver=2]="NoDataFromResolver",i[i.GuardRejected=3]="GuardRejected",i[i.Aborted=4]="Aborted",i}(yo||{}),bm=function(i){return i[i.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",i[i.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",i}(bm||{}),gc=class extends os{reason;code;type=wr.NavigationCancel;constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},bc=class extends os{reason;code;type=wr.NavigationSkipped;constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r}},vm=class extends os{error;target;type=wr.NavigationError;constructor(e,t,n,r){super(e,t),this.error=n,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Nv=class extends os{urlAfterRedirects;state;type=wr.RoutesRecognized;constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},NS=class extends os{urlAfterRedirects;state;type=wr.GuardsCheckStart;constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},jS=class extends os{urlAfterRedirects;state;shouldActivate;type=wr.GuardsCheckEnd;constructor(e,t,n,r,o){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},OS=class extends os{urlAfterRedirects;state;type=wr.ResolveStart;constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},LS=class extends os{urlAfterRedirects;state;type=wr.ResolveEnd;constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},kS=class{route;type=wr.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},BS=class{route;type=wr.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},US=class{snapshot;type=wr.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},VS=class{snapshot;type=wr.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},zS=class{snapshot;type=wr.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},HS=class{snapshot;type=wr.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ym=class{routerEvent;position;anchor;type=wr.Scroll;constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},jv=class{},xm=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function aie(i){return!(i instanceof jv)&&!(i instanceof xm)}function cie(i,e){return i.providers&&!i._injector&&(i._injector=Mf(i.providers,e,`Route: ${i.path}`)),i._injector??e}function Ta(i){return i.outlet||un}function lie(i,e){let t=i.filter(n=>Ta(n)===e);return t.push(...i.filter(n=>Ta(n)!==e)),t}function Sm(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let e=i.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var GS=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Sm(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new jh(this.rootInjector)}},jh=(()=>{class i{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,n){let r=this.getOrCreateContext(t);r.outlet=n,this.contexts.set(t,r)}onChildOutletDestroyed(t){let n=this.getContext(t);n&&(n.outlet=null,n.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let n=this.getContext(t);return n||(n=new GS(this.rootInjector),this.contexts.set(t,n)),n}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(n){return new(n||i)(ht(Ei))};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),WS=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=uP(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){let t=uP(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=dP(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return dP(e,this._root).map(t=>t.value)}};function uP(i,e){if(i===e.value)return e;for(let t of e.children){let n=uP(i,t);if(n)return n}return null}function dP(i,e){if(i===e.value)return[e];for(let t of e.children){let n=dP(i,t);if(n.length)return n.unshift(e),n}return[]}var rs=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function pm(i){let e={};return i&&i.children.forEach(t=>e[t.value.outlet]=t),e}var Ov=class extends WS{snapshot;constructor(e,t){super(e),this.snapshot=t,vP(this,e)}toString(){return this.snapshot.toString()}};function qV(i){let e=uie(i),t=new Bi([new Iu("",{})]),n=new Bi({}),r=new Bi({}),o=new Bi({}),s=new Bi(""),a=new Ns(t,n,o,s,r,un,i,e.root);return a.snapshot=e.root,new Ov(new rs(a,[]),e)}function uie(i){let e={},t={},n={},r="",o=new Ph([],e,n,r,t,un,i,null,{});return new Lv("",new rs(o,[]))}var Ns=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,n,r,o,s,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=r,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(tt(l=>l[Vv]))??ut(void 0),this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(tt(e=>Fh(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(tt(e=>Fh(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function $S(i,e,t="emptyOnly"){let n,{routeConfig:r}=i;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?n={params:ae(ae({},e.params),i.params),data:ae(ae({},e.data),i.data),resolve:ae(ae(ae(ae({},i.data),e.data),r?.data),i._resolvedData)}:n={params:ae({},i.params),data:ae({},i.data),resolve:ae(ae({},i.data),i._resolvedData??{})},r&&ZV(r)&&(n.resolve[Vv]=r.title),n}var Ph=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Vv]}constructor(e,t,n,r,o,s,a,c,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Fh(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Fh(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(n=>n.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Lv=class extends WS{url;constructor(e,t){super(t),this.url=e,vP(this,t)}toString(){return XV(this._root)}};function vP(i,e){e.value._routerState=i,e.children.forEach(t=>vP(i,t))}function XV(i){let e=i.children.length>0?` { ${i.children.map(XV).join(", ")} } `:"";return`${i.value}${e}`}function iP(i){if(i.snapshot){let e=i.snapshot,t=i._futureSnapshot;i.snapshot=t,mc(e.queryParams,t.queryParams)||i.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&i.fragmentSubject.next(t.fragment),mc(e.params,t.params)||i.paramsSubject.next(t.params),Lne(e.url,t.url)||i.urlSubject.next(t.url),mc(e.data,t.data)||i.dataSubject.next(t.data)}else i.snapshot=i._futureSnapshot,i.dataSubject.next(i._futureSnapshot.data)}function hP(i,e){let t=mc(i.params,e.params)&&Vne(i.url,e.url),n=!i.parent!=!e.parent;return t&&!n&&(!i.parent||hP(i.parent,e.parent))}function ZV(i){return typeof i.title=="string"||i.title===null}var YV=new me(""),zv=(()=>{class i{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=un;activateEvents=new dt;deactivateEvents=new dt;attachEvents=new dt;detachEvents=new dt;routerOutletData=Cf(void 0);parentContexts=S(jh);location=S(Ur);changeDetector=S(Ni);inputBinder=S(Hv,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:n,previousValue:r}=t.name;if(n)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Xe(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Xe(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Xe(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,n){this.activated=t,this._activatedRoute=n,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,n){if(this.isActivated)throw new Xe(4013,!1);this._activatedRoute=t;let r=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new fP(t,a,r.injector,this.routerOutletData);this.activated=r.createComponent(s,{index:r.length,injector:c,environmentInjector:n}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[$i]})}return i})(),fP=class{route;childContexts;parent;outletData;constructor(e,t,n,r){this.route=e,this.childContexts=t,this.parent=n,this.outletData=r}get(e,t){return e===Ns?this.route:e===jh?this.childContexts:e===YV?this.outletData:this.parent.get(e,t)}},Hv=new me(""),yP=(()=>{class i{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:n}=t,r=Qu([n.queryParams,n.params,n.data]).pipe(Ui(([o,s,a],c)=>(a=ae(ae(ae({},o),s),a),c===0?ut(a):Promise.resolve(a)))).subscribe(o=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==n||n.component===null){this.unsubscribeFromRouteData(t);return}let s=xk(n.component);if(!s){this.unsubscribeFromRouteData(t);return}for(let{templateName:a}of s.inputs)t.activatedComponentRef.setInput(a,o[a])});this.outletDataSubscriptions.set(t,r)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac})}return i})(),xP=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275cmp=O({type:i,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(n,r){n&1&&ne(0,"router-outlet")},dependencies:[zv],encapsulation:2})}return i})();function wP(i){let e=i.children&&i.children.map(wP),t=e?jt(ae({},i),{children:e}):ae({},i);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==un&&(t.component=xP),t}function die(i,e,t){let n=kv(i,e._root,t?t._root:void 0);return new Ov(n,e)}function kv(i,e,t){if(t&&i.shouldReuseRoute(e.value,t.value.snapshot)){let n=t.value;n._futureSnapshot=e.value;let r=hie(i,e,t);return new rs(n,r)}else{if(i.shouldAttach(e.value)){let o=i.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>kv(i,a)),s}}let n=fie(e.value),r=e.children.map(o=>kv(i,o));return new rs(n,r)}}function hie(i,e,t){return e.children.map(n=>{for(let r of t.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return kv(i,n,r);return kv(i,n)})}function fie(i){return new Ns(new Bi(i.url),new Bi(i.params),new Bi(i.queryParams),new Bi(i.fragment),new Bi(i.data),i.outlet,i.component,i)}var wm=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},QV="ngNavigationCancelingError";function qS(i,e){let{redirectTo:t,navigationBehaviorOptions:n}=Pu(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=KV(!1,yo.Redirect);return r.url=t,r.navigationBehaviorOptions=n,r}function KV(i,e){let t=new Error(`NavigationCancelingError: ${i||""}`);return t[QV]=!0,t.cancellationCode=e,t}function pie(i){return JV(i)&&Pu(i.url)}function JV(i){return!!i&&i[QV]}var mie=(i,e,t,n)=>tt(r=>(new pP(e,r.targetRouterState,r.currentRouterState,t,n).activate(i),r)),pP=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,n,r,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),iP(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){let r=pm(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,r[s],n),delete r[s]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,n)})}deactivateRoutes(e,t,n){let r=e.value,o=t?t.value:null;if(r===o)if(r.component){let s=n.getContext(r.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,n);else o&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,o=pm(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);if(n&&n.outlet){let s=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,o=pm(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,t,n){let r=pm(t);e.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],n),this.forwardEvent(new HS(o.value.snapshot))}),e.children.length&&this.forwardEvent(new VS(e.value.snapshot))}activateRoutes(e,t,n){let r=e.value,o=t?t.value:null;if(iP(r),r===o)if(r.component){let s=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,n);else if(r.component){let s=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),iP(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=r,s.outlet&&s.outlet.activateWith(r,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,n)}},XS=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},_m=class{component;route;constructor(e,t){this.component=e,this.route=t}};function gie(i,e,t){let n=i._root,r=e?e._root:null;return Iv(n,r,t,[n.value])}function _ie(i){let e=i.routeConfig?i.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:i,guards:e}}function Rm(i,e){let t=Symbol(),n=e.get(i,t);return n===t?typeof i=="function"&&!mT(i)?i:e.get(i):n}function Iv(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=pm(e);return i.children.forEach(s=>{bie(s,o[s.value.outlet],t,n.concat([s.value]),r),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>Pv(a,t.getContext(s),r)),r}function bie(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=i.value,s=e?e.value:null,a=t?t.getContext(i.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let c=vie(s,o,o.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new XS(n)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?Iv(i,e,a?a.children:null,n,r):Iv(i,e,t,n,r),c&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new _m(a.outlet.component,s))}else s&&Pv(e,a,r),r.canActivateChecks.push(new XS(n)),o.component?Iv(i,null,a?a.children:null,n,r):Iv(i,null,t,n,r);return r}function vie(i,e,t){if(typeof t=="function")return t(i,e);switch(t){case"pathParamsChange":return!Ah(i.url,e.url);case"pathParamsOrQueryParamsChange":return!Ah(i.url,e.url)||!mc(i.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!hP(i,e)||!mc(i.queryParams,e.queryParams);case"paramsChange":default:return!hP(i,e)}}function Pv(i,e,t){let n=pm(i),r=i.value;Object.entries(n).forEach(([o,s])=>{r.component?e?Pv(s,e.children.getContext(o),t):Pv(s,null,t):Pv(s,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new _m(e.outlet.component,r)):t.canDeactivateChecks.push(new _m(null,r)):t.canDeactivateChecks.push(new _m(null,r))}function Gv(i){return typeof i=="function"}function yie(i){return typeof i=="boolean"}function xie(i){return i&&Gv(i.canLoad)}function wie(i){return i&&Gv(i.canActivate)}function Mie(i){return i&&Gv(i.canActivateChild)}function Sie(i){return i&&Gv(i.canDeactivate)}function Rie(i){return i&&Gv(i.canMatch)}function ez(i){return i instanceof Bs||i?.name==="EmptyError"}var ES=Symbol("INITIAL_VALUE");function Mm(){return Ui(i=>Qu(i.map(e=>e.pipe(no(1),Uo(ES)))).pipe(tt(e=>{for(let t of e)if(t!==!0){if(t===ES)return ES;if(t===!1||Tie(t))return t}return!0}),vn(e=>e!==ES),no(1)))}function Tie(i){return Pu(i)||i instanceof wm}function Cie(i,e){return Pi(t=>{let{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?ut(jt(ae({},t),{guardsResult:!0})):Eie(s,n,r,i).pipe(Pi(a=>a&&yie(a)?Die(n,o,i,e):ut(a)),tt(a=>jt(ae({},t),{guardsResult:a})))})}function Eie(i,e,t,n){return qn(i).pipe(Pi(r=>Nie(r.component,r.route,t,e,n)),Cc(r=>r!==!0,!0))}function Die(i,e,t,n){return qn(e).pipe(Na(r=>Cl(Aie(r.route.parent,n),Iie(r.route,n),Fie(i,r.path,t),Pie(i,r.route,t))),Cc(r=>r!==!0,!0))}function Iie(i,e){return i!==null&&e&&e(new zS(i)),ut(!0)}function Aie(i,e){return i!==null&&e&&e(new US(i)),ut(!0)}function Pie(i,e,t){let n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||n.length===0)return ut(!0);let r=n.map(o=>Ym(()=>{let s=Sm(e)??t,a=Rm(o,s),c=wie(a)?a.canActivate(e,i):Sr(s,()=>a(e,i));return yl(c).pipe(Cc())}));return ut(r).pipe(Mm())}function Fie(i,e,t){let n=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>_ie(s)).filter(s=>s!==null).map(s=>Ym(()=>{let a=s.guards.map(c=>{let l=Sm(s.node)??t,u=Rm(c,l),d=Mie(u)?u.canActivateChild(n,i):Sr(l,()=>u(n,i));return yl(d).pipe(Cc())});return ut(a).pipe(Mm())}));return ut(o).pipe(Mm())}function Nie(i,e,t,n,r){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return ut(!0);let s=o.map(a=>{let c=Sm(e)??r,l=Rm(a,c),u=Sie(l)?l.canDeactivate(i,e,t,n):Sr(c,()=>l(i,e,t,n));return yl(u).pipe(Cc())});return ut(s).pipe(Mm())}function jie(i,e,t,n){let r=e.canLoad;if(r===void 0||r.length===0)return ut(!0);let o=r.map(s=>{let a=Rm(s,i),c=xie(a)?a.canLoad(e,t):Sr(i,()=>a(e,t));return yl(c)});return ut(o).pipe(Mm(),tz(n))}function tz(i){return XR(Kn(e=>{if(typeof e!="boolean")throw qS(i,e)}),tt(e=>e===!0))}function Oie(i,e,t,n){let r=e.canMatch;if(!r||r.length===0)return ut(!0);let o=r.map(s=>{let a=Rm(s,i),c=Rie(a)?a.canMatch(e,t):Sr(i,()=>a(e,t));return yl(c)});return ut(o).pipe(Mm(),tz(n))}var Bv=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},Uv=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function fm(i){return So(new Bv(i))}function Lie(i){return So(new Xe(4e3,!1))}function kie(i){return So(KV(!1,yo.GuardRejected))}var mP=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),r.numberOfChildren===0)return ut(n);if(r.numberOfChildren>1||!r.children[un])return Lie(`${e.redirectTo}`);r=r.children[un]}}applyRedirectCommands(e,t,n,r,o){return Bie(t,r,o).pipe(tt(s=>{if(s instanceof _c)throw new Uv(s);let a=this.applyRedirectCreateUrlTree(s,this.urlSerializer.parse(s),e,n);if(s[0]==="/")throw new Uv(a);return a}))}applyRedirectCreateUrlTree(e,t,n,r){let o=this.createSegmentGroup(e,t.root,n,r);return new _c(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let n={};return Object.entries(e).forEach(([r,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);n[r]=t[a]}else n[r]=o}),n}createSegmentGroup(e,t,n,r){let o=this.createSegments(e,t.segments,n,r),s={};return Object.entries(t.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(e,c,n,r)}),new Un(o,s)}createSegments(e,t,n,r){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,r):this.findOrReturn(o,n))}findPosParam(e,t,n){let r=n[t.path.substring(1)];if(!r)throw new Xe(4001,!1);return r}findOrReturn(e,t){let n=0;for(let r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}};function Bie(i,e,t){if(typeof i=="string")return ut(i);let n=i,{queryParams:r,fragment:o,routeConfig:s,url:a,outlet:c,params:l,data:u,title:d}=e;return yl(Sr(t,()=>n({params:l,data:u,queryParams:r,fragment:o,routeConfig:s,url:a,outlet:c,title:d})))}var gP={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Uie(i,e,t,n,r){let o=nz(i,e,t);return o.matched?(n=cie(e,n),Oie(n,e,t,r).pipe(tt(s=>s===!0?o:ae({},gP)))):ut(o)}function nz(i,e,t){if(e.path==="**")return Vie(t);if(e.path==="")return e.pathMatch==="full"&&(i.hasChildren()||t.length>0)?ae({},gP):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||AV)(t,i,e);if(!r)return ae({},gP);let o={};Object.entries(r.posParams??{}).forEach(([a,c])=>{o[a]=c.path});let s=r.consumed.length>0?ae(ae({},o),r.consumed[r.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:s,positionalParamSegments:r.posParams??{}}}function Vie(i){return{matched:!0,parameters:i.length>0?FV(i).parameters:{},consumedSegments:i,remainingSegments:[],positionalParamSegments:{}}}function EV(i,e,t,n){return t.length>0&&Gie(i,t,n)?{segmentGroup:new Un(e,Hie(n,new Un(t,i.children))),slicedSegments:[]}:t.length===0&&Wie(i,t,n)?{segmentGroup:new Un(i.segments,zie(i,t,n,i.children)),slicedSegments:t}:{segmentGroup:new Un(i.segments,i.children),slicedSegments:t}}function zie(i,e,t,n){let r={};for(let o of t)if(YS(i,e,o)&&!n[Ta(o)]){let s=new Un([],{});r[Ta(o)]=s}return ae(ae({},n),r)}function Hie(i,e){let t={};t[un]=e;for(let n of i)if(n.path===""&&Ta(n)!==un){let r=new Un([],{});t[Ta(n)]=r}return t}function Gie(i,e,t){return t.some(n=>YS(i,e,n)&&Ta(n)!==un)}function Wie(i,e,t){return t.some(n=>YS(i,e,n))}function YS(i,e,t){return(i.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function $ie(i,e,t){return e.length===0&&!i.children[t]}var _P=class{};function qie(i,e,t,n,r,o,s="emptyOnly"){return new bP(i,e,t,n,r,s,o).recognize()}var Xie=31,bP=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,n,r,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=n,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new mP(this.urlSerializer,this.urlTree)}noMatchError(e){return new Xe(4002,`'${e.segmentGroup}'`)}recognize(){let e=EV(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(tt(({children:t,rootSnapshot:n})=>{let r=new rs(n,t),o=new Lv("",r),s=zV(n,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new Ph([],Object.freeze({}),Object.freeze(ae({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),un,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,un,t).pipe(tt(n=>({children:n,rootSnapshot:t})),Br(n=>{if(n instanceof Uv)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof Bv?this.noMatchError(n):n}))}processSegmentGroup(e,t,n,r,o){return n.segments.length===0&&n.hasChildren()?this.processChildren(e,t,n,o):this.processSegment(e,t,n,n.segments,r,!0,o).pipe(tt(s=>s instanceof rs?[s]:[]))}processChildren(e,t,n,r){let o=[];for(let s of Object.keys(n.children))s==="primary"?o.unshift(s):o.push(s);return qn(o).pipe(Na(s=>{let a=n.children[s],c=lie(t,s);return this.processSegmentGroup(e,c,a,s,r)}),tT((s,a)=>(s.push(...a),s)),El(null),eT(),Pi(s=>{if(s===null)return fm(n);let a=iz(s);return Zie(a),ut(a)}))}processSegment(e,t,n,r,o,s,a){return qn(t).pipe(Na(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,n,r,o,s,a).pipe(Br(l=>{if(l instanceof Bv)return ut(null);throw l}))),Cc(c=>!!c),Br(c=>{if(ez(c))return $ie(n,r,o)?ut(new _P):fm(n);throw c}))}processSegmentAgainstRoute(e,t,n,r,o,s,a,c){return Ta(n)!==s&&(s===un||!YS(r,o,n))?fm(r):n.redirectTo===void 0?this.matchSegmentAgainstRoute(e,r,n,o,s,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,n,o,s,c):fm(r)}expandSegmentAgainstRouteUsingRedirect(e,t,n,r,o,s,a){let{matched:c,parameters:l,consumedSegments:u,positionalParamSegments:d,remainingSegments:h}=nz(t,r,o);if(!c)return fm(t);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Xie&&(this.allowRedirects=!1));let f=new Ph(o,l,Object.freeze(ae({},this.urlTree.queryParams)),this.urlTree.fragment,DV(r),Ta(r),r.component??r._loadedComponent??null,r,IV(r)),g=$S(f,a,this.paramsInheritanceStrategy);return f.params=Object.freeze(g.params),f.data=Object.freeze(g.data),this.applyRedirects.applyRedirectCommands(u,r.redirectTo,d,f,e).pipe(Ui(m=>this.applyRedirects.lineralizeSegments(r,m)),Pi(m=>this.processSegment(e,n,t,m.concat(h),s,!1,a)))}matchSegmentAgainstRoute(e,t,n,r,o,s){let a=Uie(t,n,r,e,this.urlSerializer);return n.path==="**"&&(t.children={}),a.pipe(Ui(c=>c.matched?(e=n._injector??e,this.getChildConfig(e,n,r).pipe(Ui(({routes:l})=>{let u=n._loadedInjector??e,{parameters:d,consumedSegments:h,remainingSegments:f}=c,g=new Ph(h,d,Object.freeze(ae({},this.urlTree.queryParams)),this.urlTree.fragment,DV(n),Ta(n),n.component??n._loadedComponent??null,n,IV(n)),_=$S(g,s,this.paramsInheritanceStrategy);g.params=Object.freeze(_.params),g.data=Object.freeze(_.data);let{segmentGroup:m,slicedSegments:p}=EV(t,h,f,l);if(p.length===0&&m.hasChildren())return this.processChildren(u,l,m,g).pipe(tt(v=>new rs(g,v)));if(l.length===0&&p.length===0)return ut(new rs(g,[]));let b=Ta(n)===o;return this.processSegment(u,l,m,p,b?un:o,!0,g).pipe(tt(v=>new rs(g,v instanceof rs?[v]:[])))}))):fm(t)))}getChildConfig(e,t,n){return t.children?ut({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?ut({routes:t._loadedRoutes,injector:t._loadedInjector}):jie(e,t,n,this.urlSerializer).pipe(Pi(r=>r?this.configLoader.loadChildren(e,t).pipe(Kn(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):kie(t))):ut({routes:[],injector:e})}};function Zie(i){i.sort((e,t)=>e.value.outlet===un?-1:t.value.outlet===un?1:e.value.outlet.localeCompare(t.value.outlet))}function Yie(i){let e=i.value.routeConfig;return e&&e.path===""}function iz(i){let e=[],t=new Set;for(let n of i){if(!Yie(n)){e.push(n);continue}let r=e.find(o=>n.value.routeConfig===o.value.routeConfig);r!==void 0?(r.children.push(...n.children),t.add(r)):e.push(n)}for(let n of t){let r=iz(n.children);e.push(new rs(n.value,r))}return e.filter(n=>!t.has(n))}function DV(i){return i.data||{}}function IV(i){return i.resolve||{}}function Qie(i,e,t,n,r,o){return Pi(s=>qie(i,e,t,n,s.extractedUrl,r,o).pipe(tt(({state:a,tree:c})=>jt(ae({},s),{targetSnapshot:a,urlAfterRedirects:c}))))}function Kie(i,e){return Pi(t=>{let{targetSnapshot:n,guards:{canActivateChecks:r}}=t;if(!r.length)return ut(t);let o=new Set(r.map(c=>c.route)),s=new Set;for(let c of o)if(!s.has(c))for(let l of rz(c))s.add(l);let a=0;return qn(s).pipe(Na(c=>o.has(c)?Jie(c,n,i,e):(c.data=$S(c,c.parent,i).resolve,ut(void 0))),Kn(()=>a++),Jh(1),Pi(c=>a===s.size?ut(t):Ti))})}function rz(i){let e=i.children.map(t=>rz(t)).flat();return[i,...e]}function Jie(i,e,t,n){let r=i.routeConfig,o=i._resolve;return r?.title!==void 0&&!ZV(r)&&(o[Vv]=r.title),Ym(()=>(i.data=$S(i,i.parent,t).resolve,ere(o,i,e,n).pipe(tt(s=>(i._resolvedData=s,i.data=ae(ae({},i.data),s),null)))))}function ere(i,e,t,n){let r=sP(i);if(r.length===0)return ut({});let o={};return qn(r).pipe(Pi(s=>tre(i[s],e,t,n).pipe(Cc(),Kn(a=>{if(a instanceof wm)throw qS(new Au,a);o[s]=a}))),Jh(1),tt(()=>o),Br(s=>ez(s)?Ti:So(s)))}function tre(i,e,t,n){let r=Sm(e)??n,o=Rm(i,r),s=o.resolve?o.resolve(e,t):Sr(r,()=>o(e,t));return yl(s)}function rP(i){return Ui(e=>{let t=i(e);return t?qn(t).pipe(tt(()=>e)):ut(e)})}var MP=(()=>{class i{buildTitle(t){let n,r=t.root;for(;r!==void 0;)n=this.getResolvedTitleForRoute(r)??n,r=r.children.find(o=>o.outlet===un);return n}getResolvedTitleForRoute(t){return t.data[Vv]}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:()=>S(oz),providedIn:"root"})}return i})(),oz=(()=>{class i extends MP{title;constructor(t){super(),this.title=t}updateTitle(t){let n=this.buildTitle(t);n!==void 0&&this.title.setTitle(n)}static \u0275fac=function(n){return new(n||i)(ht(Jk))};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),Nu=new me("",{providedIn:"root",factory:()=>({})}),Oh=new me(""),QS=(()=>{class i{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=S(GE);loadComponent(t,n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return ut(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);let r=yl(Sr(t,()=>n.loadComponent())).pipe(tt(az),Kn(s=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=s}),ja(()=>{this.componentLoaders.delete(n)})),o=new Zh(r,()=>new lt).pipe(Xh());return this.componentLoaders.set(n,o),o}loadChildren(t,n){if(this.childrenLoaders.get(n))return this.childrenLoaders.get(n);if(n._loadedRoutes)return ut({routes:n._loadedRoutes,injector:n._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(n);let o=sz(n,this.compiler,t,this.onLoadEndListener).pipe(ja(()=>{this.childrenLoaders.delete(n)})),s=new Zh(o,()=>new lt).pipe(Xh());return this.childrenLoaders.set(n,s),s}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function sz(i,e,t,n){return yl(Sr(t,()=>i.loadChildren())).pipe(tt(az),Pi(r=>r instanceof Yy||Array.isArray(r)?ut(r):qn(e.compileModuleAsync(r))),tt(r=>{n&&n(i);let o,s,a=!1;return Array.isArray(r)?(s=r,a=!0):(o=r.create(t).injector,s=o.get(Oh,[],{optional:!0,self:!0}).flat()),{routes:s.map(wP),injector:o}}))}function nre(i){return i&&typeof i=="object"&&"default"in i}function az(i){return nre(i)?i.default:i}var KS=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:()=>S(ire),providedIn:"root"})}return i})(),ire=(()=>{class i{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,n){return t}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),SP=new me(""),RP=new me("");function cz(i,e,t){let n=i.get(RP),r=i.get(kt);if(!r.startViewTransition||n.skipNextTransition)return n.skipNextTransition=!1,new Promise(l=>setTimeout(l));let o,s=new Promise(l=>{o=l}),a=r.startViewTransition(()=>(o(),rre(i))),{onViewTransitionCreated:c}=n;return c&&Sr(i,()=>c({transition:a,from:e,to:t})),s}function rre(i){return new Promise(e=>{co({read:()=>setTimeout(e)},{injector:i})})}var TP=new me(""),JS=(()=>{class i{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new lt;transitionAbortWithErrorSubject=new lt;configLoader=S(QS);environmentInjector=S(Ei);destroyRef=S(Nr);urlSerializer=S(Nh);rootContexts=S(jh);location=S(Hl);inputBindingEnabled=S(Hv,{optional:!0})!==null;titleStrategy=S(MP);options=S(Nu,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=S(KS);createViewTransition=S(SP,{optional:!0});navigationErrorHandler=S(TP,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>ut(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=r=>this.events.next(new kS(r)),n=r=>this.events.next(new BS(r));this.configLoader.onLoadEndListener=n,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let n=++this.navigationId;this.transitions?.next(jt(ae({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,abortController:new AbortController,id:n}))}setupNavigations(t){return this.transitions=new Bi(null),this.transitions.pipe(vn(n=>n!==null),Ui(n=>{let r=!1;return ut(n).pipe(Ui(o=>{if(this.navigationId>n.id)return this.cancelNavigationTransition(n,"",yo.SupersededByNewNavigation),Ti;this.currentTransition=n,this.currentNavigation={id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?jt(ae({},this.lastSuccessfulNavigation),{previousNavigation:null}):null,abort:()=>o.abortController.abort()};let s=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),a=o.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!s&&a!=="reload"){let c="";return this.events.next(new bc(o.id,this.urlSerializer.serialize(o.rawUrl),c,bm.IgnoredSameUrlNavigation)),o.resolve(!1),Ti}if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return ut(o).pipe(Ui(c=>(this.events.next(new Fu(c.id,this.urlSerializer.serialize(c.extractedUrl),c.source,c.restoredState)),c.id!==this.navigationId?Ti:Promise.resolve(c))),Qie(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),Kn(c=>{n.targetSnapshot=c.targetSnapshot,n.urlAfterRedirects=c.urlAfterRedirects,this.currentNavigation=jt(ae({},this.currentNavigation),{finalUrl:c.urlAfterRedirects});let l=new Nv(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}));if(s&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:c,extractedUrl:l,source:u,restoredState:d,extras:h}=o,f=new Fu(c,this.urlSerializer.serialize(l),u,d);this.events.next(f);let g=qV(this.rootComponentType).snapshot;return this.currentTransition=n=jt(ae({},o),{targetSnapshot:g,urlAfterRedirects:l,extras:jt(ae({},h),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=l,ut(n)}else{let c="";return this.events.next(new bc(o.id,this.urlSerializer.serialize(o.extractedUrl),c,bm.IgnoredByUrlHandlingStrategy)),o.resolve(!1),Ti}}),Kn(o=>{let s=new NS(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(s)}),tt(o=>(this.currentTransition=n=jt(ae({},o),{guards:gie(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),n)),Cie(this.environmentInjector,o=>this.events.next(o)),Kn(o=>{if(n.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw qS(this.urlSerializer,o.guardsResult);let s=new jS(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(s)}),vn(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",yo.GuardRejected),!1)),rP(o=>{if(o.guards.canActivateChecks.length!==0)return ut(o).pipe(Kn(s=>{let a=new OS(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(a)}),Ui(s=>{let a=!1;return ut(s).pipe(Kie(this.paramsInheritanceStrategy,this.environmentInjector),Kn({next:()=>a=!0,complete:()=>{a||this.cancelNavigationTransition(s,"",yo.NoDataFromResolver)}}))}),Kn(s=>{let a=new LS(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(a)}))}),rP(o=>{let s=a=>{let c=[];if(a.routeConfig?.loadComponent&&!a.routeConfig._loadedComponent){let l=Sm(a)??this.environmentInjector;c.push(this.configLoader.loadComponent(l,a.routeConfig).pipe(Kn(u=>{a.component=u}),tt(()=>{})))}for(let l of a.children)c.push(...s(l));return c};return Qu(s(o.targetSnapshot.root)).pipe(El(null),no(1))}),rP(()=>this.afterPreactivation()),Ui(()=>{let{currentSnapshot:o,targetSnapshot:s}=n,a=this.createViewTransition?.(this.environmentInjector,o.root,s.root);return a?qn(a).pipe(tt(()=>n)):ut(n)}),tt(o=>{let s=die(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=n=jt(ae({},o),{targetRouterState:s}),this.currentNavigation.targetRouterState=s,n}),Kn(()=>{this.events.next(new jv)}),mie(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),no(1),Pn(new It(o=>{let s=n.abortController.signal,a=()=>o.next();return s.addEventListener("abort",a),()=>s.removeEventListener("abort",a)}).pipe(vn(()=>!r&&!n.targetRouterState),Kn(()=>{this.cancelNavigationTransition(n,n.abortController.signal.reason+"",yo.Aborted)}))),Kn({next:o=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Fs(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{r=!0}}),Pn(this.transitionAbortWithErrorSubject.pipe(Kn(o=>{throw o}))),ja(()=>{r||this.cancelNavigationTransition(n,"",yo.SupersededByNewNavigation),this.currentTransition?.id===n.id&&(this.currentNavigation=null,this.currentTransition=null)}),Br(o=>{if(this.destroyed)return n.resolve(!1),Ti;if(r=!0,JV(o))this.events.next(new gc(n.id,this.urlSerializer.serialize(n.extractedUrl),o.message,o.cancellationCode)),pie(o)?this.events.next(new xm(o.url,o.navigationBehaviorOptions)):n.resolve(!1);else{let s=new vm(n.id,this.urlSerializer.serialize(n.extractedUrl),o,n.targetSnapshot??void 0);try{let a=Sr(this.environmentInjector,()=>this.navigationErrorHandler?.(s));if(a instanceof wm){let{message:c,cancellationCode:l}=qS(this.urlSerializer,a);this.events.next(new gc(n.id,this.urlSerializer.serialize(n.extractedUrl),c,l)),this.events.next(new xm(a.redirectTo,a.navigationBehaviorOptions))}else throw this.events.next(s),o}catch(a){this.options.resolveNavigationPromiseOnError?n.resolve(!1):n.reject(a)}}return Ti}))}))}cancelNavigationTransition(t,n,r){let o=new gc(t.id,this.urlSerializer.serialize(t.extractedUrl),n,r);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),n=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==n?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function ore(i){return i!==gm}var lz=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:()=>S(sre),providedIn:"root"})}return i})(),ZS=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},sre=(()=>{class i extends ZS{static \u0275fac=(()=>{let t;return function(r){return(t||(t=q(i)))(r||i)}})();static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),uz=(()=>{class i{urlSerializer=S(Nh);options=S(Nu,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=S(Hl);urlHandlingStrategy=S(KS);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new _c;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:n,targetBrowserUrl:r}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,n):n,s=r??o;return s instanceof _c?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:t,finalUrl:n,initialUrl:r}){n&&t?(this.currentUrlTree=n,this.rawUrlTree=this.urlHandlingStrategy.merge(n,r),this.routerState=t):this.rawUrlTree=r}routerState=qV(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:()=>S(are),providedIn:"root"})}return i})(),are=(()=>{class i extends uz{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(n=>{n.type==="popstate"&&setTimeout(()=>{t(n.url,n.state,"popstate")})})}handleRouterEvent(t,n){t instanceof Fu?this.updateStateMemento():t instanceof bc?this.commitTransition(n):t instanceof Nv?this.urlUpdateStrategy==="eager"&&(n.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(n),n)):t instanceof jv?(this.commitTransition(n),this.urlUpdateStrategy==="deferred"&&!n.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(n),n)):t instanceof gc&&t.code!==yo.SupersededByNewNavigation&&t.code!==yo.Redirect?this.restoreHistory(n):t instanceof vm?this.restoreHistory(n,!0):t instanceof Fs&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:n,id:r}){let{replaceUrl:o,state:s}=n;if(this.location.isCurrentPathEqualTo(t)||o){let a=this.browserPageId,c=ae(ae({},s),this.generateNgRouterState(r,a));this.location.replaceState(t,"",c)}else{let a=ae(ae({},s),this.generateNgRouterState(r,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,n=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,o=this.currentPageId-r;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(n&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,n){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:n}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=q(i)))(r||i)}})();static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function eR(i,e){i.events.pipe(vn(t=>t instanceof Fs||t instanceof gc||t instanceof vm||t instanceof bc),tt(t=>t instanceof Fs||t instanceof bc?0:(t instanceof gc?t.code===yo.Redirect||t.code===yo.SupersededByNewNavigation:!1)?2:1),vn(t=>t!==2),no(1)).subscribe(()=>{e()})}var cre={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},lre={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},vc=(()=>{class i{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=S(ex);stateManager=S(uz);options=S(Nu,{optional:!0})||{};pendingTasks=S(Pc);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=S(JS);urlSerializer=S(Nh);location=S(Hl);urlHandlingStrategy=S(KS);injector=S(Ei);_events=new lt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=S(lz);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=S(Oh,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!S(Hv,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Rn;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(n=>{try{let r=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(r!==null&&o!==null){if(this.stateManager.handleRouterEvent(n,o),n instanceof gc&&n.code!==yo.Redirect&&n.code!==yo.SupersededByNewNavigation)this.navigated=!0;else if(n instanceof Fs)this.navigated=!0;else if(n instanceof xm){let s=n.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(n.url,r.currentRawUrl),c=ae({browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||ore(r.source)},s);this.scheduleNavigation(a,gm,null,c,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}aie(n)&&this._events.next(n)}catch(r){this.navigationTransitions.transitionAbortWithErrorSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),gm,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,n,r)=>{this.navigateToSyncWithBrowser(t,r,n)})}navigateToSyncWithBrowser(t,n,r){let o={replaceUrl:!0},s=r?.navigationId?r:null;if(r){let c=ae({},r);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,n,s,o).catch(c=>{this.disposed||this.injector.get(ao)(c)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(wP),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,n={}){let{relativeTo:r,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:c}=n,l=c?this.currentUrlTree.fragment:s,u=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":u=ae(ae({},this.currentUrlTree.queryParams),o);break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=o||null}u!==null&&(u=this.removeEmptyProps(u));let d;try{let h=r?r.snapshot:this.routerState.snapshot.root;d=HV(h)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),d=this.currentUrlTree.root}return GV(d,t,u,l??null)}navigateByUrl(t,n={skipLocationChange:!1}){let r=Pu(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,gm,null,n)}navigate(t,n={skipLocationChange:!1}){return ure(t),this.navigateByUrl(this.createUrlTree(t,n),n)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,n){let r;if(n===!0?r=ae({},cre):n===!1?r=ae({},lre):r=n,Pu(t))return SV(this.currentUrlTree,t,r);let o=this.parseUrl(t);return SV(this.currentUrlTree,o,r)}removeEmptyProps(t){return Object.entries(t).reduce((n,[r,o])=>(o!=null&&(n[r]=o),n),{})}scheduleNavigation(t,n,r,o,s){if(this.disposed)return Promise.resolve(!1);let a,c,l;s?(a=s.resolve,c=s.reject,l=s.promise):l=new Promise((d,h)=>{a=d,c=h});let u=this.pendingTasks.add();return eR(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:n,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(d=>Promise.reject(d))}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function ure(i){for(let e=0;e<i.length;e++)if(i[e]==null)throw new Xe(4008,!1)}var tR=(()=>{class i{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=Vn(null);get href(){return Fi(this.reactiveHref)}set href(t){this.reactiveHref.set(t)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new lt;applicationErrorHandler=S(ao);options=S(Nu,{optional:!0});constructor(t,n,r,o,s,a){this.router=t,this.route=n,this.tabIndexAttribute=r,this.renderer=o,this.el=s,this.locationStrategy=a,this.reactiveHref.set(S(new Dd("href"),{optional:!0}));let c=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area"||!!(typeof customElements=="object"&&customElements.get(c)?.observedAttributes?.includes?.("href")),this.isAnchorElement?this.setTabIndexIfNotOnNativeEl("0"):this.subscribeToNavigationEventsIfNecessary()}subscribeToNavigationEventsIfNecessary(){if(this.subscription!==void 0||!this.isAnchorElement)return;let t=this.preserveFragment,n=r=>r==="merge"||r==="preserve";t||=n(this.queryParamsHandling),t||=!this.queryParamsHandling&&!n(this.options?.defaultQueryParamsHandling),t&&(this.subscription=this.router.events.subscribe(r=>{r instanceof Fs&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&(this.updateHref(),this.subscribeToNavigationEventsIfNecessary()),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(Pu(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,n,r,o,s){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||n||r||o||s||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,c)?.catch(l=>{this.applicationErrorHandler(l)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.reactiveHref.set(t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t))??"":null)}applyAttributeValue(t,n){let r=this.renderer,o=this.el.nativeElement;n!==null?r.setAttribute(o,t,n):r.removeAttribute(o,t)}get urlTree(){return this.routerLinkInput===null?null:Pu(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(n){return new(n||i)(Dn(vc),Dn(Ns),Dg("tabindex"),Dn(Yi),Dn(vt),Dn(Qs))};static \u0275dir=Ge({type:i,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(n,r){n&1&&Ie("click",function(s){return r.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),n&2&&oi("href",r.reactiveHref(),uE)("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",On],skipLocationChange:[2,"skipLocationChange","skipLocationChange",On],replaceUrl:[2,"replaceUrl","replaceUrl",On],routerLink:"routerLink"},features:[$i]})}return i})();var Wv=class{};var dz=(()=>{class i{router;injector;preloadingStrategy;loader;subscription;constructor(t,n,r,o){this.router=t,this.injector=n,this.preloadingStrategy=r,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(vn(t=>t instanceof Fs),Na(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,n){let r=[];for(let o of n){o.providers&&!o._injector&&(o._injector=Mf(o.providers,t,`Route: ${o.path}`));let s=o._injector??t,a=o._loadedInjector??s;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&r.push(this.preloadConfig(s,o)),(o.children||o._loadedRoutes)&&r.push(this.processRoutes(a,o.children??o._loadedRoutes))}return qn(r).pipe(Tl())}preloadConfig(t,n){return this.preloadingStrategy.preload(n,()=>{let r;n.loadChildren&&n.canLoad===void 0?r=this.loader.loadChildren(t,n):r=ut(null);let o=r.pipe(Pi(s=>s===null?ut(void 0):(n._loadedRoutes=s.routes,n._loadedInjector=s.injector,this.processRoutes(s.injector??t,s.routes))));if(n.loadComponent&&!n._loadedComponent){let s=this.loader.loadComponent(t,n);return qn([o,s]).pipe(Tl())}else return o})}static \u0275fac=function(n){return new(n||i)(ht(vc),ht(Ei),ht(Wv),ht(QS))};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),hz=new me(""),dre=(()=>{class i{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource=gm;restoredId=0;store={};constructor(t,n,r,o,s={}){this.urlSerializer=t,this.transitions=n,this.viewportScroller=r,this.zone=o,this.options=s,s.scrollPositionRestoration||="disabled",s.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Fu?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Fs?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof bc&&t.code===bm.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof ym&&(t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,n){this.zone.runOutsideAngular(()=>Wt(this,null,function*(){yield new Promise(r=>{setTimeout(r),typeof requestAnimationFrame<"u"&&requestAnimationFrame(r)}),this.zone.run(()=>{this.transitions.events.next(new ym(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,n))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(n){TE()};static \u0275prov=ge({token:i,factory:i.\u0275fac})}return i})();function EP(i,...e){return Vs([{provide:Oh,multi:!0,useValue:i},[],{provide:Ns,useFactory:fz,deps:[vc]},{provide:kg,multi:!0,useFactory:pz},e.map(t=>t.\u0275providers)])}function fz(i){return i.routerState.root}function $v(i,e){return{\u0275kind:i,\u0275providers:e}}function pz(){let i=S(yn);return e=>{let t=i.get(ps);if(e!==t.components[0])return;let n=i.get(vc),r=i.get(mz);i.get(DP)===1&&n.initialNavigation(),i.get(bz,null,{optional:!0})?.setUpPreloading(),i.get(hz,null,{optional:!0})?.init(),n.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var mz=new me("",{factory:()=>new lt}),DP=new me("",{providedIn:"root",factory:()=>1});function gz(){let i=[{provide:DP,useValue:0},nx(()=>{let e=S(yn);return e.get(cD,Promise.resolve()).then(()=>new Promise(n=>{let r=e.get(vc),o=e.get(mz);eR(r,()=>{n(!0)}),e.get(JS).afterPreactivation=()=>(n(!0),o.closed?ut(void 0):o),r.initialNavigation()}))})];return $v(2,i)}function _z(){let i=[nx(()=>{S(vc).setUpLocationChangeListener()}),{provide:DP,useValue:2}];return $v(3,i)}var bz=new me("");function vz(i){return $v(0,[{provide:bz,useExisting:dz},{provide:Wv,useExisting:i}])}function yz(){return $v(8,[yP,{provide:Hv,useExisting:yP}])}function xz(i){hs("NgRouterViewTransitions");let e=[{provide:SP,useValue:cz},{provide:RP,useValue:ae({skipNextTransition:!!i?.skipInitialTransition},i)}];return $v(9,e)}var wz=[Hl,{provide:Nh,useClass:Au},vc,jh,{provide:Ns,useFactory:fz,deps:[vc]},QS,[]],IP=(()=>{class i{constructor(){}static forRoot(t,n){return{ngModule:i,providers:[wz,[],{provide:Oh,multi:!0,useValue:t},[],n?.errorHandler?{provide:TP,useValue:n.errorHandler}:[],{provide:Nu,useValue:n||{}},n?.useHash?fre():pre(),hre(),n?.preloadingStrategy?vz(n.preloadingStrategy).\u0275providers:[],n?.initialNavigation?mre(n):[],n?.bindToComponentInputs?yz().\u0275providers:[],n?.enableViewTransitions?xz().\u0275providers:[],gre()]}}static forChild(t){return{ngModule:i,providers:[{provide:Oh,multi:!0,useValue:t}]}}static \u0275fac=function(n){return new(n||i)};static \u0275mod=Mn({type:i});static \u0275inj=xn({})}return i})();function hre(){return{provide:hz,useFactory:()=>{let i=S(Ek),e=S(pt),t=S(Nu),n=S(JS),r=S(Nh);return t.scrollOffset&&i.setOffset(t.scrollOffset),new dre(r,n,i,e,t)}}}function fre(){return{provide:Qs,useClass:dD}}function pre(){return{provide:Qs,useClass:hx}}function mre(i){return[i.initialNavigation==="disabled"?_z().\u0275providers:[],i.initialNavigation==="enabledBlocking"?gz().\u0275providers:[]]}var CP=new me("");function gre(){return[{provide:CP,useFactory:pz},{provide:kg,multi:!0,useExisting:CP}]}var ju={name:"ngx-three",version:"0.43.3",scripts:{ng:"ng",start:"ng serve",build:"ng build ngx-three","build:prod":"ng build ngx-three --configuration production","build:demo":"ng build ngx-three-demo --configuration production --base-href /ngx-three/",test:"ng test","test-headless":"ng test --watch=false --browsers=ChromeHeadless",lint:"ng lint",e2e:"ng e2e","copy:docs":"(cp README.md dist/ngx-three/ || copy README.md dist\\ngx-three)",package:"ng build --configuration production ngx-three && npm run copy:docs",format:'prettier-eslint --write "{,!(node_modules|dist)/**/}*.{ts,tsx}"'},private:!0,dependencies:{"@angular/animations":"^20.1.0","@angular/cdk":"^20.1.0","@angular/common":"^20.1.0","@angular/compiler":"^20.1.0","@angular/core":"^20.1.0","@angular/forms":"^20.1.0","@angular/material":"^20.1.0","@angular/platform-browser":"^20.1.0","@angular/platform-browser-dynamic":"^20.1.0","@angular/router":"^20.1.0","@stackblitz/sdk":"^1.11.0","@types/webxr":"^0.5.22","highlight.js":"^11.9.0","lil-gui":"^0.20.0","ngx-highlightjs":"^14.0.1","normalize.css":"^8.0.1",rxjs:"~7.8.1","simplex-noise":"^4.0.3",three:"~0.182.0",tslib:"^2.8.1"},devDependencies:{"@angular-devkit/build-angular":"^20.1.0","@angular-eslint/builder":"20.1.1","@angular-eslint/eslint-plugin":"20.1.1","@angular-eslint/eslint-plugin-template":"20.1.1","@angular-eslint/schematics":"20.1.1","@angular-eslint/template-parser":"20.1.1","@angular/cli":"^20.1.0","@angular/compiler-cli":"^20.1.0","@types/jasmine":"^4.3.5","@types/node":"^24.0.13","@types/three":"^0.182.0","@typescript-eslint/eslint-plugin":"7.11.0","@typescript-eslint/parser":"7.11.0",acorn:">=8","angular-eslint":"^20.1.1",eslint:"8.57.1","eslint-plugin-import":"^2.28.1","eslint-plugin-jsdoc":"^46.5.0","eslint-plugin-prefer-arrow":"^1.2.3","jasmine-core":"^5.1.0","jasmine-spec-reporter":"^7.0.0",karma:"^6.4.2","karma-chrome-launcher":"^3.2.0","karma-coverage":"^2.2.1","karma-jasmine":"^5.1.0","karma-jasmine-html-reporter":"^2.1.0","ng-packagr":"^20.1.0",prettier:"^3.6.2","prettier-eslint":"^16.4.2","prettier-eslint-cli":"^8.0.1","ts-node":"^10.9.2",typescript:"^5.8.3","utility-types":"^3.11.0"}};var AP=`
import "zone.js";`;function Mz(i,e){return Wt(this,null,function*(){let t=jP(i),n=Tm(t),r=NP(n),o={"package.json":yre(),"src/index.html":{content:FP(r)},"src/main.ts":{content:PP(n,e)},"src/polyfills.ts":{content:AP},"src/assets.ts":{content:`export const ASSET_PATH = '${TS}';`}};yield vre(i,o),fetch("https://codesandbox.io/api/v1/sandboxes/define?json=1",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({files:o})}).then(s=>s.json()).then(s=>window.open(`https://codesandbox.io/s/${s.sandbox_id}`,"_blank"))})}function vre(i,e){return Promise.all(i.map(t=>fetch(t).then(n=>Wt(null,null,function*(){e[`src/app/${Tm(t)}`]={content:yield n.text()}}))))}function yre(){return{content:{main:"src/main.ts",dependencies:ae({"ngx-three":"latest","@types/three":ju.devDependencies["@types/three"]},ju.dependencies),devDependencies:ae({},ju.devDependencies)}}}function Tm(i){return i.replace(/^.*[\\\/]/,"")}function PP(i,e){let t=wre(e)??xre(i),n=Mre(e,t);return`
            import { platformBrowserDynamic } from '@angular/platform-browser-dynamic';
            import { NgModule } from '@angular/core';
            import { BrowserModule } from '@angular/platform-browser';
            import { NgxThreeModule } from 'ngx-three';
            import { FormsModule } from '@angular/forms';
            import { ${n} } from './app/${i.replace(".ts","")}';

            @NgModule({
                imports: [
                    BrowserModule,
                    NgxThreeModule,
                    FormsModule
                ],
                providers: [],
                declarations: [${n}],
                bootstrap: [${t}]
            })
            export class AppModule {}

            platformBrowserDynamic().bootstrapModule(AppModule)
            .catch(err => console.log(err));
            `}function FP(i){return`
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>NgxThreeDemo</title>
        <base href="/" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" type="image/x-icon" href="favicon.ico" />
    </head>
    <body>
        <${i}></${i}>
    </body>
    </html>
    `}function xre(i){return i.replace(".ts","").replace(/(?:^\w|[A-Z]|\b\w)/g,(e,t)=>e.toUpperCase()).replace(/[-.]/g,"")}function NP(i){return"app-"+i.replace(".component.ts","")}function jP(i){for(let e of i)if(e.endsWith(".ts"))return e;return""}function Sz(i){for(let e of i)if(e.endsWith(".html"))return e}function wre(i){if(i&&i.length>0)return i[0]}function Mre(i,e){return i&&i.length>0?i.join(","):e}var Sre="https://stackblitz.com",Rz=["angular-cli","create-react-app","html","javascript","node","polymer","typescript","vue"],Rre=["project","search","ports","settings"],Tre=["light","dark"],Cre=["editor","preview"],Tz={clickToLoad:i=>Lh("ctl",i),devToolsHeight:i=>Cz("devtoolsheight",i),forceEmbedLayout:i=>Lh("embed",i),hideDevTools:i=>Lh("hidedevtools",i),hideExplorer:i=>Lh("hideExplorer",i),hideNavigation:i=>Lh("hideNavigation",i),openFile:i=>nR("file",i),showSidebar:i=>Ere("showSidebar",i),sidebarView:i=>OP("sidebarView",i,Rre),startScript:i=>nR("startScript",i),terminalHeight:i=>Cz("terminalHeight",i),theme:i=>OP("theme",i,Tre),view:i=>OP("view",i,Cre),zenMode:i=>Lh("zenMode",i),organization:i=>`${nR("orgName",i?.name)}&${nR("orgProvider",i?.provider)}`,crossOriginIsolated:i=>Lh("corp",i)};function Ez(i={}){let e=Object.entries(i).map(([t,n])=>n!=null&&Tz.hasOwnProperty(t)?Tz[t](n):"").filter(Boolean);return e.length?`?${e.join("&")}`:""}function Lh(i,e){return e===!0?`${i}=1`:""}function Ere(i,e){return typeof e=="boolean"?`${i}=${e?"1":"0"}`:""}function Cz(i,e){if(typeof e=="number"&&!Number.isNaN(e)){let t=Math.min(100,Math.max(0,e));return`${i}=${encodeURIComponent(Math.round(t))}`}return""}function OP(i,e="",t=[]){return t.includes(e)?`${i}=${encodeURIComponent(e)}`:""}function nR(i,e){return(Array.isArray(e)?e:[e]).filter(n=>typeof n=="string"&&n.trim()!=="").map(n=>`${i}=${encodeURIComponent(n)}`).join("&")}function Dz(){return Math.random().toString(36).slice(2,6)+Math.random().toString(36).slice(2,6)}function UP(i,e){return`${Iz(e)}${i}${Ez(e)}`}function VP(i,e){let t={forceEmbedLayout:!0};return e&&typeof e=="object"&&Object.assign(t,e),`${Iz(t)}${i}${Ez(t)}`}function Iz(i={}){return(typeof i.origin=="string"?i.origin:Sre).replace(/\/$/,"")}function zP(i,e,t){if(!e||!i||!i.parentNode)throw new Error("Invalid Element");i.id&&(e.id=i.id),i.className&&(e.className=i.className),Dre(e,t),Ire(i,e,t),i.replaceWith(e)}function HP(i){if(typeof i=="string"){let e=document.getElementById(i);if(!e)throw new Error(`Could not find element with id '${i}'`);return e}else if(i instanceof HTMLElement)return i;throw new Error(`Invalid element: ${i}`)}function GP(i){return i&&i.newWindow===!1?"_self":"_blank"}function Dre(i,e={}){let t=Object.hasOwnProperty.call(e,"height")?`${e.height}`:"300",n=Object.hasOwnProperty.call(e,"width")?`${e.width}`:void 0;i.setAttribute("height",t),n?i.setAttribute("width",n):i.setAttribute("style","width:100%;")}function Ire(i,e,t={}){let n=i.allow?.split(";")?.map(r=>r.trim())??[];t.crossOriginIsolated&&!n.includes("cross-origin-isolated")&&n.push("cross-origin-isolated"),n.length>0&&(e.allow=n.join("; "))}var LP=class{constructor(e){this.pending={},this.port=e,this.port.onmessage=this.messageListener.bind(this)}request({type:e,payload:t}){return new Promise((n,r)=>{let o=Dz();this.pending[o]={resolve:n,reject:r},this.port.postMessage({type:e,payload:jt(ae({},t),{__reqid:o})})})}messageListener(e){if(typeof e.data.payload?.__reqid!="string")return;let{type:t,payload:n}=e.data,{__reqid:r,__success:o,__error:s}=n;this.pending[r]&&(o?this.pending[r].resolve(this.cleanResult(n)):this.pending[r].reject(s?`${t}: ${s}`:t),delete this.pending[r])}cleanResult(e){let t=ae({},e);return delete t.__reqid,delete t.__success,delete t.__error,Object.keys(t).length?t:null}},kP=class{constructor(e,t){this.editor={openFile:n=>this._rdc.request({type:"SDK_OPEN_FILE",payload:{path:n}}),setCurrentFile:n=>this._rdc.request({type:"SDK_SET_CURRENT_FILE",payload:{path:n}}),setTheme:n=>this._rdc.request({type:"SDK_SET_UI_THEME",payload:{theme:n}}),setView:n=>this._rdc.request({type:"SDK_SET_UI_VIEW",payload:{view:n}}),showSidebar:(n=!0)=>this._rdc.request({type:"SDK_TOGGLE_SIDEBAR",payload:{visible:n}})},this.preview={origin:"",getUrl:()=>this._rdc.request({type:"SDK_GET_PREVIEW_URL",payload:{}}).then(n=>n?.url??null),setUrl:(n="/")=>{if(typeof n!="string"||!n.startsWith("/"))throw new Error(`Invalid argument: expected a path starting with '/', got '${n}'`);return this._rdc.request({type:"SDK_SET_PREVIEW_URL",payload:{path:n}})}},this._rdc=new LP(e),Object.defineProperty(this.preview,"origin",{value:typeof t.previewOrigin=="string"?t.previewOrigin:null,writable:!1})}applyFsDiff(e){let t=n=>n!==null&&typeof n=="object";if(!t(e)||!t(e.create))throw new Error("Invalid diff object: expected diff.create to be an object.");if(!Array.isArray(e.destroy))throw new Error("Invalid diff object: expected diff.destroy to be an array.");return this._rdc.request({type:"SDK_APPLY_FS_DIFF",payload:e})}getDependencies(){return this._rdc.request({type:"SDK_GET_DEPS_SNAPSHOT",payload:{}})}getFsSnapshot(){return this._rdc.request({type:"SDK_GET_FS_SNAPSHOT",payload:{}})}},iR=[],BP=class{constructor(e){this.id=Dz(),this.element=e,this.pending=new Promise((t,n)=>{let r=({data:l,ports:u})=>{l?.action==="SDK_INIT_SUCCESS"&&l.id===this.id&&(this.vm=new kP(u[0],l.payload),t(this.vm),s())},o=()=>{this.element.contentWindow?.postMessage({action:"SDK_INIT",id:this.id},"*")};function s(){window.clearInterval(c),window.removeEventListener("message",r)}window.addEventListener("message",r),o();let a=0,c=window.setInterval(()=>{if(this.vm){s();return}if(a>=20){s(),n("Timeout: Unable to establish a connection with the StackBlitz VM"),iR.forEach((l,u)=>{l.id===this.id&&iR.splice(u,1)});return}a++,o()},500)}),iR.push(this)}},Are=i=>{let e=i instanceof Element?"element":"id";return iR.find(t=>t[e]===i)??null};function Pre(i,e){let t=document.createElement("input");return t.type="hidden",t.name=i,t.value=e,t}function Fre(i){return i.replace(/\[/g,"%5B").replace(/\]/g,"%5D")}function Az({template:i,title:e,description:t,dependencies:n,files:r,settings:o}){if(!Rz.includes(i)){let l=Rz.map(u=>`'${u}'`).join(", ");console.warn(`Unsupported project.template: must be one of ${l}`)}let s=[],a=(l,u,d="")=>{s.push(Pre(l,typeof u=="string"?u:d))};a("project[title]",e),typeof t=="string"&&t.length>0&&a("project[description]",t),a("project[template]",i,"javascript"),n&&(i==="node"?console.warn("Invalid project.dependencies: dependencies must be provided as a 'package.json' file when using the 'node' template."):a("project[dependencies]",JSON.stringify(n))),o&&a("project[settings]",JSON.stringify(o)),Object.entries(r).forEach(([l,u])=>{a(`project[files][${Fre(l)}]`,u)});let c=document.createElement("form");return c.method="POST",c.setAttribute("style","display:none!important;"),c.append(...s),c}function Nre(i,e){let t=Az(i);return t.action=VP("/run",e),t.id="sb_run",`<!doctype html>
<html>
<head><title></title></head>
<body>
  ${t.outerHTML}
  <script>document.getElementById('${t.id}').submit();<\/script>
</body>
</html>`}function jre(i,e){let t=Az(i);t.action=UP("/run",e),t.target=GP(e),document.body.appendChild(t),t.submit(),document.body.removeChild(t)}function rR(i){return i?.contentWindow?(Are(i)??new BP(i)).pending:Promise.reject("Provided element is not an iframe.")}function Ore(i,e){jre(i,e)}function Lre(i,e){let t=UP(`/edit/${i}`,e),n=GP(e);window.open(t,n)}function kre(i,e){let t=UP(`/github/${i}`,e),n=GP(e);window.open(t,n)}function Bre(i,e,t){let n=HP(i),r=Nre(e,t),o=document.createElement("iframe");return zP(n,o,t),o.contentDocument?.write(r),rR(o)}function Ure(i,e,t){let n=HP(i),r=document.createElement("iframe");return r.src=VP(`/edit/${e}`,t),zP(n,r,t),rR(r)}function Vre(i,e,t){let n=HP(i),r=document.createElement("iframe");return r.src=VP(`/github/${e}`,t),zP(n,r,t),rR(r)}var Pz={connect:rR,embedGithubProject:Vre,embedProject:Bre,embedProjectId:Ure,openGithubProject:kre,openProject:Ore,openProjectId:Lre};function Fz(i,e){return Wt(this,null,function*(){let t=jP(i),n=Sz(i),r=Tm(t),o=NP(r),s={template:"angular-cli",title:o,description:"ngx-three example "+o,files:{"src/index.html":FP(o),"src/main.ts":PP(r,e),"src/polyfills.ts":AP,"src/assets.ts":`export const ASSET_PATH = '${TS}';`},dependencies:ae({"ngx-three":"latest","@types/three":ju.devDependencies["@types/three"]},ju.dependencies),devDependencies:ae({},ju.devDependencies)};yield zre(i,s.files);let a=n?{openFile:`src/app/${Tm(n)}`}:void 0;Pz.openProject(s,a)})}function zre(i,e){return Promise.all(i.map(t=>fetch(t).then(n=>Wt(null,null,function*(){let r=yield n.text();e[`src/app/${Tm(t)}`]=r}))))}var Cm=(()=>{let e=class e{constructor(){this.urls=[],this.fileNames=[]}setUrls(n){this.urls=n,this.fileNames=this.extractFileNames()}extractFileNames(){return this.urls.map(n=>n.split("/").pop()??"")}toStackblitz(n){n?.preventDefault(),Fz(this.urls,this.declarations)}toCodeSandbox(n){n?.preventDefault(),Mz(this.urls,this.declarations)}getLanguage(n){switch(n.substring(n.lastIndexOf(".")+1)){case"ts":return"typescript";case"js":return"javascript";case"html":return"html";case"css":return"css";default:return"typescript"}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ge({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function qv(i){return i.buttons===0||i.detail===0}function Xv(i){let e=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!!e&&e.identifier===-1&&(e.radiusX==null||e.radiusX===1)&&(e.radiusY==null||e.radiusY===1)}var WP;function Nz(){if(WP==null){let i=typeof document<"u"?document.head:null;WP=!!(i&&(i.createShadowRoot||i.attachShadow))}return WP}function $P(i){if(Nz()){let e=i.getRootNode?i.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}function Ca(i){return i.composedPath?i.composedPath()[0]:i.target}var Zv;function jz(){if(Zv==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Zv=!0}))}finally{Zv=Zv||!1}return Zv}function Em(i){return jz()?i:!!i.capture}function xl(i,e=0){return Oz(i)?Number(i):arguments.length===2?e:0}function Oz(i){return!isNaN(parseFloat(i))&&!isNaN(Number(i))}function js(i){return i instanceof vt?i.nativeElement:i}var Lz=new me("cdk-input-modality-detector-options"),kz={ignoreKeys:[18,17,224,91,16]},Bz=650,qP={passive:!0,capture:!0},Uz=(()=>{class i{_platform=S(si);_listenerCleanups;modalityDetected;modalityChanged;get mostRecentModality(){return this._modality.value}_mostRecentTarget=null;_modality=new Bi(null);_options;_lastTouchMs=0;_onKeydown=t=>{this._options?.ignoreKeys?.some(n=>n===t.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Ca(t))};_onMousedown=t=>{Date.now()-this._lastTouchMs<Bz||(this._modality.next(qv(t)?"keyboard":"mouse"),this._mostRecentTarget=Ca(t))};_onTouchstart=t=>{if(Xv(t)){this._modality.next("keyboard");return}this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Ca(t)};constructor(){let t=S(pt),n=S(kt),r=S(Lz,{optional:!0});if(this._options=ae(ae({},kz),r),this.modalityDetected=this._modality.pipe(Ju(1)),this.modalityChanged=this.modalityDetected.pipe(W0()),this._platform.isBrowser){let o=S(Co).createRenderer(null,null);this._listenerCleanups=t.runOutsideAngular(()=>[o.listen(n,"keydown",this._onKeydown,qP),o.listen(n,"mousedown",this._onMousedown,qP),o.listen(n,"touchstart",this._onTouchstart,qP)])}}ngOnDestroy(){this._modality.complete(),this._listenerCleanups?.forEach(t=>t())}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),Yv=function(i){return i[i.IMMEDIATE=0]="IMMEDIATE",i[i.EVENTUAL=1]="EVENTUAL",i}(Yv||{}),Vz=new me("cdk-focus-monitor-default-options"),oR=Em({passive:!0,capture:!0}),kh=(()=>{class i{_ngZone=S(pt);_platform=S(si);_inputModalityDetector=S(Uz);_origin=null;_lastFocusOrigin;_windowFocused=!1;_windowFocusTimeoutId;_originTimeoutId;_originFromTouchInteraction=!1;_elementInfo=new Map;_monitoredElementCount=0;_rootNodeFocusListenerCount=new Map;_detectionMode;_windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)};_document=S(kt);_stopInputModalityDetector=new lt;constructor(){let t=S(Vz,{optional:!0});this._detectionMode=t?.detectionMode||Yv.IMMEDIATE}_rootNodeFocusAndBlurListener=t=>{let n=Ca(t);for(let r=n;r;r=r.parentElement)t.type==="focus"?this._onFocus(t,r):this._onBlur(t,r)};monitor(t,n=!1){let r=js(t);if(!this._platform.isBrowser||r.nodeType!==1)return ut();let o=$P(r)||this._document,s=this._elementInfo.get(r);if(s)return n&&(s.checkChildren=!0),s.subject;let a={checkChildren:n,subject:new lt,rootNode:o};return this._elementInfo.set(r,a),this._registerGlobalListeners(a),a.subject}stopMonitoring(t){let n=js(t),r=this._elementInfo.get(n);r&&(r.subject.complete(),this._setClasses(n),this._elementInfo.delete(n),this._removeGlobalListeners(r))}focusVia(t,n,r){let o=js(t),s=this._document.activeElement;o===s?this._getClosestElementsInfo(o).forEach(([a,c])=>this._originChanged(a,n,c)):(this._setOrigin(n),typeof o.focus=="function"&&o.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,n)=>this.stopMonitoring(n))}_getWindow(){return this._document.defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return this._detectionMode===Yv.EVENTUAL||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,n){t.classList.toggle("cdk-focused",!!n),t.classList.toggle("cdk-touch-focused",n==="touch"),t.classList.toggle("cdk-keyboard-focused",n==="keyboard"),t.classList.toggle("cdk-mouse-focused",n==="mouse"),t.classList.toggle("cdk-program-focused",n==="program")}_setOrigin(t,n=!1){this._ngZone.runOutsideAngular(()=>{if(this._origin=t,this._originFromTouchInteraction=t==="touch"&&n,this._detectionMode===Yv.IMMEDIATE){clearTimeout(this._originTimeoutId);let r=this._originFromTouchInteraction?Bz:1;this._originTimeoutId=setTimeout(()=>this._origin=null,r)}})}_onFocus(t,n){let r=this._elementInfo.get(n),o=Ca(t);!r||!r.checkChildren&&n!==o||this._originChanged(n,this._getFocusOrigin(o),r)}_onBlur(t,n){let r=this._elementInfo.get(n);!r||r.checkChildren&&t.relatedTarget instanceof Node&&n.contains(t.relatedTarget)||(this._setClasses(n),this._emitOrigin(r,null))}_emitOrigin(t,n){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(n))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;let n=t.rootNode,r=this._rootNodeFocusListenerCount.get(n)||0;r||this._ngZone.runOutsideAngular(()=>{n.addEventListener("focus",this._rootNodeFocusAndBlurListener,oR),n.addEventListener("blur",this._rootNodeFocusAndBlurListener,oR)}),this._rootNodeFocusListenerCount.set(n,r+1),++this._monitoredElementCount===1&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Pn(this._stopInputModalityDetector)).subscribe(o=>{this._setOrigin(o,!0)}))}_removeGlobalListeners(t){let n=t.rootNode;if(this._rootNodeFocusListenerCount.has(n)){let r=this._rootNodeFocusListenerCount.get(n);r>1?this._rootNodeFocusListenerCount.set(n,r-1):(n.removeEventListener("focus",this._rootNodeFocusAndBlurListener,oR),n.removeEventListener("blur",this._rootNodeFocusAndBlurListener,oR),this._rootNodeFocusListenerCount.delete(n))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,n,r){this._setClasses(t,n),this._emitOrigin(r,n),this._lastFocusOrigin=n}_getClosestElementsInfo(t){let n=[];return this._elementInfo.forEach((r,o)=>{(o===t||r.checkChildren&&o.contains(t))&&n.push([o,r])}),n}_isLastInteractionFromInputLabel(t){let{_mostRecentTarget:n,mostRecentModality:r}=this._inputModalityDetector;if(r!=="mouse"||!n||n===t||t.nodeName!=="INPUT"&&t.nodeName!=="TEXTAREA"||t.disabled)return!1;let o=t.labels;if(o){for(let s=0;s<o.length;s++)if(o[s].contains(n))return!0}return!1}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),XP=(()=>{class i{_elementRef=S(vt);_focusMonitor=S(kh);_monitorSubscription;_focusOrigin=null;cdkFocusChange=new dt;constructor(){}get focusOrigin(){return this._focusOrigin}ngAfterViewInit(){let t=this._elementRef.nativeElement;this._monitorSubscription=this._focusMonitor.monitor(t,t.nodeType===1&&t.hasAttribute("cdkMonitorSubtreeFocus")).subscribe(n=>{this._focusOrigin=n,this.cdkFocusChange.emit(n)})}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._monitorSubscription&&this._monitorSubscription.unsubscribe()}static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,selectors:[["","cdkMonitorElementFocus",""],["","cdkMonitorSubtreeFocus",""]],outputs:{cdkFocusChange:"cdkFocusChange"},exportAs:["cdkMonitorFocus"]})}return i})();var sR=new WeakMap,Ea=(()=>{class i{_appRef;_injector=S(yn);_environmentInjector=S(Ei);load(t){let n=this._appRef=this._appRef||this._injector.get(ps),r=sR.get(n);r||(r={loaders:new Set,refs:[]},sR.set(n,r),n.onDestroy(()=>{sR.get(n)?.refs.forEach(o=>o.destroy()),sR.delete(n)})),r.loaders.has(t)||(r.loaders.add(t),r.refs.push(sD(t,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var zz=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275cmp=O({type:i,selectors:[["ng-component"]],exportAs:["cdkVisuallyHidden"],decls:0,vars:0,template:function(n,r){},styles:[`.cdk-visually-hidden{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap;outline:0;-webkit-appearance:none;-moz-appearance:none;left:0}[dir=rtl] .cdk-visually-hidden{left:auto;right:0}
`],encapsulation:2,changeDetection:0})}return i})();function Hre(i){if(i.type==="characterData"&&i.target instanceof Comment)return!0;if(i.type==="childList"){for(let e=0;e<i.addedNodes.length;e++)if(!(i.addedNodes[e]instanceof Comment))return!1;for(let e=0;e<i.removedNodes.length;e++)if(!(i.removedNodes[e]instanceof Comment))return!1;return!0}return!1}var Gre=(()=>{class i{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),Wre=(()=>{class i{_mutationObserverFactory=S(Gre);_observedElements=new Map;_ngZone=S(pt);constructor(){}ngOnDestroy(){this._observedElements.forEach((t,n)=>this._cleanupObserver(n))}observe(t){let n=js(t);return new It(r=>{let s=this._observeElement(n).pipe(tt(a=>a.filter(c=>!Hre(c))),vn(a=>!!a.length)).subscribe(a=>{this._ngZone.run(()=>{r.next(a)})});return()=>{s.unsubscribe(),this._unobserveElement(n)}})}_observeElement(t){return this._ngZone.runOutsideAngular(()=>{if(this._observedElements.has(t))this._observedElements.get(t).count++;else{let n=new lt,r=this._mutationObserverFactory.create(o=>n.next(o));r&&r.observe(t,{characterData:!0,childList:!0,subtree:!0}),this._observedElements.set(t,{observer:r,stream:n,count:1})}return this._observedElements.get(t).stream})}_unobserveElement(t){this._observedElements.has(t)&&(this._observedElements.get(t).count--,this._observedElements.get(t).count||this._cleanupObserver(t))}_cleanupObserver(t){if(this._observedElements.has(t)){let{observer:n,stream:r}=this._observedElements.get(t);n&&n.disconnect(),r.complete(),this._observedElements.delete(t)}}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),aR=(()=>{class i{_contentObserver=S(Wre);_elementRef=S(vt);event=new dt;get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._disabled?this._unsubscribe():this._subscribe()}_disabled=!1;get debounce(){return this._debounce}set debounce(t){this._debounce=xl(t),this._subscribe()}_debounce;_currentSubscription=null;constructor(){}ngAfterContentInit(){!this._currentSubscription&&!this.disabled&&this._subscribe()}ngOnDestroy(){this._unsubscribe()}_subscribe(){this._unsubscribe();let t=this._contentObserver.observe(this._elementRef);this._currentSubscription=(this.debounce?t.pipe(Us(this.debounce)):t).subscribe(this.event)}_unsubscribe(){this._currentSubscription?.unsubscribe()}static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,selectors:[["","cdkObserveContent",""]],inputs:{disabled:[2,"cdkObserveContentDisabled","disabled",On],debounce:"debounce"},outputs:{event:"cdkObserveContent"},exportAs:["cdkObserveContent"]})}return i})();var lR=(()=>{class i{_platform=S(si);constructor(){}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return qre(t)&&getComputedStyle(t).visibility==="visible"}isTabbable(t){if(!this._platform.isBrowser)return!1;let n=$re(toe(t));if(n&&(Hz(n)===-1||!this.isVisible(n)))return!1;let r=t.nodeName.toLowerCase(),o=Hz(t);return t.hasAttribute("contenteditable")?o!==-1:r==="iframe"||r==="object"||this._platform.WEBKIT&&this._platform.IOS&&!Jre(t)?!1:r==="audio"?t.hasAttribute("controls")?o!==-1:!1:r==="video"?o===-1?!1:o!==null?!0:this._platform.FIREFOX||t.hasAttribute("controls"):t.tabIndex>=0}isFocusable(t,n){return eoe(t)&&!this.isDisabled(t)&&(n?.ignoreVisibility||this.isVisible(t))}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function $re(i){try{return i.frameElement}catch{return null}}function qre(i){return!!(i.offsetWidth||i.offsetHeight||typeof i.getClientRects=="function"&&i.getClientRects().length)}function Xre(i){let e=i.nodeName.toLowerCase();return e==="input"||e==="select"||e==="button"||e==="textarea"}function Zre(i){return Qre(i)&&i.type=="hidden"}function Yre(i){return Kre(i)&&i.hasAttribute("href")}function Qre(i){return i.nodeName.toLowerCase()=="input"}function Kre(i){return i.nodeName.toLowerCase()=="a"}function $z(i){if(!i.hasAttribute("tabindex")||i.tabIndex===void 0)return!1;let e=i.getAttribute("tabindex");return!!(e&&!isNaN(parseInt(e,10)))}function Hz(i){if(!$z(i))return null;let e=parseInt(i.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}function Jre(i){let e=i.nodeName.toLowerCase(),t=e==="input"&&i.type;return t==="text"||t==="password"||e==="select"||e==="textarea"}function eoe(i){return Zre(i)?!1:Xre(i)||Yre(i)||i.hasAttribute("contenteditable")||$z(i)}function toe(i){return i.ownerDocument&&i.ownerDocument.defaultView||window}var cR=class{_element;_checker;_ngZone;_document;_injector;_startAnchor;_endAnchor;_hasAttached=!1;startAnchorListener=()=>this.focusLastTabbableElement();endAnchorListener=()=>this.focusFirstTabbableElement();get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_enabled=!0;constructor(e,t,n,r,o=!1,s){this._element=e,this._checker=t,this._ngZone=n,this._document=r,this._injector=s,o||this.attachAnchors()}destroy(){let e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return this._hasAttached?!0:(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){let t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return e=="start"?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){let t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){let n=this._getFirstTabbableElement(t);return n?.focus(e),!!n}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){let t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){let t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;let t=e.children;for(let n=0;n<t.length;n++){let r=t[n].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[n]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;let t=e.children;for(let n=t.length-1;n>=0;n--){let r=t[n].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[n]):null;if(r)return r}return null}_createAnchor(){let e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._injector?co(e,{injector:this._injector}):setTimeout(e)}},YP=(()=>{class i{_checker=S(lR);_ngZone=S(pt);_document=S(kt);_injector=S(yn);constructor(){S(Ea).load(zz)}create(t,n=!1){return new cR(t,this._checker,this._ngZone,this._document,n,this._injector)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Ou=function(i){return i[i.NONE=0]="NONE",i[i.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",i[i.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",i}(Ou||{}),Gz="cdk-high-contrast-black-on-white",Wz="cdk-high-contrast-white-on-black",ZP="cdk-high-contrast-active",QP=(()=>{class i{_platform=S(si);_hasCheckedHighContrastMode;_document=S(kt);_breakpointSubscription;constructor(){this._breakpointSubscription=S(e_).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return Ou.NONE;let t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);let n=this._document.defaultView||window,r=n&&n.getComputedStyle?n.getComputedStyle(t):null,o=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),o){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return Ou.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return Ou.BLACK_ON_WHITE}return Ou.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let t=this._document.body.classList;t.remove(ZP,Gz,Wz),this._hasCheckedHighContrastMode=!0;let n=this.getHighContrastMode();n===Ou.BLACK_ON_WHITE?t.add(ZP,Gz):n===Ou.WHITE_ON_BLACK&&t.add(ZP,Wz)}}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var KP={},JP=(()=>{class i{_appId=S(xf);getId(t){return this._appId!=="ng"&&(t+=this._appId),KP.hasOwnProperty(t)||(KP[t]=0),`${t}${KP[t]++}`}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var noe=200,uR=class{_letterKeyStream=new lt;_items=[];_selectedItemIndex=-1;_pressedLetters=[];_skipPredicateFn;_selectedItem=new lt;selectedItem=this._selectedItem;constructor(e,t){let n=typeof t?.debounceInterval=="number"?t.debounceInterval:noe;t?.skipPredicate&&(this._skipPredicateFn=t.skipPredicate),this.setItems(e),this._setupKeyHandler(n)}destroy(){this._pressedLetters=[],this._letterKeyStream.complete(),this._selectedItem.complete()}setCurrentSelectedItemIndex(e){this._selectedItemIndex=e}setItems(e){this._items=e}handleKey(e){let t=e.keyCode;e.key&&e.key.length===1?this._letterKeyStream.next(e.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))}isTyping(){return this._pressedLetters.length>0}reset(){this._pressedLetters=[]}_setupKeyHandler(e){this._letterKeyStream.pipe(Kn(t=>this._pressedLetters.push(t)),Us(e),vn(()=>this._pressedLetters.length>0),tt(()=>this._pressedLetters.join("").toLocaleUpperCase())).subscribe(t=>{for(let n=1;n<this._items.length+1;n++){let r=(this._selectedItemIndex+n)%this._items.length,o=this._items[r];if(!this._skipPredicateFn?.(o)&&o.getLabel?.().toLocaleUpperCase().trim().indexOf(t)===0){this._selectedItem.next(o);break}}this._pressedLetters=[]})}};function Dm(i,...e){return e.length?e.some(t=>i[t]):i.altKey||i.shiftKey||i.ctrlKey||i.metaKey}var dR=class{_items;_activeItemIndex=Vn(-1);_activeItem=Vn(null);_wrap=!1;_typeaheadSubscription=Rn.EMPTY;_itemChangesSubscription;_vertical=!0;_horizontal;_allowedModifierKeys=[];_homeAndEnd=!1;_pageUpAndDown={enabled:!1,delta:10};_effectRef;_typeahead;_skipPredicateFn=e=>e.disabled;constructor(e,t){this._items=e,e instanceof $s?this._itemChangesSubscription=e.changes.subscribe(n=>this._itemsChanged(n.toArray())):lf(e)&&(this._effectRef=Tf(()=>this._itemsChanged(e()),{injector:t}))}tabOut=new lt;change=new lt;skipPredicate(e){return this._skipPredicateFn=e,this}withWrap(e=!0){return this._wrap=e,this}withVerticalOrientation(e=!0){return this._vertical=e,this}withHorizontalOrientation(e){return this._horizontal=e,this}withAllowedModifierKeys(e){return this._allowedModifierKeys=e,this}withTypeAhead(e=200){this._typeaheadSubscription.unsubscribe();let t=this._getItemsArray();return this._typeahead=new uR(t,{debounceInterval:typeof e=="number"?e:void 0,skipPredicate:n=>this._skipPredicateFn(n)}),this._typeaheadSubscription=this._typeahead.selectedItem.subscribe(n=>{this.setActiveItem(n)}),this}cancelTypeahead(){return this._typeahead?.reset(),this}withHomeAndEnd(e=!0){return this._homeAndEnd=e,this}withPageUpDown(e=!0,t=10){return this._pageUpAndDown={enabled:e,delta:t},this}setActiveItem(e){let t=this._activeItem();this.updateActiveItem(e),this._activeItem()!==t&&this.change.next(this._activeItemIndex())}onKeydown(e){let t=e.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(o=>!e[o]||this._allowedModifierKeys.indexOf(o)>-1);switch(t){case 9:this.tabOut.next();return;case 40:if(this._vertical&&r){this.setNextItemActive();break}else return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}else return;case 39:if(this._horizontal&&r){this._horizontal==="rtl"?this.setPreviousItemActive():this.setNextItemActive();break}else return;case 37:if(this._horizontal&&r){this._horizontal==="rtl"?this.setNextItemActive():this.setPreviousItemActive();break}else return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}else return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}else return;case 33:if(this._pageUpAndDown.enabled&&r){let o=this._activeItemIndex()-this._pageUpAndDown.delta;this._setActiveItemByIndex(o>0?o:0,1);break}else return;case 34:if(this._pageUpAndDown.enabled&&r){let o=this._activeItemIndex()+this._pageUpAndDown.delta,s=this._getItemsArray().length;this._setActiveItemByIndex(o<s?o:s-1,-1);break}else return;default:(r||Dm(e,"shiftKey"))&&this._typeahead?.handleKey(e);return}this._typeahead?.reset(),e.preventDefault()}get activeItemIndex(){return this._activeItemIndex()}get activeItem(){return this._activeItem()}isTyping(){return!!this._typeahead&&this._typeahead.isTyping()}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._getItemsArray().length-1,-1)}setNextItemActive(){this._activeItemIndex()<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex()<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(e){let t=this._getItemsArray(),n=typeof e=="number"?e:t.indexOf(e),r=t[n];this._activeItem.set(r??null),this._activeItemIndex.set(n),this._typeahead?.setCurrentSelectedItemIndex(n)}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._effectRef?.destroy(),this._typeahead?.destroy(),this.tabOut.complete(),this.change.complete()}_setActiveItemByDelta(e){this._wrap?this._setActiveInWrapMode(e):this._setActiveInDefaultMode(e)}_setActiveInWrapMode(e){let t=this._getItemsArray();for(let n=1;n<=t.length;n++){let r=(this._activeItemIndex()+e*n+t.length)%t.length,o=t[r];if(!this._skipPredicateFn(o)){this.setActiveItem(r);return}}}_setActiveInDefaultMode(e){this._setActiveItemByIndex(this._activeItemIndex()+e,e)}_setActiveItemByIndex(e,t){let n=this._getItemsArray();if(n[e]){for(;this._skipPredicateFn(n[e]);)if(e+=t,!n[e])return;this.setActiveItem(e)}}_getItemsArray(){return lf(this._items)?this._items():this._items instanceof $s?this._items.toArray():this._items}_itemsChanged(e){this._typeahead?.setItems(e);let t=this._activeItem();if(t){let n=e.indexOf(t);n>-1&&n!==this._activeItemIndex()&&(this._activeItemIndex.set(n),this._typeahead?.setCurrentSelectedItemIndex(n))}}};var Qv=class extends dR{_origin="program";setFocusOrigin(e){return this._origin=e,this}setActiveItem(e){super.setActiveItem(e),this.activeItem&&this.activeItem.focus(this._origin)}};var ioe=new me("cdk-dir-doc",{providedIn:"root",factory:roe});function roe(){return S(kt)}var ooe=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function qz(i){let e=i?.toLowerCase()||"";return e==="auto"&&typeof navigator<"u"&&navigator?.language?ooe.test(navigator.language)?"rtl":"ltr":e==="rtl"?"rtl":"ltr"}var Lu=(()=>{class i{get value(){return this.valueSignal()}valueSignal=Vn("ltr");change=new dt;constructor(){let t=S(ioe,{optional:!0});if(t){let n=t.body?t.body.dir:null,r=t.documentElement?t.documentElement.dir:null;this.valueSignal.set(qz(n||r||"ltr"))}}ngOnDestroy(){this.change.complete()}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var eF=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Mn({type:i});static \u0275inj=xn({})}return i})();var wl=(()=>{class i{constructor(){S(QP)._applyBodyHighContrastModeCssClasses()}static \u0275fac=function(n){return new(n||i)};static \u0275mod=Mn({type:i});static \u0275inj=xn({imports:[eF,eF]})}return i})();var soe=["*"];var aoe=new me("MAT_CARD_CONFIG"),Xz=(()=>{class i{appearance;constructor(){let t=S(aoe,{optional:!0});this.appearance=t?.appearance||"raised"}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=O({type:i,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:8,hostBindings:function(n,r){n&2&&sn("mat-mdc-card-outlined",r.appearance==="outlined")("mdc-card--outlined",r.appearance==="outlined")("mat-mdc-card-filled",r.appearance==="filled")("mdc-card--filled",r.appearance==="filled")},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:soe,decls:1,vars:0,template:function(n,r){n&1&&(ie(),Q(0))},styles:[`.mat-mdc-card{display:flex;flex-direction:column;box-sizing:border-box;position:relative;border-style:solid;border-width:0;background-color:var(--mat-card-elevated-container-color, var(--mat-sys-surface-container-low));border-color:var(--mat-card-elevated-container-color, var(--mat-sys-surface-container-low));border-radius:var(--mat-card-elevated-container-shape, var(--mat-sys-corner-medium));box-shadow:var(--mat-card-elevated-container-elevation, var(--mat-sys-level1))}.mat-mdc-card::after{position:absolute;top:0;left:0;width:100%;height:100%;border:solid 1px rgba(0,0,0,0);content:"";display:block;pointer-events:none;box-sizing:border-box;border-radius:var(--mat-card-elevated-container-shape, var(--mat-sys-corner-medium))}.mat-mdc-card-outlined{background-color:var(--mat-card-outlined-container-color, var(--mat-sys-surface));border-radius:var(--mat-card-outlined-container-shape, var(--mat-sys-corner-medium));border-width:var(--mat-card-outlined-outline-width, 1px);border-color:var(--mat-card-outlined-outline-color, var(--mat-sys-outline-variant));box-shadow:var(--mat-card-outlined-container-elevation, var(--mat-sys-level0))}.mat-mdc-card-outlined::after{border:none}.mat-mdc-card-filled{background-color:var(--mat-card-filled-container-color, var(--mat-sys-surface-container-highest));border-radius:var(--mat-card-filled-container-shape, var(--mat-sys-corner-medium));box-shadow:var(--mat-card-filled-container-elevation, var(--mat-sys-level0))}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mat-mdc-card-actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font, var(--mat-sys-title-large-font));line-height:var(--mat-card-title-text-line-height, var(--mat-sys-title-large-line-height));font-size:var(--mat-card-title-text-size, var(--mat-sys-title-large-size));letter-spacing:var(--mat-card-title-text-tracking, var(--mat-sys-title-large-tracking));font-weight:var(--mat-card-title-text-weight, var(--mat-sys-title-large-weight))}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color, var(--mat-sys-on-surface));font-family:var(--mat-card-subtitle-text-font, var(--mat-sys-title-medium-font));line-height:var(--mat-card-subtitle-text-line-height, var(--mat-sys-title-medium-line-height));font-size:var(--mat-card-subtitle-text-size, var(--mat-sys-title-medium-size));letter-spacing:var(--mat-card-subtitle-text-tracking, var(--mat-sys-title-medium-tracking));font-weight:var(--mat-card-subtitle-text-weight, var(--mat-sys-title-medium-weight))}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}
`],encapsulation:2,changeDetection:0})}return i})();var Zz=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"]})}return i})();var Yz=(()=>{class i{align="start";static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,selectors:[["mat-card-actions"]],hostAttrs:[1,"mat-mdc-card-actions","mdc-card__actions"],hostVars:2,hostBindings:function(n,r){n&2&&sn("mat-mdc-card-actions-align-end",r.align==="end")},inputs:{align:"align"},exportAs:["matCardActions"]})}return i})();var Qz=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Mn({type:i});static \u0275inj=xn({imports:[wl,wl]})}return i})();var tF=class{_box;_destroyed=new lt;_resizeSubject=new lt;_resizeObserver;_elementObservables=new Map;constructor(e){this._box=e,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(t=>this._resizeSubject.next(t)))}observe(e){return this._elementObservables.has(e)||this._elementObservables.set(e,new It(t=>{let n=this._resizeSubject.subscribe(t);return this._resizeObserver?.observe(e,{box:this._box}),()=>{this._resizeObserver?.unobserve(e),n.unsubscribe(),this._elementObservables.delete(e)}}).pipe(vn(t=>t.some(n=>n.target===e)),Ec({bufferSize:1,refCount:!0}),Pn(this._destroyed))),this._elementObservables.get(e)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}},Kz=(()=>{class i{_cleanupErrorListener;_observers=new Map;_ngZone=S(pt);constructor(){typeof ResizeObserver<"u"}ngOnDestroy(){for(let[,t]of this._observers)t.destroy();this._observers.clear(),this._cleanupErrorListener?.()}observe(t,n){let r=n?.box||"content-box";return this._observers.has(r)||this._observers.set(r,new tF(r)),this._observers.get(r).observe(t)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var Da=function(i){return i[i.NORMAL=0]="NORMAL",i[i.NEGATED=1]="NEGATED",i[i.INVERTED=2]="INVERTED",i}(Da||{}),hR,Bh;function Jz(){if(Bh==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return Bh=!1,Bh;if("scrollBehavior"in document.documentElement.style)Bh=!0;else{let i=Element.prototype.scrollTo;i?Bh=!/\{\s*\[native code\]\s*\}/.test(i.toString()):Bh=!1}}return Bh}function Im(){if(typeof document!="object"||!document)return Da.NORMAL;if(hR==null){let i=document.createElement("div"),e=i.style;i.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";let t=document.createElement("div"),n=t.style;n.width="2px",n.height="1px",i.appendChild(t),document.body.appendChild(i),hR=Da.NORMAL,i.scrollLeft===0&&(i.scrollLeft=1,hR=i.scrollLeft===0?Da.NEGATED:Da.INVERTED),i.remove()}return hR}var uoe=20,nF=(()=>{class i{_ngZone=S(pt);_platform=S(si);_renderer=S(Co).createRenderer(null,null);_cleanupGlobalListener;constructor(){}_scrolled=new lt;_scrolledCount=0;scrollContainers=new Map;register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){let n=this.scrollContainers.get(t);n&&(n.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=uoe){return this._platform.isBrowser?new It(n=>{this._cleanupGlobalListener||(this._cleanupGlobalListener=this._ngZone.runOutsideAngular(()=>this._renderer.listen("document","scroll",()=>this._scrolled.next())));let r=t>0?this._scrolled.pipe(H0(t)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||(this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0)}}):ut()}ngOnDestroy(){this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0,this.scrollContainers.forEach((t,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(t,n){let r=this.getAncestorScrollContainers(t);return this.scrolled(n).pipe(vn(o=>!o||r.indexOf(o)>-1))}getAncestorScrollContainers(t){let n=[];return this.scrollContainers.forEach((r,o)=>{this._scrollableContainsElement(o,t)&&n.push(o)}),n}_scrollableContainsElement(t,n){let r=js(n),o=t.getElementRef().nativeElement;do if(r==o)return!0;while(r=r.parentElement);return!1}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),ku=(()=>{class i{elementRef=S(vt);scrollDispatcher=S(nF);ngZone=S(pt);dir=S(Lu,{optional:!0});_scrollElement=this.elementRef.nativeElement;_destroyed=new lt;_renderer=S(Yi);_cleanupScroll;_elementScrolled=new lt;constructor(){}ngOnInit(){this._cleanupScroll=this.ngZone.runOutsideAngular(()=>this._renderer.listen(this._scrollElement,"scroll",t=>this._elementScrolled.next(t))),this.scrollDispatcher.register(this)}ngOnDestroy(){this._cleanupScroll?.(),this._elementScrolled.complete(),this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){let n=this.elementRef.nativeElement,r=this.dir&&this.dir.value=="rtl";t.left==null&&(t.left=r?t.end:t.start),t.right==null&&(t.right=r?t.start:t.end),t.bottom!=null&&(t.top=n.scrollHeight-n.clientHeight-t.bottom),r&&Im()!=Da.NORMAL?(t.left!=null&&(t.right=n.scrollWidth-n.clientWidth-t.left),Im()==Da.INVERTED?t.left=t.right:Im()==Da.NEGATED&&(t.left=t.right?-t.right:t.right)):t.right!=null&&(t.left=n.scrollWidth-n.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){let n=this.elementRef.nativeElement;Jz()?n.scrollTo(t):(t.top!=null&&(n.scrollTop=t.top),t.left!=null&&(n.scrollLeft=t.left))}measureScrollOffset(t){let n="left",r="right",o=this.elementRef.nativeElement;if(t=="top")return o.scrollTop;if(t=="bottom")return o.scrollHeight-o.clientHeight-o.scrollTop;let s=this.dir&&this.dir.value=="rtl";return t=="start"?t=s?r:n:t=="end"&&(t=s?n:r),s&&Im()==Da.INVERTED?t==n?o.scrollWidth-o.clientWidth-o.scrollLeft:o.scrollLeft:s&&Im()==Da.NEGATED?t==n?o.scrollLeft+o.scrollWidth-o.clientWidth:-o.scrollLeft:t==n?o.scrollLeft:o.scrollWidth-o.clientWidth-o.scrollLeft}static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]})}return i})(),doe=20,fR=(()=>{class i{_platform=S(si);_listeners;_viewportSize;_change=new lt;_document=S(kt);constructor(){let t=S(pt),n=S(Co).createRenderer(null,null);t.runOutsideAngular(()=>{if(this._platform.isBrowser){let r=o=>this._change.next(o);this._listeners=[n.listen("window","resize",r),n.listen("window","orientationchange",r)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(t=>t()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){let t=this.getViewportScrollPosition(),{width:n,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+n,height:r,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let t=this._document,n=this._getWindow(),r=t.documentElement,o=r.getBoundingClientRect(),s=-o.top||t.body.scrollTop||n.scrollY||r.scrollTop||0,a=-o.left||t.body.scrollLeft||n.scrollX||r.scrollLeft||0;return{top:s,left:a}}change(t=doe){return t>0?this._change.pipe(H0(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var hoe=new me("MATERIAL_ANIMATIONS");function Lo(){return S(hoe,{optional:!0})?.animationsDisabled||S(nE,{optional:!0})==="NoopAnimations"?!0:S(Rx).matchMedia("(prefers-reduced-motion)").matches}var Kv=class{_attachedHost;attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;e!=null&&(this._attachedHost=null,e.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(e){this._attachedHost=e}},iF=class extends Kv{component;viewContainerRef;injector;projectableNodes;constructor(e,t,n,r){super(),this.component=e,this.viewContainerRef=t,this.injector=n,this.projectableNodes=r}},Am=class extends Kv{templateRef;viewContainerRef;context;injector;constructor(e,t,n,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=n,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}},rF=class extends Kv{element;constructor(e){super(),this.element=e instanceof vt?e.nativeElement:e}},oF=class{_attachedPortal;_disposeFn;_isDisposed=!1;hasAttached(){return!!this._attachedPortal}attach(e){if(e instanceof iF)return this._attachedPortal=e,this.attachComponentPortal(e);if(e instanceof Am)return this._attachedPortal=e,this.attachTemplatePortal(e);if(this.attachDomPortal&&e instanceof rF)return this._attachedPortal=e,this.attachDomPortal(e)}attachDomPortal=null;detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}};var eH=(()=>{class i extends Am{constructor(){let t=S(To),n=S(Ur);super(t,n)}static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,selectors:[["","cdkPortal",""]],exportAs:["cdkPortal"],features:[$]})}return i})();var sF=(()=>{class i extends oF{_moduleRef=S(Wa,{optional:!0});_document=S(kt);_viewContainerRef=S(Ur);_isInitialized=!1;_attachedRef;constructor(){super()}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}attached=new dt;get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(t){t.setAttachedHost(this);let n=t.viewContainerRef!=null?t.viewContainerRef:this._viewContainerRef,r=n.createComponent(t.component,{index:n.length,injector:t.injector||n.injector,projectableNodes:t.projectableNodes||void 0,ngModuleRef:this._moduleRef||void 0});return n!==this._viewContainerRef&&this._getRootNode().appendChild(r.hostView.rootNodes[0]),super.setDisposeFn(()=>r.destroy()),this._attachedPortal=t,this._attachedRef=r,this.attached.emit(r),r}attachTemplatePortal(t){t.setAttachedHost(this);let n=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=n,this.attached.emit(n),n}attachDomPortal=t=>{let n=t.element;n.parentNode;let r=this._document.createComment("dom-portal");t.setAttachedHost(this),n.parentNode.insertBefore(r,n),this._getRootNode().appendChild(n),this._attachedPortal=t,super.setDisposeFn(()=>{r.parentNode&&r.parentNode.replaceChild(n,r)})};_getRootNode(){let t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[0,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[$]})}return i})();var Pm=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275cmp=O({type:i,selectors:[["structural-styles"]],decls:0,vars:0,template:function(n,r){},styles:[`.mat-focus-indicator{position:relative}.mat-focus-indicator::before{top:0;left:0;right:0;bottom:0;position:absolute;box-sizing:border-box;pointer-events:none;display:var(--mat-focus-indicator-display, none);border-width:var(--mat-focus-indicator-border-width, 3px);border-style:var(--mat-focus-indicator-border-style, solid);border-color:var(--mat-focus-indicator-border-color, transparent);border-radius:var(--mat-focus-indicator-border-radius, 4px)}.mat-focus-indicator:focus::before{content:""}@media(forced-colors: active){html{--mat-focus-indicator-display: block}}
`],encapsulation:2,changeDetection:0})}return i})();function ss(i){return i!=null&&`${i}`!="false"}var Os=function(i){return i[i.FADING_IN=0]="FADING_IN",i[i.VISIBLE=1]="VISIBLE",i[i.FADING_OUT=2]="FADING_OUT",i[i.HIDDEN=3]="HIDDEN",i}(Os||{}),aF=class{_renderer;element;config;_animationForciblyDisabledThroughCss;state=Os.HIDDEN;constructor(e,t,n,r=!1){this._renderer=e,this.element=t,this.config=n,this._animationForciblyDisabledThroughCss=r}fadeOut(){this._renderer.fadeOutRipple(this)}},tH=Em({passive:!0,capture:!0}),cF=class{_events=new Map;addHandler(e,t,n,r){let o=this._events.get(t);if(o){let s=o.get(n);s?s.add(r):o.set(n,new Set([r]))}else this._events.set(t,new Map([[n,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,tH)})}removeHandler(e,t,n){let r=this._events.get(e);if(!r)return;let o=r.get(t);o&&(o.delete(n),o.size===0&&r.delete(t),r.size===0&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,tH)))}_delegateEventHandler=e=>{let t=Ca(e);t&&this._events.get(e.type)?.forEach((n,r)=>{(r===t||r.contains(t))&&n.forEach(o=>o.handleEvent(e))})}},Jv={enterDuration:225,exitDuration:150},foe=800,nH=Em({passive:!0,capture:!0}),iH=["mousedown","touchstart"],rH=["mouseup","mouseleave","touchend","touchcancel"],poe=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275cmp=O({type:i,selectors:[["ng-component"]],hostAttrs:["mat-ripple-style-loader",""],decls:0,vars:0,template:function(n,r){},styles:[`.mat-ripple{overflow:hidden;position:relative}.mat-ripple:not(:empty){transform:translateZ(0)}.mat-ripple.mat-ripple-unbounded{overflow:visible}.mat-ripple-element{position:absolute;border-radius:50%;pointer-events:none;transition:opacity,transform 0ms cubic-bezier(0, 0, 0.2, 1);transform:scale3d(0, 0, 0);background-color:var(--mat-ripple-color, color-mix(in srgb, var(--mat-sys-on-surface) 10%, transparent))}@media(forced-colors: active){.mat-ripple-element{display:none}}.cdk-drag-preview .mat-ripple-element,.cdk-drag-placeholder .mat-ripple-element{display:none}
`],encapsulation:2,changeDetection:0})}return i})(),Uh=class i{_target;_ngZone;_platform;_containerElement;_triggerElement;_isPointerDown=!1;_activeRipples=new Map;_mostRecentTransientRipple;_lastTouchStartEvent;_pointerUpEventsRegistered=!1;_containerRect;static _eventManager=new cF;constructor(e,t,n,r,o){this._target=e,this._ngZone=t,this._platform=r,r.isBrowser&&(this._containerElement=js(n)),o&&o.get(Ea).load(poe)}fadeInRipple(e,t,n={}){let r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),o=ae(ae({},Jv),n.animation);n.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);let s=n.radius||moe(e,t,r),a=e-r.left,c=t-r.top,l=o.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=`${a-s}px`,u.style.top=`${c-s}px`,u.style.height=`${s*2}px`,u.style.width=`${s*2}px`,n.color!=null&&(u.style.backgroundColor=n.color),u.style.transitionDuration=`${l}ms`,this._containerElement.appendChild(u);let d=window.getComputedStyle(u),h=d.transitionProperty,f=d.transitionDuration,g=h==="none"||f==="0s"||f==="0s, 0s"||r.width===0&&r.height===0,_=new aF(this,u,n,g);u.style.transform="scale3d(1, 1, 1)",_.state=Os.FADING_IN,n.persistent||(this._mostRecentTransientRipple=_);let m=null;return!g&&(l||o.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let p=()=>{m&&(m.fallbackTimer=null),clearTimeout(v),this._finishRippleTransition(_)},b=()=>this._destroyRipple(_),v=setTimeout(b,l+100);u.addEventListener("transitionend",p),u.addEventListener("transitioncancel",b),m={onTransitionEnd:p,onTransitionCancel:b,fallbackTimer:v}}),this._activeRipples.set(_,m),(g||!l)&&this._finishRippleTransition(_),_}fadeOutRipple(e){if(e.state===Os.FADING_OUT||e.state===Os.HIDDEN)return;let t=e.element,n=ae(ae({},Jv),e.config.animation);t.style.transitionDuration=`${n.exitDuration}ms`,t.style.opacity="0",e.state=Os.FADING_OUT,(e._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){let t=js(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,iH.forEach(n=>{i._eventManager.addHandler(this._ngZone,n,t,this)}))}handleEvent(e){e.type==="mousedown"?this._onMousedown(e):e.type==="touchstart"?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{rH.forEach(t=>{this._triggerElement.addEventListener(t,this,nH)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===Os.FADING_IN?this._startFadeOutTransition(e):e.state===Os.FADING_OUT&&this._destroyRipple(e)}_startFadeOutTransition(e){let t=e===this._mostRecentTransientRipple,{persistent:n}=e.config;e.state=Os.VISIBLE,!n&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){let t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=Os.HIDDEN,t!==null&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel),t.fallbackTimer!==null&&clearTimeout(t.fallbackTimer)),e.element.remove()}_onMousedown(e){let t=qv(e),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+foe;!this._target.rippleDisabled&&!t&&!n&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!Xv(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let t=e.changedTouches;if(t)for(let n=0;n<t.length;n++)this.fadeInRipple(t[n].clientX,t[n].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{let t=e.state===Os.VISIBLE||e.config.terminateOnPointerUp&&e.state===Os.FADING_IN;!e.config.persistent&&t&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let e=this._triggerElement;e&&(iH.forEach(t=>i._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&(rH.forEach(t=>e.removeEventListener(t,this,nH)),this._pointerUpEventsRegistered=!1))}};function moe(i,e,t){let n=Math.max(Math.abs(i-t.left),Math.abs(i-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(n*n+r*r)}var Fm=new me("mat-ripple-global-options"),lF=(()=>{class i{_elementRef=S(vt);_animationsDisabled=Lo();color;unbounded;centered;radius=0;animation;get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}_disabled=!1;get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}_trigger;_rippleRenderer;_globalOptions;_isInitialized=!1;constructor(){let t=S(pt),n=S(si),r=S(Fm,{optional:!0}),o=S(yn);this._globalOptions=r||{},this._rippleRenderer=new Uh(this,t,this._elementRef,n,o)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:ae(ae(ae({},this._globalOptions.animation),this._animationsDisabled?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,n=0,r){return typeof t=="number"?this._rippleRenderer.fadeInRipple(t,n,ae(ae({},this.rippleConfig),r)):this._rippleRenderer.fadeInRipple(0,0,ae(ae({},this.rippleConfig),t))}static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(n,r){n&2&&sn("mat-ripple-unbounded",r.unbounded)},inputs:{color:[0,"matRippleColor","color"],unbounded:[0,"matRippleUnbounded","unbounded"],centered:[0,"matRippleCentered","centered"],radius:[0,"matRippleRadius","radius"],animation:[0,"matRippleAnimation","animation"],disabled:[0,"matRippleDisabled","disabled"],trigger:[0,"matRippleTrigger","trigger"]},exportAs:["matRipple"]})}return i})();var pF=["*"];function boe(i,e){i&1&&Q(0)}var voe=["tabListContainer"],yoe=["tabList"],xoe=["tabListInner"],woe=["nextPaginator"],Moe=["previousPaginator"],Soe=["content"];function Roe(i,e){}var Toe=["tabBodyWrapper"],Coe=["tabHeader"];function Eoe(i,e){}function Doe(i,e){if(i&1&&fs(0,Eoe,0,0,"ng-template",12),i&2){let t=$t().$implicit;N("cdkPortalOutlet",t.templateLabel)}}function Ioe(i,e){if(i&1&&Vt(0),i&2){let t=$t().$implicit;Sf(t.textLabel)}}function Aoe(i,e){if(i&1){let t=en();B(0,"div",7,2),Ie("click",function(){let r=rt(t),o=r.$implicit,s=r.$index,a=$t(),c=Ft(1);return ot(a._handleClick(o,c,s))})("cdkFocusChange",function(r){let o=rt(t).$index,s=$t();return ot(s._tabFocusChanged(r,o))}),ne(2,"span",8)(3,"div",9),B(4,"span",10)(5,"span",11),Vi(6,Doe,1,1,null,12)(7,Ioe,1,1),X()()()}if(i&2){let t=e.$implicit,n=e.$index,r=Ft(1),o=$t();Xs(t.labelClass),sn("mdc-tab--active",o.selectedIndex===n),N("id",o._getTabLabelId(t,n))("disabled",t.disabled)("fitInkBarToContent",o.fitInkBarToContent),oi("tabIndex",o._getTabIndex(n))("aria-posinset",n+1)("aria-setsize",o._tabs.length)("aria-controls",o._getTabContentId(n))("aria-selected",o.selectedIndex===n)("aria-label",t.ariaLabel||null)("aria-labelledby",!t.ariaLabel&&t.ariaLabelledby?t.ariaLabelledby:null),F(3),N("matRippleTrigger",r)("matRippleDisabled",t.disabled||o.disableRipple),F(3),zi(t.templateLabel?6:7)}}function Poe(i,e){i&1&&Q(0)}function Foe(i,e){if(i&1){let t=en();B(0,"mat-tab-body",13),Ie("_onCentered",function(){rt(t);let r=$t();return ot(r._removeTabBodyWrapperHeight())})("_onCentering",function(r){rt(t);let o=$t();return ot(o._setTabBodyWrapperHeight(r))})("_beforeCentering",function(r){rt(t);let o=$t();return ot(o._bodyCentered(r))}),X()}if(i&2){let t=e.$implicit,n=e.$index,r=$t();Xs(t.bodyClass),N("id",r._getTabContentId(n))("content",t.content)("position",t.position)("animationDuration",r.animationDuration)("preserveContent",r.preserveContent),oi("tabindex",r.contentTabIndex!=null&&r.selectedIndex===n?r.contentTabIndex:null)("aria-labelledby",r._getTabLabelId(t,n))("aria-hidden",r.selectedIndex!==n)}}var Noe=new me("MatTabContent"),joe=(()=>{class i{template=S(To);constructor(){}static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,selectors:[["","matTabContent",""]],features:[K([{provide:Noe,useExisting:i}])]})}return i})(),Ooe=new me("MatTabLabel"),cH=new me("MAT_TAB"),Loe=(()=>{class i extends eH{_closestTab=S(cH,{optional:!0});static \u0275fac=(()=>{let t;return function(r){return(t||(t=q(i)))(r||i)}})();static \u0275dir=Ge({type:i,selectors:[["","mat-tab-label",""],["","matTabLabel",""]],features:[K([{provide:Ooe,useExisting:i}]),$]})}return i})(),lH=new me("MAT_TAB_GROUP"),mF=(()=>{class i{_viewContainerRef=S(Ur);_closestTabGroup=S(lH,{optional:!0});disabled=!1;get templateLabel(){return this._templateLabel}set templateLabel(t){this._setTemplateLabelInput(t)}_templateLabel;_explicitContent=void 0;_implicitContent;textLabel="";ariaLabel;ariaLabelledby;labelClass;bodyClass;id=null;_contentPortal=null;get content(){return this._contentPortal}_stateChanges=new lt;position=null;origin=null;isActive=!1;constructor(){S(Ea).load(Pm)}ngOnChanges(t){(t.hasOwnProperty("textLabel")||t.hasOwnProperty("disabled"))&&this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}ngOnInit(){this._contentPortal=new Am(this._explicitContent||this._implicitContent,this._viewContainerRef)}_setTemplateLabelInput(t){t&&t._closestTab===this&&(this._templateLabel=t)}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=O({type:i,selectors:[["mat-tab"]],contentQueries:function(n,r,o){if(n&1&&(xi(o,Loe,5),xi(o,joe,7,To)),n&2){let s;st(s=at())&&(r.templateLabel=s.first),st(s=at())&&(r._explicitContent=s.first)}},viewQuery:function(n,r){if(n&1&&tn(To,7),n&2){let o;st(o=at())&&(r._implicitContent=o.first)}},hostAttrs:["hidden",""],hostVars:1,hostBindings:function(n,r){n&2&&oi("id",null)},inputs:{disabled:[2,"disabled","disabled",On],textLabel:[0,"label","textLabel"],ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],labelClass:"labelClass",bodyClass:"bodyClass",id:"id"},exportAs:["matTab"],features:[K([{provide:cH,useExisting:i}]),$i],ngContentSelectors:pF,decls:1,vars:0,template:function(n,r){n&1&&(ie(),Qy(0,boe,1,0,"ng-template"))},encapsulation:2})}return i})(),uF="mdc-tab-indicator--active",oH="mdc-tab-indicator--no-transition",dF=class{_items;_currentItem;constructor(e){this._items=e}hide(){this._items.forEach(e=>e.deactivateInkBar()),this._currentItem=void 0}alignToElement(e){let t=this._items.find(r=>r.elementRef.nativeElement===e),n=this._currentItem;if(t!==n&&(n?.deactivateInkBar(),t)){let r=n?.elementRef.nativeElement.getBoundingClientRect?.();t.activateInkBar(r),this._currentItem=t}}},koe=(()=>{class i{_elementRef=S(vt);_inkBarElement;_inkBarContentElement;_fitToContent=!1;get fitInkBarToContent(){return this._fitToContent}set fitInkBarToContent(t){this._fitToContent!==t&&(this._fitToContent=t,this._inkBarElement&&this._appendInkBarElement())}activateInkBar(t){let n=this._elementRef.nativeElement;if(!t||!n.getBoundingClientRect||!this._inkBarContentElement){n.classList.add(uF);return}let r=n.getBoundingClientRect(),o=t.width/r.width,s=t.left-r.left;n.classList.add(oH),this._inkBarContentElement.style.setProperty("transform",`translateX(${s}px) scaleX(${o})`),n.getBoundingClientRect(),n.classList.remove(oH),n.classList.add(uF),this._inkBarContentElement.style.setProperty("transform","")}deactivateInkBar(){this._elementRef.nativeElement.classList.remove(uF)}ngOnInit(){this._createInkBarElement()}ngOnDestroy(){this._inkBarElement?.remove(),this._inkBarElement=this._inkBarContentElement=null}_createInkBarElement(){let t=this._elementRef.nativeElement.ownerDocument||document,n=this._inkBarElement=t.createElement("span"),r=this._inkBarContentElement=t.createElement("span");n.className="mdc-tab-indicator",r.className="mdc-tab-indicator__content mdc-tab-indicator__content--underline",n.appendChild(this._inkBarContentElement),this._appendInkBarElement()}_appendInkBarElement(){this._inkBarElement;let t=this._fitToContent?this._elementRef.nativeElement.querySelector(".mdc-tab__content"):this._elementRef.nativeElement;t.appendChild(this._inkBarElement)}static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,inputs:{fitInkBarToContent:[2,"fitInkBarToContent","fitInkBarToContent",On]}})}return i})();var uH=(()=>{class i extends koe{elementRef=S(vt);disabled=!1;focus(){this.elementRef.nativeElement.focus()}getOffsetLeft(){return this.elementRef.nativeElement.offsetLeft}getOffsetWidth(){return this.elementRef.nativeElement.offsetWidth}static \u0275fac=(()=>{let t;return function(r){return(t||(t=q(i)))(r||i)}})();static \u0275dir=Ge({type:i,selectors:[["","matTabLabelWrapper",""]],hostVars:3,hostBindings:function(n,r){n&2&&(oi("aria-disabled",!!r.disabled),sn("mat-mdc-tab-disabled",r.disabled))},inputs:{disabled:[2,"disabled","disabled",On]},features:[$]})}return i})(),sH={passive:!0},Boe=650,Uoe=100,Voe=(()=>{class i{_elementRef=S(vt);_changeDetectorRef=S(Ni);_viewportRuler=S(fR);_dir=S(Lu,{optional:!0});_ngZone=S(pt);_platform=S(si);_sharedResizeObserver=S(Kz);_injector=S(yn);_renderer=S(Yi);_animationsDisabled=Lo();_eventCleanups;_scrollDistance=0;_selectedIndexChanged=!1;_destroyed=new lt;_showPaginationControls=!1;_disableScrollAfter=!0;_disableScrollBefore=!0;_tabLabelCount;_scrollDistanceChanged;_keyManager;_currentTextContent;_stopScrolling=new lt;disablePagination=!1;get selectedIndex(){return this._selectedIndex}set selectedIndex(t){let n=isNaN(t)?0:t;this._selectedIndex!=n&&(this._selectedIndexChanged=!0,this._selectedIndex=n,this._keyManager&&this._keyManager.updateActiveItem(n))}_selectedIndex=0;selectFocusedIndex=new dt;indexFocused=new dt;constructor(){this._eventCleanups=this._ngZone.runOutsideAngular(()=>[this._renderer.listen(this._elementRef.nativeElement,"mouseleave",()=>this._stopInterval())])}ngAfterViewInit(){this._eventCleanups.push(this._renderer.listen(this._previousPaginator.nativeElement,"touchstart",()=>this._handlePaginatorPress("before"),sH),this._renderer.listen(this._nextPaginator.nativeElement,"touchstart",()=>this._handlePaginatorPress("after"),sH))}ngAfterContentInit(){let t=this._dir?this._dir.change:ut("ltr"),n=this._sharedResizeObserver.observe(this._elementRef.nativeElement).pipe(Us(32),Pn(this._destroyed)),r=this._viewportRuler.change(150).pipe(Pn(this._destroyed)),o=()=>{this.updatePagination(),this._alignInkBarToSelectedTab()};this._keyManager=new Qv(this._items).withHorizontalOrientation(this._getLayoutDirection()).withHomeAndEnd().withWrap().skipPredicate(()=>!1),this._keyManager.updateActiveItem(Math.max(this._selectedIndex,0)),co(o,{injector:this._injector}),Tc(t,r,n,this._items.changes,this._itemsResized()).pipe(Pn(this._destroyed)).subscribe(()=>{this._ngZone.run(()=>{Promise.resolve().then(()=>{this._scrollDistance=Math.max(0,Math.min(this._getMaxScrollDistance(),this._scrollDistance)),o()})}),this._keyManager?.withHorizontalOrientation(this._getLayoutDirection())}),this._keyManager.change.subscribe(s=>{this.indexFocused.emit(s),this._setTabFocus(s)})}_itemsResized(){return typeof ResizeObserver!="function"?Ti:this._items.changes.pipe(Uo(this._items),Ui(t=>new It(n=>this._ngZone.runOutsideAngular(()=>{let r=new ResizeObserver(o=>n.next(o));return t.forEach(o=>r.observe(o.elementRef.nativeElement)),()=>{r.disconnect()}}))),Ju(1),vn(t=>t.some(n=>n.contentRect.width>0&&n.contentRect.height>0)))}ngAfterContentChecked(){this._tabLabelCount!=this._items.length&&(this.updatePagination(),this._tabLabelCount=this._items.length,this._changeDetectorRef.markForCheck()),this._selectedIndexChanged&&(this._scrollToLabel(this._selectedIndex),this._checkScrollingControls(),this._alignInkBarToSelectedTab(),this._selectedIndexChanged=!1,this._changeDetectorRef.markForCheck()),this._scrollDistanceChanged&&(this._updateTabScrollPosition(),this._scrollDistanceChanged=!1,this._changeDetectorRef.markForCheck())}ngOnDestroy(){this._eventCleanups.forEach(t=>t()),this._keyManager?.destroy(),this._destroyed.next(),this._destroyed.complete(),this._stopScrolling.complete()}_handleKeydown(t){if(!Dm(t))switch(t.keyCode){case 13:case 32:if(this.focusIndex!==this.selectedIndex){let n=this._items.get(this.focusIndex);n&&!n.disabled&&(this.selectFocusedIndex.emit(this.focusIndex),this._itemSelected(t))}break;default:this._keyManager?.onKeydown(t)}}_onContentChanges(){let t=this._elementRef.nativeElement.textContent;t!==this._currentTextContent&&(this._currentTextContent=t||"",this._ngZone.run(()=>{this.updatePagination(),this._alignInkBarToSelectedTab(),this._changeDetectorRef.markForCheck()}))}updatePagination(){this._checkPaginationEnabled(),this._checkScrollingControls(),this._updateTabScrollPosition()}get focusIndex(){return this._keyManager?this._keyManager.activeItemIndex:0}set focusIndex(t){!this._isValidIndex(t)||this.focusIndex===t||!this._keyManager||this._keyManager.setActiveItem(t)}_isValidIndex(t){return this._items?!!this._items.toArray()[t]:!0}_setTabFocus(t){if(this._showPaginationControls&&this._scrollToLabel(t),this._items&&this._items.length){this._items.toArray()[t].focus();let n=this._tabListContainer.nativeElement;this._getLayoutDirection()=="ltr"?n.scrollLeft=0:n.scrollLeft=n.scrollWidth-n.offsetWidth}}_getLayoutDirection(){return this._dir&&this._dir.value==="rtl"?"rtl":"ltr"}_updateTabScrollPosition(){if(this.disablePagination)return;let t=this.scrollDistance,n=this._getLayoutDirection()==="ltr"?-t:t;this._tabList.nativeElement.style.transform=`translateX(${Math.round(n)}px)`,(this._platform.TRIDENT||this._platform.EDGE)&&(this._tabListContainer.nativeElement.scrollLeft=0)}get scrollDistance(){return this._scrollDistance}set scrollDistance(t){this._scrollTo(t)}_scrollHeader(t){let n=this._tabListContainer.nativeElement.offsetWidth,r=(t=="before"?-1:1)*n/3;return this._scrollTo(this._scrollDistance+r)}_handlePaginatorClick(t){this._stopInterval(),this._scrollHeader(t)}_scrollToLabel(t){if(this.disablePagination)return;let n=this._items?this._items.toArray()[t]:null;if(!n)return;let r=this._tabListContainer.nativeElement.offsetWidth,{offsetLeft:o,offsetWidth:s}=n.elementRef.nativeElement,a,c;this._getLayoutDirection()=="ltr"?(a=o,c=a+s):(c=this._tabListInner.nativeElement.offsetWidth-o,a=c-s);let l=this.scrollDistance,u=this.scrollDistance+r;a<l?this.scrollDistance-=l-a:c>u&&(this.scrollDistance+=Math.min(c-u,a-l))}_checkPaginationEnabled(){if(this.disablePagination)this._showPaginationControls=!1;else{let t=this._tabListInner.nativeElement.scrollWidth,n=this._elementRef.nativeElement.offsetWidth,r=t-n>=5;r||(this.scrollDistance=0),r!==this._showPaginationControls&&(this._showPaginationControls=r,this._changeDetectorRef.markForCheck())}}_checkScrollingControls(){this.disablePagination?this._disableScrollAfter=this._disableScrollBefore=!0:(this._disableScrollBefore=this.scrollDistance==0,this._disableScrollAfter=this.scrollDistance==this._getMaxScrollDistance(),this._changeDetectorRef.markForCheck())}_getMaxScrollDistance(){let t=this._tabListInner.nativeElement.scrollWidth,n=this._tabListContainer.nativeElement.offsetWidth;return t-n||0}_alignInkBarToSelectedTab(){let t=this._items&&this._items.length?this._items.toArray()[this.selectedIndex]:null,n=t?t.elementRef.nativeElement:null;n?this._inkBar.alignToElement(n):this._inkBar.hide()}_stopInterval(){this._stopScrolling.next()}_handlePaginatorPress(t,n){n&&n.button!=null&&n.button!==0||(this._stopInterval(),Km(Boe,Uoe).pipe(Pn(Tc(this._stopScrolling,this._destroyed))).subscribe(()=>{let{maxScrollDistance:r,distance:o}=this._scrollHeader(t);(o===0||o>=r)&&this._stopInterval()}))}_scrollTo(t){if(this.disablePagination)return{maxScrollDistance:0,distance:0};let n=this._getMaxScrollDistance();return this._scrollDistance=Math.max(0,Math.min(n,t)),this._scrollDistanceChanged=!0,this._checkScrollingControls(),{maxScrollDistance:n,distance:this._scrollDistance}}static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,inputs:{disablePagination:[2,"disablePagination","disablePagination",On],selectedIndex:[2,"selectedIndex","selectedIndex",Id]},outputs:{selectFocusedIndex:"selectFocusedIndex",indexFocused:"indexFocused"}})}return i})(),zoe=(()=>{class i extends Voe{_items;_tabListContainer;_tabList;_tabListInner;_nextPaginator;_previousPaginator;_inkBar;ariaLabel;ariaLabelledby;disableRipple=!1;ngAfterContentInit(){this._inkBar=new dF(this._items),super.ngAfterContentInit()}_itemSelected(t){t.preventDefault()}static \u0275fac=(()=>{let t;return function(r){return(t||(t=q(i)))(r||i)}})();static \u0275cmp=O({type:i,selectors:[["mat-tab-header"]],contentQueries:function(n,r,o){if(n&1&&xi(o,uH,4),n&2){let s;st(s=at())&&(r._items=s)}},viewQuery:function(n,r){if(n&1&&(tn(voe,7),tn(yoe,7),tn(xoe,7),tn(woe,5),tn(Moe,5)),n&2){let o;st(o=at())&&(r._tabListContainer=o.first),st(o=at())&&(r._tabList=o.first),st(o=at())&&(r._tabListInner=o.first),st(o=at())&&(r._nextPaginator=o.first),st(o=at())&&(r._previousPaginator=o.first)}},hostAttrs:[1,"mat-mdc-tab-header"],hostVars:4,hostBindings:function(n,r){n&2&&sn("mat-mdc-tab-header-pagination-controls-enabled",r._showPaginationControls)("mat-mdc-tab-header-rtl",r._getLayoutDirection()=="rtl")},inputs:{ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],disableRipple:[2,"disableRipple","disableRipple",On]},features:[$],ngContentSelectors:pF,decls:13,vars:10,consts:[["previousPaginator",""],["tabListContainer",""],["tabList",""],["tabListInner",""],["nextPaginator",""],["mat-ripple","",1,"mat-mdc-tab-header-pagination","mat-mdc-tab-header-pagination-before",3,"click","mousedown","touchend","matRippleDisabled"],[1,"mat-mdc-tab-header-pagination-chevron"],[1,"mat-mdc-tab-label-container",3,"keydown"],["role","tablist",1,"mat-mdc-tab-list",3,"cdkObserveContent"],[1,"mat-mdc-tab-labels"],["mat-ripple","",1,"mat-mdc-tab-header-pagination","mat-mdc-tab-header-pagination-after",3,"mousedown","click","touchend","matRippleDisabled"]],template:function(n,r){if(n&1){let o=en();ie(),B(0,"div",5,0),Ie("click",function(){return rt(o),ot(r._handlePaginatorClick("before"))})("mousedown",function(a){return rt(o),ot(r._handlePaginatorPress("before",a))})("touchend",function(){return rt(o),ot(r._stopInterval())}),ne(2,"div",6),X(),B(3,"div",7,1),Ie("keydown",function(a){return rt(o),ot(r._handleKeydown(a))}),B(5,"div",8,2),Ie("cdkObserveContent",function(){return rt(o),ot(r._onContentChanges())}),B(7,"div",9,3),Q(9),X()()(),B(10,"div",10,4),Ie("mousedown",function(a){return rt(o),ot(r._handlePaginatorPress("after",a))})("click",function(){return rt(o),ot(r._handlePaginatorClick("after"))})("touchend",function(){return rt(o),ot(r._stopInterval())}),ne(12,"div",6),X()}n&2&&(sn("mat-mdc-tab-header-pagination-disabled",r._disableScrollBefore),N("matRippleDisabled",r._disableScrollBefore||r.disableRipple),F(3),sn("_mat-animation-noopable",r._animationsDisabled),F(2),oi("aria-label",r.ariaLabel||null)("aria-labelledby",r.ariaLabelledby||null),F(5),sn("mat-mdc-tab-header-pagination-disabled",r._disableScrollAfter),N("matRippleDisabled",r._disableScrollAfter||r.disableRipple))},dependencies:[lF,aR],styles:[`.mat-mdc-tab-header{display:flex;overflow:hidden;position:relative;flex-shrink:0}.mdc-tab-indicator .mdc-tab-indicator__content{transition-duration:var(--mat-tab-animation-duration, 250ms)}.mat-mdc-tab-header-pagination{-webkit-user-select:none;user-select:none;position:relative;display:none;justify-content:center;align-items:center;min-width:32px;cursor:pointer;z-index:2;-webkit-tap-highlight-color:rgba(0,0,0,0);touch-action:none;box-sizing:content-box;outline:0}.mat-mdc-tab-header-pagination::-moz-focus-inner{border:0}.mat-mdc-tab-header-pagination .mat-ripple-element{opacity:.12;background-color:var(--mat-tab-inactive-ripple-color, var(--mat-sys-on-surface))}.mat-mdc-tab-header-pagination-controls-enabled .mat-mdc-tab-header-pagination{display:flex}.mat-mdc-tab-header-pagination-before,.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-after{padding-left:4px}.mat-mdc-tab-header-pagination-before .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-after .mat-mdc-tab-header-pagination-chevron{transform:rotate(-135deg)}.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-before,.mat-mdc-tab-header-pagination-after{padding-right:4px}.mat-mdc-tab-header-rtl .mat-mdc-tab-header-pagination-before .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-header-pagination-after .mat-mdc-tab-header-pagination-chevron{transform:rotate(45deg)}.mat-mdc-tab-header-pagination-chevron{border-style:solid;border-width:2px 2px 0 0;height:8px;width:8px;border-color:var(--mat-tab-pagination-icon-color, var(--mat-sys-on-surface))}.mat-mdc-tab-header-pagination-disabled{box-shadow:none;cursor:default;pointer-events:none}.mat-mdc-tab-header-pagination-disabled .mat-mdc-tab-header-pagination-chevron{opacity:.4}.mat-mdc-tab-list{flex-grow:1;position:relative;transition:transform 500ms cubic-bezier(0.35, 0, 0.25, 1)}._mat-animation-noopable .mat-mdc-tab-list{transition:none}.mat-mdc-tab-label-container{display:flex;flex-grow:1;overflow:hidden;z-index:1;border-bottom-style:solid;border-bottom-width:var(--mat-tab-divider-height, 1px);border-bottom-color:var(--mat-tab-divider-color, var(--mat-sys-surface-variant))}.mat-mdc-tab-group-inverted-header .mat-mdc-tab-label-container{border-bottom:none;border-top-style:solid;border-top-width:var(--mat-tab-divider-height, 1px);border-top-color:var(--mat-tab-divider-color, var(--mat-sys-surface-variant))}.mat-mdc-tab-labels{display:flex;flex:1 0 auto}[mat-align-tabs=center]>.mat-mdc-tab-header .mat-mdc-tab-labels{justify-content:center}[mat-align-tabs=end]>.mat-mdc-tab-header .mat-mdc-tab-labels{justify-content:flex-end}.cdk-drop-list .mat-mdc-tab-labels,.mat-mdc-tab-labels.cdk-drop-list{min-height:var(--mat-tab-container-height, 48px)}.mat-mdc-tab::before{margin:5px}@media(forced-colors: active){.mat-mdc-tab[aria-disabled=true]{color:GrayText}}
`],encapsulation:2})}return i})(),Hoe=new me("MAT_TABS_CONFIG"),aH=(()=>{class i extends sF{_host=S(hF);_centeringSub=Rn.EMPTY;_leavingSub=Rn.EMPTY;constructor(){super()}ngOnInit(){super.ngOnInit(),this._centeringSub=this._host._beforeCentering.pipe(Uo(this._host._isCenterPosition())).subscribe(t=>{this._host._content&&t&&!this.hasAttached()&&this.attach(this._host._content)}),this._leavingSub=this._host._afterLeavingCenter.subscribe(()=>{this._host.preserveContent||this.detach()})}ngOnDestroy(){super.ngOnDestroy(),this._centeringSub.unsubscribe(),this._leavingSub.unsubscribe()}static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,selectors:[["","matTabBodyHost",""]],features:[$]})}return i})(),hF=(()=>{class i{_elementRef=S(vt);_dir=S(Lu,{optional:!0});_ngZone=S(pt);_injector=S(yn);_renderer=S(Yi);_diAnimationsDisabled=Lo();_eventCleanups;_initialized;_fallbackTimer;_positionIndex;_dirChangeSubscription=Rn.EMPTY;_position;_previousPosition;_onCentering=new dt;_beforeCentering=new dt;_afterLeavingCenter=new dt;_onCentered=new dt(!0);_portalHost;_contentElement;_content;animationDuration="500ms";preserveContent=!1;set position(t){this._positionIndex=t,this._computePositionAnimationState()}constructor(){if(this._dir){let t=S(Ni);this._dirChangeSubscription=this._dir.change.subscribe(n=>{this._computePositionAnimationState(n),t.markForCheck()})}}ngOnInit(){this._bindTransitionEvents(),this._position==="center"&&(this._setActiveClass(!0),co(()=>this._onCentering.emit(this._elementRef.nativeElement.clientHeight),{injector:this._injector})),this._initialized=!0}ngOnDestroy(){clearTimeout(this._fallbackTimer),this._eventCleanups?.forEach(t=>t()),this._dirChangeSubscription.unsubscribe()}_bindTransitionEvents(){this._ngZone.runOutsideAngular(()=>{let t=this._elementRef.nativeElement,n=r=>{r.target===this._contentElement?.nativeElement&&(this._elementRef.nativeElement.classList.remove("mat-tab-body-animating"),r.type==="transitionend"&&this._transitionDone())};this._eventCleanups=[this._renderer.listen(t,"transitionstart",r=>{r.target===this._contentElement?.nativeElement&&(this._elementRef.nativeElement.classList.add("mat-tab-body-animating"),this._transitionStarted())}),this._renderer.listen(t,"transitionend",n),this._renderer.listen(t,"transitioncancel",n)]})}_transitionStarted(){clearTimeout(this._fallbackTimer);let t=this._position==="center";this._beforeCentering.emit(t),t&&this._onCentering.emit(this._elementRef.nativeElement.clientHeight)}_transitionDone(){this._position==="center"?this._onCentered.emit():this._previousPosition==="center"&&this._afterLeavingCenter.emit()}_setActiveClass(t){this._elementRef.nativeElement.classList.toggle("mat-mdc-tab-body-active",t)}_getLayoutDirection(){return this._dir&&this._dir.value==="rtl"?"rtl":"ltr"}_isCenterPosition(){return this._positionIndex===0}_computePositionAnimationState(t=this._getLayoutDirection()){this._previousPosition=this._position,this._positionIndex<0?this._position=t=="ltr"?"left":"right":this._positionIndex>0?this._position=t=="ltr"?"right":"left":this._position="center",this._animationsDisabled()?this._simulateTransitionEvents():this._initialized&&(this._position==="center"||this._previousPosition==="center")&&(clearTimeout(this._fallbackTimer),this._fallbackTimer=this._ngZone.runOutsideAngular(()=>setTimeout(()=>this._simulateTransitionEvents(),100)))}_simulateTransitionEvents(){this._transitionStarted(),co(()=>this._transitionDone(),{injector:this._injector})}_animationsDisabled(){return this._diAnimationsDisabled||this.animationDuration==="0ms"||this.animationDuration==="0s"}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=O({type:i,selectors:[["mat-tab-body"]],viewQuery:function(n,r){if(n&1&&(tn(aH,5),tn(Soe,5)),n&2){let o;st(o=at())&&(r._portalHost=o.first),st(o=at())&&(r._contentElement=o.first)}},hostAttrs:[1,"mat-mdc-tab-body"],hostVars:1,hostBindings:function(n,r){n&2&&oi("inert",r._position==="center"?null:"")},inputs:{_content:[0,"content","_content"],animationDuration:"animationDuration",preserveContent:"preserveContent",position:"position"},outputs:{_onCentering:"_onCentering",_beforeCentering:"_beforeCentering",_onCentered:"_onCentered"},decls:3,vars:6,consts:[["content",""],["cdkScrollable","",1,"mat-mdc-tab-body-content"],["matTabBodyHost",""]],template:function(n,r){n&1&&(B(0,"div",1,0),fs(2,Roe,0,0,"ng-template",2),X()),n&2&&sn("mat-tab-body-content-left",r._position==="left")("mat-tab-body-content-right",r._position==="right")("mat-tab-body-content-can-animate",r._position==="center"||r._previousPosition==="center")},dependencies:[aH,ku],styles:[`.mat-mdc-tab-body{top:0;left:0;right:0;bottom:0;position:absolute;display:block;overflow:hidden;outline:0;flex-basis:100%}.mat-mdc-tab-body.mat-mdc-tab-body-active{position:relative;overflow-x:hidden;overflow-y:auto;z-index:1;flex-grow:1}.mat-mdc-tab-group.mat-mdc-tab-group-dynamic-height .mat-mdc-tab-body.mat-mdc-tab-body-active{overflow-y:hidden}.mat-mdc-tab-body-content{height:100%;overflow:auto;transform:none;visibility:hidden}.mat-tab-body-animating>.mat-mdc-tab-body-content,.mat-mdc-tab-body-active>.mat-mdc-tab-body-content{visibility:visible}.mat-mdc-tab-group-dynamic-height .mat-mdc-tab-body-content{overflow:hidden}.mat-tab-body-content-can-animate{transition:transform var(--mat-tab-animation-duration) 1ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-mdc-tab-body-wrapper._mat-animation-noopable .mat-tab-body-content-can-animate{transition:none}.mat-tab-body-content-left{transform:translate3d(-100%, 0, 0)}.mat-tab-body-content-right{transform:translate3d(100%, 0, 0)}
`],encapsulation:2})}return i})(),dH=(()=>{class i{_elementRef=S(vt);_changeDetectorRef=S(Ni);_ngZone=S(pt);_tabsSubscription=Rn.EMPTY;_tabLabelSubscription=Rn.EMPTY;_tabBodySubscription=Rn.EMPTY;_diAnimationsDisabled=Lo();_allTabs;_tabBodies;_tabBodyWrapper;_tabHeader;_tabs=new $s;_indexToSelect=0;_lastFocusedTabIndex=null;_tabBodyWrapperHeight=0;color;get fitInkBarToContent(){return this._fitInkBarToContent}set fitInkBarToContent(t){this._fitInkBarToContent=t,this._changeDetectorRef.markForCheck()}_fitInkBarToContent=!1;stretchTabs=!0;alignTabs=null;dynamicHeight=!1;get selectedIndex(){return this._selectedIndex}set selectedIndex(t){this._indexToSelect=isNaN(t)?null:t}_selectedIndex=null;headerPosition="above";get animationDuration(){return this._animationDuration}set animationDuration(t){let n=t+"";this._animationDuration=/^\d+$/.test(n)?t+"ms":n}_animationDuration;get contentTabIndex(){return this._contentTabIndex}set contentTabIndex(t){this._contentTabIndex=isNaN(t)?null:t}_contentTabIndex;disablePagination=!1;disableRipple=!1;preserveContent=!1;get backgroundColor(){return this._backgroundColor}set backgroundColor(t){let n=this._elementRef.nativeElement.classList;n.remove("mat-tabs-with-background",`mat-background-${this.backgroundColor}`),t&&n.add("mat-tabs-with-background",`mat-background-${t}`),this._backgroundColor=t}_backgroundColor;ariaLabel;ariaLabelledby;selectedIndexChange=new dt;focusChange=new dt;animationDone=new dt;selectedTabChange=new dt(!0);_groupId;_isServer=!S(si).isBrowser;constructor(){let t=S(Hoe,{optional:!0});this._groupId=S(JP).getId("mat-tab-group-"),this.animationDuration=t&&t.animationDuration?t.animationDuration:"500ms",this.disablePagination=t&&t.disablePagination!=null?t.disablePagination:!1,this.dynamicHeight=t&&t.dynamicHeight!=null?t.dynamicHeight:!1,t?.contentTabIndex!=null&&(this.contentTabIndex=t.contentTabIndex),this.preserveContent=!!t?.preserveContent,this.fitInkBarToContent=t&&t.fitInkBarToContent!=null?t.fitInkBarToContent:!1,this.stretchTabs=t&&t.stretchTabs!=null?t.stretchTabs:!0,this.alignTabs=t&&t.alignTabs!=null?t.alignTabs:null}ngAfterContentChecked(){let t=this._indexToSelect=this._clampTabIndex(this._indexToSelect);if(this._selectedIndex!=t){let n=this._selectedIndex==null;if(!n){this.selectedTabChange.emit(this._createChangeEvent(t));let r=this._tabBodyWrapper.nativeElement;r.style.minHeight=r.clientHeight+"px"}Promise.resolve().then(()=>{this._tabs.forEach((r,o)=>r.isActive=o===t),n||(this.selectedIndexChange.emit(t),this._tabBodyWrapper.nativeElement.style.minHeight="")})}this._tabs.forEach((n,r)=>{n.position=r-t,this._selectedIndex!=null&&n.position==0&&!n.origin&&(n.origin=t-this._selectedIndex)}),this._selectedIndex!==t&&(this._selectedIndex=t,this._lastFocusedTabIndex=null,this._changeDetectorRef.markForCheck())}ngAfterContentInit(){this._subscribeToAllTabChanges(),this._subscribeToTabLabels(),this._tabsSubscription=this._tabs.changes.subscribe(()=>{let t=this._clampTabIndex(this._indexToSelect);if(t===this._selectedIndex){let n=this._tabs.toArray(),r;for(let o=0;o<n.length;o++)if(n[o].isActive){this._indexToSelect=this._selectedIndex=o,this._lastFocusedTabIndex=null,r=n[o];break}!r&&n[t]&&Promise.resolve().then(()=>{n[t].isActive=!0,this.selectedTabChange.emit(this._createChangeEvent(t))})}this._changeDetectorRef.markForCheck()})}ngAfterViewInit(){this._tabBodySubscription=this._tabBodies.changes.subscribe(()=>this._bodyCentered(!0))}_subscribeToAllTabChanges(){this._allTabs.changes.pipe(Uo(this._allTabs)).subscribe(t=>{this._tabs.reset(t.filter(n=>n._closestTabGroup===this||!n._closestTabGroup)),this._tabs.notifyOnChanges()})}ngOnDestroy(){this._tabs.destroy(),this._tabsSubscription.unsubscribe(),this._tabLabelSubscription.unsubscribe(),this._tabBodySubscription.unsubscribe()}realignInkBar(){this._tabHeader&&this._tabHeader._alignInkBarToSelectedTab()}updatePagination(){this._tabHeader&&this._tabHeader.updatePagination()}focusTab(t){let n=this._tabHeader;n&&(n.focusIndex=t)}_focusChanged(t){this._lastFocusedTabIndex=t,this.focusChange.emit(this._createChangeEvent(t))}_createChangeEvent(t){let n=new fF;return n.index=t,this._tabs&&this._tabs.length&&(n.tab=this._tabs.toArray()[t]),n}_subscribeToTabLabels(){this._tabLabelSubscription&&this._tabLabelSubscription.unsubscribe(),this._tabLabelSubscription=Tc(...this._tabs.map(t=>t._stateChanges)).subscribe(()=>this._changeDetectorRef.markForCheck())}_clampTabIndex(t){return Math.min(this._tabs.length-1,Math.max(t||0,0))}_getTabLabelId(t,n){return t.id||`${this._groupId}-label-${n}`}_getTabContentId(t){return`${this._groupId}-content-${t}`}_setTabBodyWrapperHeight(t){if(!this.dynamicHeight||!this._tabBodyWrapperHeight){this._tabBodyWrapperHeight=t;return}let n=this._tabBodyWrapper.nativeElement;n.style.height=this._tabBodyWrapperHeight+"px",this._tabBodyWrapper.nativeElement.offsetHeight&&(n.style.height=t+"px")}_removeTabBodyWrapperHeight(){let t=this._tabBodyWrapper.nativeElement;this._tabBodyWrapperHeight=t.clientHeight,t.style.height="",this._ngZone.run(()=>this.animationDone.emit())}_handleClick(t,n,r){n.focusIndex=r,t.disabled||(this.selectedIndex=r)}_getTabIndex(t){let n=this._lastFocusedTabIndex??this.selectedIndex;return t===n?0:-1}_tabFocusChanged(t,n){t&&t!=="mouse"&&t!=="touch"&&(this._tabHeader.focusIndex=n)}_bodyCentered(t){t&&this._tabBodies?.forEach((n,r)=>n._setActiveClass(r===this._selectedIndex))}_animationsDisabled(){return this._diAnimationsDisabled||this.animationDuration==="0"||this.animationDuration==="0ms"}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=O({type:i,selectors:[["mat-tab-group"]],contentQueries:function(n,r,o){if(n&1&&xi(o,mF,5),n&2){let s;st(s=at())&&(r._allTabs=s)}},viewQuery:function(n,r){if(n&1&&(tn(Toe,5),tn(Coe,5),tn(hF,5)),n&2){let o;st(o=at())&&(r._tabBodyWrapper=o.first),st(o=at())&&(r._tabHeader=o.first),st(o=at())&&(r._tabBodies=o)}},hostAttrs:[1,"mat-mdc-tab-group"],hostVars:11,hostBindings:function(n,r){n&2&&(oi("mat-align-tabs",r.alignTabs),Xs("mat-"+(r.color||"primary")),qs("--mat-tab-animation-duration",r.animationDuration),sn("mat-mdc-tab-group-dynamic-height",r.dynamicHeight)("mat-mdc-tab-group-inverted-header",r.headerPosition==="below")("mat-mdc-tab-group-stretch-tabs",r.stretchTabs))},inputs:{color:"color",fitInkBarToContent:[2,"fitInkBarToContent","fitInkBarToContent",On],stretchTabs:[2,"mat-stretch-tabs","stretchTabs",On],alignTabs:[0,"mat-align-tabs","alignTabs"],dynamicHeight:[2,"dynamicHeight","dynamicHeight",On],selectedIndex:[2,"selectedIndex","selectedIndex",Id],headerPosition:"headerPosition",animationDuration:"animationDuration",contentTabIndex:[2,"contentTabIndex","contentTabIndex",Id],disablePagination:[2,"disablePagination","disablePagination",On],disableRipple:[2,"disableRipple","disableRipple",On],preserveContent:[2,"preserveContent","preserveContent",On],backgroundColor:"backgroundColor",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"]},outputs:{selectedIndexChange:"selectedIndexChange",focusChange:"focusChange",animationDone:"animationDone",selectedTabChange:"selectedTabChange"},exportAs:["matTabGroup"],features:[K([{provide:lH,useExisting:i}])],ngContentSelectors:pF,decls:9,vars:8,consts:[["tabHeader",""],["tabBodyWrapper",""],["tabNode",""],[3,"indexFocused","selectFocusedIndex","selectedIndex","disableRipple","disablePagination","aria-label","aria-labelledby"],["role","tab","matTabLabelWrapper","","cdkMonitorElementFocus","",1,"mdc-tab","mat-mdc-tab","mat-focus-indicator",3,"id","mdc-tab--active","class","disabled","fitInkBarToContent"],[1,"mat-mdc-tab-body-wrapper"],["role","tabpanel",3,"id","class","content","position","animationDuration","preserveContent"],["role","tab","matTabLabelWrapper","","cdkMonitorElementFocus","",1,"mdc-tab","mat-mdc-tab","mat-focus-indicator",3,"click","cdkFocusChange","id","disabled","fitInkBarToContent"],[1,"mdc-tab__ripple"],["mat-ripple","",1,"mat-mdc-tab-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mdc-tab__content"],[1,"mdc-tab__text-label"],[3,"cdkPortalOutlet"],["role","tabpanel",3,"_onCentered","_onCentering","_beforeCentering","id","content","position","animationDuration","preserveContent"]],template:function(n,r){if(n&1){let o=en();ie(),B(0,"mat-tab-header",3,0),Ie("indexFocused",function(a){return rt(o),ot(r._focusChanged(a))})("selectFocusedIndex",function(a){return rt(o),ot(r.selectedIndex=a)}),Ki(2,Aoe,8,17,"div",4,Qi),X(),Vi(4,Poe,1,0),B(5,"div",5,1),Ki(7,Foe,1,10,"mat-tab-body",6,Qi),X()}n&2&&(N("selectedIndex",r.selectedIndex||0)("disableRipple",r.disableRipple)("disablePagination",r.disablePagination)("aria-label",r.ariaLabel)("aria-labelledby",r.ariaLabelledby),F(2),Ji(r._tabs),F(2),zi(r._isServer?4:-1),F(),sn("_mat-animation-noopable",r._animationsDisabled()),F(2),Ji(r._tabs))},dependencies:[zoe,uH,XP,lF,sF,hF],styles:[`.mdc-tab{min-width:90px;padding:0 24px;display:flex;flex:1 0 auto;justify-content:center;box-sizing:border-box;border:none;outline:none;text-align:center;white-space:nowrap;cursor:pointer;z-index:1;touch-action:manipulation}.mdc-tab__content{display:flex;align-items:center;justify-content:center;height:inherit;pointer-events:none}.mdc-tab__text-label{transition:150ms color linear;display:inline-block;line-height:1;z-index:2}.mdc-tab--active .mdc-tab__text-label{transition-delay:100ms}._mat-animation-noopable .mdc-tab__text-label{transition:none}.mdc-tab-indicator{display:flex;position:absolute;top:0;left:0;justify-content:center;width:100%;height:100%;pointer-events:none;z-index:1}.mdc-tab-indicator__content{transition:var(--mat-tab-animation-duration, 250ms) transform cubic-bezier(0.4, 0, 0.2, 1);transform-origin:left;opacity:0}.mdc-tab-indicator__content--underline{align-self:flex-end;box-sizing:border-box;width:100%;border-top-style:solid}.mdc-tab-indicator--active .mdc-tab-indicator__content{opacity:1}._mat-animation-noopable .mdc-tab-indicator__content,.mdc-tab-indicator--no-transition .mdc-tab-indicator__content{transition:none}.mat-mdc-tab-ripple.mat-mdc-tab-ripple{position:absolute;top:0;left:0;bottom:0;right:0;pointer-events:none}.mat-mdc-tab{-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-decoration:none;background:none;height:var(--mat-tab-container-height, 48px);font-family:var(--mat-tab-label-text-font, var(--mat-sys-title-small-font));font-size:var(--mat-tab-label-text-size, var(--mat-sys-title-small-size));letter-spacing:var(--mat-tab-label-text-tracking, var(--mat-sys-title-small-tracking));line-height:var(--mat-tab-label-text-line-height, var(--mat-sys-title-small-line-height));font-weight:var(--mat-tab-label-text-weight, var(--mat-sys-title-small-weight))}.mat-mdc-tab.mdc-tab{flex-grow:0}.mat-mdc-tab .mdc-tab-indicator__content--underline{border-color:var(--mat-tab-active-indicator-color, var(--mat-sys-primary));border-top-width:var(--mat-tab-active-indicator-height, 2px);border-radius:var(--mat-tab-active-indicator-shape, 0)}.mat-mdc-tab:hover .mdc-tab__text-label{color:var(--mat-tab-inactive-hover-label-text-color, var(--mat-sys-on-surface))}.mat-mdc-tab:focus .mdc-tab__text-label{color:var(--mat-tab-inactive-focus-label-text-color, var(--mat-sys-on-surface))}.mat-mdc-tab.mdc-tab--active .mdc-tab__text-label{color:var(--mat-tab-active-label-text-color, var(--mat-sys-on-surface))}.mat-mdc-tab.mdc-tab--active .mdc-tab__ripple::before,.mat-mdc-tab.mdc-tab--active .mat-ripple-element{background-color:var(--mat-tab-active-ripple-color, var(--mat-sys-on-surface))}.mat-mdc-tab.mdc-tab--active:hover .mdc-tab__text-label{color:var(--mat-tab-active-hover-label-text-color, var(--mat-sys-on-surface))}.mat-mdc-tab.mdc-tab--active:hover .mdc-tab-indicator__content--underline{border-color:var(--mat-tab-active-hover-indicator-color, var(--mat-sys-primary))}.mat-mdc-tab.mdc-tab--active:focus .mdc-tab__text-label{color:var(--mat-tab-active-focus-label-text-color, var(--mat-sys-on-surface))}.mat-mdc-tab.mdc-tab--active:focus .mdc-tab-indicator__content--underline{border-color:var(--mat-tab-active-focus-indicator-color, var(--mat-sys-primary))}.mat-mdc-tab.mat-mdc-tab-disabled{opacity:.4;pointer-events:none}.mat-mdc-tab.mat-mdc-tab-disabled .mdc-tab__content{pointer-events:none}.mat-mdc-tab.mat-mdc-tab-disabled .mdc-tab__ripple::before,.mat-mdc-tab.mat-mdc-tab-disabled .mat-ripple-element{background-color:var(--mat-tab-disabled-ripple-color, var(--mat-sys-on-surface-variant))}.mat-mdc-tab .mdc-tab__ripple::before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;opacity:0;pointer-events:none;background-color:var(--mat-tab-inactive-ripple-color, var(--mat-sys-on-surface))}.mat-mdc-tab .mdc-tab__text-label{color:var(--mat-tab-inactive-label-text-color, var(--mat-sys-on-surface));display:inline-flex;align-items:center}.mat-mdc-tab .mdc-tab__content{position:relative;pointer-events:auto}.mat-mdc-tab:hover .mdc-tab__ripple::before{opacity:.04}.mat-mdc-tab.cdk-program-focused .mdc-tab__ripple::before,.mat-mdc-tab.cdk-keyboard-focused .mdc-tab__ripple::before{opacity:.12}.mat-mdc-tab .mat-ripple-element{opacity:.12;background-color:var(--mat-tab-inactive-ripple-color, var(--mat-sys-on-surface))}.mat-mdc-tab-group.mat-mdc-tab-group-stretch-tabs>.mat-mdc-tab-header .mat-mdc-tab{flex-grow:1}.mat-mdc-tab-group{display:flex;flex-direction:column;max-width:100%}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination{background-color:var(--mat-tab-background-color)}.mat-mdc-tab-group.mat-tabs-with-background.mat-primary>.mat-mdc-tab-header .mat-mdc-tab .mdc-tab__text-label{color:var(--mat-tab-foreground-color)}.mat-mdc-tab-group.mat-tabs-with-background.mat-primary>.mat-mdc-tab-header .mdc-tab-indicator__content--underline{border-color:var(--mat-tab-foreground-color)}.mat-mdc-tab-group.mat-tabs-with-background:not(.mat-primary)>.mat-mdc-tab-header .mat-mdc-tab:not(.mdc-tab--active) .mdc-tab__text-label{color:var(--mat-tab-foreground-color)}.mat-mdc-tab-group.mat-tabs-with-background:not(.mat-primary)>.mat-mdc-tab-header .mat-mdc-tab:not(.mdc-tab--active) .mdc-tab-indicator__content--underline{border-color:var(--mat-tab-foreground-color)}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-focus-indicator::before,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mat-focus-indicator::before{border-color:var(--mat-tab-foreground-color)}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-ripple-element,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mdc-tab__ripple::before,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mat-ripple-element,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mdc-tab__ripple::before{background-color:var(--mat-tab-foreground-color)}.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header .mat-mdc-tab-header-pagination-chevron,.mat-mdc-tab-group.mat-tabs-with-background>.mat-mdc-tab-header-pagination .mat-mdc-tab-header-pagination-chevron{color:var(--mat-tab-foreground-color)}.mat-mdc-tab-group.mat-mdc-tab-group-inverted-header{flex-direction:column-reverse}.mat-mdc-tab-group.mat-mdc-tab-group-inverted-header .mdc-tab-indicator__content--underline{align-self:flex-start}.mat-mdc-tab-body-wrapper{position:relative;overflow:hidden;display:flex;transition:height 500ms cubic-bezier(0.35, 0, 0.25, 1)}.mat-mdc-tab-body-wrapper._mat-animation-noopable{transition:none !important;animation:none !important}
`],encapsulation:2})}return i})(),fF=class{index;tab};var hH=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Mn({type:i});static \u0275inj=xn({imports:[wl,wl]})}return i})();var pR;function Woe(){if(pR===void 0&&(pR=null,typeof window<"u")){let i=window;i.trustedTypes!==void 0&&(pR=i.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return pR}function e0(i){return Woe()?.createHTML(i)||i}function fH(i){return Error(`Unable to find icon with the name "${i}"`)}function $oe(){return Error("Could not find HttpClient for use with Angular Material icons. Please add provideHttpClient() to your providers.")}function pH(i){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${i}".`)}function mH(i){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${i}".`)}var Ml=class{url;svgText;options;svgElement;constructor(e,t,n){this.url=e,this.svgText=t,this.options=n}},_H=(()=>{class i{_httpClient;_sanitizer;_errorHandler;_document;_svgIconConfigs=new Map;_iconSetConfigs=new Map;_cachedIconsByUrl=new Map;_inProgressUrlFetches=new Map;_fontCssClassesByAlias=new Map;_resolvers=[];_defaultFontSetClass=["material-icons","mat-ligature-font"];constructor(t,n,r,o){this._httpClient=t,this._sanitizer=n,this._errorHandler=o,this._document=r}addSvgIcon(t,n,r){return this.addSvgIconInNamespace("",t,n,r)}addSvgIconLiteral(t,n,r){return this.addSvgIconLiteralInNamespace("",t,n,r)}addSvgIconInNamespace(t,n,r,o){return this._addSvgIconConfig(t,n,new Ml(r,null,o))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,n,r,o){let s=this._sanitizer.sanitize(_r.HTML,r);if(!s)throw mH(r);let a=e0(s);return this._addSvgIconConfig(t,n,new Ml("",a,o))}addSvgIconSet(t,n){return this.addSvgIconSetInNamespace("",t,n)}addSvgIconSetLiteral(t,n){return this.addSvgIconSetLiteralInNamespace("",t,n)}addSvgIconSetInNamespace(t,n,r){return this._addSvgIconSetConfig(t,new Ml(n,null,r))}addSvgIconSetLiteralInNamespace(t,n,r){let o=this._sanitizer.sanitize(_r.HTML,n);if(!o)throw mH(n);let s=e0(o);return this._addSvgIconSetConfig(t,new Ml("",s,r))}registerFontClassAlias(t,n=t){return this._fontCssClassesByAlias.set(t,n),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){let n=this._sanitizer.sanitize(_r.RESOURCE_URL,t);if(!n)throw pH(t);let r=this._cachedIconsByUrl.get(n);return r?ut(mR(r)):this._loadSvgIconFromConfig(new Ml(t,null)).pipe(Kn(o=>this._cachedIconsByUrl.set(n,o)),tt(o=>mR(o)))}getNamedSvgIcon(t,n=""){let r=gH(n,t),o=this._svgIconConfigs.get(r);if(o)return this._getSvgFromConfig(o);if(o=this._getIconConfigFromResolvers(n,t),o)return this._svgIconConfigs.set(r,o),this._getSvgFromConfig(o);let s=this._iconSetConfigs.get(n);return s?this._getSvgFromIconSetConfigs(t,s):So(fH(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?ut(mR(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(tt(n=>mR(n)))}_getSvgFromIconSetConfigs(t,n){let r=this._extractIconWithNameFromAnySet(t,n);if(r)return ut(r);let o=n.filter(s=>!s.svgText).map(s=>this._loadSvgIconSetFromConfig(s).pipe(Br(a=>{let l=`Loading icon set URL: ${this._sanitizer.sanitize(_r.RESOURCE_URL,s.url)} failed: ${a.message}`;return this._errorHandler.handleError(new Error(l)),ut(null)})));return Ku(o).pipe(tt(()=>{let s=this._extractIconWithNameFromAnySet(t,n);if(!s)throw fH(t);return s}))}_extractIconWithNameFromAnySet(t,n){for(let r=n.length-1;r>=0;r--){let o=n[r];if(o.svgText&&o.svgText.toString().indexOf(t)>-1){let s=this._svgElementFromConfig(o),a=this._extractSvgIconFromSet(s,t,o.options);if(a)return a}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(Kn(n=>t.svgText=n),tt(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?ut(null):this._fetchIcon(t).pipe(Kn(n=>t.svgText=n))}_extractSvgIconFromSet(t,n,r){let o=t.querySelector(`[id="${n}"]`);if(!o)return null;let s=o.cloneNode(!0);if(s.removeAttribute("id"),s.nodeName.toLowerCase()==="svg")return this._setSvgAttributes(s,r);if(s.nodeName.toLowerCase()==="symbol")return this._setSvgAttributes(this._toSvgElement(s),r);let a=this._svgElementFromString(e0("<svg></svg>"));return a.appendChild(s),this._setSvgAttributes(a,r)}_svgElementFromString(t){let n=this._document.createElement("DIV");n.innerHTML=t;let r=n.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){let n=this._svgElementFromString(e0("<svg></svg>")),r=t.attributes;for(let o=0;o<r.length;o++){let{name:s,value:a}=r[o];s!=="id"&&n.setAttribute(s,a)}for(let o=0;o<t.childNodes.length;o++)t.childNodes[o].nodeType===this._document.ELEMENT_NODE&&n.appendChild(t.childNodes[o].cloneNode(!0));return n}_setSvgAttributes(t,n){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),n&&n.viewBox&&t.setAttribute("viewBox",n.viewBox),t}_fetchIcon(t){let{url:n,options:r}=t,o=r?.withCredentials??!1;if(!this._httpClient)throw $oe();if(n==null)throw Error(`Cannot fetch icon from URL "${n}".`);let s=this._sanitizer.sanitize(_r.RESOURCE_URL,n);if(!s)throw pH(n);let a=this._inProgressUrlFetches.get(s);if(a)return a;let c=this._httpClient.get(s,{responseType:"text",withCredentials:o}).pipe(tt(l=>e0(l)),ja(()=>this._inProgressUrlFetches.delete(s)),Jm());return this._inProgressUrlFetches.set(s,c),c}_addSvgIconConfig(t,n,r){return this._svgIconConfigs.set(gH(t,n),r),this}_addSvgIconSetConfig(t,n){let r=this._iconSetConfigs.get(t);return r?r.push(n):this._iconSetConfigs.set(t,[n]),this}_svgElementFromConfig(t){if(!t.svgElement){let n=this._svgElementFromString(t.svgText);this._setSvgAttributes(n,t.options),t.svgElement=n}return t.svgElement}_getIconConfigFromResolvers(t,n){for(let r=0;r<this._resolvers.length;r++){let o=this._resolvers[r](n,t);if(o)return qoe(o)?new Ml(o.url,null,o.options):new Ml(o,null)}}static \u0275fac=function(n){return new(n||i)(ht(Ff,8),ht(Jg),ht(kt,8),ht(Mr))};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function mR(i){return i.cloneNode(!0)}function gH(i,e){return i+":"+e}function qoe(i){return!!(i.url&&i.options)}var Xoe=["*"],Zoe=new me("MAT_ICON_DEFAULT_OPTIONS"),Yoe=new me("mat-icon-location",{providedIn:"root",factory:Qoe});function Qoe(){let i=S(kt),e=i?i.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}var bH=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],Koe=bH.map(i=>`[${i}]`).join(", "),Joe=/^url\(['"]?#(.*?)['"]?\)$/,gR=(()=>{class i{_elementRef=S(vt);_iconRegistry=S(_H);_location=S(Yoe);_errorHandler=S(Mr);_defaultColor;get color(){return this._color||this._defaultColor}set color(t){this._color=t}_color;inline=!1;get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}_svgIcon;get fontSet(){return this._fontSet}set fontSet(t){let n=this._cleanupFontValue(t);n!==this._fontSet&&(this._fontSet=n,this._updateFontIconClasses())}_fontSet;get fontIcon(){return this._fontIcon}set fontIcon(t){let n=this._cleanupFontValue(t);n!==this._fontIcon&&(this._fontIcon=n,this._updateFontIconClasses())}_fontIcon;_previousFontSetClass=[];_previousFontIconClass;_svgName;_svgNamespace;_previousPath;_elementsWithExternalReferences;_currentIconFetch=Rn.EMPTY;constructor(){let t=S(new Dd("aria-hidden"),{optional:!0}),n=S(Zoe,{optional:!0});n&&(n.color&&(this.color=this._defaultColor=n.color),n.fontSet&&(this.fontSet=n.fontSet)),t||this._elementRef.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(t){if(!t)return["",""];let n=t.split(":");switch(n.length){case 1:return["",n[0]];case 2:return n;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){let t=this._elementsWithExternalReferences;if(t&&t.size){let n=this._location.getPathname();n!==this._previousPath&&(this._previousPath=n,this._prependPathToReferences(n))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();let n=this._location.getPathname();this._previousPath=n,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(n),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){let t=this._elementRef.nativeElement,n=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();n--;){let r=t.childNodes[n];(r.nodeType!==1||r.nodeName.toLowerCase()==="svg")&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;let t=this._elementRef.nativeElement,n=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>t.classList.remove(r)),n.forEach(r=>t.classList.add(r)),this._previousFontSetClass=n,this.fontIcon!==this._previousFontIconClass&&!n.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return typeof t=="string"?t.trim().split(" ")[0]:t}_prependPathToReferences(t){let n=this._elementsWithExternalReferences;n&&n.forEach((r,o)=>{r.forEach(s=>{o.setAttribute(s.name,`url('${t}#${s.value}')`)})})}_cacheChildrenWithExternalReferences(t){let n=t.querySelectorAll(Koe),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let o=0;o<n.length;o++)bH.forEach(s=>{let a=n[o],c=a.getAttribute(s),l=c?c.match(Joe):null;if(l){let u=r.get(a);u||(u=[],r.set(a,u)),u.push({name:s,value:l[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){let[n,r]=this._splitIconName(t);n&&(this._svgNamespace=n),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,n).pipe(no(1)).subscribe(o=>this._setSvgElement(o),o=>{let s=`Error retrieving icon ${n}:${r}! ${o.message}`;this._errorHandler.handleError(new Error(s))})}}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=O({type:i,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(n,r){n&2&&(oi("data-mat-icon-type",r._usingFontIcon()?"font":"svg")("data-mat-icon-name",r._svgName||r.fontIcon)("data-mat-icon-namespace",r._svgNamespace||r.fontSet)("fontIcon",r._usingFontIcon()?r.fontIcon:null),Xs(r.color?"mat-"+r.color:""),sn("mat-icon-inline",r.inline)("mat-icon-no-color",r.color!=="primary"&&r.color!=="accent"&&r.color!=="warn"))},inputs:{color:"color",inline:[2,"inline","inline",On],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],ngContentSelectors:Xoe,decls:1,vars:0,template:function(n,r){n&1&&(ie(),Q(0))},styles:[`mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color, inherit)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}
`],encapsulation:2,changeDetection:0})}return i})(),vH=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Mn({type:i});static \u0275inj=xn({imports:[wl,wl]})}return i})();function yH(i){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!]))?/.test(i)}var tse=new me("GIST_OPTIONS");var nse=(()=>{let e=class e{constructor(){this._http=S(Ff),this._options=S(tse,{optional:!0})}getCodeFromGist(n){let r;return this._options?.clientId&&this._options?.clientSecret&&(r=new Ks().set("client_id",this._options.clientId).set("client_secret",this._options.clientSecret)),this.fetchFile(`https://api.github.com/gists/${n}`,{params:r,responseType:"json"})}getCodeFromUrl(n){return this.fetchFile(n,{responseType:"text"})}fetchFile(n,r){return yH(n)?this._http.get(n,r).pipe(Ec(1),Br(o=>(console.error("[NgxHighlight]: Unable to fetch the URL!",o.message),Ti))):Ti}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=ge({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var ise=new me("HIGHLIGHT_FILE_LOCATION",{providedIn:"root",factory:rse});function rse(){let i=S(kt)?.location;return{getPathname:()=>i?i.origin:""}}var xH=(()=>{let e=class e{constructor(){this._location=S(ise),this._loader=S(nse)}transform(n){return this._loader.getCodeFromUrl(yH(n)?n:`${this._location.getPathname()}/${n}`)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275pipe=$o({name:"codeFromUrl",type:e,pure:!0});let i=e;return i})(),wH=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Mn({type:e}),e.\u0275inj=xn({});let i=e;return i})();var sse={capture:!0},ase=["focus","mousedown","mouseenter","touchstart"],gF="mat-ripple-loader-uninitialized",_F="mat-ripple-loader-class-name",MH="mat-ripple-loader-centered",_R="mat-ripple-loader-disabled",SH=(()=>{class i{_document=S(kt);_animationsDisabled=Lo();_globalRippleOptions=S(Fm,{optional:!0});_platform=S(si);_ngZone=S(pt);_injector=S(yn);_eventCleanups;_hosts=new Map;constructor(){let t=S(Co).createRenderer(null,null);this._eventCleanups=this._ngZone.runOutsideAngular(()=>ase.map(n=>t.listen(this._document,n,this._onInteraction,sse)))}ngOnDestroy(){let t=this._hosts.keys();for(let n of t)this.destroyRipple(n);this._eventCleanups.forEach(n=>n())}configureRipple(t,n){t.setAttribute(gF,this._globalRippleOptions?.namespace??""),(n.className||!t.hasAttribute(_F))&&t.setAttribute(_F,n.className||""),n.centered&&t.setAttribute(MH,""),n.disabled&&t.setAttribute(_R,"")}setDisabled(t,n){let r=this._hosts.get(t);r?(r.target.rippleDisabled=n,!n&&!r.hasSetUpEvents&&(r.hasSetUpEvents=!0,r.renderer.setupTriggerEvents(t))):n?t.setAttribute(_R,""):t.removeAttribute(_R)}_onInteraction=t=>{let n=Ca(t);if(n instanceof HTMLElement){let r=n.closest(`[${gF}="${this._globalRippleOptions?.namespace??""}"]`);r&&this._createRipple(r)}};_createRipple(t){if(!this._document||this._hosts.has(t))return;t.querySelector(".mat-ripple")?.remove();let n=this._document.createElement("span");n.classList.add("mat-ripple",t.getAttribute(_F)),t.append(n);let r=this._globalRippleOptions,o=this._animationsDisabled?0:r?.animation?.enterDuration??Jv.enterDuration,s=this._animationsDisabled?0:r?.animation?.exitDuration??Jv.exitDuration,a={rippleDisabled:this._animationsDisabled||r?.disabled||t.hasAttribute(_R),rippleConfig:{centered:t.hasAttribute(MH),terminateOnPointerUp:r?.terminateOnPointerUp,animation:{enterDuration:o,exitDuration:s}}},c=new Uh(a,this._ngZone,n,this._platform,this._injector),l=!a.rippleDisabled;l&&c.setupTriggerEvents(t),this._hosts.set(t,{target:a,renderer:c,hasSetUpEvents:l}),t.removeAttribute(gF)}destroyRipple(t){let n=this._hosts.get(t);n&&(n.renderer._removeTriggerEvents(),this._hosts.delete(t))}static \u0275fac=function(n){return new(n||i)};static \u0275prov=ge({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var cse=new me("MAT_BUTTON_CONFIG");function RH(i){return i==null?void 0:Id(i)}var TH=(()=>{class i{_elementRef=S(vt);_ngZone=S(pt);_animationsDisabled=Lo();_config=S(cse,{optional:!0});_focusMonitor=S(kh);_cleanupClick;_renderer=S(Yi);_rippleLoader=S(SH);_isAnchor;_isFab=!1;color;get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=t,this._updateRippleDisabled()}_disableRipple=!1;get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._updateRippleDisabled()}_disabled=!1;ariaDisabled;disabledInteractive;tabIndex;set _tabindex(t){this.tabIndex=t}constructor(){S(Ea).load(Pm);let t=this._elementRef.nativeElement;this._isAnchor=t.tagName==="A",this.disabledInteractive=this._config?.disabledInteractive??!1,this.color=this._config?.color??null,this._rippleLoader?.configureRipple(t,{className:"mat-mdc-button-ripple"})}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0),this._isAnchor&&this._setupAsAnchor()}ngOnDestroy(){this._cleanupClick?.(),this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(t="program",n){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,n):this._elementRef.nativeElement.focus(n)}_getAriaDisabled(){return this.ariaDisabled!=null?this.ariaDisabled:this._isAnchor?this.disabled||null:this.disabled&&this.disabledInteractive?!0:null}_getDisabledAttribute(){return this.disabledInteractive||!this.disabled?null:!0}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}_getTabIndex(){return this._isAnchor?this.disabled&&!this.disabledInteractive?-1:this.tabIndex:this.tabIndex}_setupAsAnchor(){this._cleanupClick=this._ngZone.runOutsideAngular(()=>this._renderer.listen(this._elementRef.nativeElement,"click",t=>{this.disabled&&(t.preventDefault(),t.stopImmediatePropagation())}))}static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,hostAttrs:[1,"mat-mdc-button-base"],hostVars:13,hostBindings:function(n,r){n&2&&(oi("disabled",r._getDisabledAttribute())("aria-disabled",r._getAriaDisabled())("tabindex",r._getTabIndex()),Xs(r.color?"mat-"+r.color:""),sn("mat-mdc-button-disabled",r.disabled)("mat-mdc-button-disabled-interactive",r.disabledInteractive)("mat-unthemed",!r.color)("_mat-animation-noopable",r._animationsDisabled))},inputs:{color:"color",disableRipple:[2,"disableRipple","disableRipple",On],disabled:[2,"disabled","disabled",On],ariaDisabled:[2,"aria-disabled","ariaDisabled",On],disabledInteractive:[2,"disabledInteractive","disabledInteractive",On],tabIndex:[2,"tabIndex","tabIndex",RH],_tabindex:[2,"tabindex","_tabindex",RH]}})}return i})();var lse=["matButton",""],use=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],dse=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"];var CH=new Map([["text",["mat-mdc-button"]],["filled",["mdc-button--unelevated","mat-mdc-unelevated-button"]],["elevated",["mdc-button--raised","mat-mdc-raised-button"]],["outlined",["mdc-button--outlined","mat-mdc-outlined-button"]],["tonal",["mat-tonal-button"]]]),bR=(()=>{class i extends TH{get appearance(){return this._appearance}set appearance(t){this.setAppearance(t||this._config?.defaultAppearance||"text")}_appearance=null;constructor(){super();let t=hse(this._elementRef.nativeElement);t&&this.setAppearance(t)}setAppearance(t){if(t===this._appearance)return;let n=this._elementRef.nativeElement.classList,r=this._appearance?CH.get(this._appearance):null,o=CH.get(t);r&&n.remove(...r),n.add(...o),this._appearance=t}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=O({type:i,selectors:[["button","matButton",""],["a","matButton",""],["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""],["a","mat-button",""],["a","mat-raised-button",""],["a","mat-flat-button",""],["a","mat-stroked-button",""]],hostAttrs:[1,"mdc-button"],inputs:{appearance:[0,"matButton","appearance"]},exportAs:["matButton","matAnchor"],features:[$],attrs:lse,ngContentSelectors:dse,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(n,r){n&1&&(ie(use),Sd(0,"span",0),Q(1),wd(2,"span",1),Q(3,1),Md(),Q(4,2),Sd(5,"span",2)(6,"span",3)),n&2&&sn("mdc-button__ripple",!r._isFab)("mdc-fab__ripple",r._isFab)},styles:[`.mat-mdc-button-base{text-decoration:none}.mat-mdc-button-base .mat-icon{min-height:fit-content;flex-shrink:0}.mdc-button{-webkit-user-select:none;user-select:none;position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0);padding:0 8px}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__label{position:relative}.mat-mdc-button{padding:0 var(--mat-button-text-horizontal-padding, 12px);height:var(--mat-button-text-container-height, 40px);font-family:var(--mat-button-text-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-text-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-text-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-text-label-text-transform);font-weight:var(--mat-button-text-label-text-weight, var(--mat-sys-label-large-weight))}.mat-mdc-button,.mat-mdc-button .mdc-button__ripple{border-radius:var(--mat-button-text-container-shape, var(--mat-sys-corner-full))}.mat-mdc-button:not(:disabled){color:var(--mat-button-text-label-text-color, var(--mat-sys-primary))}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-text-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-button-text-with-icon-horizontal-padding, 16px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-button-text-icon-spacing, 8px);margin-left:var(--mat-button-text-icon-offset, -4px)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-button-text-icon-offset, -4px);margin-left:var(--mat-button-text-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-text-icon-offset, -4px);margin-left:var(--mat-button-text-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-text-icon-spacing, 8px);margin-left:var(--mat-button-text-icon-offset, -4px)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-button-text-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-text-state-layer-color, var(--mat-sys-primary))}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-text-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-text-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-text-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-text-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;display:var(--mat-button-text-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-unelevated-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-button-filled-container-height, 40px);font-family:var(--mat-button-filled-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-filled-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-filled-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-filled-label-text-transform);font-weight:var(--mat-button-filled-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-button-filled-horizontal-padding, 24px)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-button-filled-icon-spacing, 8px);margin-left:var(--mat-button-filled-icon-offset, -8px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-button-filled-icon-offset, -8px);margin-left:var(--mat-button-filled-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-filled-icon-offset, -8px);margin-left:var(--mat-button-filled-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-filled-icon-spacing, 8px);margin-left:var(--mat-button-filled-icon-offset, -8px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-button-filled-ripple-color, color-mix(in srgb, var(--mat-sys-on-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-filled-state-layer-color, var(--mat-sys-on-primary))}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-filled-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-unelevated-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-filled-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-unelevated-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-filled-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-unelevated-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-filled-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;display:var(--mat-button-filled-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mat-button-filled-label-text-color, var(--mat-sys-on-primary));background-color:var(--mat-button-filled-container-color, var(--mat-sys-primary))}.mat-mdc-unelevated-button,.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mat-button-filled-container-shape, var(--mat-sys-corner-full))}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-filled-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-button-filled-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);box-shadow:var(--mat-button-protected-container-elevation-shadow, var(--mat-sys-level1));height:var(--mat-button-protected-container-height, 40px);font-family:var(--mat-button-protected-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-protected-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-protected-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-protected-label-text-transform);font-weight:var(--mat-button-protected-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-button-protected-horizontal-padding, 24px)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-button-protected-icon-spacing, 8px);margin-left:var(--mat-button-protected-icon-offset, -8px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-button-protected-icon-offset, -8px);margin-left:var(--mat-button-protected-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-protected-icon-offset, -8px);margin-left:var(--mat-button-protected-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-protected-icon-spacing, 8px);margin-left:var(--mat-button-protected-icon-offset, -8px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-button-protected-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-protected-state-layer-color, var(--mat-sys-primary))}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-protected-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-raised-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-protected-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-raised-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-protected-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-raised-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-protected-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;display:var(--mat-button-protected-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-raised-button:not(:disabled){color:var(--mat-button-protected-label-text-color, var(--mat-sys-primary));background-color:var(--mat-button-protected-container-color, var(--mat-sys-surface))}.mat-mdc-raised-button,.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mat-button-protected-container-shape, var(--mat-sys-corner-full))}.mat-mdc-raised-button:hover{box-shadow:var(--mat-button-protected-hover-container-elevation-shadow, var(--mat-sys-level2))}.mat-mdc-raised-button:focus{box-shadow:var(--mat-button-protected-focus-container-elevation-shadow, var(--mat-sys-level1))}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mat-button-protected-pressed-container-elevation-shadow, var(--mat-sys-level1))}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-protected-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-button-protected-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mat-button-protected-disabled-container-elevation-shadow, var(--mat-sys-level0))}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-button-outlined-container-height, 40px);font-family:var(--mat-button-outlined-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-outlined-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-outlined-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-outlined-label-text-transform);font-weight:var(--mat-button-outlined-label-text-weight, var(--mat-sys-label-large-weight));border-radius:var(--mat-button-outlined-container-shape, var(--mat-sys-corner-full));border-width:var(--mat-button-outlined-outline-width, 1px);padding:0 var(--mat-button-outlined-horizontal-padding, 24px)}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-button-outlined-icon-spacing, 8px);margin-left:var(--mat-button-outlined-icon-offset, -8px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-button-outlined-icon-offset, -8px);margin-left:var(--mat-button-outlined-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-outlined-icon-offset, -8px);margin-left:var(--mat-button-outlined-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-outlined-icon-spacing, 8px);margin-left:var(--mat-button-outlined-icon-offset, -8px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-button-outlined-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-outlined-state-layer-color, var(--mat-sys-primary))}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-outlined-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-outlined-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-outlined-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-outlined-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-outlined-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-outlined-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-outlined-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;display:var(--mat-button-outlined-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-outlined-button:not(:disabled){color:var(--mat-button-outlined-label-text-color, var(--mat-sys-primary));border-color:var(--mat-button-outlined-outline-color, var(--mat-sys-outline))}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-outlined-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));border-color:var(--mat-button-outlined-disabled-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-tonal-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-button-tonal-container-height, 40px);font-family:var(--mat-button-tonal-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mat-button-tonal-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-button-tonal-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mat-button-tonal-label-text-transform);font-weight:var(--mat-button-tonal-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-button-tonal-horizontal-padding, 24px)}.mat-tonal-button:not(:disabled){color:var(--mat-button-tonal-label-text-color, var(--mat-sys-on-secondary-container));background-color:var(--mat-button-tonal-container-color, var(--mat-sys-secondary-container))}.mat-tonal-button,.mat-tonal-button .mdc-button__ripple{border-radius:var(--mat-button-tonal-container-shape, var(--mat-sys-corner-full))}.mat-tonal-button[disabled],.mat-tonal-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-button-tonal-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-button-tonal-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-tonal-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-tonal-button>.mat-icon{margin-right:var(--mat-button-tonal-icon-spacing, 8px);margin-left:var(--mat-button-tonal-icon-offset, -8px)}[dir=rtl] .mat-tonal-button>.mat-icon{margin-right:var(--mat-button-tonal-icon-offset, -8px);margin-left:var(--mat-button-tonal-icon-spacing, 8px)}.mat-tonal-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-tonal-icon-offset, -8px);margin-left:var(--mat-button-tonal-icon-spacing, 8px)}[dir=rtl] .mat-tonal-button .mdc-button__label+.mat-icon{margin-right:var(--mat-button-tonal-icon-spacing, 8px);margin-left:var(--mat-button-tonal-icon-offset, -8px)}.mat-tonal-button .mat-ripple-element{background-color:var(--mat-button-tonal-ripple-color, color-mix(in srgb, var(--mat-sys-on-secondary-container) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-tonal-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-tonal-state-layer-color, var(--mat-sys-on-secondary-container))}.mat-tonal-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-button-tonal-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-tonal-button:hover>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-tonal-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-tonal-button.cdk-program-focused>.mat-mdc-button-persistent-ripple::before,.mat-tonal-button.cdk-keyboard-focused>.mat-mdc-button-persistent-ripple::before,.mat-tonal-button.mat-mdc-button-disabled-interactive:focus>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-tonal-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-tonal-button:active>.mat-mdc-button-persistent-ripple::before{opacity:var(--mat-button-tonal-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-tonal-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;display:var(--mat-button-tonal-touch-target-display, block);left:0;right:0;transform:translateY(-50%)}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button,.mat-tonal-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before,.mat-tonal-button .mat-mdc-button-ripple,.mat-tonal-button .mat-mdc-button-persistent-ripple,.mat-tonal-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-tonal-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before,.mat-tonal-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-button .mat-icon,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-unelevated-button .mat-icon,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-raised-button .mat-icon,.mat-mdc-outlined-button .mdc-button__label,.mat-mdc-outlined-button .mat-icon,.mat-tonal-button .mdc-button__label,.mat-tonal-button .mat-icon{z-index:1;position:relative}.mat-mdc-button .mat-focus-indicator,.mat-mdc-unelevated-button .mat-focus-indicator,.mat-mdc-raised-button .mat-focus-indicator,.mat-mdc-outlined-button .mat-focus-indicator,.mat-tonal-button .mat-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:inherit}.mat-mdc-button:focus>.mat-focus-indicator::before,.mat-mdc-unelevated-button:focus>.mat-focus-indicator::before,.mat-mdc-raised-button:focus>.mat-focus-indicator::before,.mat-mdc-outlined-button:focus>.mat-focus-indicator::before,.mat-tonal-button:focus>.mat-focus-indicator::before{content:"";border-radius:inherit}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable,.mat-tonal-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon,.mat-tonal-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px}.mat-mdc-unelevated-button .mat-focus-indicator::before,.mat-tonal-button .mat-focus-indicator::before,.mat-mdc-raised-button .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px)*-1)}
`,`@media(forced-colors: active){.mat-mdc-button:not(.mdc-button--outlined),.mat-mdc-unelevated-button:not(.mdc-button--outlined),.mat-mdc-raised-button:not(.mdc-button--outlined),.mat-mdc-outlined-button:not(.mdc-button--outlined),.mat-mdc-button-base.mat-tonal-button,.mat-mdc-icon-button.mat-mdc-icon-button,.mat-mdc-outlined-button .mdc-button__ripple{outline:solid 1px}}
`],encapsulation:2,changeDetection:0})}return i})();function hse(i){return i.hasAttribute("mat-raised-button")?"elevated":i.hasAttribute("mat-stroked-button")?"outlined":i.hasAttribute("mat-flat-button")?"filled":i.hasAttribute("mat-button")?"text":null}function fse(i,e){if(i&1&&(B(0,"mat-tab",2)(1,"pre"),Vt(2,"              "),ne(3,"code",5),In(4,"codeFromUrl"),In(5,"async"),Vt(6,`
            `),X()()),i&2){let t=e.$implicit,n=e.$index,r=$t();N("label",r.fileNames[n]),F(3),N("highlight",jn(5,5,jn(4,3,t)))("language",r.getLanguage(r.fileNames[n]))}}var EH=(()=>{let e=class e{constructor(){this.editorService=S(Cm),this.fileNames=[],this.lineNumbers=!1}set codeUrls(n){this.editorService.setUrls(n),this.fileNames=this.editorService.fileNames}get codeUrls(){return this.editorService.urls}getLanguage(n){return this.editorService.getLanguage(n)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-code"]],inputs:{codeUrls:"codeUrls",lineNumbers:"lineNumbers"},decls:15,vars:2,consts:[[1,"code-wrapper","hljs"],["color","primary","backgroundColor","primary",3,"dynamicHeight"],[3,"label"],[3,"align"],["mat-button","","href","#",1,"gist-url",3,"click"],[3,"highlight","language"]],template:function(r,o){r&1&&(B(0,"mat-card")(1,"mat-card-content")(2,"div",0)(3,"mat-tab-group",1),Ki(4,fse,7,7,"mat-tab",2,Qi),X()()(),B(6,"mat-card-actions",3)(7,"button",4),Ie("click",function(a){return o.editorService.toCodeSandbox(a)}),B(8,"mat-icon"),Vt(9,"crop_din"),X(),Vt(10," CodeSandbox "),X(),B(11,"button",4),Ie("click",function(a){return o.editorService.toStackblitz(a)}),B(12,"mat-icon"),Vt(13,"bolt"),X(),Vt(14," Stackblitz "),X()()()),r&2&&(F(3),N("dynamicHeight",!0),F(),Ji(o.codeUrls),F(2),N("align","end"))},dependencies:[Qz,Xz,Yz,Zz,hH,mF,dH,vH,gR,r2,i2,wH,bR,xH,Gg],styles:["pre[_ngcontent-%COMP%]{display:flex;margin-top:0;margin-bottom:0;word-wrap:break-word}pre[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{flex:1;line-height:1.8em;font-size:14px;min-height:100%;padding:1em 1.2em}pre[_ngcontent-%COMP%]   code.hljs-line-numbers[_ngcontent-%COMP%]{padding:0}.mat-mdc-card[_ngcontent-%COMP%]{padding:0;margin-bottom:3em}.mat-card-header[_ngcontent-%COMP%]{margin:0!important;padding:0!important;display:flex;align-items:center;height:40px}.mat-card-content[_ngcontent-%COMP%]{position:relative;overflow:hidden;padding:1px;margin-bottom:0}.mat-card-footer[_ngcontent-%COMP%]{padding:10px!important;margin:0!important;display:flex;flex-direction:row-reverse}.mat-card-footer[_ngcontent-%COMP%]   .gist-url[_ngcontent-%COMP%]{display:flex;align-items:center;font-weight:300;font-size:13px;text-decoration:unset}.mat-card-footer[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.mat-icon[_ngcontent-%COMP%]{margin:0 3px}.code-wrapper[_ngcontent-%COMP%]{border-radius:3px 3px 0 0}  .hljs{padding:0;border:none;transition:border ease 1s}  .hljs-ln{padding:10px 0}  .hljs-ln tr:first-child td{padding-top:10px!important}  .hljs-ln tr:last-child td{padding-bottom:10px!important}  td.hljs-ln-numbers{-webkit-user-select:none;user-select:none;text-align:center;color:#cccccc6b;border-right:1px solid rgba(204,204,204,.1098039216);vertical-align:top;padding-right:10px!important;padding-left:10px!important}  td.hljs-ln-code{padding-left:10px!important}"],changeDetection:0});let i=e;return i})();function pse(i,e){i&1&&Rd(0)}var DH=(()=>{let e=class e{constructor(){this.editorService=S(Cm),this.route=S(Ns),this.exampleComponent=null,this.codeUrls=this.route.snapshot.data.codeUrls??[],this.editorService.declarations=this.route.snapshot.data.declarations,this.exampleComponent=this.route.snapshot.data.exampleComponent}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-example-page"]],decls:3,vars:3,consts:[[1,"example-container"],[4,"ngComponentOutlet"],[3,"lineNumbers","codeUrls"]],template:function(r,o){r&1&&(B(0,"div",0),fs(1,pse,1,0,"ng-container",1),X(),ne(2,"app-code",2)),r&2&&(F(),N("ngComponentOutlet",o.exampleComponent),F(),N("lineNumbers",!0)("codeUrls",o.codeUrls))},dependencies:[EH,hD],encapsulation:2,changeDetection:0});let i=e;return i})();var bF=i=>[0,i,0],mse=()=>[0,1,0],gse=()=>({background:"lightblue",borderRadius:"1em",padding:"1em",display:"flex",flexDirection:"column"}),IH=i=>[i,0,0],_se=()=>[0,.039,.1],bse=()=>[.17,.17,.17],vse=()=>[4,10,2],yse=()=>[100,100],xse=()=>[55,2,.1,100],wse=(i,e)=>[i,0,e],Mse=()=>[0,0,0],AH=(()=>{let e=class e{constructor(){this.Math=Math,this.sprite=!1,this.glbPath=`${ui}mac-draco.glb`,this.clock=new go(!0),this.plane=new Xi(new C(0,1,0),3),this.rotation=[0,0,0],this.position=[0,0,0];let n=S(Du);n.setDecoderPath("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/jsm/libs/draco/gltf/"),n.setCrossOrigin("no-cors"),this.calcPose()}onBeforeRender(){this.calcPose()}calcPose(){let n=this.clock.getElapsedTime();this.rotation=[Ze.lerp(this.rotation[0],Math.cos(n/2)/20+.25,.1),Ze.lerp(this.rotation[1],Math.sin(n/4)/20,.1),Ze.lerp(this.rotation[2],Math.sin(n/8)/20,.1)],this.position=[0,Ze.lerp(this.position[1],(-2+Math.sin(n/2))/2,.1),0]}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-html-example"]],decls:17,vars:56,consts:[["light",""],[3,"onRender","thStats","shadow"],[3,"intensity"],[3,"rotation","position"],["loadGLTF","",3,"castShadow","url","position","rotation"],[3,"refById"],[3,"rotation","position","scale","sprite","transform","occlude"],["src",Pg`./multi-view-postprocessing-example`,2,"width","1960px","height","1280px"],[3,"castShadow","position","lookAt","color","intensity"],[3,"receiveShadow","rotation","position"],[3,"args"],[3,"color"],[3,"args","position","lookAt"]],template:function(r,o){if(r&1){let s=en();B(0,"th-canvas",1),Ie("onRender",function(){return rt(s),ot(o.onBeforeRender())}),B(1,"th-scene"),ne(2,"th-ambientLight",2),B(3,"th-group",3)(4,"th-object3D",4)(5,"th-mesh",5)(6,"th-html",6),ne(7,"iframe",7),X()()()(),ne(8,"th-directionalLight",8,0),In(10,"color"),B(11,"th-mesh",9),ne(12,"th-planeGeometry",10)(13,"th-meshBasicMaterial",11),In(14,"color"),X(),B(15,"th-perspectiveCamera",12),ne(16,"th-orbitControls"),X()()()}r&2&&(N("thStats",!0)("shadow",!0),F(2),N("intensity",3),F(),N("rotation",_t(35,bF,o.Math.PI))("position",V(37,mse)),F(),N("castShadow",!0)("url",o.glbPath)("position",o.position)("rotation",o.rotation),F(),N("refById","Cube008_2"),F(),zl(V(38,gse)),N("rotation",_t(39,IH,-1*o.Math.PI/2))("position",V(41,_se))("scale",V(42,bse))("sprite",o.sprite)("transform",!0)("occlude",!0),F(2),N("castShadow",!0)("position",V(43,vse))("lookAt",_t(44,bF,-3))("color",jn(10,31,"#ffffff"))("intensity",2),F(3),N("receiveShadow",!0)("rotation",_t(46,IH,3*o.Math.PI/2))("position",_t(48,bF,-3)),F(),N("args",V(50,yse)),F(),N("color",jn(14,33,"#efefef")),F(2),N("args",V(51,xse))("position",br(52,wse,-5,-15))("lookAt",V(55,Mse)))},dependencies:[ln,vi,Gt,de,Tn,Pr,uc,Cn,Ot,dc,Ds,At,hr,yi,hm,cV,As],encapsulation:2,changeDetection:0});let i=e;return i})();var vF=i=>[0,i,0],Sse=()=>[0,1,0],PH=i=>[i,0,0],Rse=i=>[0,.04,i],Tse=()=>[.0043,.0043,.0043],Cse=()=>[1960,1280],Ese=()=>[4,10,2],Dse=()=>[100,100],Ise=()=>[55,2,.1,100],Ase=(i,e)=>[i,0,e],Pse=()=>[0,0,0],FH=(()=>{let e=class e{constructor(){this.THREE=vu,this.Math=Math,this.sprite=!1,this.glbPath=`${ui}mac-draco.glb`,this.clock=new go(!0),this.rotation=[0,0,0],this.position=[0,0,0],this.webGlRenderer=S(Rh);let n=S(Du);n.setDecoderPath("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/jsm/libs/draco/gltf/"),n.setCrossOrigin("no-cors"),this.webGlRenderer.domElement.style.pointerEvents="none",this.webGlRenderer.domElement.style.zIndex="1",this.calcPose()}onBeforeRender(){this.calcPose()}calcPose(){let n=this.clock.getElapsedTime();this.rotation=[Ze.lerp(this.rotation[0],Math.cos(n/2)/20+.25,.1),Ze.lerp(this.rotation[1],Math.sin(n/4)/20,.1),Ze.lerp(this.rotation[2],Math.sin(n/8)/20,.1)],this.position=[0,Ze.lerp(this.position[1],(-2+Math.sin(n/2))/2,.1),0]}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-html-with-css3d-example"]],features:[K([Mu(),zM()])],decls:23,vars:59,consts:[["holder",""],["light",""],[3,"onRender","thStats","shadow"],[3,"intensity"],[3,"rotation","position"],["loadGLTF","",3,"castShadow","url","position","rotation"],[3,"refById"],[3,"rotation","position","scale"],[3,"args"],[3,"opacity","blending","side","color"],["src",Pg`./multi-view-postprocessing-example`,2,"width","1960px","height","1280px"],[3,"castShadow","position","lookAt","color","intensity"],[3,"receiveShadow","rotation","position"],[3,"color"],[3,"args","position","lookAt"]],template:function(r,o){if(r&1){let s=en();B(0,"th-canvas",2),Ie("onRender",function(){return rt(s),ot(o.onBeforeRender())}),B(1,"th-scene"),ne(2,"th-ambientLight",3),B(3,"th-group",4)(4,"th-object3D",5)(5,"th-mesh",6)(6,"th-group",7,0)(8,"th-mesh"),ne(9,"th-planeGeometry",8)(10,"th-meshBasicMaterial",9),In(11,"color"),X(),B(12,"th-cSS3DObject"),ne(13,"iframe",10),X()()()()(),ne(14,"th-directionalLight",11,1),In(16,"color"),B(17,"th-mesh",12),ne(18,"th-planeGeometry",8)(19,"th-meshBasicMaterial",13),In(20,"color"),X(),B(21,"th-perspectiveCamera",14),ne(22,"th-orbitControls"),X()()()}r&2&&(N("thStats",!0)("shadow",!0),F(2),N("intensity",3),F(),N("rotation",_t(37,vF,o.Math.PI))("position",V(39,Sse)),F(),N("castShadow",!0)("url",o.glbPath)("position",o.position)("rotation",o.rotation),F(),N("refById","Cube008_2"),F(),N("rotation",_t(40,PH,-1*o.Math.PI/2))("position",_t(42,Rse,-.02))("scale",V(44,Tse)),F(3),N("args",V(45,Cse)),F(),N("opacity",0)("blending",o.THREE.NoBlending)("side",o.THREE.DoubleSide)("color",jn(11,31,"black")),F(4),N("castShadow",!0)("position",V(46,Ese))("lookAt",_t(47,vF,-3))("color",jn(16,33,"#ffffff"))("intensity",2.2),F(3),N("receiveShadow",!0)("rotation",_t(49,PH,3*o.Math.PI/2))("position",_t(51,vF,-3)),F(),N("args",V(53,Dse)),F(),N("color",jn(20,35,"#efefef")),F(2),N("args",V(54,Ise))("position",br(55,Ase,-5,-15))("lookAt",V(58,Pse)))},dependencies:[ln,vi,Gt,de,Tn,Pr,uc,Cn,Ot,VM,dc,Ds,At,hr,yi,hm,As],encapsulation:2,changeDetection:0});let i=e;return i})();var NH=Math.sqrt(3),jH=Math.sqrt(5),NJe=.5*(NH-1),jJe=(3-NH)/6,Fse=1/3,yc=1/6,OJe=(jH-1)/4,LJe=(5-jH)/20,yF=i=>Math.floor(i)|0;var xF=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function OH(i=Math.random){let e=Nse(i),t=new Float64Array(e).map(o=>xF[o%12*3]),n=new Float64Array(e).map(o=>xF[o%12*3+1]),r=new Float64Array(e).map(o=>xF[o%12*3+2]);return function(s,a,c){let l,u,d,h,f=(s+a+c)*Fse,g=yF(s+f),_=yF(a+f),m=yF(c+f),p=(g+_+m)*yc,b=g-p,v=_-p,y=m-p,w=s-b,R=a-v,E=c-y,A,x,T,P,L,H;w>=R?R>=E?(A=1,x=0,T=0,P=1,L=1,H=0):w>=E?(A=1,x=0,T=0,P=1,L=0,H=1):(A=0,x=0,T=1,P=1,L=0,H=1):R<E?(A=0,x=0,T=1,P=0,L=1,H=1):w<E?(A=0,x=1,T=0,P=0,L=1,H=1):(A=0,x=1,T=0,P=1,L=1,H=0);let te=w-A+yc,Y=R-x+yc,J=E-T+yc,W=w-P+2*yc,fe=R-L+2*yc,ve=E-H+2*yc,Re=w-1+3*yc,Te=R-1+3*yc,mt=E-1+3*yc,gt=g&255,dn=_&255,_n=m&255,le=.6-w*w-R*R-E*E;if(le<0)l=0;else{let Ae=gt+e[dn+e[_n]];le*=le,l=le*le*(t[Ae]*w+n[Ae]*R+r[Ae]*E)}let _e=.6-te*te-Y*Y-J*J;if(_e<0)u=0;else{let Ae=gt+A+e[dn+x+e[_n+T]];_e*=_e,u=_e*_e*(t[Ae]*te+n[Ae]*Y+r[Ae]*J)}let Le=.6-W*W-fe*fe-ve*ve;if(Le<0)d=0;else{let Ae=gt+P+e[dn+L+e[_n+H]];Le*=Le,d=Le*Le*(t[Ae]*W+n[Ae]*fe+r[Ae]*ve)}let Je=.6-Re*Re-Te*Te-mt*mt;if(Je<0)h=0;else{let Ae=gt+1+e[dn+1+e[_n+1]];Je*=Je,h=Je*Je*(t[Ae]*Re+n[Ae]*Te+r[Ae]*mt)}return 32*(l+u+d+h)}}function Nse(i){let t=new Uint8Array(512);for(let n=0;n<512/2;n++)t[n]=n;for(let n=0;n<512/2-1;n++){let r=n+~~(i()*(256-n)),o=t[n];t[n]=t[r],t[r]=o}for(let n=256;n<512;n++)t[n]=t[n-256];return t}var jse=["canvas"],Ose=["light"],Lse=["instancedMesh"],kse=()=>[0,0,30],Bse=()=>[0,0,0],Use=()=>["#808080"],Vse=i=>[void 0,void 0,i],zse=(i,e,t)=>[i,e,t],LH=()=>["#9C1E15"],Hse=i=>[0,0,i],Gse=(i,e)=>[i,e],kH=(()=>{let e=class e{constructor(){this.SIZE=1.5,this.NX=20,this.NY=20,this.PADDING=1,this.SIZEP=this.SIZE+this.PADDING,this.W=this.NX*this.SIZEP-this.PADDING,this.H=this.NY*this.SIZEP-this.PADDING,this.NUM_INSTANCES=this.NX*this.NY,this.dummy=new wt,this.simplexNoise=OH(),this.pointerPN={x:0,y:0}}ngOnInit(){this.light?.shadow&&(this.light.shadow.mapSize.width=1024,this.light.shadow.mapSize.height=1024)}onRender(){this.updateLightPosition(),this.updateInstanceMatrix()}updateLightPosition(){let n=this.light?.position;n&&(n.x=this.pointerPN.x*this.W,n.y=this.pointerPN.y*this.H)}updateInstanceMatrix(){if(!this.instancedMesh||!this.instancedMesh.objRef)return;let n=-this.W/2+this.PADDING,r=-this.H/2+this.PADDING,o=Date.now()*1e-4,s=this.pointerPN.x*.1,a=this.pointerPN.y*.1,c=.005,l,u,d,h,f,g;for(let _=0;_<this.NX;_++)for(let m=0;m<this.NY;m++)l=n+_*this.SIZEP,u=r+m*this.SIZEP,d=l*c+s,h=u*c+a,f=this.simplexNoise(d,h,o)*Math.PI,g=this.simplexNoise(h,d,o)*Math.PI,this.dummy.position.set(l,u,-10),this.dummy.rotation.set(f,g,0),this.dummy.updateMatrix(),this.instancedMesh?.objRef?.setMatrixAt(_*this.NY+m,this.dummy.matrix);this.instancedMesh.objRef.instanceMatrix.needsUpdate=!0}onMouseMove(n){if(!this.canvas||!this.canvas.hostElement.nativeElement)return;let r=this.canvas.hostElement.nativeElement;this.pointerPN.x=(n.clientX-r.offsetLeft+window.scrollX)/r.clientWidth*2-1,this.pointerPN.y=-((n.clientY-r.offsetTop+window.scrollY)/r.clientHeight)*2+1}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-instanced-mesh-example"]],viewQuery:function(r,o){if(r&1&&(tn(jse,5),tn(Ose,5),tn(Lse,5)),r&2){let s;st(s=at())&&(o.canvas=s.first),st(s=at())&&(o.light=s.first),st(s=at())&&(o.instancedMesh=s.first)}},hostBindings:function(r,o){r&1&&Ie("mousemove",function(a){return o.onMouseMove(a)},yd)},decls:15,vars:34,consts:[["canvas",""],["light",""],["instancedMesh",""],[3,"onRender","shadow"],[3,"position","lookAt"],[3,"intensity","color"],[3,"castShadow","intensity","decay"],[3,"args","count","castShadow","receiveShadow"],[3,"args"],[3,"color"],[3,"position","receiveShadow"]],template:function(r,o){if(r&1){let s=en();B(0,"th-canvas",3,0),Ie("onRender",function(){return rt(s),ot(o.onRender())}),B(2,"th-scene")(3,"th-perspectiveCamera",4),ne(4,"th-orbitControls"),X(),ne(5,"th-ambientLight",5)(6,"th-pointLight",6,1),B(8,"th-instancedMesh",7,2),ne(10,"th-boxGeometry",8)(11,"th-meshPhongMaterial",9),X(),B(12,"th-mesh",10),ne(13,"th-planeGeometry",8)(14,"th-meshPhongMaterial",9),X()()()}r&2&&(N("shadow",!0),F(3),N("position",V(18,kse))("lookAt",V(19,Bse)),F(2),N("intensity",3)("color",V(20,Use)),F(),N("castShadow",!0)("intensity",3)("decay",0),F(2),N("args",_t(21,Vse,o.NUM_INSTANCES))("count",o.NUM_INSTANCES)("castShadow",!0)("receiveShadow",!0),F(2),N("args",Zs(23,zse,o.SIZE,o.SIZE,o.SIZE)),F(),N("color",V(27,LH)),F(),N("position",_t(28,Hse,-10-o.SIZE))("receiveShadow",!0),F(),N("args",br(30,Gse,o.W*2,o.H*2)),F(),N("color",V(33,LH)))},dependencies:[ln,vi,Gt,Tn,Gi,NU,Cn,Ot,No,cl,Ds,At],encapsulation:2,changeDetection:0});let i=e;return i})();var Wse=()=>[2,2,2],$se=()=>[1,1,1],qse=()=>({color:"purple"}),Xse=i=>[i,0,0],Zse=()=>[2,0,0],Yse=()=>[75,2,.1,1e3],Qse=()=>[1,1,5],Kse=(()=>{let e=class e{constructor(){this.selected=!1,this.rotation=[0,0,0],this.position=[0,0,0]}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-box"]],inputs:{rotation:"rotation",position:"position"},decls:3,vars:7,consts:[[3,"onClick","rotation","position","scale"],[3,"args"]],template:function(r,o){r&1&&(B(0,"th-mesh",0),Ie("onClick",function(){return o.selected=!o.selected}),ne(1,"th-boxGeometry")(2,"th-meshBasicMaterial",1),X()),r&2&&(N("rotation",o.rotation)("position",o.position)("scale",o.selected?V(4,Wse):V(5,$se)),F(2),N("args",V(6,qse)))},dependencies:[Cn,cl,dc],encapsulation:2,changeDetection:0});let i=e;return i})(),BH=(()=>{let e=class e{constructor(){this.rotation=[0,0,0]}onBeforeRender(){this.rotation=[0,this.rotation[2]+.01,this.rotation[2]+.01]}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-introductory-example"]],decls:6,vars:11,consts:[[3,"onRender"],[3,"position","rotation"],[3,"args","position"]],template:function(r,o){r&1&&(B(0,"th-canvas",0),Ie("onRender",function(){return o.onBeforeRender()}),B(1,"th-scene"),ne(2,"app-box",1)(3,"app-box",1)(4,"th-ambientLight")(5,"th-perspectiveCamera",2),X()()),r&2&&(F(2),N("position",_t(6,Xse,-2))("rotation",o.rotation),F(),N("position",V(8,Zse))("rotation",o.rotation),F(2),N("args",V(9,Yse))("position",V(10,Qse)))},dependencies:[Kse,ln,Gt,Tn,Ot,At],encapsulation:2,changeDetection:0});let i=e;return i})();var Jse=()=>[0,1,0],eae=()=>[100,100,100],tae=i=>[0,0,i],nae=()=>[10,10],UH=()=>[10,10,10],iae=()=>[45,2,.1,100],rae=()=>[0,0,0],VH=(()=>{let e=class e{constructor(){this.assetPath1=`${ui}DamagedHelmet.glb`,this.assetPath2=`${ui}BoomBox.glb`,this.rotation=[0,0,0]}onBeforeRender(){this.rotation=[0,this.rotation[1]+.01,0]}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-loader-example"]],decls:8,vars:24,consts:[[3,"onRender"],[3,"thStats"],[3,"intensity"],["loadGLTF","",3,"url","rotation","position"],["loadGLTF","",3,"url","scale","rotation","position"],[3,"args"],[3,"position","decay"],[3,"args","position","lookAt"]],template:function(r,o){r&1&&(B(0,"th-canvas",0),Ie("onRender",function(){return o.onBeforeRender()}),B(1,"th-scene",1),ne(2,"th-ambientLight",2),B(3,"th-object3D",3),ne(4,"th-object3D",4),X(),ne(5,"th-gridHelper",5)(6,"th-pointLight",6)(7,"th-perspectiveCamera",7),X()()),r&2&&(F(),N("thStats",!0),F(),N("intensity",3),F(),N("url",o.assetPath1)("rotation",o.rotation)("position",V(15,Jse)),F(),N("url",o.assetPath2)("scale",V(16,eae))("rotation",o.rotation)("position",_t(17,tae,-3)),F(),N("args",V(19,nae)),F(),N("position",V(20,UH))("decay",0),F(),N("args",V(21,iae))("position",V(22,UH))("lookAt",V(23,rae)))},dependencies:[ln,Gt,de,dr,Tn,Gi,Ot,At,hr,yi],encapsulation:2,changeDetection:0});let i=e;return i})();var oae=()=>[20,20],zH=()=>[10,10,10],sae=()=>[1,1,1],aae=()=>[45,2,.1,100],cae=()=>[0,4,0],wF=()=>[0,3,0],HH=()=>[.1,.2,6],GH=()=>[.5],lae=()=>[.4,4,.4],uae=()=>[1],dae=i=>[i,5,0],hae=()=>[.8],fae=i=>[.3,6,i],pae=()=>[.9],mae=()=>[0,7,0],gae=()=>({distance:15}),_ae=()=>[0,6,0],bae=()=>[.5,1,.5],vae=()=>[3],yae=()=>({distance:20}),xae=()=>[0,5,0],wae=()=>[2,6,2];function Mae(i,e){if(i&1&&(B(0,"th-lOD",5)(1,"th-group",10)(2,"th-mesh",11),ne(3,"th-cylinderGeometry",6),X(),B(4,"th-mesh",11),ne(5,"th-sphereGeometry",6),X(),B(6,"th-mesh",11),ne(7,"th-sphereGeometry",6),X(),B(8,"th-mesh",11),ne(9,"th-sphereGeometry",6),X(),B(10,"th-mesh",11),ne(11,"th-sphereGeometry",6),X(),B(12,"th-mesh",11),ne(13,"th-sphereGeometry",6),X()(),B(14,"th-group",10)(15,"th-mesh",11),ne(16,"th-cylinderGeometry",6),X(),B(17,"th-mesh",12),ne(18,"th-sphereGeometry",6),X()(),B(19,"th-group",10)(20,"th-mesh",11),ne(21,"th-boxGeometry",6),X()()()),i&2){let t=e.$implicit;$t();let n=Ft(4),r=Ft(7);N("position",t),F(2),N("position",V(31,wF))("material",n.objRef),F(),N("args",V(32,HH)),F(),N("position",V(33,wF))("material",r.objRef),F(),N("args",V(34,GH)),F(),N("position",V(35,lae))("material",r.objRef),F(),N("args",V(36,uae)),F(),N("position",_t(37,dae,-.2))("material",r.objRef),F(),N("args",V(39,hae)),F(),N("position",_t(40,fae,-.1))("material",r.objRef),F(),N("args",V(42,pae)),F(),N("position",V(43,mae))("material",r.objRef),F(),N("args",V(44,GH)),F(),N("lodLevel",V(45,gae)),F(),N("position",V(46,wF))("material",n.objRef),F(),N("args",V(47,HH)),F(),N("position",V(48,_ae))("scale",V(49,bae))("material",r.objRef),F(),N("args",V(50,vae)),F(),N("lodLevel",V(51,yae)),F(),N("position",V(52,xae))("material",r.objRef),F(),N("args",V(53,wae))}}var WH=(()=>{let e=class e{constructor(){this.trees=[[2,0,-10],[0,0,-8],[2,0,-6],[4,0,-4],[2,0,-2],[0,0,0],[2,0,2],[4,0,4],[2,0,6],[0,0,8],[2,0,10]]}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-lod-example"]],decls:15,vars:23,consts:[["trunkMat",""],["leavesMat",""],[3,"thStats"],[3,"intensity"],[3,"color"],[3,"position"],[3,"args"],[3,"position","intensity","color","distance","decay"],[3,"args","position"],[3,"target"],[3,"lodLevel"],[3,"position","material"],[3,"position","scale","material"]],template:function(r,o){r&1&&(B(0,"th-canvas",2)(1,"th-scene"),ne(2,"th-ambientLight",3)(3,"th-meshStandardMaterial",4,0),In(5,"color"),ne(6,"th-meshStandardMaterial",4,1),In(8,"color"),Ki(9,Mae,22,54,"th-lOD",5,Qi),ne(11,"th-gridHelper",6)(12,"th-pointLight",7),B(13,"th-perspectiveCamera",8),ne(14,"th-orbitControls",9),X()()()),r&2&&(N("thStats",!0),F(2),N("intensity",3),F(),N("color",jn(5,13,"#893602")),F(3),N("color",jn(8,15,"#45bf45")),F(3),Ji(o.trees),F(2),N("args",V(17,oae)),F(),N("position",V(18,zH))("intensity",3)("color",V(19,sae))("distance",0)("decay",0),F(),N("args",V(20,aae))("position",V(21,zH)),F(),N("target",V(22,cae)))},dependencies:[ln,vi,Gt,dr,Tn,Gi,uc,cS,Cn,Ot,Dh,cl,XI,fc,At,yi,uV,As],encapsulation:2,changeDetection:0});let i=e;return i})();var Sae=()=>[0,1,0],Rae=()=>[0,0,.2],Tae=()=>[0,0],Cae=()=>[10,10],$H=()=>[10,10,10],Eae=()=>[45,2,.1,100],Dae=()=>[0,0,0],qH=(()=>{let e=class e{constructor(){this.assetPath1=`${ui}DamagedHelmet.glb`,this.assetPath2=`${ui}BoomBox.glb`,this.rotation=[0,0,0]}onBeforeRender(){this.rotation=[0,this.rotation[1]+.01,0]}resetRotation(){this.rotation=[0,0,0]}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-multi-renderer-example"]],features:[K([Mu(),tU()])],decls:13,vars:21,consts:[[3,"onRender"],[3,"thStats"],[3,"intensity"],["loadGLTF","",3,"url","rotation","position"],[3,"position","center"],[1,"label"],[3,"pointerdown"],[3,"args"],[3,"position","decay"],[3,"args","position","lookAt"]],template:function(r,o){r&1&&(B(0,"th-canvas",0),Ie("onRender",function(){return o.onBeforeRender()}),B(1,"th-scene",1),ne(2,"th-ambientLight",2),B(3,"th-object3D",3)(4,"th-cSS2DObject",4)(5,"div",5),Vt(6," A Helmet "),B(7,"button",6),Ie("pointerdown",function(){return o.resetRotation()}),Vt(8,"Reset"),X()()()(),ne(9,"th-gridHelper",7)(10,"th-pointLight",8),B(11,"th-perspectiveCamera",9),ne(12,"th-orbitControls"),X()()()),r&2&&(F(),N("thStats",!0),F(),N("intensity",3),F(),N("url",o.assetPath1)("rotation",o.rotation)("position",V(13,Sae)),F(),N("position",V(14,Rae))("center",V(15,Tae)),F(5),N("args",V(16,Cae)),F(),N("position",V(17,$H))("decay",0),F(),N("args",V(18,Eae))("position",V(19,$H))("lookAt",V(20,Dae)))},dependencies:[ln,vi,Gt,de,dr,Tn,Gi,Ot,$3,At,hr,yi],styles:[".label{background-color:#d3d3d3;border-radius:5px;line-height:1rem;padding:.5rem;display:inline-block}"],changeDetection:0});let i=e;return i})();var Iae=["slider"],Aae=()=>[35,2,.1,100],Pae=()=>[0,0,6],Fae=(i,e)=>({x:0,y:0,width:i,height:e}),Nae=()=>["#ffffff","#444444",1],jae=i=>[i,2,2],Oae=()=>[1,3],Lae=(i,e,t)=>({x:i,y:0,width:e,height:t}),XH=(()=>{let e=class e{constructor(){this.sliderPos=0,this.controlsEnabled=!0,this.colorLeft=new ue(12375183),this.colorRight=new ue(9419988)}ngOnInit(){!this.slider||!this.canvas||!this.canvas.rendererCanvas||(this.slider.nativeElement.style.touchAction="none",this.sliderPos=(this.canvas.rendererCanvas.clientWidth||0)/2)}onPointerMove(n){if(this.controlsEnabled||!this.canvas||!this.canvas.rendererCanvas||!this.slider||n.isPrimary===!1)return;let o=this.canvas.rendererCanvas.getBoundingClientRect();this.sliderPos=Math.max(o.left,Math.min(o.right,n.pageX))-o.left,this.slider.nativeElement.style.left=this.sliderPos-this.slider.nativeElement.offsetWidth/2+"px"}onPointerUp(){this.controlsEnabled=!0}onSliderPointerDown(n){n.isPrimary!==!1&&(this.controlsEnabled=!1)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-multi-scene-example"]],viewQuery:function(r,o){if(r&1&&(tn(Iae,7),tn(At,7)),r&2){let s;st(s=at())&&(o.slider=s.first),st(s=at())&&(o.canvas=s.first)}},hostBindings:function(r,o){r&1&&Ie("pointermove",function(a){return o.onPointerMove(a)},Hy)("pointerup",function(){return o.onPointerUp()},Hy)},decls:20,vars:33,consts:[["thecanvas",""],["cam",""],["light",""],["geo",""],["slider",""],[3,"disableDefaultView"],[3,"args","position"],[3,"scissor","scissorTest","clearColor","camera"],[3,"background"],[3,"args","position","intensity"],[3,"args"],[3,"objRef"],[3,"geometry"],[3,"wireframe"],[1,"slider",3,"pointerdown"]],template:function(r,o){if(r&1){let s=en();B(0,"th-canvas",5,0)(2,"th-perspectiveCamera",6,1),ne(4,"th-orbitControls"),X(),B(5,"th-view",7)(6,"th-scene",8),ne(7,"th-hemisphereLight",9,2),B(9,"th-mesh"),ne(10,"th-meshStandardMaterial")(11,"th-icosahedronGeometry",10,3),X()()(),B(13,"th-view",7)(14,"th-scene",8),ne(15,"th-hemisphereLight",11),B(16,"th-mesh",12),ne(17,"th-meshStandardMaterial",13),X()()()(),B(18,"div",14,4),Ie("pointerdown",function(c){return rt(s),ot(o.onSliderPointerDown(c))}),X()}if(r&2){let s=Ft(1),a=Ft(3),c=Ft(8),l=Ft(12);N("disableDefaultView",!0),F(2),N("args",V(20,Aae))("position",V(21,Pae)),F(3),N("scissor",br(22,Fae,o.sliderPos,(s.rendererCanvas==null?null:s.rendererCanvas.height)||0))("scissorTest",!0)("clearColor",o.colorLeft)("camera",a),F(),N("background",o.colorLeft),F(),N("args",V(25,Nae))("position",_t(26,jae,-2))("intensity",3),F(4),N("args",V(28,Oae)),F(2),N("scissor",Zs(29,Lae,o.sliderPos,(s.rendererCanvas==null?null:s.rendererCanvas.width)||0,(s.rendererCanvas==null?null:s.rendererCanvas.height)||0))("scissorTest",!0)("clearColor",o.colorRight)("camera",a),F(),N("background",o.colorRight),F(),N("objRef",c.objRef==null?null:c.objRef.clone()),F(),N("geometry",l.objRef),F(),N("wireframe",!0)}},dependencies:[ln,vi,Gt,em,Cn,Ot,Dh,FU,At,Zr],styles:[".container[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}.slider[_ngcontent-%COMP%]{position:absolute;cursor:ew-resize;width:40px;height:40px;background-color:#f32196;opacity:.7;border-radius:50%;top:calc(50% - 20px);left:calc(50% - 20px)}"],changeDetection:0});let i=e;return i})();var vR={name:"RGBShiftShader",uniforms:{tDiffuse:{value:null},amount:{value:.005},angle:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform float amount;
		uniform float angle;

		varying vec2 vUv;

		void main() {

			vec2 offset = amount * vec2( cos(angle), sin(angle));
			vec4 cr = texture2D(tDiffuse, vUv + offset);
			vec4 cga = texture2D(tDiffuse, vUv);
			vec4 cb = texture2D(tDiffuse, vUv - offset);
			gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);

		}`};var kae=["thecanvas"],Bae=(i,e)=>({x:0,y:0,width:i,height:e}),Uae=()=>[0,0,1],Vae=()=>["#ffffff"],zae=()=>[0,0,0],yR=i=>[i,0,0],Hae=()=>[200,32,16],Gae=()=>["#fac400"],Wae=()=>["#f83f0d"],$ae=()=>[400,0,0],MF=(i,e,t,n)=>({x:i,y:e,width:t,height:n}),qae=i=>[i],Xae=()=>({value:.055}),Zae=i=>({amount:i}),Yae=()=>[.35,.5,2048,!0],ZH=(()=>{let e=class e{constructor(){this.Math=Math,this.RGBShiftShader=vR,this.DotScreenShader=JM,this.canvasWidth=128,this.canvasHeight=128,this.mouseX=0,this.mouseY=0,this.view1={left:0,bottom:0,width:.5,height:1,background:new ue(.5,.5,.7),eye:[0,300,1800],up:[0,1,0],fov:30,updateCamera:(n,r)=>{this.updateSize(),n.position.x+=this.mouseX*.05,n.position.x=Math.max(Math.min(n.position.x,2e3),-2e3),n.lookAt(r.position),n.updateProjectionMatrix()}},this.view2={left:.5,bottom:0,width:.5,height:.5,background:new ue(.7,.5,.5),eye:[0,1800,0],up:[0,0,1],fov:45,updateCamera:(n,r)=>{this.updateSize(),n.position.x-=this.mouseX*.05,n.position.x=Math.max(Math.min(n.position.x,2e3),-2e3),n.lookAt(n.position.clone().setY(0)),n.updateProjectionMatrix()}},this.view3={left:.5,bottom:.5,width:.5,height:.5,background:new ue(.5,.7,.7),eye:[1400,800,1400],up:[0,1,0],fov:60,updateCamera:(n,r)=>{this.updateSize(),n.position.y-=this.mouseX*.05,n.position.y=Math.max(Math.min(n.position.y,1600),-1600),n.lookAt(r.position),n.updateProjectionMatrix()}}}ngOnInit(){!this.canvas||!this.canvas.rendererCanvas||(this.shadowTexture=new uu(this.canvas.rendererCanvas))}updateSize(){!this.canvas||!this.canvas.rendererCanvas||(this.canvasWidth=this.canvas.rendererCanvas.width,this.canvasHeight=this.canvas.rendererCanvas.height)}onMouseMove(n){if(!this.canvas||!this.canvas.rendererCanvas)return;let r=this.canvas.rendererCanvas.getBoundingClientRect();this.mouseX=n.clientX-r.left-r.width/2,this.mouseY=n.clientY-r.right-r.height/2}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-multi-view-postprocessing-example"]],viewQuery:function(r,o){if(r&1&&tn(kae,7),r&2){let s;st(s=at())&&(o.canvas=s.first)}},hostBindings:function(r,o){r&1&&Ie("mousemove",function(a){return o.onMouseMove(a)},yd)},decls:32,vars:96,consts:[["thecanvas",""],["scene",""],["geo",""],["mat",""],["thview1",""],["camera1",""],["thview2",""],["camera2",""],["thview3",""],["camera3",""],[3,"disableDefaultView","viewPort"],[3,"position","args","intensity"],[3,"position","rotation"],[3,"args"],[3,"flatShading","shininess","specular","color"],[3,"position","rotation","geometry","material"],[3,"onRender","scene","viewPort","scissor","scissorTest"],[3,"position","up","fov","aspect","near","far"],[3,"clearColor"],[3,"strength"],[3,"args","uniforms"],[3,"onRender","scene","viewPort","scissor","scissorTest","clearColor"]],template:function(r,o){if(r&1){let s=en();B(0,"th-canvas",10,0)(2,"th-scene",null,1),ne(4,"th-directionalLight",11),B(5,"th-mesh",12),ne(6,"th-sphereGeometry",13,2)(8,"th-meshPhongMaterial",14,3),X(),ne(10,"th-mesh",15)(11,"th-mesh",15),X(),B(12,"th-view",16,4),Ie("onRender",function(){rt(s);let c=Ft(3),l=Ft(15);return ot(o.view1.updateCamera(l.objRef,c.objRef))}),ne(14,"th-perspectiveCamera",17,5),B(16,"th-effectComposer"),ne(17,"th-renderPass",18)(18,"th-unrealBloomPass",19)(19,"th-shaderPass",20)(20,"th-glitchPass"),X()(),B(21,"th-view",21,6),Ie("onRender",function(){rt(s);let c=Ft(3),l=Ft(24);return ot(o.view2.updateCamera(l.objRef,c.objRef))}),ne(23,"th-perspectiveCamera",17,7),B(25,"th-effectComposer"),ne(26,"th-renderPass")(27,"th-filmPass",13),X()(),B(28,"th-view",21,8),Ie("onRender",function(){rt(s);let c=Ft(3),l=Ft(31);return ot(o.view3.updateCamera(l.objRef,c.objRef))}),ne(30,"th-perspectiveCamera",17,9),X()()}if(r&2){let s=Ft(3),a=Ft(7),c=Ft(9),l=Ft(13),u=Ft(22),d=Ft(29);N("disableDefaultView",!0)("viewPort",br(57,Bae,.5*o.canvasWidth,o.canvasHeight)),F(4),N("position",V(60,Uae))("args",V(61,Vae))("intensity",3),F(),N("position",V(62,zae))("rotation",_t(63,yR,-o.Math.PI/2)),F(),N("args",V(65,Hae)),F(2),N("flatShading",!1)("shininess",30)("specular",V(66,Gae))("color",V(67,Wae)),F(2),N("position",_t(68,yR,-400))("rotation",_t(70,yR,-o.Math.PI/2))("geometry",a.objRef)("material",c.objRef),F(),N("position",V(72,$ae))("rotation",_t(73,yR,-o.Math.PI/2))("geometry",a.objRef)("material",c.objRef),F(),N("scene",s)("viewPort",Ed(75,MF,o.view1.left*o.canvasWidth,o.view1.bottom*o.canvasHeight,o.view1.width*o.canvasWidth,o.view1.height*o.canvasHeight))("scissor",l.viewPort)("scissorTest",!0),F(2),N("position",o.view1.eye)("up",o.view1.up)("fov",o.view1.fov)("aspect",o.view1.width*o.canvasWidth/(o.view1.height*o.canvasHeight))("near",1)("far",1e4),F(3),N("clearColor",o.view1.background),F(),N("strength",.2),F(),N("args",_t(80,qae,o.RGBShiftShader))("uniforms",_t(83,Zae,V(82,Xae))),F(2),N("scene",s)("viewPort",Ed(85,MF,o.view2.left*o.canvasWidth,o.view2.bottom*o.canvasHeight,o.view2.width*o.canvasWidth,o.view2.height*o.canvasHeight))("scissor",u.viewPort)("scissorTest",!0)("clearColor",o.view2.background),F(2),N("position",o.view2.eye)("up",o.view2.up)("fov",o.view2.fov)("aspect",o.view2.width*o.canvasWidth/(o.view2.height*o.canvasHeight))("near",1)("far",1e4),F(4),N("args",V(90,Yae)),F(),N("scene",s)("viewPort",Ed(91,MF,o.view3.left*o.canvasWidth,o.view3.bottom*o.canvasHeight,o.view3.width*o.canvasWidth,o.view3.height*o.canvasHeight))("scissor",d.viewPort)("scissorTest",!0)("clearColor",o.view3.background),F(2),N("position",o.view3.eye)("up",o.view3.up)("fov",o.view3.fov)("aspect",o.view3.width*o.canvasWidth/(o.view3.height*o.canvasHeight))("near",1)("far",1e4)}},dependencies:[ln,Gt,Pr,Cn,Ot,No,fc,Su,RU,PU,Qp,_v,yS,At,Zr],encapsulation:2,changeDetection:0});let i=e;return i})();var r4=(()=>{class i{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,n){this._renderer=t,this._elementRef=n}setProperty(t,n){this._renderer.setProperty(this._elementRef.nativeElement,t,n)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(n){return new(n||i)(Dn(Yi),Dn(vt))};static \u0275dir=Ge({type:i})}return i})(),s0=(()=>{class i extends r4{static \u0275fac=(()=>{let t;return function(r){return(t||(t=q(i)))(r||i)}})();static \u0275dir=Ge({type:i,features:[$]})}return i})(),Lm=new me(""),Qae={provide:Lm,useExisting:he(()=>EF),multi:!0},EF=(()=>{class i extends s0{writeValue(t){this.setProperty("checked",t)}static \u0275fac=(()=>{let t;return function(r){return(t||(t=q(i)))(r||i)}})();static \u0275dir=Ge({type:i,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(n,r){n&1&&Ie("change",function(s){return r.onChange(s.target.checked)})("blur",function(){return r.onTouched()})},standalone:!1,features:[K([Qae]),$]})}return i})(),Kae={provide:Lm,useExisting:he(()=>RR),multi:!0};function Jae(){let i=gs()?gs().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}var ece=new me(""),RR=(()=>{class i extends r4{_compositionMode;_composing=!1;constructor(t,n,r){super(t,n),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!Jae())}writeValue(t){let n=t??"";this.setProperty("value",n)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(n){return new(n||i)(Dn(Yi),Dn(vt),Dn(ece,8))};static \u0275dir=Ge({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(n,r){n&1&&Ie("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},standalone:!1,features:[K([Kae]),$]})}return i})();var tce=new me(""),nce=new me("");function o4(i){return i!=null}function s4(i){return Lc(i)?qn(i):i}function a4(i){let e={};return i.forEach(t=>{e=t!=null?ae(ae({},e),t):e}),Object.keys(e).length===0?null:e}function c4(i,e){return e.map(t=>t(i))}function ice(i){return!i.validate}function l4(i){return i.map(e=>ice(e)?e:t=>e.validate(t))}function rce(i){if(!i)return null;let e=i.filter(o4);return e.length==0?null:function(t){return a4(c4(t,e))}}function u4(i){return i!=null?rce(l4(i)):null}function oce(i){if(!i)return null;let e=i.filter(o4);return e.length==0?null:function(t){let n=c4(t,e).map(s4);return Ku(n).pipe(tt(a4))}}function d4(i){return i!=null?oce(l4(i)):null}function YH(i,e){return i===null?[e]:Array.isArray(i)?[...i,e]:[i,e]}function sce(i){return i._rawValidators}function ace(i){return i._rawAsyncValidators}function SF(i){return i?Array.isArray(i)?i:[i]:[]}function wR(i,e){return Array.isArray(i)?i.includes(e):i===e}function QH(i,e){let t=SF(e);return SF(i).forEach(r=>{wR(t,r)||t.push(r)}),t}function KH(i,e){return SF(e).filter(t=>!wR(i,t))}var MR=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=u4(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=d4(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},RF=class extends MR{name;get formDirective(){return null}get path(){return null}},o0=class extends MR{_parent=null;name=null;valueAccessor=null},TF=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},cce={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Tet=jt(ae({},cce),{"[class.ng-submitted]":"isSubmitted"}),TR=(()=>{class i extends TF{constructor(t){super(t)}static \u0275fac=function(n){return new(n||i)(Dn(o0,2))};static \u0275dir=Ge({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(n,r){n&2&&sn("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[$]})}return i})();var t0="VALID",xR="INVALID",Nm="PENDING",n0="DISABLED",Om=class{},SR=class extends Om{value;source;constructor(e,t){super(),this.value=e,this.source=t}},i0=class extends Om{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},r0=class extends Om{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},jm=class extends Om{status;source;constructor(e,t){super(),this.status=e,this.source=t}};function lce(i){return(CR(i)?i.validators:i)||null}function uce(i){return Array.isArray(i)?u4(i):i||null}function dce(i,e){return(CR(e)?e.asyncValidators:i)||null}function hce(i){return Array.isArray(i)?d4(i):i||null}function CR(i){return i!=null&&!Array.isArray(i)&&typeof i=="object"}var CF=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return Fi(this.statusReactive)}set status(e){Fi(()=>this.statusReactive.set(e))}_status=qo(()=>this.statusReactive());statusReactive=Vn(void 0);get valid(){return this.status===t0}get invalid(){return this.status===xR}get pending(){return this.status==Nm}get disabled(){return this.status===n0}get enabled(){return this.status!==n0}errors;get pristine(){return Fi(this.pristineReactive)}set pristine(e){Fi(()=>this.pristineReactive.set(e))}_pristine=qo(()=>this.pristineReactive());pristineReactive=Vn(!0);get dirty(){return!this.pristine}get touched(){return Fi(this.touchedReactive)}set touched(e){Fi(()=>this.touchedReactive.set(e))}_touched=qo(()=>this.touchedReactive());touchedReactive=Vn(!1);get untouched(){return!this.touched}_events=new lt;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(QH(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(QH(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(KH(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(KH(e,this._rawAsyncValidators))}hasValidator(e){return wR(this._rawValidators,e)}hasAsyncValidator(e){return wR(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let n=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(jt(ae({},e),{sourceControl:n})),t&&e.emitEvent!==!1&&this._events.next(new r0(!0,n))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let n=e.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:n})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,n),t&&e.emitEvent!==!1&&this._events.next(new r0(!1,n))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let n=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(jt(ae({},e),{sourceControl:n})),t&&e.emitEvent!==!1&&this._events.next(new i0(!1,n))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let n=e.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,n),t&&e.emitEvent!==!1&&this._events.next(new i0(!0,n))}markAsPending(e={}){this.status=Nm;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new jm(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(jt(ae({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=n0,this.errors=null,this._forEachChild(r=>{r.disable(jt(ae({},e),{onlySelf:!0}))}),this._updateValue();let n=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new SR(this.value,n)),this._events.next(new jm(this.status,n)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(jt(ae({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=t0,this._forEachChild(n=>{n.enable(jt(ae({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(jt(ae({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let n=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===t0||this.status===Nm)&&this._runAsyncValidator(n,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new SR(this.value,t)),this._events.next(new jm(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(jt(ae({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?n0:t0}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Nm,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let n=s4(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((n,r)=>n&&n._find(r),this)}getError(e,t){let n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,n){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||n)&&this._events.next(new jm(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,n)}_initObservables(){this.valueChanges=new dt,this.statusChanges=new dt}_calculateStatus(){return this._allControlsDisabled()?n0:this.errors?xR:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Nm)?Nm:this._anyControlsHaveStatus(xR)?xR:t0}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let n=!this._anyControlsDirty(),r=this.pristine!==n;this.pristine=n,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),r&&this._events.next(new i0(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new r0(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){CR(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=uce(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=hce(this._rawAsyncValidators)}};var h4=new me("",{providedIn:"root",factory:()=>DF}),DF="always";function fce(i,e){return[...e.path,i]}function pce(i,e,t=DF){gce(i,e),e.valueAccessor.writeValue(i.value),(i.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(i.disabled),_ce(i,e),vce(i,e),bce(i,e),mce(i,e)}function JH(i,e){i.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function mce(i,e){if(e.valueAccessor.setDisabledState){let t=n=>{e.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(t),e._registerOnDestroy(()=>{i._unregisterOnDisabledChange(t)})}}function gce(i,e){let t=sce(i);e.validator!==null?i.setValidators(YH(t,e.validator)):typeof t=="function"&&i.setValidators([t]);let n=ace(i);e.asyncValidator!==null?i.setAsyncValidators(YH(n,e.asyncValidator)):typeof n=="function"&&i.setAsyncValidators([n]);let r=()=>i.updateValueAndValidity();JH(e._rawValidators,r),JH(e._rawAsyncValidators,r)}function _ce(i,e){e.valueAccessor.registerOnChange(t=>{i._pendingValue=t,i._pendingChange=!0,i._pendingDirty=!0,i.updateOn==="change"&&f4(i,e)})}function bce(i,e){e.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,i.updateOn==="blur"&&i._pendingChange&&f4(i,e),i.updateOn!=="submit"&&i.markAsTouched()})}function f4(i,e){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function vce(i,e){let t=(n,r)=>{e.valueAccessor.writeValue(n),r&&e.viewToModelUpdate(n)};i.registerOnChange(t),e._registerOnDestroy(()=>{i._unregisterOnChange(t)})}function yce(i,e){if(!i.hasOwnProperty("model"))return!1;let t=i.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function xce(i){return Object.getPrototypeOf(i.constructor)===s0}function wce(i,e){if(!e)return null;Array.isArray(e);let t,n,r;return e.forEach(o=>{o.constructor===RR?t=o:xce(o)?n=o:r=o}),r||n||t||null}function e4(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}function t4(i){return typeof i=="object"&&i!==null&&Object.keys(i).length===2&&"value"in i&&"disabled"in i}var Mce=class extends CF{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,n){super(lce(t),dce(n,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),CR(t)&&(t.nonNullable||t.initialValueIsDefault)&&(t4(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){e4(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){e4(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){t4(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var Sce={provide:o0,useExisting:he(()=>a0)},n4=Promise.resolve(),a0=(()=>{class i extends o0{_changeDetectorRef;callSetDisabledState;control=new Mce;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new dt;constructor(t,n,r,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this._parent=t,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=wce(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let n=t.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),yce(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){pce(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){n4.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let n=t.isDisabled.currentValue,r=n!==0&&On(n);n4.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?fce(t,this._parent):[t]}static \u0275fac=function(n){return new(n||i)(Dn(RF,9),Dn(tce,10),Dn(nce,10),Dn(Lm,10),Dn(Ni,8),Dn(h4,8))};static \u0275dir=Ge({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[K([Sce]),$,$i]})}return i})();var Rce={provide:Lm,useExisting:he(()=>IF),multi:!0},IF=(()=>{class i extends s0{writeValue(t){this.setProperty("value",parseFloat(t))}registerOnChange(t){this.onChange=n=>{t(n==""?null:parseFloat(n))}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=q(i)))(r||i)}})();static \u0275dir=Ge({type:i,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(n,r){n&1&&Ie("change",function(s){return r.onChange(s.target.value)})("input",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},standalone:!1,features:[K([Rce]),$]})}return i})();var Tce={provide:Lm,useExisting:he(()=>ER),multi:!0};function p4(i,e){return i==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${i}: ${e}`.slice(0,50))}function Cce(i){return i.split(":")[0]}var ER=(()=>{class i extends s0{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;appRefInjector=S(ps).injector;appRefDestroyRef=this.appRefInjector.get(Nr);destroyRef=S(Nr);cdr=S(Ni);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefDestroyRef.destroyed||(this._queuedWrite=!0,co({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(t){this.cdr.markForCheck(),this.value=t;let n=this._getOptionId(t),r=p4(n,t);this.setProperty("value",r)}registerOnChange(t){this.onChange=n=>{this.value=this._getOptionValue(n),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let n of this._optionMap.keys())if(this._compareWith(this._optionMap.get(n),t))return n;return null}_getOptionValue(t){let n=Cce(t);return this._optionMap.has(n)?this._optionMap.get(n):t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=q(i)))(r||i)}})();static \u0275dir=Ge({type:i,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(n,r){n&1&&Ie("change",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[K([Tce]),$]})}return i})(),m4=(()=>{class i{_element;_renderer;_select;id;constructor(t,n,r){this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(p4(this.id,t)),this._select._writeValueAfterRender())}set value(t){this._setElementValue(t),this._select&&this._select._writeValueAfterRender()}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(n){return new(n||i)(Dn(vt),Dn(Yi),Dn(ER,9))};static \u0275dir=Ge({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return i})(),Ece={provide:Lm,useExisting:he(()=>g4),multi:!0};function i4(i,e){return i==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${i}: ${e}`.slice(0,50))}function Dce(i){return i.split(":")[0]}var g4=(()=>{class i extends s0{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let n;if(Array.isArray(t)){let r=t.map(o=>this._getOptionId(o));n=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else n=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(n)}registerOnChange(t){this.onChange=n=>{let r=[],o=n.selectedOptions;if(o!==void 0){let s=o;for(let a=0;a<s.length;a++){let c=s[a],l=this._getOptionValue(c.value);r.push(l)}}else{let s=n.options;for(let a=0;a<s.length;a++){let c=s[a];if(c.selected){let l=this._getOptionValue(c.value);r.push(l)}}}this.value=r,t(r)}}_registerOption(t){let n=(this._idCounter++).toString();return this._optionMap.set(n,t),n}_getOptionId(t){for(let n of this._optionMap.keys())if(this._compareWith(this._optionMap.get(n)._value,t))return n;return null}_getOptionValue(t){let n=Dce(t);return this._optionMap.has(n)?this._optionMap.get(n)._value:t}static \u0275fac=(()=>{let t;return function(r){return(t||(t=q(i)))(r||i)}})();static \u0275dir=Ge({type:i,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(n,r){n&1&&Ie("change",function(s){return r.onChange(s.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[K([Ece]),$]})}return i})(),_4=(()=>{class i{_element;_renderer;_select;id;_value;constructor(t,n,r){this._element=t,this._renderer=n,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(i4(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(i4(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(n){return new(n||i)(Dn(vt),Dn(Yi),Dn(g4,9))};static \u0275dir=Ge({type:i,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return i})();var Ice=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=Mn({type:i});static \u0275inj=xn({})}return i})();var km=(()=>{class i{static withConfig(t){return{ngModule:i,providers:[{provide:h4,useValue:t.callSetDisabledState??DF}]}}static \u0275fac=function(n){return new(n||i)};static \u0275mod=Mn({type:i});static \u0275inj=xn({imports:[Ice]})}return i})();var Ace=()=>[2,2,2],Pce=()=>[1,1,1],Fce=()=>[10,10],v4=()=>[10,10,10],Nce=()=>[45,2,.1,100],jce=()=>[0,0,0],Oce=i=>[i],Lce=(i,e,t)=>[i,e,t];function kce(i,e){i&1&&ne(0,"th-orbitControls")}function Bce(i,e){i&1&&ne(0,"th-mapControls")}function Uce(i,e){i&1&&ne(0,"th-arcballControls")}function Vce(i,e){if(i&1&&ne(0,"th-transformControls",15),i&2){$t();let t=Ft(26);N("object",t.objRef)}}function zce(i,e){if(i&1&&ne(0,"th-dragControls",12),i&2){$t();let t=Ft(22),n=Ft(26),r=Ft(30);N("args",Zs(3,Lce,_t(1,Oce,n.objRef),r.objRef,t.hostElement.nativeElement))}}function Hce(i,e){i&1&&ne(0,"th-flyControls")}function Gce(i,e){i&1&&ne(0,"th-trackballControls")}function Wce(i,e){i&1&&ne(0,"th-firstPersonControls")}var y4=(()=>{let e=class e{constructor(){this.controlType="orbit",this.renderOnDemand=!0,this.selected=!1,this.glbPath=`${ui}DamagedHelmet.glb`}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-on-demand-example"]],decls:39,vars:21,consts:[["canvas",""],["model",""],["camera",""],[1,"control-panel"],["id","ondemand","type","checkbox",3,"ngModelChange","ngModel"],["for","ondemand"],[1,"form-control",3,"ngModelChange","ngModel"],[1,"works-on-demand"],[1,"needs-loop"],[3,"thStats","renderOnDemand"],[3,"intensity"],["loadGLTF","",3,"onClick","url","scale"],[3,"args"],[3,"position","decay"],[3,"args","position","lookAt"],[3,"object"]],template:function(r,o){if(r&1){let s=en();B(0,"div",3)(1,"input",4),Cd("ngModelChange",function(c){return rt(s),Rf(o.renderOnDemand,c)||(o.renderOnDemand=c),ot(c)}),X(),B(2,"label",5),Vt(3,"Render On-Demand"),X(),B(4,"select",6),Cd("ngModelChange",function(c){return rt(s),Rf(o.controlType,c)||(o.controlType=c),ot(c)}),B(5,"option",7),Vt(6,"orbit"),X(),B(7,"option",7),Vt(8,"map"),X(),B(9,"option",7),Vt(10,"arcball"),X(),B(11,"option",7),Vt(12,"transform"),X(),B(13,"option",7),Vt(14,"drag"),X(),B(15,"option",8),Vt(16,"fly"),X(),B(17,"option",8),Vt(18,"trackball"),X(),B(19,"option",8),Vt(20,"firstpersion"),X()()(),B(21,"th-canvas",9,0)(23,"th-scene"),ne(24,"th-ambientLight",10),B(25,"th-object3D",11,1),Ie("onClick",function(){return rt(s),ot(o.selected=!o.selected)}),X(),ne(27,"th-gridHelper",12)(28,"th-pointLight",13),B(29,"th-perspectiveCamera",14,2),Vi(31,kce,1,0,"th-orbitControls")(32,Bce,1,0,"th-mapControls")(33,Uce,1,0,"th-arcballControls")(34,Vce,1,1,"th-transformControls",15)(35,zce,1,7,"th-dragControls",12)(36,Hce,1,0,"th-flyControls")(37,Gce,1,0,"th-trackballControls")(38,Wce,1,0,"th-firstPersonControls"),X()()()}if(r&2){let s;F(),Td("ngModel",o.renderOnDemand),F(3),Td("ngModel",o.controlType),F(17),N("thStats",!0)("renderOnDemand",o.renderOnDemand),F(3),N("intensity",3),F(),N("url",o.glbPath)("scale",o.selected?V(14,Ace):V(15,Pce)),F(2),N("args",V(16,Fce)),F(),N("position",V(17,v4))("decay",0),F(),N("args",V(18,Nce))("position",V(19,v4))("lookAt",V(20,jce)),F(2),zi((s=o.controlType)==="orbit"?31:s==="map"?32:s==="arcball"?33:s==="transform"?34:s==="drag"?35:s==="fly"?36:s==="trackball"?37:s==="firstpersion"?38:-1)}},dependencies:[ln,hU,mU,MU,EU,AU,vi,UU,vS,Gt,de,dr,Tn,Gi,Ot,At,hr,wu,dm,yi,km,m4,_4,EF,ER,TR,a0],styles:[".needs-loop[_ngcontent-%COMP%]{color:red}.works-on-demand[_ngcontent-%COMP%]{color:green}.control-panel[_ngcontent-%COMP%]{display:flex;gap:1em;margin:1em}"],changeDetection:0});let i=e;return i})();var Bu=class i{constructor(e,t,n,r,o="div"){this.parent=e,this.object=t,this.property=n,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement(o),this.domElement.classList.add("controller"),this.domElement.classList.add(r),this.$name=document.createElement("div"),this.$name.classList.add("name"),i.nextNameID=i.nextNameID||0,this.$name.id=`lil-gui-name-${++i.nextNameID}`,this.$widget=document.createElement("div"),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.domElement.addEventListener("keydown",s=>s.stopPropagation()),this.domElement.addEventListener("keyup",s=>s.stopPropagation()),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(n)}name(e){return this._name=e,this.$name.textContent=e,this}onChange(e){return this._onChange=e,this}_callOnChange(){this.parent._callOnChange(this),this._onChange!==void 0&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),this._onFinishChange!==void 0&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(e=!0){return this.disable(!e)}disable(e=!0){return e===this._disabled?this:(this._disabled=e,this.domElement.classList.toggle("disabled",e),this.$disable.toggleAttribute("disabled",e),this)}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(e){let t=this.parent.add(this.object,this.property,e);return t.name(this._name),this.destroy(),t}min(e){return this}max(e){return this}step(e){return this}decimals(e){return this}listen(e=!0){return this._listening=e,this._listenCallbackID!==void 0&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);let e=this.save();e!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=e}getValue(){return this.object[this.property]}setValue(e){return this.getValue()!==e&&(this.object[this.property]=e,this._callOnChange(),this.updateDisplay()),this}updateDisplay(){return this}load(e){return this.setValue(e),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}},AF=class extends Bu{constructor(e,t,n){super(e,t,n,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}};function PF(i){let e,t;return(e=i.match(/(#|0x)?([a-f0-9]{6})/i))?t=e[2]:(e=i.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?t=parseInt(e[1]).toString(16).padStart(2,0)+parseInt(e[2]).toString(16).padStart(2,0)+parseInt(e[3]).toString(16).padStart(2,0):(e=i.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(t=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),t?"#"+t:!1}var $ce={isPrimitive:!0,match:i=>typeof i=="string",fromHexString:PF,toHexString:PF},l0={isPrimitive:!0,match:i=>typeof i=="number",fromHexString:i=>parseInt(i.substring(1),16),toHexString:i=>"#"+i.toString(16).padStart(6,0)},qce={isPrimitive:!1,match:i=>Array.isArray(i),fromHexString(i,e,t=1){let n=l0.fromHexString(i);e[0]=(n>>16&255)/255*t,e[1]=(n>>8&255)/255*t,e[2]=(n&255)/255*t},toHexString([i,e,t],n=1){n=255/n;let r=i*n<<16^e*n<<8^t*n<<0;return l0.toHexString(r)}},Xce={isPrimitive:!1,match:i=>Object(i)===i,fromHexString(i,e,t=1){let n=l0.fromHexString(i);e.r=(n>>16&255)/255*t,e.g=(n>>8&255)/255*t,e.b=(n&255)/255*t},toHexString({r:i,g:e,b:t},n=1){n=255/n;let r=i*n<<16^e*n<<8^t*n<<0;return l0.toHexString(r)}},Zce=[$ce,l0,qce,Xce];function Yce(i){return Zce.find(e=>e.match(i))}var FF=class extends Bu{constructor(e,t,n,r){super(e,t,n,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=Yce(this.initialValue),this._rgbScale=r,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{let o=PF(this.$text.value);o&&this._setValueFromHexString(o)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(e){if(this._format.isPrimitive){let t=this._format.fromHexString(e);this.setValue(t)}else this._format.fromHexString(e,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(e){return this._setValueFromHexString(e),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}},c0=class extends Bu{constructor(e,t,n){super(e,t,n,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",r=>{r.preventDefault(),this.getValue().call(this.object),this._callOnChange()}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}},NF=class extends Bu{constructor(e,t,n,r,o,s){super(e,t,n,"number"),this._initInput(),this.min(r),this.max(o);let a=s!==void 0;this.step(a?s:this._getImplicitStep(),a),this.updateDisplay()}decimals(e){return this._decimals=e,this.updateDisplay(),this}min(e){return this._min=e,this._onUpdateMinMax(),this}max(e){return this._max=e,this._onUpdateMinMax(),this}step(e,t=!0){return this._step=e,this._stepExplicit=t,this}updateDisplay(){let e=this.getValue();if(this._hasSlider){let t=(e-this._min)/(this._max-this._min);t=Math.max(0,Math.min(t,1)),this.$fill.style.width=t*100+"%"}return this._inputFocused||(this.$input.value=this._decimals===void 0?e:e.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),window.matchMedia("(pointer: coarse)").matches&&(this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any")),this.$widget.appendChild(this.$input),this.$disable=this.$input;let t=()=>{let b=parseFloat(this.$input.value);isNaN(b)||(this._stepExplicit&&(b=this._snap(b)),this.setValue(this._clamp(b)))},n=b=>{let v=parseFloat(this.$input.value);isNaN(v)||(this._snapClampSetValue(v+b),this.$input.value=this.getValue())},r=b=>{b.key==="Enter"&&this.$input.blur(),b.code==="ArrowUp"&&(b.preventDefault(),n(this._step*this._arrowKeyMultiplier(b))),b.code==="ArrowDown"&&(b.preventDefault(),n(this._step*this._arrowKeyMultiplier(b)*-1))},o=b=>{this._inputFocused&&(b.preventDefault(),n(this._step*this._normalizeMouseWheel(b)))},s=!1,a,c,l,u,d,h=5,f=b=>{a=b.clientX,c=l=b.clientY,s=!0,u=this.getValue(),d=0,window.addEventListener("mousemove",g),window.addEventListener("mouseup",_)},g=b=>{if(s){let v=b.clientX-a,y=b.clientY-c;Math.abs(y)>h?(b.preventDefault(),this.$input.blur(),s=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(v)>h&&_()}if(!s){let v=b.clientY-l;d-=v*this._step*this._arrowKeyMultiplier(b),u+d>this._max?d=this._max-u:u+d<this._min&&(d=this._min-u),this._snapClampSetValue(u+d)}l=b.clientY},_=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",_)},m=()=>{this._inputFocused=!0},p=()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()};this.$input.addEventListener("input",t),this.$input.addEventListener("keydown",r),this.$input.addEventListener("wheel",o,{passive:!1}),this.$input.addEventListener("mousedown",f),this.$input.addEventListener("focus",m),this.$input.addEventListener("blur",p)}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");let e=(p,b,v,y,w)=>(p-b)/(v-b)*(w-y)+y,t=p=>{let b=this.$slider.getBoundingClientRect(),v=e(p,b.left,b.right,this._min,this._max);this._snapClampSetValue(v)},n=p=>{this._setDraggingStyle(!0),t(p.clientX),window.addEventListener("mousemove",r),window.addEventListener("mouseup",o)},r=p=>{t(p.clientX)},o=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",o)},s=!1,a,c,l=p=>{p.preventDefault(),this._setDraggingStyle(!0),t(p.touches[0].clientX),s=!1},u=p=>{p.touches.length>1||(this._hasScrollBar?(a=p.touches[0].clientX,c=p.touches[0].clientY,s=!0):l(p),window.addEventListener("touchmove",d,{passive:!1}),window.addEventListener("touchend",h))},d=p=>{if(s){let b=p.touches[0].clientX-a,v=p.touches[0].clientY-c;Math.abs(b)>Math.abs(v)?l(p):(window.removeEventListener("touchmove",d),window.removeEventListener("touchend",h))}else p.preventDefault(),t(p.touches[0].clientX)},h=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",d),window.removeEventListener("touchend",h)},f=this._callOnFinishChange.bind(this),g=400,_,m=p=>{if(Math.abs(p.deltaX)<Math.abs(p.deltaY)&&this._hasScrollBar)return;p.preventDefault();let v=this._normalizeMouseWheel(p)*this._step;this._snapClampSetValue(this.getValue()+v),this.$input.value=this.getValue(),clearTimeout(_),_=setTimeout(f,g)};this.$slider.addEventListener("mousedown",n),this.$slider.addEventListener("touchstart",u,{passive:!1}),this.$slider.addEventListener("wheel",m,{passive:!1})}_setDraggingStyle(e,t="horizontal"){this.$slider&&this.$slider.classList.toggle("active",e),document.body.classList.toggle("lil-gui-dragging",e),document.body.classList.toggle(`lil-gui-${t}`,e)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(e){let{deltaX:t,deltaY:n}=e;return Math.floor(e.deltaY)!==e.deltaY&&e.wheelDelta&&(t=0,n=-e.wheelDelta/120,n*=this._stepExplicit?1:10),t+-n}_arrowKeyMultiplier(e){let t=this._stepExplicit?1:10;return e.shiftKey?t*=10:e.altKey&&(t/=10),t}_snap(e){let t=0;return this._hasMin?t=this._min:this._hasMax&&(t=this._max),e-=t,e=Math.round(e/this._step)*this._step,e+=t,e=parseFloat(e.toPrecision(15)),e}_clamp(e){return e<this._min&&(e=this._min),e>this._max&&(e=this._max),e}_snapClampSetValue(e){this.setValue(this._clamp(this._snap(e)))}get _hasScrollBar(){let e=this.parent.root.$children;return e.scrollHeight>e.clientHeight}get _hasMin(){return this._min!==void 0}get _hasMax(){return this._max!==void 0}},jF=class extends Bu{constructor(e,t,n,r){super(e,t,n,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.options(r)}options(e){return this._values=Array.isArray(e)?e:Object.values(e),this._names=Array.isArray(e)?e:Object.keys(e),this.$select.replaceChildren(),this._names.forEach(t=>{let n=document.createElement("option");n.textContent=t,this.$select.appendChild(n)}),this.updateDisplay(),this}updateDisplay(){let e=this.getValue(),t=this._values.indexOf(e);return this.$select.selectedIndex=t,this.$display.textContent=t===-1?e:this._names[t],this}},OF=class extends Bu{constructor(e,t,n){super(e,t,n,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("spellcheck","false"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",r=>{r.code==="Enter"&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}},Qce=`.lil-gui {
  font-family: var(--font-family);
  font-size: var(--font-size);
  line-height: 1;
  font-weight: normal;
  font-style: normal;
  text-align: left;
  color: var(--text-color);
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  --background-color: #1f1f1f;
  --text-color: #ebebeb;
  --title-background-color: #111111;
  --title-text-color: #ebebeb;
  --widget-color: #424242;
  --hover-color: #4f4f4f;
  --focus-color: #595959;
  --number-color: #2cc9ff;
  --string-color: #a2db3c;
  --font-size: 11px;
  --input-font-size: 11px;
  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;
  --padding: 4px;
  --spacing: 4px;
  --widget-height: 20px;
  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);
  --name-width: 45%;
  --slider-knob-width: 2px;
  --slider-input-width: 27%;
  --color-input-width: 27%;
  --slider-input-min-width: 45px;
  --color-input-min-width: 45px;
  --folder-indent: 7px;
  --widget-padding: 0 0 0 3px;
  --widget-border-radius: 2px;
  --checkbox-size: calc(0.75 * var(--widget-height));
  --scrollbar-width: 5px;
}
.lil-gui, .lil-gui * {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}
.lil-gui.root {
  width: var(--width, 245px);
  display: flex;
  flex-direction: column;
  background: var(--background-color);
}
.lil-gui.root > .title {
  background: var(--title-background-color);
  color: var(--title-text-color);
}
.lil-gui.root > .children {
  overflow-x: hidden;
  overflow-y: auto;
}
.lil-gui.root > .children::-webkit-scrollbar {
  width: var(--scrollbar-width);
  height: var(--scrollbar-width);
  background: var(--background-color);
}
.lil-gui.root > .children::-webkit-scrollbar-thumb {
  border-radius: var(--scrollbar-width);
  background: var(--focus-color);
}
@media (pointer: coarse) {
  .lil-gui.allow-touch-styles, .lil-gui.allow-touch-styles .lil-gui {
    --widget-height: 28px;
    --padding: 6px;
    --spacing: 6px;
    --font-size: 13px;
    --input-font-size: 16px;
    --folder-indent: 10px;
    --scrollbar-width: 7px;
    --slider-input-min-width: 50px;
    --color-input-min-width: 65px;
  }
}
.lil-gui.force-touch-styles, .lil-gui.force-touch-styles .lil-gui {
  --widget-height: 28px;
  --padding: 6px;
  --spacing: 6px;
  --font-size: 13px;
  --input-font-size: 16px;
  --folder-indent: 10px;
  --scrollbar-width: 7px;
  --slider-input-min-width: 50px;
  --color-input-min-width: 65px;
}
.lil-gui.autoPlace {
  max-height: 100%;
  position: fixed;
  top: 0;
  right: 15px;
  z-index: 1001;
}

.lil-gui .controller {
  display: flex;
  align-items: center;
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
}
.lil-gui .controller.disabled {
  opacity: 0.5;
}
.lil-gui .controller.disabled, .lil-gui .controller.disabled * {
  pointer-events: none !important;
}
.lil-gui .controller > .name {
  min-width: var(--name-width);
  flex-shrink: 0;
  white-space: pre;
  padding-right: var(--spacing);
  line-height: var(--widget-height);
}
.lil-gui .controller .widget {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  min-height: var(--widget-height);
}
.lil-gui .controller.string input {
  color: var(--string-color);
}
.lil-gui .controller.boolean {
  cursor: pointer;
}
.lil-gui .controller.color .display {
  width: 100%;
  height: var(--widget-height);
  border-radius: var(--widget-border-radius);
  position: relative;
}
@media (hover: hover) {
  .lil-gui .controller.color .display:hover:before {
    content: " ";
    display: block;
    position: absolute;
    border-radius: var(--widget-border-radius);
    border: 1px solid #fff9;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
.lil-gui .controller.color input[type=color] {
  opacity: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
}
.lil-gui .controller.color input[type=text] {
  margin-left: var(--spacing);
  font-family: var(--font-family-mono);
  min-width: var(--color-input-min-width);
  width: var(--color-input-width);
  flex-shrink: 0;
}
.lil-gui .controller.option select {
  opacity: 0;
  position: absolute;
  width: 100%;
  max-width: 100%;
}
.lil-gui .controller.option .display {
  position: relative;
  pointer-events: none;
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  line-height: var(--widget-height);
  max-width: 100%;
  overflow: hidden;
  word-break: break-all;
  padding-left: 0.55em;
  padding-right: 1.75em;
  background: var(--widget-color);
}
@media (hover: hover) {
  .lil-gui .controller.option .display.focus {
    background: var(--focus-color);
  }
}
.lil-gui .controller.option .display.active {
  background: var(--focus-color);
}
.lil-gui .controller.option .display:after {
  font-family: "lil-gui";
  content: "\u2195";
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  padding-right: 0.375em;
}
.lil-gui .controller.option .widget,
.lil-gui .controller.option select {
  cursor: pointer;
}
@media (hover: hover) {
  .lil-gui .controller.option .widget:hover .display {
    background: var(--hover-color);
  }
}
.lil-gui .controller.number input {
  color: var(--number-color);
}
.lil-gui .controller.number.hasSlider input {
  margin-left: var(--spacing);
  width: var(--slider-input-width);
  min-width: var(--slider-input-min-width);
  flex-shrink: 0;
}
.lil-gui .controller.number .slider {
  width: 100%;
  height: var(--widget-height);
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
  padding-right: var(--slider-knob-width);
  overflow: hidden;
  cursor: ew-resize;
  touch-action: pan-y;
}
@media (hover: hover) {
  .lil-gui .controller.number .slider:hover {
    background: var(--hover-color);
  }
}
.lil-gui .controller.number .slider.active {
  background: var(--focus-color);
}
.lil-gui .controller.number .slider.active .fill {
  opacity: 0.95;
}
.lil-gui .controller.number .fill {
  height: 100%;
  border-right: var(--slider-knob-width) solid var(--number-color);
  box-sizing: content-box;
}

.lil-gui-dragging .lil-gui {
  --hover-color: var(--widget-color);
}
.lil-gui-dragging * {
  cursor: ew-resize !important;
}

.lil-gui-dragging.lil-gui-vertical * {
  cursor: ns-resize !important;
}

.lil-gui .title {
  height: var(--title-height);
  font-weight: 600;
  padding: 0 var(--padding);
  width: 100%;
  text-align: left;
  background: none;
  text-decoration-skip: objects;
}
.lil-gui .title:before {
  font-family: "lil-gui";
  content: "\u25BE";
  padding-right: 2px;
  display: inline-block;
}
.lil-gui .title:active {
  background: var(--title-background-color);
  opacity: 0.75;
}
@media (hover: hover) {
  body:not(.lil-gui-dragging) .lil-gui .title:hover {
    background: var(--title-background-color);
    opacity: 0.85;
  }
  .lil-gui .title:focus {
    text-decoration: underline var(--focus-color);
  }
}
.lil-gui.root > .title:focus {
  text-decoration: none !important;
}
.lil-gui.closed > .title:before {
  content: "\u25B8";
}
.lil-gui.closed > .children {
  transform: translateY(-7px);
  opacity: 0;
}
.lil-gui.closed:not(.transition) > .children {
  display: none;
}
.lil-gui.transition > .children {
  transition-duration: 300ms;
  transition-property: height, opacity, transform;
  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);
  overflow: hidden;
  pointer-events: none;
}
.lil-gui .children:empty:before {
  content: "Empty";
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
  display: block;
  height: var(--widget-height);
  font-style: italic;
  line-height: var(--widget-height);
  opacity: 0.5;
}
.lil-gui.root > .children > .lil-gui > .title {
  border: 0 solid var(--widget-color);
  border-width: 1px 0;
  transition: border-color 300ms;
}
.lil-gui.root > .children > .lil-gui.closed > .title {
  border-bottom-color: transparent;
}
.lil-gui + .controller {
  border-top: 1px solid var(--widget-color);
  margin-top: 0;
  padding-top: var(--spacing);
}
.lil-gui .lil-gui .lil-gui > .title {
  border: none;
}
.lil-gui .lil-gui .lil-gui > .children {
  border: none;
  margin-left: var(--folder-indent);
  border-left: 2px solid var(--widget-color);
}
.lil-gui .lil-gui .controller {
  border: none;
}

.lil-gui label, .lil-gui input, .lil-gui button {
  -webkit-tap-highlight-color: transparent;
}
.lil-gui input {
  border: 0;
  outline: none;
  font-family: var(--font-family);
  font-size: var(--input-font-size);
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  background: var(--widget-color);
  color: var(--text-color);
  width: 100%;
}
@media (hover: hover) {
  .lil-gui input:hover {
    background: var(--hover-color);
  }
  .lil-gui input:active {
    background: var(--focus-color);
  }
}
.lil-gui input:disabled {
  opacity: 1;
}
.lil-gui input[type=text],
.lil-gui input[type=number] {
  padding: var(--widget-padding);
  -moz-appearance: textfield;
}
.lil-gui input[type=text]:focus,
.lil-gui input[type=number]:focus {
  background: var(--focus-color);
}
.lil-gui input[type=checkbox] {
  appearance: none;
  width: var(--checkbox-size);
  height: var(--checkbox-size);
  border-radius: var(--widget-border-radius);
  text-align: center;
  cursor: pointer;
}
.lil-gui input[type=checkbox]:checked:before {
  font-family: "lil-gui";
  content: "\u2713";
  font-size: var(--checkbox-size);
  line-height: var(--checkbox-size);
}
@media (hover: hover) {
  .lil-gui input[type=checkbox]:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui button {
  outline: none;
  cursor: pointer;
  font-family: var(--font-family);
  font-size: var(--font-size);
  color: var(--text-color);
  width: 100%;
  border: none;
}
.lil-gui .controller button {
  height: var(--widget-height);
  text-transform: none;
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
}
@media (hover: hover) {
  .lil-gui .controller button:hover {
    background: var(--hover-color);
  }
  .lil-gui .controller button:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui .controller button:active {
  background: var(--focus-color);
}

@font-face {
  font-family: "lil-gui";
  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");
}`;function Kce(i){let e=document.createElement("style");e.innerHTML=i;let t=document.querySelector("head link[rel=stylesheet], head style");t?document.head.insertBefore(e,t):document.head.appendChild(e)}var x4=!1,DR=class i{constructor({parent:e,autoPlace:t=e===void 0,container:n,width:r,title:o="Controls",closeFolders:s=!1,injectStyles:a=!0,touchStyles:c=!0}={}){if(this.parent=e,this.root=e?e.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("button"),this.$title.classList.add("title"),this.$title.setAttribute("aria-expanded",!0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(o),this.parent){this.parent.children.push(this),this.parent.folders.push(this),this.parent.$children.appendChild(this.domElement);return}this.domElement.classList.add("root"),c&&this.domElement.classList.add("allow-touch-styles"),!x4&&a&&(Kce(Qce),x4=!0),n?n.appendChild(this.domElement):t&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),r&&this.domElement.style.setProperty("--width",r+"px"),this._closeFolders=s}add(e,t,n,r,o){if(Object(n)===n)return new jF(this,e,t,n);let s=e[t];switch(typeof s){case"number":return new NF(this,e,t,n,r,o);case"boolean":return new AF(this,e,t);case"string":return new OF(this,e,t);case"function":return new c0(this,e,t)}console.error(`gui.add failed
	property:`,t,`
	object:`,e,`
	value:`,s)}addColor(e,t,n=1){return new FF(this,e,t,n)}addFolder(e){let t=new i({parent:this,title:e});return this.root._closeFolders&&t.close(),t}load(e,t=!0){return e.controllers&&this.controllers.forEach(n=>{n instanceof c0||n._name in e.controllers&&n.load(e.controllers[n._name])}),t&&e.folders&&this.folders.forEach(n=>{n._title in e.folders&&n.load(e.folders[n._title])}),this}save(e=!0){let t={controllers:{},folders:{}};return this.controllers.forEach(n=>{if(!(n instanceof c0)){if(n._name in t.controllers)throw new Error(`Cannot save GUI with duplicate property "${n._name}"`);t.controllers[n._name]=n.save()}}),e&&this.folders.forEach(n=>{if(n._title in t.folders)throw new Error(`Cannot save GUI with duplicate folder "${n._title}"`);t.folders[n._title]=n.save()}),t}open(e=!0){return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}_setClosed(e){this._closed!==e&&(this._closed=e,this._callOnOpenClose(this))}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(e=!0){return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{let t=this.$children.clientHeight;this.$children.style.height=t+"px",this.domElement.classList.add("transition");let n=o=>{o.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",n))};this.$children.addEventListener("transitionend",n);let r=e?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!e),requestAnimationFrame(()=>{this.$children.style.height=r+"px"})}),this}title(e){return this._title=e,this.$title.textContent=e,this}reset(e=!0){return(e?this.controllersRecursive():this.controllers).forEach(n=>n.reset()),this}onChange(e){return this._onChange=e,this}_callOnChange(e){this.parent&&this.parent._callOnChange(e),this._onChange!==void 0&&this._onChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(e){this.parent&&this.parent._callOnFinishChange(e),this._onFinishChange!==void 0&&this._onFinishChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onOpenClose(e){return this._onOpenClose=e,this}_callOnOpenClose(e){this.parent&&this.parent._callOnOpenClose(e),this._onOpenClose!==void 0&&this._onOpenClose.call(this,e)}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(e=>e.destroy())}controllersRecursive(){let e=Array.from(this.controllers);return this.folders.forEach(t=>{e=e.concat(t.controllersRecursive())}),e}foldersRecursive(){let e=Array.from(this.folders);return this.folders.forEach(t=>{e=e.concat(t.foldersRecursive())}),e}};var Jce=["outlinePass"],ele=()=>["#ffffff"],tle=()=>[0,0,8],nle=()=>["#aaaaaa"],ile=()=>["#ddffdd"],rle=()=>[3,48,24],LF=(i,e,t)=>[i,e,t];function ole(i,e){if(i&1){let t=en();B(0,"th-mesh",13),Ie("onMouseEnter",function(r){rt(t);let o=$t();return ot(o.onHover(r))})("onMouseExit",function(){rt(t);let r=$t();return ot(r.onBlur())})("onPointerDown",function(r){rt(t);let o=$t();return ot(o.onPointerDown(r))}),ne(1,"th-meshPhongMaterial",14),X()}if(i&2){let t=e.$implicit;$t();let n=Ft(11);N("geometry",n.objRef)("position",Zs(7,LF,t.x,t.y,t.z))("scale",Zs(11,LF,t.scale,t.scale,t.scale))("receiveShadow",!0)("castShadow",!0),F(),N("flatShading",!0)("color",t.color)}}var w4=(()=>{let e=class e{constructor(){this.elem=S(vt),this.outlinePassResolution=new z(window.innerWidth,window.innerHeight),this.meshData=[],this.visibleEdgeColor="#ffffff",this.hiddenEdgeColor="#190a05",this.edgeStrength=3,this.edgeGlow=.5,this.edgeThickness=1,this.pulsePeriod=1,this.initGUI(),this.initMeshData()}initGUI(){let n=new DR({title:"Settings",injectStyles:!0,container:this.elem.nativeElement,autoPlace:!0});n.add(this,"edgeStrength",.01,10),n.add(this,"edgeGlow",0,2),n.add(this,"edgeThickness",1,4),n.add(this,"pulsePeriod",0,5),n.addColor(this,"visibleEdgeColor"),n.addColor(this,"hiddenEdgeColor")}ngOnInit(){this.outlinePassResolution=new z(window.innerWidth,window.innerHeight),this.outlinePass&&(this.outlinePass.resolution=this.outlinePassResolution)}initMeshData(){for(let n=0;n<20;n++)this.meshData.push({color:new ue().setHSL(Math.random(),1,.3),x:Math.random()*4-2,y:Math.random()*4-2,z:Math.random()*4-2,scale:Math.random()*.3+.1})}onHover(n){n.component.objRef&&(this.outlinePass.selectedObjects=[n.component.objRef])}onBlur(){this.outlinePass.selectedObjects=[]}onPointerDown(n){n.component.material?.color.set("#ff0000")}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-outline-pass-events-example"]],viewQuery:function(r,o){if(r&1&&tn(Jce,7),r&2){let s;st(s=at())&&(o.outlinePass=s.first)}},decls:20,vars:32,consts:[["thecanvas",""],["scene",""],["camera",""],["light",""],["geometry",""],["outlinePass",""],[3,"shadow","thStats"],[3,"background"],[3,"position","fov","near","far"],[3,"color","intensity"],[3,"args"],[3,"geometry","position","scale","receiveShadow","castShadow"],[3,"args","visibleEdgeColor","hiddenEdgeColor","edgeStrength","edgeGlow","edgeThickness","pulsePeriod"],[3,"onMouseEnter","onMouseExit","onPointerDown","geometry","position","scale","receiveShadow","castShadow"],[3,"flatShading","color"]],template:function(r,o){if(r&1&&(B(0,"th-canvas",6,0)(2,"th-scene",7,1)(4,"th-perspectiveCamera",8,2),ne(6,"th-orbitControls"),X(),ne(7,"th-ambientLight",9)(8,"th-directionalLight",9,3)(10,"th-sphereGeometry",10,4),Ki(12,ole,2,15,"th-mesh",11,Qi),X(),B(14,"th-effectComposer"),ne(15,"th-renderPass")(16,"th-outlinePass",12,5),In(18,"color"),In(19,"color"),X()()),r&2){let s=Ft(3),a=Ft(5);N("shadow",!0)("thStats",!0),F(2),N("background",V(23,ele)),F(2),N("position",V(24,tle))("fov",45)("near",.1)("far",100),F(3),N("color",V(25,nle))("intensity",3),F(),N("color",V(26,ile))("intensity",1.8),F(2),N("args",V(27,rle)),F(2),Ji(o.meshData),F(4),N("args",Zs(28,LF,o.outlinePassResolution,s.objRef,a.objRef))("visibleEdgeColor",jn(18,19,o.visibleEdgeColor))("hiddenEdgeColor",jn(19,21,o.hiddenEdgeColor))("edgeStrength",o.edgeStrength)("edgeGlow",o.edgeGlow)("edgeThickness",o.edgeThickness)("pulsePeriod",o.pulsePeriod)}},dependencies:[ln,vi,Gt,Tn,Pr,Cn,Ot,No,fc,Su,VU,Qp,At,wu,yi,As],styles:["[_nghost-%COMP%]     .lil-gui{position:fixed;right:0;z-index:9999}"],changeDetection:0});let i=e;return i})();var sle=["camera"],ale=()=>["#72645b",2,15],cle=i=>[0,i,0],M4=i=>[i,0,0],lle=()=>[40,40],ule=()=>({color:"#999999",specular:"#101010"}),dle=i=>[0,i,.3],hle=()=>[.001,.001,.001],fle=()=>({color:"#0055ff",flatShading:!0}),ple=()=>["#443333","#111122"],mle=()=>[1,1,1],gle=i=>[.5,1,i],_le=()=>[35,2,1,15],S4=(()=>{let e=class e{constructor(){this.Math=Math,this.cameraPosition=new C(3,.15,3),this.assetPath=`${ui}dolphins.ply`}onBeforeRender(){let n=Date.now()*5e-4;this.camera&&(this.camera.position=new C(Math.sin(n)*2.5,.15,Math.cos(n)*2.5),this.camera.lookAt=[0,.1,0])}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-plyloader-example"]],viewQuery:function(r,o){if(r&1&&tn(sle,5),r&2){let s;st(s=at())&&(o.camera=s.first)}},decls:17,vars:58,consts:[["camera",""],[3,"onRender","shadow"],[3,"background","fog"],[3,"position","rotation","receiveShadow"],[3,"args"],[3,"rotation","position","scale","castShadow","receiveShadow"],["loadPLY","",3,"url"],[3,"args","intensity"],[3,"castShadow","position","color","intensity","receiveShadow"]],template:function(r,o){if(r&1){let s=en();B(0,"th-canvas",1),Ie("onRender",function(){return rt(s),ot(o.onBeforeRender())}),B(1,"th-scene",2),In(2,"color"),In(3,"fog"),B(4,"th-mesh",3),ne(5,"th-planeGeometry",4)(6,"th-meshPhongMaterial",4),X(),B(7,"th-mesh",5),ne(8,"th-bufferGeometry",6)(9,"th-meshStandardMaterial",4),X(),ne(10,"th-hemisphereLight",7)(11,"th-directionalLight",8),In(12,"color"),ne(13,"th-directionalLight",8),In(14,"color"),ne(15,"th-perspectiveCamera",4,0),X()()}r&2&&(N("shadow",!0),F(),N("background",jn(2,32,"#72645b"))("fog",jn(3,34,V(40,ale))),F(3),N("position",_t(41,cle,-.5))("rotation",_t(43,M4,-o.Math.PI/2))("receiveShadow",!0),F(),N("args",V(45,lle)),F(),N("args",V(46,ule)),F(),N("rotation",_t(47,M4,-o.Math.PI/2))("position",_t(49,dle,-.2))("scale",V(51,hle))("castShadow",!0)("receiveShadow",!0),F(),N("url",o.assetPath),F(),N("args",V(52,fle)),F(),N("args",V(53,ple))("intensity",3),F(),N("castShadow",!0)("position",V(54,mle))("color",jn(12,36,"#ffffff"))("intensity",1.35)("castShadow",!0)("receiveShadow",!0)("intensity",3),F(2),N("castShadow",!0)("position",_t(55,gle,-1))("color",jn(14,38,"#ffaa00"))("intensity",1)("castShadow",!0)("receiveShadow",!0)("intensity",3),F(2),N("args",V(57,_le)))},dependencies:[ln,Gt,Pr,em,Cn,Ot,No,Dh,Kt,Ds,At,oV,As,SS],encapsulation:2,changeDetection:0});let i=e;return i})();var ble=["object"],vle=["light"],yle=i=>[i],xle=i=>({value:i}),wle=i=>({amount:i}),R4=()=>["#ffffff"],Mle=i=>[0,0,i],Sle=()=>["#333333"],Rle=()=>[1,4,4];function Tle(i,e){if(i&1&&(B(0,"th-mesh",14),ne(1,"th-meshPhongMaterial",15),X()),i&2){let t=e.$implicit;$t();let n=Ft(15);N("geometry",n.objRef)("position",t.pos)("rotation",t.rotation)("scale",t.scale),F(),N("flatShading",!0)("color",t.color)}}var T4=(()=>{let e=class e{constructor(){this.DotScreenShader=JM,this.RGBShiftShader=vR,this.shiftAmount=.0015,this.zDist=400,this.meshData=[],this.initMeshData()}ngOnInit(){this.light?.position?.set(1,1,1)}initMeshData(){for(let n=0;n<100;n++){let r=Math.random()*50;this.meshData.push({pos:new C(Math.random()-.5,Math.random()-.5,Math.random()-.5).normalize().multiplyScalar(Math.random()*this.zDist),rotation:new ho(Math.random()*2,Math.random()*2,Math.random()*2),scale:new C(r,r,r),color:new ue(16777215*Math.random())})}}animate(){this.object?.objRef?.rotation&&(this.object.objRef.rotation.x+=.005,this.object.objRef.rotation.y+=.01)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-post-processing-example"]],viewQuery:function(r,o){if(r&1&&(tn(ble,7),tn(vle,7)),r&2){let s;st(s=at())&&(o.object=s.first),st(s=at())&&(o.light=s.first)}},decls:20,vars:30,consts:[["thecanvas",""],["light",""],["geometry",""],["object",""],["for","shift"],["id","shift","type","range",3,"ngModelChange","ngModel","min","max","step"],[3,"onRender","shadow","thStats"],[3,"strength"],[3,"args","uniforms"],[3,"background"],[3,"position","fov","near","far"],[3,"color","intensity"],[3,"color"],[3,"args"],[3,"geometry","position","rotation","scale"],[3,"flatShading","color"]],template:function(r,o){if(r&1){let s=en();B(0,"label",4),Vt(1,"Shift Amount"),X(),B(2,"input",5),Cd("ngModelChange",function(c){return rt(s),Rf(o.shiftAmount,c)||(o.shiftAmount=c),ot(c)}),X(),B(3,"th-canvas",6,0),Ie("onRender",function(){return rt(s),ot(o.animate())}),B(5,"th-effectComposer"),ne(6,"th-renderPass")(7,"th-unrealBloomPass",7)(8,"th-shaderPass",8),X(),B(9,"th-scene",9),ne(10,"th-perspectiveCamera",10)(11,"th-ambientLight",11)(12,"th-directionalLight",12,1)(14,"th-sphereGeometry",13,2),B(16,"th-object3D",null,3),Ki(18,Tle,2,6,"th-mesh",14,Qi),X()()()}r&2&&(F(2),Td("ngModel",o.shiftAmount),N("min",.0015)("max",.2)("step",.005),F(),N("shadow",!0)("thStats",!0),F(4),N("strength",1),F(),N("args",_t(18,yle,o.RGBShiftShader))("uniforms",_t(22,wle,_t(20,xle,o.shiftAmount))),F(),N("background",V(24,R4)),F(),N("position",_t(25,Mle,o.zDist))("fov",70)("near",1)("far",1e3),F(),N("color",V(27,Sle))("intensity",6),F(),N("color",V(28,R4)),F(2),N("args",V(29,Rle)),F(4),Ji(o.meshData))},dependencies:[ln,Gt,de,Tn,Pr,Cn,Ot,No,fc,Su,Qp,_v,yS,At,yi,km,RR,IF,TR,a0],styles:["label[_ngcontent-%COMP%]{margin-right:.5em}"],changeDetection:0});let i=e;return i})();var kF=i=>[0,i,0],Cle=()=>[0,1,0],Ele=()=>[4,10,2],Dle=i=>[i,0,0],Ile=()=>[100,100],Ale=()=>[55,2,.1,100],Ple=(i,e)=>[i,0,e],Fle=()=>[0,0,0],C4=(()=>{let e=class e{constructor(){this.Math=Math,this.selected=!1,this.glbPath=`${ui}mac-draco.glb`,this.clock=new go(!0),this.plane=new Xi(new C(0,1,0),3),this.rotation=[0,0,0],this.position=[0,0,0],this.uniforms={time:{value:1}},this.fragmentShader1=`
uniform float time;
varying vec2 vUv;

void main( void ) {
  vec2 position = - 1.0 + 2.0 * vUv;

  float red = abs( sin( position.x * position.y + time / 5.0 ) );
  float green = abs( sin( position.x * position.y + time / 4.0 ) );
  float blue = abs( sin( position.x * position.y + time / 3.0 ) );
  gl_FragColor = vec4( red, green, blue, 1.0 );

}
`,this.fragmentShader2=`
  uniform float time;
  varying vec2 vUv;

  void main( void ) {
    vec2 position = vUv;
    float color = 0.0;
    color += sin( position.x * cos( time / 15.0 ) * 80.0 ) + cos( position.y * cos( time / 15.0 ) * 10.0 );
    color += sin( position.y * sin( time / 10.0 ) * 40.0 ) + cos( position.x * sin( time / 25.0 ) * 40.0 );
    color += sin( position.x * sin( time / 5.0 ) * 10.0 ) + sin( position.y * sin( time / 35.0 ) * 80.0 );
    color *= sin( time / 10.0 ) * 0.5;
    gl_FragColor = vec4( vec3( color, color * 0.5, sin( color + time / 3.0 ) * 0.75 ), 1.0 );
  }
  `,this.vertexShader=`varying vec2 vUv;
  void main() {
    vUv = uv;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix * mvPosition;
  }
  `;let n=S(Du);n.setDecoderPath("https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/jsm/libs/draco/gltf/"),n.setCrossOrigin("no-cors"),this.calcPose()}onBeforeRender(){this.calcPose(),this.calcUniforms()}calcPose(){let n=this.clock.getElapsedTime();this.rotation=[Ze.lerp(this.rotation[0],Math.cos(n/2)/20+.25,.1),Ze.lerp(this.rotation[1],Math.sin(n/4)/20,.1),Ze.lerp(this.rotation[2],Math.sin(n/8)/20,.1)],this.position=[0,Ze.lerp(this.position[1],(-2+Math.sin(n/2))/2,.1),0]}calcUniforms(){this.uniforms.time.value=1+this.clock.getElapsedTime()*5}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-ref-by-id-example"]],decls:17,vars:45,consts:[["shader",""],["light",""],[3,"onRender","thStats","shadow"],[3,"rotation","position"],["loadGLTF","",3,"onClick","castShadow","url","position","rotation"],[3,"refById"],[3,"vertexShader","fragmentShader","uniforms"],[3,"castShadow","position","lookAt","color","intensity"],[3,"receiveShadow","rotation","position"],[3,"args"],[3,"color"],[3,"args","position","lookAt"]],template:function(r,o){if(r&1){let s=en();B(0,"th-canvas",2),Ie("onRender",function(){return rt(s),ot(o.onBeforeRender())}),B(1,"th-scene"),ne(2,"th-ambientLight"),B(3,"th-group",3)(4,"th-object3D",4),Ie("onClick",function(){rt(s);let c=Ft(7);return o.selected=!o.selected,ot(c.uniformsNeedUpdate=!0)}),B(5,"th-mesh",5),ne(6,"th-shaderMaterial",6,0),X()()(),ne(8,"th-directionalLight",7,1),In(10,"color"),B(11,"th-mesh",8),ne(12,"th-planeGeometry",9)(13,"th-meshBasicMaterial",10),In(14,"color"),X(),B(15,"th-perspectiveCamera",11),ne(16,"th-orbitControls"),X()()()}r&2&&(N("thStats",!0)("shadow",!0),F(3),N("rotation",_t(29,kF,o.Math.PI))("position",V(31,Cle)),F(),N("castShadow",!0)("url",o.glbPath)("position",o.position)("rotation",o.rotation),F(),N("refById","Cube008_2"),F(),N("vertexShader",o.vertexShader)("fragmentShader",o.selected?o.fragmentShader1:o.fragmentShader2)("uniforms",o.uniforms),F(2),N("castShadow",!0)("position",V(32,Ele))("lookAt",_t(33,kF,-3))("color",jn(10,25,"#ffffff"))("intensity",.75),F(3),N("receiveShadow",!0)("rotation",_t(35,Dle,3*o.Math.PI/2))("position",_t(37,kF,-3)),F(),N("args",V(39,Ile)),F(),N("color",jn(14,27,"#efefef")),F(2),N("args",V(40,Ale))("position",br(41,Ple,-5,-15))("lookAt",V(44,Fle)))},dependencies:[At,Ot,Tn,uc,de,Cn,aA,Ds,dc,Gt,vi,Pr,hr,yi,hm,As],encapsulation:2,changeDetection:0});let i=e;return i})();var BF=()=>[0,0,0],Nle=()=>[2,2,2],jle=()=>[1,1,1],Ole=(i,e)=>[i,e],Lle=()=>[10,10],E4=()=>[10,10,10],kle=()=>[45,2,.1,100],Ble=(()=>{let e=class e extends Cn{ngOnInit(){super.ngOnInit(),this.objRef&&(this.objRef.material=new kr({color:"green"}),this.objRef.geometry=new ei(1,1,1))}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=q(e)))(o||e)}})(),e.\u0275cmp=O({type:e,selectors:[["th-box"]],features:[K(dV(e)),$],decls:0,vars:0,template:function(r,o){},encapsulation:2,changeDetection:0});let i=e;return i})(),D4=(()=>{let e=class e{constructor(){this.THREE=vu,this.box=new wi(new C(0,0,0),new C(1.5,1.5,1.5)),this.color=new ue(1,0,0),this.rotation=[0,0,0],this.material=new kr,this.selected=!1,this.material.color.set("green"),setInterval(()=>{this.material.color.r!==0?(this.material=new kr,this.material.color.set("green")):(this.material=new kr,this.material.color.set("red"))},400)}onBeforeRender(){this.rotation=[0,this.rotation[2]+.01,this.rotation[2]+.01]}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-simple-example"]],features:[K([Mu()])],decls:8,vars:27,consts:[[3,"onRender"],[3,"intensity"],[3,"position","material","rotation","scale"],[3,"onClick","args","material","position"],[3,"args"],[3,"position","intensity","decay"],[3,"args","position","lookAt"]],template:function(r,o){r&1&&(B(0,"th-canvas",0),Ie("onRender",function(){return o.onBeforeRender()}),B(1,"th-scene"),ne(2,"th-ambientLight",1)(3,"th-box",2),B(4,"th-box3Helper",3),Ie("onClick",function(){return o.selected=!o.selected}),X(),ne(5,"th-gridHelper",4)(6,"th-pointLight",5)(7,"th-perspectiveCamera",6),X()()),r&2&&(F(2),N("intensity",3),F(),N("position",V(15,BF))("material",o.material)("rotation",o.rotation)("scale",o.selected?V(16,Nle):V(17,jle)),F(),N("args",br(18,Ole,o.box,o.color))("material",o.material)("position",V(21,BF)),F(),N("args",V(22,Lle)),F(),N("position",V(23,E4))("intensity",3)("decay",0),F(),N("args",V(24,kle))("position",V(25,E4))("lookAt",V(26,BF)))},dependencies:[gU,dr,Gi,Ble,Tn,Ot,At,Gt,wu],encapsulation:2,changeDetection:0});let i=e;return i})();var Ule=["thecanvas"],Vle=(i,e)=>({x:0,y:0,width:i,height:e}),zle=()=>[0,0,1],Hle=()=>["#ffffff"],Gle=()=>[0,0,0],IR=i=>[i,0,0],Wle=()=>[200,32,16],$le=()=>["#fac400"],qle=()=>["#f83f0d"],Xle=()=>[400,0,0],Zle=(i,e,t,n)=>({x:i,y:e,width:t,height:n});function Yle(i,e){if(i&1){let t=en();B(0,"th-view",13,4),Ie("onRender",function(){let r=rt(t).$implicit,o=Ft(3);$t();let s=Ft(3);return ot(r.updateCamera(o.objRef,s.objRef))}),ne(2,"th-perspectiveCamera",14,5),X()}if(i&2){let t=e.$implicit,n=Ft(1),r=$t(),o=Ft(3);N("scene",o)("viewPort",Ed(11,Zle,t.left*r.canvasWidth,t.bottom*r.canvasHeight,t.width*r.canvasWidth,t.height*r.canvasHeight))("scissor",n.viewPort)("scissorTest",!0)("clearColor",t.background),F(2),N("position",t.eye)("up",t.up)("fov",t.fov)("aspect",t.width*r.canvasWidth/(t.height*r.canvasHeight))("near",1)("far",1e4)}}var I4=(()=>{let e=class e{constructor(){this.Math=Math,this.canvasWidth=128,this.canvasHeight=128,this.mouseX=0,this.mouseY=0,this.views=[{left:0,bottom:0,width:.5,height:1,background:new ue(.5,.5,.7),eye:[0,300,1800],up:[0,1,0],fov:30,updateCamera:(n,r)=>{this.updateSize(),n.position.x+=this.mouseX*.05,n.position.x=Math.max(Math.min(n.position.x,2e3),-2e3),n.lookAt(r.position),n.updateProjectionMatrix()}},{left:.5,bottom:0,width:.5,height:.5,background:new ue(.7,.5,.5),eye:[0,1800,0],up:[0,0,1],fov:45,updateCamera:(n,r)=>{this.updateSize(),n.position.x-=this.mouseX*.05,n.position.x=Math.max(Math.min(n.position.x,2e3),-2e3),n.lookAt(n.position.clone().setY(0)),n.updateProjectionMatrix()}},{left:.5,bottom:.5,width:.5,height:.5,background:new ue(.5,.7,.7),eye:[1400,800,1400],up:[0,1,0],fov:60,updateCamera:(n,r)=>{this.updateSize(),n.position.y-=this.mouseX*.05,n.position.y=Math.max(Math.min(n.position.y,1600),-1600),n.lookAt(r.position),n.updateProjectionMatrix()}}]}ngOnInit(){!this.canvas||!this.canvas.rendererCanvas||(this.shadowTexture=new uu(this.canvas.rendererCanvas))}updateSize(){!this.canvas||!this.canvas.rendererCanvas||(this.canvasWidth=this.canvas.rendererCanvas.width,this.canvasHeight=this.canvas.rendererCanvas.height)}onMouseMove(n){if(!this.canvas||!this.canvas.rendererCanvas)return;let r=this.canvas.rendererCanvas.getBoundingClientRect();this.mouseX=n.clientX-r.left-r.width/2,this.mouseY=n.clientY-r.right-r.height/2}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-views-example"]],viewQuery:function(r,o){if(r&1&&tn(Ule,7),r&2){let s;st(s=at())&&(o.canvas=s.first)}},hostBindings:function(r,o){r&1&&Ie("mousemove",function(a){return o.onMouseMove(a)},yd)},decls:14,vars:38,consts:[["thecanvas",""],["scene",""],["geo",""],["mat",""],["thview",""],["camera",""],[3,"disableDefaultView","viewPort"],[3,"position","args","intensity"],[3,"position","rotation"],[3,"args"],[3,"flatShading","shininess","specular","color"],[3,"position","rotation","geometry","material"],[3,"scene","viewPort","scissor","scissorTest","clearColor"],[3,"onRender","scene","viewPort","scissor","scissorTest","clearColor"],[3,"position","up","fov","aspect","near","far"]],template:function(r,o){if(r&1&&(B(0,"th-canvas",6,0)(2,"th-scene",null,1),ne(4,"th-directionalLight",7),B(5,"th-mesh",8),ne(6,"th-sphereGeometry",9,2)(8,"th-meshPhongMaterial",10,3),X(),ne(10,"th-mesh",11)(11,"th-mesh",11),X(),Ki(12,Yle,4,16,"th-view",12,Qi),X()),r&2){let s=Ft(7),a=Ft(9);N("disableDefaultView",!0)("viewPort",br(20,Vle,.5*o.canvasWidth,o.canvasHeight)),F(4),N("position",V(23,zle))("args",V(24,Hle))("intensity",3),F(),N("position",V(25,Gle))("rotation",_t(26,IR,-o.Math.PI/2)),F(),N("args",V(28,Wle)),F(2),N("flatShading",!1)("shininess",30)("specular",V(29,$le))("color",V(30,qle)),F(2),N("position",_t(31,IR,-400))("rotation",_t(33,IR,-o.Math.PI/2))("geometry",s.objRef)("material",a.objRef),F(),N("position",V(35,Xle))("rotation",_t(36,IR,-o.Math.PI/2))("geometry",s.objRef)("material",a.objRef),F(),Ji(o.views)}},dependencies:[At,Ot,Pr,Cn,fc,No,Zr,Gt],encapsulation:2,changeDetection:0});let i=e;return i})();var Qle=()=>[10,10],A4=()=>[10,10,10],Kle=()=>[45,2,.1,100],Jle=()=>[0,0,0];function eue(i,e){if(i&1&&ne(0,"th-object3D",5),i&2){$t();let t=zE(6);N("objRef",t)}}var P4=(()=>{let e=class e{constructor(){this.assetPath1=`${ui}DamagedHelmet.glb`,this.instanceCnt=_k(100),this.rotation=Vn(0),this.loader=S(YA),this.dummy=new wt,this.helmets=JE({params:this.instanceCnt,loader:r=>Wt(this,[r],function*({params:n}){let o=yield this.loader.load(this.assetPath1);return hV(o.scene,n)})}).value,this.updateInstancesEffect=Tf(()=>{let n=this.helmets(),r=this.instanceCnt();if(n)for(let o=0;o<r;o++){let s=Math.ceil(Math.sqrt(r)),a=s,c=Math.floor(o/s),l=o%s;this.dummy.position.set((c-s/2)*2.5,0,2.5*(l-a/2)),this.dummy.rotation.set(0,this.rotation()*(l-a/2),0),this.dummy.updateMatrix(),fV(n,o,this.dummy.matrix)}})}onBeforeRender(){this.rotation.update(n=>n+.01)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-instanced-glb-example"]],inputs:{instanceCnt:[1,"instanceCnt"]},outputs:{instanceCnt:"instanceCntChange"},decls:12,vars:19,consts:[["for","shift"],["id","shift","type","range",3,"change","value","min","max"],[3,"onRender"],[3,"thStats"],[3,"intensity"],[3,"objRef"],[3,"args"],[3,"position","decay"],[3,"args","position","lookAt"]],template:function(r,o){if(r&1){let s=en();B(0,"label",0),Vt(1),X(),B(2,"input",1),Ie("change",function(c){return rt(s),ot(o.instanceCnt.set(c.target.value))}),X(),B(3,"th-canvas",2),Ie("onRender",function(){return rt(s),ot(o.onBeforeRender())}),B(4,"th-scene",3),ne(5,"th-ambientLight",4),ix(6),Vi(7,eue,1,1,"th-object3D",5),ne(8,"th-gridHelper",6)(9,"th-pointLight",7),B(10,"th-perspectiveCamera",8),ne(11,"th-orbitControls"),X()()()}if(r&2){F(),ms("Instances ",o.instanceCnt()),F(),N("value",o.instanceCnt())("min",9)("max",1e3),F(2),N("thStats",!0),F(),N("intensity",3),F();let s=VE(o.helmets());F(),zi(s?7:-1),F(),N("args",V(14,Qle)),F(),N("position",V(15,A4))("decay",0),F(),N("args",V(16,Kle))("position",V(17,A4))("lookAt",V(18,Jle))}},dependencies:[ln,vi,Gt,de,dr,Tn,Gi,Ot,At,yi,km],encapsulation:2,changeDetection:0});let i=e;return i})();var Bm=[{path:"basic-example",data:{title:"Basic Example",exampleComponent:gV,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/basic-example/basic-example.component.ts"]}},{path:"simple-example",data:{title:"Simple Example",exampleComponent:D4,declarations:["SimpleExampleComponent","Box"],codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/simple-example/simple-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/simple-example/simple-example.component.ts"]}},{path:"introductory-example",data:{title:"Introductory Example",exampleComponent:BH,declarations:["IntroductoryExampleComponent","Box"],codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/introductory-example/introductory-example.component.ts"]}},{path:"controls-example",data:{title:"Controls Example",exampleComponent:bV,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/controls-example/controls-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/controls-example/controls-example.component.ts"]}},{path:"loader-example",data:{title:"Loader Example",exampleComponent:VH,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/loader-example/loader-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/loader-example/loader-example.component.ts"]}},{path:"dynamic loader-example",data:{title:"Dynamic Loader Example",exampleComponent:xV,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/dynamic-loader-example/dynamic-loader-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/dynamic-loader-example/dynamic-loader-example.component.ts"]}},{path:"events-example",data:{title:"Events Example",exampleComponent:MV,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/events-example/events-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/events-example/events-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/events-example/events-example.component.scss"]}},{path:"instanced-mesh-example",data:{title:"Instanced Mesh Example",exampleComponent:kH,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/instanced-mesh-example/instanced-mesh-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/instanced-mesh-example/instanced-mesh-example.component.ts"]}},{path:"post-processing-example",data:{title:"Post Processing Example",exampleComponent:T4,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/post-processing-example/post-processing-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/post-processing-example/post-processing-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/post-processing-example/post-processing-example.component.scss"]}},{path:"views-example",data:{title:"Multiple Views Example",exampleComponent:I4,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/views-example/views-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/views-example/views-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/views-example/views-example.component.scss"]}},{path:"multi-scene-example",data:{title:"Multiple Scenes Example",codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-scene-example/multi-scene-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-scene-example/multi-scene-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-scene-example/multi-scene-example.component.scss"],exampleComponent:XH}},{path:"multi-view-postprocessing-example",data:{title:"Multiple View Post Processing Example",exampleComponent:ZH,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-view-postprocessing-example/multi-view-postprocessing-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-view-postprocessing-example/multi-view-postprocessing-example.component.ts"]}},{path:"animation-example",data:{title:"Animation Example",exampleComponent:mV,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/animation-example/animation-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/animation-example/animation-example.component.ts"]}},{path:"plyloader-example",data:{title:"PLY Loader Example",exampleComponent:S4,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/plyloader-example/plyloader-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/plyloader-example/plyloader-example.component.ts"]}},{path:"on-demand-example",data:{title:"On-Demand Rendering Example",exampleComponent:y4,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/on-demand-example/on-demand-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/on-demand-example/on-demand-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/on-demand-example/on-demand-example.component.scss"]}},{path:"ref-by-id-example",data:{title:"Ref By Id Example",exampleComponent:C4,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/ref-by-id-example/ref-by-id-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/ref-by-id-example/ref-by-id-example.component.ts"]}},{path:"html-example",data:{title:"Html Content Example",exampleComponent:AH,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/html-example/html-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/html-example/html-example.component.ts"]}},{path:"outline-pass-events-example",data:{title:"Render Pass + Events Example",exampleComponent:w4,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/outline-pass-events-example/outline-pass-events-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/outline-pass-events-example/outline-pass-events-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/outline-pass-events-example/outline-pass-events-example.component.scss"]}},{path:"multi-renderer-example",data:{title:"Multi Renderer Example: WebGL + CSS2D",exampleComponent:qH,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-renderer-example/multi-renderer-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/multi-renderer-example/multi-renderer-example.component.ts"]}},{path:"css3d-renderer-example",data:{title:"CSS3D Renderer Example",exampleComponent:vV,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/css3d-renderer-example/css3d-renderer-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/css3d-renderer-example/css3d-renderer-example.component.ts","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/css3d-renderer-example/css3d-renderer-example.component.scss"]}},{path:"html-with-css3d-example",data:{title:"Html with CSS3D Example",exampleComponent:FH,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/html-with-css3d-example/html-with-css3d-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/html-with-css3d-example/html-with-css3d-example.component.ts"]}},{path:"lod-example",data:{title:"LOD Example",exampleComponent:WH,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/lod-example/lod-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/lod-example/lod-example.component.ts"]}},{path:"instanced-glb-example",data:{title:"Instanced GLB Example",exampleComponent:P4,codeUrls:["https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/instanced-glb-example/instanced-glb-example.component.html","https://raw.githubusercontent.com/demike/ngx-three/main/projects/ngx-three-demo/src/app/instanced-glb-example/instanced-glb-example.component.ts"]}}];Bm.forEach(i=>i.component=DH);var tue=[];Bm.forEach(i=>{tue.push(i.component)});var FR=["*"],iue=["content"],rue=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],oue=["mat-drawer","mat-drawer-content","*"];function sue(i,e){if(i&1){let t=en();B(0,"div",1),Ie("click",function(){rt(t);let r=$t();return ot(r._onBackdropClicked())}),X()}if(i&2){let t=$t();sn("mat-drawer-shown",t._isShowingBackdrop())}}function aue(i,e){i&1&&(B(0,"mat-drawer-content"),Q(1,2),X())}var cue=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],lue=["mat-sidenav","mat-sidenav-content","*"];function uue(i,e){if(i&1){let t=en();B(0,"div",1),Ie("click",function(){rt(t);let r=$t();return ot(r._onBackdropClicked())}),X()}if(i&2){let t=$t();sn("mat-drawer-shown",t._isShowingBackdrop())}}function due(i,e){i&1&&(B(0,"mat-sidenav-content"),Q(1,2),X())}var hue=`.mat-drawer-container{position:relative;z-index:1;color:var(--mat-sidenav-content-text-color, var(--mat-sys-on-background));background-color:var(--mat-sidenav-content-background-color, var(--mat-sys-background));box-sizing:border-box;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible;background-color:var(--mat-sidenav-scrim-color, color-mix(in srgb, var(--mat-sys-neutral-variant20) 40%, transparent))}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}@media(forced-colors: active){.mat-drawer-backdrop{opacity:.5}}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-content.mat-drawer-content-hidden{opacity:0}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;color:var(--mat-sidenav-container-text-color, var(--mat-sys-on-surface-variant));box-shadow:var(--mat-sidenav-container-elevation-shadow, none);background-color:var(--mat-sidenav-container-background-color, var(--mat-sys-surface));border-top-right-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-bottom-right-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));width:var(--mat-sidenav-container-width, 360px);display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}@media(forced-colors: active){.mat-drawer,[dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}}@media(forced-colors: active){[dir=rtl] .mat-drawer,.mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0);border-top-left-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-bottom-left-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-top-right-radius:0;border-bottom-right-radius:0}[dir=rtl] .mat-drawer{border-top-left-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-bottom-left-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-top-right-radius:0;border-bottom-right-radius:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{border-top-right-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-bottom-right-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-top-left-radius:0;border-bottom-left-radius:0;left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-transition .mat-drawer{transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-drawer:not(.mat-drawer-opened):not(.mat-drawer-animating){visibility:hidden;box-shadow:none}.mat-drawer:not(.mat-drawer-opened):not(.mat-drawer-animating) .mat-drawer-inner-container{display:none}.mat-drawer.mat-drawer-opened.mat-drawer-opened{transform:none}.mat-drawer-side{box-shadow:none;border-right-color:var(--mat-sidenav-container-divider-color, transparent);border-right-width:1px;border-right-style:solid}.mat-drawer-side.mat-drawer-end{border-left-color:var(--mat-sidenav-container-divider-color, transparent);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side{border-left-color:var(--mat-sidenav-container-divider-color, transparent);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side.mat-drawer-end{border-right-color:var(--mat-sidenav-container-divider-color, transparent);border-right-width:1px;border-right-style:solid;border-left:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto}.mat-sidenav-fixed{position:fixed}
`;var fue=new me("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:pue}),zF=new me("MAT_DRAWER_CONTAINER");function pue(){return!1}var AR=(()=>{class i extends ku{_platform=S(si);_changeDetectorRef=S(Ni);_container=S(VF);constructor(){let t=S(vt),n=S(nF),r=S(pt);super(t,n,r)}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}_shouldBeHidden(){if(this._platform.isBrowser)return!1;let{start:t,end:n}=this._container;return t!=null&&t.mode!=="over"&&t.opened||n!=null&&n.mode!=="over"&&n.opened}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=O({type:i,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:6,hostBindings:function(n,r){n&2&&(qs("margin-left",r._container._contentMargins.left,"px")("margin-right",r._container._contentMargins.right,"px"),sn("mat-drawer-content-hidden",r._shouldBeHidden()))},features:[K([{provide:ku,useExisting:i}]),$],ngContentSelectors:FR,decls:1,vars:0,template:function(n,r){n&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0})}return i})(),UF=(()=>{class i{_elementRef=S(vt);_focusTrapFactory=S(YP);_focusMonitor=S(kh);_platform=S(si);_ngZone=S(pt);_renderer=S(Yi);_interactivityChecker=S(lR);_doc=S(kt);_container=S(zF,{optional:!0});_focusTrap=null;_elementFocusedBeforeDrawerWasOpened=null;_eventCleanups;_isAttached;_anchor;get position(){return this._position}set position(t){t=t==="end"?"end":"start",t!==this._position&&(this._isAttached&&this._updatePositionInParent(t),this._position=t,this.onPositionChanged.emit())}_position="start";get mode(){return this._mode}set mode(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}_mode="over";get disableClose(){return this._disableClose}set disableClose(t){this._disableClose=ss(t)}_disableClose=!1;get autoFocus(){let t=this._autoFocus;return t??(this.mode==="side"?"dialog":"first-tabbable")}set autoFocus(t){(t==="true"||t==="false"||t==null)&&(t=ss(t)),this._autoFocus=t}_autoFocus;get opened(){return this._opened()}set opened(t){this.toggle(ss(t))}_opened=Vn(!1);_openedVia;_animationStarted=new lt;_animationEnd=new lt;openedChange=new dt(!0);_openedStream=this.openedChange.pipe(vn(t=>t),tt(()=>{}));openedStart=this._animationStarted.pipe(vn(()=>this.opened),G0(void 0));_closedStream=this.openedChange.pipe(vn(t=>!t),tt(()=>{}));closedStart=this._animationStarted.pipe(vn(()=>!this.opened),G0(void 0));_destroyed=new lt;onPositionChanged=new dt;_content;_modeChanged=new lt;_injector=S(yn);_changeDetectorRef=S(Ni);constructor(){this.openedChange.pipe(Pn(this._destroyed)).subscribe(t=>{t?(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement,this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{let t=this._elementRef.nativeElement;Qm(t,"keydown").pipe(vn(n=>n.keyCode===27&&!this.disableClose&&!Dm(n)),Pn(this._destroyed)).subscribe(n=>this._ngZone.run(()=>{this.close(),n.stopPropagation(),n.preventDefault()})),this._eventCleanups=[this._renderer.listen(t,"transitionrun",this._handleTransitionEvent),this._renderer.listen(t,"transitionend",this._handleTransitionEvent),this._renderer.listen(t,"transitioncancel",this._handleTransitionEvent)]}),this._animationEnd.subscribe(()=>{this.openedChange.emit(this.opened)})}_forceFocus(t,n){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{let r=()=>{o(),s(),t.removeAttribute("tabindex")},o=this._renderer.listen(t,"blur",r),s=this._renderer.listen(t,"mousedown",r)})),t.focus(n)}_focusByCssSelector(t,n){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,n)}_takeFocus(){if(!this._focusTrap)return;let t=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":co(()=>{!this._focusTrap.focusInitialElement()&&typeof t.focus=="function"&&t.focus()},{injector:this._injector});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus);break}}_restoreFocus(t){this.autoFocus!=="dialog"&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,t):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){let t=this._doc.activeElement;return!!t&&this._elementRef.nativeElement.contains(t)}ngAfterViewInit(){this._isAttached=!0,this._position==="end"&&this._updatePositionInParent("end"),this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState())}ngOnDestroy(){this._eventCleanups.forEach(t=>t()),this._focusTrap?.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(t){return this.toggle(!0,t)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(t=!this.opened,n){t&&n&&(this._openedVia=n);let r=this._setOpen(t,!t&&this._isFocusWithinDrawer(),this._openedVia||"program");return t||(this._openedVia=null),r}_setOpen(t,n,r){return t===this.opened?Promise.resolve(t?"open":"close"):(this._opened.set(t),this._container?._transitionsEnabled?this._setIsAnimating(!0):setTimeout(()=>{this._animationStarted.next(),this._animationEnd.next()}),this._elementRef.nativeElement.classList.toggle("mat-drawer-opened",t),!t&&n&&this._restoreFocus(r),this._changeDetectorRef.markForCheck(),this._updateFocusTrapState(),new Promise(o=>{this.openedChange.pipe(no(1)).subscribe(s=>o(s?"open":"close"))}))}_setIsAnimating(t){this._elementRef.nativeElement.classList.toggle("mat-drawer-animating",t)}_getWidth(){return this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=!!this._container?.hasBackdrop&&this.opened)}_updatePositionInParent(t){if(!this._platform.isBrowser)return;let n=this._elementRef.nativeElement,r=n.parentNode;t==="end"?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),r.insertBefore(this._anchor,n)),r.appendChild(n)):this._anchor&&this._anchor.parentNode.insertBefore(n,this._anchor)}_handleTransitionEvent=t=>{let n=this._elementRef.nativeElement;t.target===n&&this._ngZone.run(()=>{t.type==="transitionrun"?this._animationStarted.next(t):(t.type==="transitionend"&&this._setIsAnimating(!1),this._animationEnd.next(t))})};static \u0275fac=function(n){return new(n||i)};static \u0275cmp=O({type:i,selectors:[["mat-drawer"]],viewQuery:function(n,r){if(n&1&&tn(iue,5),n&2){let o;st(o=at())&&(r._content=o.first)}},hostAttrs:[1,"mat-drawer"],hostVars:12,hostBindings:function(n,r){n&2&&(oi("align",null)("tabIndex",r.mode!=="side"?"-1":null),qs("visibility",!r._container&&!r.opened?"hidden":null),sn("mat-drawer-end",r.position==="end")("mat-drawer-over",r.mode==="over")("mat-drawer-push",r.mode==="push")("mat-drawer-side",r.mode==="side"))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:FR,decls:3,vars:0,consts:[["content",""],["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(n,r){n&1&&(ie(),B(0,"div",1,0),Q(2),X())},dependencies:[ku],encapsulation:2,changeDetection:0})}return i})(),VF=(()=>{class i{_dir=S(Lu,{optional:!0});_element=S(vt);_ngZone=S(pt);_changeDetectorRef=S(Ni);_animationDisabled=Lo();_transitionsEnabled=!1;_allDrawers;_drawers=new $s;_content;_userContent;get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(t){this._autosize=ss(t)}_autosize=S(fue);get hasBackdrop(){return this._drawerHasBackdrop(this._start)||this._drawerHasBackdrop(this._end)}set hasBackdrop(t){this._backdropOverride=t==null?null:ss(t)}_backdropOverride;backdropClick=new dt;_start;_end;_left;_right;_destroyed=new lt;_doCheckSubject=new lt;_contentMargins={left:null,right:null};_contentMarginChanges=new lt;get scrollable(){return this._userContent||this._content}_injector=S(yn);constructor(){let t=S(si),n=S(fR);this._dir?.change.pipe(Pn(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),n.change().pipe(Pn(this._destroyed)).subscribe(()=>this.updateContentMargins()),!this._animationDisabled&&t.isBrowser&&this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{this._element.nativeElement.classList.add("mat-drawer-transition"),this._transitionsEnabled=!0},200)})}ngAfterContentInit(){this._allDrawers.changes.pipe(Uo(this._allDrawers),Pn(this._destroyed)).subscribe(t=>{this._drawers.reset(t.filter(n=>!n._container||n._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(Uo(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(t=>{this._watchDrawerToggle(t),this._watchDrawerPosition(t),this._watchDrawerMode(t)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(Us(10),Pn(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(t=>t.open())}close(){this._drawers.forEach(t=>t.close())}updateContentMargins(){let t=0,n=0;if(this._left&&this._left.opened){if(this._left.mode=="side")t+=this._left._getWidth();else if(this._left.mode=="push"){let r=this._left._getWidth();t+=r,n-=r}}if(this._right&&this._right.opened){if(this._right.mode=="side")n+=this._right._getWidth();else if(this._right.mode=="push"){let r=this._right._getWidth();n+=r,t-=r}}t=t||null,n=n||null,(t!==this._contentMargins.left||n!==this._contentMargins.right)&&(this._contentMargins={left:t,right:n},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(t){t._animationStarted.pipe(Pn(this._drawers.changes)).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),t.mode!=="side"&&t.openedChange.pipe(Pn(this._drawers.changes)).subscribe(()=>this._setContainerClass(t.opened))}_watchDrawerPosition(t){t.onPositionChanged.pipe(Pn(this._drawers.changes)).subscribe(()=>{co({read:()=>this._validateDrawers()},{injector:this._injector})})}_watchDrawerMode(t){t._modeChanged.pipe(Pn(Tc(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(t){let n=this._element.nativeElement.classList,r="mat-drawer-container-has-open";t?n.add(r):n.remove(r)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(t=>{t.position=="end"?(this._end!=null,this._end=t):(this._start!=null,this._start=t)}),this._right=this._left=null,this._dir&&this._dir.value==="rtl"?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&this._start.mode!="over"||this._isDrawerOpen(this._end)&&this._end.mode!="over"}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(t=>t&&!t.disableClose&&this._drawerHasBackdrop(t)).forEach(t=>t._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._drawerHasBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._drawerHasBackdrop(this._end)}_isDrawerOpen(t){return t!=null&&t.opened}_drawerHasBackdrop(t){return this._backdropOverride==null?!!t&&t.mode!=="side":this._backdropOverride}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=O({type:i,selectors:[["mat-drawer-container"]],contentQueries:function(n,r,o){if(n&1&&(xi(o,AR,5),xi(o,UF,5)),n&2){let s;st(s=at())&&(r._content=s.first),st(s=at())&&(r._allDrawers=s)}},viewQuery:function(n,r){if(n&1&&tn(AR,5),n&2){let o;st(o=at())&&(r._userContent=o.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(n,r){n&2&&sn("mat-drawer-container-explicit-backdrop",r._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[K([{provide:zF,useExisting:i}])],ngContentSelectors:oue,decls:4,vars:2,consts:[[1,"mat-drawer-backdrop",3,"mat-drawer-shown"],[1,"mat-drawer-backdrop",3,"click"]],template:function(n,r){n&1&&(ie(rue),Vi(0,sue,1,2,"div",0),Q(1),Q(2,1),Vi(3,aue,2,0,"mat-drawer-content")),n&2&&(zi(r.hasBackdrop?0:-1),F(3),zi(r._content?-1:3))},dependencies:[AR],styles:[`.mat-drawer-container{position:relative;z-index:1;color:var(--mat-sidenav-content-text-color, var(--mat-sys-on-background));background-color:var(--mat-sidenav-content-background-color, var(--mat-sys-background));box-sizing:border-box;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible;background-color:var(--mat-sidenav-scrim-color, color-mix(in srgb, var(--mat-sys-neutral-variant20) 40%, transparent))}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}@media(forced-colors: active){.mat-drawer-backdrop{opacity:.5}}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-content.mat-drawer-content-hidden{opacity:0}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;color:var(--mat-sidenav-container-text-color, var(--mat-sys-on-surface-variant));box-shadow:var(--mat-sidenav-container-elevation-shadow, none);background-color:var(--mat-sidenav-container-background-color, var(--mat-sys-surface));border-top-right-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-bottom-right-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));width:var(--mat-sidenav-container-width, 360px);display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}@media(forced-colors: active){.mat-drawer,[dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}}@media(forced-colors: active){[dir=rtl] .mat-drawer,.mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0);border-top-left-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-bottom-left-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-top-right-radius:0;border-bottom-right-radius:0}[dir=rtl] .mat-drawer{border-top-left-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-bottom-left-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-top-right-radius:0;border-bottom-right-radius:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{border-top-right-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-bottom-right-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-top-left-radius:0;border-bottom-left-radius:0;left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-transition .mat-drawer{transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-drawer:not(.mat-drawer-opened):not(.mat-drawer-animating){visibility:hidden;box-shadow:none}.mat-drawer:not(.mat-drawer-opened):not(.mat-drawer-animating) .mat-drawer-inner-container{display:none}.mat-drawer.mat-drawer-opened.mat-drawer-opened{transform:none}.mat-drawer-side{box-shadow:none;border-right-color:var(--mat-sidenav-container-divider-color, transparent);border-right-width:1px;border-right-style:solid}.mat-drawer-side.mat-drawer-end{border-left-color:var(--mat-sidenav-container-divider-color, transparent);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side{border-left-color:var(--mat-sidenav-container-divider-color, transparent);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side.mat-drawer-end{border-right-color:var(--mat-sidenav-container-divider-color, transparent);border-right-width:1px;border-right-style:solid;border-left:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto}.mat-sidenav-fixed{position:fixed}
`],encapsulation:2,changeDetection:0})}return i})(),PR=(()=>{class i extends AR{static \u0275fac=(()=>{let t;return function(r){return(t||(t=q(i)))(r||i)}})();static \u0275cmp=O({type:i,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],features:[K([{provide:ku,useExisting:i}]),$],ngContentSelectors:FR,decls:1,vars:0,template:function(n,r){n&1&&(ie(),Q(0))},encapsulation:2,changeDetection:0})}return i})(),HF=(()=>{class i extends UF{get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(t){this._fixedInViewport=ss(t)}_fixedInViewport=!1;get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(t){this._fixedTopGap=xl(t)}_fixedTopGap=0;get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(t){this._fixedBottomGap=xl(t)}_fixedBottomGap=0;static \u0275fac=(()=>{let t;return function(r){return(t||(t=q(i)))(r||i)}})();static \u0275cmp=O({type:i,selectors:[["mat-sidenav"]],hostAttrs:[1,"mat-drawer","mat-sidenav"],hostVars:16,hostBindings:function(n,r){n&2&&(oi("tabIndex",r.mode!=="side"?"-1":null)("align",null),qs("top",r.fixedInViewport?r.fixedTopGap:null,"px")("bottom",r.fixedInViewport?r.fixedBottomGap:null,"px"),sn("mat-drawer-end",r.position==="end")("mat-drawer-over",r.mode==="over")("mat-drawer-push",r.mode==="push")("mat-drawer-side",r.mode==="side")("mat-sidenav-fixed",r.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[K([{provide:UF,useExisting:i}]),$],ngContentSelectors:FR,decls:3,vars:0,consts:[["content",""],["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(n,r){n&1&&(ie(),B(0,"div",1,0),Q(2),X())},dependencies:[ku],encapsulation:2,changeDetection:0})}return i})(),F4=(()=>{class i extends VF{_allDrawers=void 0;_content=void 0;static \u0275fac=(()=>{let t;return function(r){return(t||(t=q(i)))(r||i)}})();static \u0275cmp=O({type:i,selectors:[["mat-sidenav-container"]],contentQueries:function(n,r,o){if(n&1&&(xi(o,PR,5),xi(o,HF,5)),n&2){let s;st(s=at())&&(r._content=s.first),st(s=at())&&(r._allDrawers=s)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(n,r){n&2&&sn("mat-drawer-container-explicit-backdrop",r._backdropOverride)},exportAs:["matSidenavContainer"],features:[K([{provide:zF,useExisting:i},{provide:VF,useExisting:i}]),$],ngContentSelectors:lue,decls:4,vars:2,consts:[[1,"mat-drawer-backdrop",3,"mat-drawer-shown"],[1,"mat-drawer-backdrop",3,"click"]],template:function(n,r){n&1&&(ie(cue),Vi(0,uue,1,2,"div",0),Q(1),Q(2,1),Vi(3,due,2,0,"mat-sidenav-content")),n&2&&(zi(r.hasBackdrop?0:-1),F(3),zi(r._content?-1:3))},dependencies:[PR],styles:[hue],encapsulation:2,changeDetection:0})}return i})();var mue=["*",[["mat-toolbar-row"]]],gue=["*","mat-toolbar-row"],_ue=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]})}return i})(),N4=(()=>{class i{_elementRef=S(vt);_platform=S(si);_document=S(kt);color;_toolbarRows;constructor(){}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){this._toolbarRows.length}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=O({type:i,selectors:[["mat-toolbar"]],contentQueries:function(n,r,o){if(n&1&&xi(o,_ue,5),n&2){let s;st(s=at())&&(r._toolbarRows=s)}},hostAttrs:[1,"mat-toolbar"],hostVars:6,hostBindings:function(n,r){n&2&&(Xs(r.color?"mat-"+r.color:""),sn("mat-toolbar-multiple-rows",r._toolbarRows.length>0)("mat-toolbar-single-row",r._toolbarRows.length===0))},inputs:{color:"color"},exportAs:["matToolbar"],ngContentSelectors:gue,decls:2,vars:0,template:function(n,r){n&1&&(ie(mue),Q(0),Q(1,1))},styles:[`.mat-toolbar{background:var(--mat-toolbar-container-background-color, var(--mat-sys-surface));color:var(--mat-toolbar-container-text-color, var(--mat-sys-on-surface))}.mat-toolbar,.mat-toolbar h1,.mat-toolbar h2,.mat-toolbar h3,.mat-toolbar h4,.mat-toolbar h5,.mat-toolbar h6{font-family:var(--mat-toolbar-title-text-font, var(--mat-sys-title-large-font));font-size:var(--mat-toolbar-title-text-size, var(--mat-sys-title-large-size));line-height:var(--mat-toolbar-title-text-line-height, var(--mat-sys-title-large-line-height));font-weight:var(--mat-toolbar-title-text-weight, var(--mat-sys-title-large-weight));letter-spacing:var(--mat-toolbar-title-text-tracking, var(--mat-sys-title-large-tracking));margin:0}@media(forced-colors: active){.mat-toolbar{outline:solid 1px}}.mat-toolbar .mat-form-field-underline,.mat-toolbar .mat-form-field-ripple,.mat-toolbar .mat-focused .mat-form-field-ripple{background-color:currentColor}.mat-toolbar .mat-form-field-label,.mat-toolbar .mat-focused .mat-form-field-label,.mat-toolbar .mat-select-value,.mat-toolbar .mat-select-arrow,.mat-toolbar .mat-form-field.mat-focused .mat-select-arrow{color:inherit}.mat-toolbar .mat-input-element{caret-color:currentColor}.mat-toolbar .mat-mdc-button-base.mat-mdc-button-base.mat-unthemed{--mat-button-text-label-text-color: var(--mat-toolbar-container-text-color, var(--mat-sys-on-surface));--mat-button-outlined-label-text-color: var(--mat-toolbar-container-text-color, var(--mat-sys-on-surface))}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap;height:var(--mat-toolbar-standard-height, 64px)}@media(max-width: 599px){.mat-toolbar-row,.mat-toolbar-single-row{height:var(--mat-toolbar-mobile-height, 56px)}}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%;min-height:var(--mat-toolbar-standard-height, 64px)}@media(max-width: 599px){.mat-toolbar-multiple-rows{min-height:var(--mat-toolbar-mobile-height, 56px)}}
`],encapsulation:2,changeDetection:0})}return i})();var bue=["*"],vue=`.mdc-list{margin:0;padding:8px 0;list-style-type:none}.mdc-list:focus{outline:none}.mdc-list-item{display:flex;position:relative;justify-content:flex-start;overflow:hidden;padding:0;align-items:stretch;cursor:pointer;padding-left:16px;padding-right:16px;background-color:var(--mat-list-list-item-container-color, transparent);border-radius:var(--mat-list-list-item-container-shape, var(--mat-sys-corner-none))}.mdc-list-item.mdc-list-item--selected{background-color:var(--mat-list-list-item-selected-container-color)}.mdc-list-item:focus{outline:0}.mdc-list-item.mdc-list-item--disabled{cursor:auto}.mdc-list-item.mdc-list-item--with-one-line{height:var(--mat-list-list-item-one-line-container-height, 48px)}.mdc-list-item.mdc-list-item--with-one-line .mdc-list-item__start{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-one-line .mdc-list-item__end{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-two-lines{height:var(--mat-list-list-item-two-line-container-height, 64px)}.mdc-list-item.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--with-two-lines .mdc-list-item__end{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-three-lines{height:var(--mat-list-list-item-three-line-container-height, 88px)}.mdc-list-item.mdc-list-item--with-three-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--selected::before,.mdc-list-item.mdc-list-item--selected:focus::before,.mdc-list-item:not(.mdc-list-item--selected):focus::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;content:"";pointer-events:none}a.mdc-list-item{color:inherit;text-decoration:none}.mdc-list-item__start{fill:currentColor;flex-shrink:0;pointer-events:none}.mdc-list-item--with-leading-icon .mdc-list-item__start{color:var(--mat-list-list-item-leading-icon-color, var(--mat-sys-on-surface-variant));width:var(--mat-list-list-item-leading-icon-size, 24px);height:var(--mat-list-list-item-leading-icon-size, 24px);margin-left:16px;margin-right:32px}[dir=rtl] .mdc-list-item--with-leading-icon .mdc-list-item__start{margin-left:32px;margin-right:16px}.mdc-list-item--with-leading-icon:hover .mdc-list-item__start{color:var(--mat-list-list-item-hover-leading-icon-color)}.mdc-list-item--with-leading-avatar .mdc-list-item__start{width:var(--mat-list-list-item-leading-avatar-size, 40px);height:var(--mat-list-list-item-leading-avatar-size, 40px);margin-left:16px;margin-right:16px;border-radius:50%}.mdc-list-item--with-leading-avatar .mdc-list-item__start,[dir=rtl] .mdc-list-item--with-leading-avatar .mdc-list-item__start{margin-left:16px;margin-right:16px;border-radius:50%}.mdc-list-item__end{flex-shrink:0;pointer-events:none}.mdc-list-item--with-trailing-meta .mdc-list-item__end{font-family:var(--mat-list-list-item-trailing-supporting-text-font, var(--mat-sys-label-small-font));line-height:var(--mat-list-list-item-trailing-supporting-text-line-height, var(--mat-sys-label-small-line-height));font-size:var(--mat-list-list-item-trailing-supporting-text-size, var(--mat-sys-label-small-size));font-weight:var(--mat-list-list-item-trailing-supporting-text-weight, var(--mat-sys-label-small-weight));letter-spacing:var(--mat-list-list-item-trailing-supporting-text-tracking, var(--mat-sys-label-small-tracking))}.mdc-list-item--with-trailing-icon .mdc-list-item__end{color:var(--mat-list-list-item-trailing-icon-color, var(--mat-sys-on-surface-variant));width:var(--mat-list-list-item-trailing-icon-size, 24px);height:var(--mat-list-list-item-trailing-icon-size, 24px)}.mdc-list-item--with-trailing-icon:hover .mdc-list-item__end{color:var(--mat-list-list-item-hover-trailing-icon-color)}.mdc-list-item.mdc-list-item--with-trailing-meta .mdc-list-item__end{color:var(--mat-list-list-item-trailing-supporting-text-color, var(--mat-sys-on-surface-variant))}.mdc-list-item--selected.mdc-list-item--with-trailing-icon .mdc-list-item__end{color:var(--mat-list-list-item-selected-trailing-icon-color, var(--mat-sys-primary))}.mdc-list-item__content{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;align-self:center;flex:1;pointer-events:none}.mdc-list-item--with-two-lines .mdc-list-item__content,.mdc-list-item--with-three-lines .mdc-list-item__content{align-self:stretch}.mdc-list-item__primary-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;color:var(--mat-list-list-item-label-text-color, var(--mat-sys-on-surface));font-family:var(--mat-list-list-item-label-text-font, var(--mat-sys-body-large-font));line-height:var(--mat-list-list-item-label-text-line-height, var(--mat-sys-body-large-line-height));font-size:var(--mat-list-list-item-label-text-size, var(--mat-sys-body-large-size));font-weight:var(--mat-list-list-item-label-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mat-list-list-item-label-text-tracking, var(--mat-sys-body-large-tracking))}.mdc-list-item:hover .mdc-list-item__primary-text{color:var(--mat-list-list-item-hover-label-text-color, var(--mat-sys-on-surface))}.mdc-list-item:focus .mdc-list-item__primary-text{color:var(--mat-list-list-item-focus-label-text-color, var(--mat-sys-on-surface))}.mdc-list-item--with-two-lines .mdc-list-item__primary-text,.mdc-list-item--with-three-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before,.mdc-list-item--with-three-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after,.mdc-list-item--with-three-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item__secondary-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;margin-top:0;color:var(--mat-list-list-item-supporting-text-color, var(--mat-sys-on-surface-variant));font-family:var(--mat-list-list-item-supporting-text-font, var(--mat-sys-body-medium-font));line-height:var(--mat-list-list-item-supporting-text-line-height, var(--mat-sys-body-medium-line-height));font-size:var(--mat-list-list-item-supporting-text-size, var(--mat-sys-body-medium-size));font-weight:var(--mat-list-list-item-supporting-text-weight, var(--mat-sys-body-medium-weight));letter-spacing:var(--mat-list-list-item-supporting-text-tracking, var(--mat-sys-body-medium-tracking))}.mdc-list-item__secondary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-list-item--with-three-lines .mdc-list-item__secondary-text{white-space:normal;line-height:20px}.mdc-list-item--with-overline .mdc-list-item__secondary-text{white-space:nowrap;line-height:auto}.mdc-list-item--with-leading-radio.mdc-list-item,.mdc-list-item--with-leading-checkbox.mdc-list-item,.mdc-list-item--with-leading-icon.mdc-list-item,.mdc-list-item--with-leading-avatar.mdc-list-item{padding-left:0;padding-right:16px}[dir=rtl] .mdc-list-item--with-leading-radio.mdc-list-item,[dir=rtl] .mdc-list-item--with-leading-checkbox.mdc-list-item,[dir=rtl] .mdc-list-item--with-leading-icon.mdc-list-item,[dir=rtl] .mdc-list-item--with-leading-avatar.mdc-list-item{padding-left:16px;padding-right:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text,.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text,.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text,.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before,.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before,.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before,.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after,.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after,.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after,.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end,.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end,.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end,.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before,.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before,.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before,.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-trailing-icon.mdc-list-item,[dir=rtl] .mdc-list-item--with-trailing-icon.mdc-list-item{padding-left:0;padding-right:0}.mdc-list-item--with-trailing-icon .mdc-list-item__end{margin-left:16px;margin-right:16px}.mdc-list-item--with-trailing-meta.mdc-list-item{padding-left:16px;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-meta.mdc-list-item{padding-left:0;padding-right:16px}.mdc-list-item--with-trailing-meta .mdc-list-item__end{-webkit-user-select:none;user-select:none;margin-left:28px;margin-right:16px}[dir=rtl] .mdc-list-item--with-trailing-meta .mdc-list-item__end{margin-left:16px;margin-right:28px}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end,.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end{display:block;line-height:normal;align-self:flex-start;margin-top:0}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end::before,.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio .mdc-list-item__start,.mdc-list-item--with-leading-checkbox .mdc-list-item__start{margin-left:8px;margin-right:24px}[dir=rtl] .mdc-list-item--with-leading-radio .mdc-list-item__start,[dir=rtl] .mdc-list-item--with-leading-checkbox .mdc-list-item__start{margin-left:24px;margin-right:8px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__start,.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:8px}.mdc-list-item--with-trailing-radio.mdc-list-item,.mdc-list-item--with-trailing-checkbox.mdc-list-item{padding-left:16px;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-radio.mdc-list-item,[dir=rtl] .mdc-list-item--with-trailing-checkbox.mdc-list-item{padding-left:0;padding-right:16px}.mdc-list-item--with-trailing-radio.mdc-list-item--with-leading-icon,.mdc-list-item--with-trailing-radio.mdc-list-item--with-leading-avatar,.mdc-list-item--with-trailing-checkbox.mdc-list-item--with-leading-icon,.mdc-list-item--with-trailing-checkbox.mdc-list-item--with-leading-avatar{padding-left:0}[dir=rtl] .mdc-list-item--with-trailing-radio.mdc-list-item--with-leading-icon,[dir=rtl] .mdc-list-item--with-trailing-radio.mdc-list-item--with-leading-avatar,[dir=rtl] .mdc-list-item--with-trailing-checkbox.mdc-list-item--with-leading-icon,[dir=rtl] .mdc-list-item--with-trailing-checkbox.mdc-list-item--with-leading-avatar{padding-right:0}.mdc-list-item--with-trailing-radio .mdc-list-item__end,.mdc-list-item--with-trailing-checkbox .mdc-list-item__end{margin-left:24px;margin-right:8px}[dir=rtl] .mdc-list-item--with-trailing-radio .mdc-list-item__end,[dir=rtl] .mdc-list-item--with-trailing-checkbox .mdc-list-item__end{margin-left:8px;margin-right:24px}.mdc-list-item--with-trailing-radio.mdc-list-item--with-three-lines .mdc-list-item__end,.mdc-list-item--with-trailing-checkbox.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:8px}.mdc-list-group__subheader{margin:.75rem 16px}.mdc-list-item--disabled .mdc-list-item__start,.mdc-list-item--disabled .mdc-list-item__content,.mdc-list-item--disabled .mdc-list-item__end{opacity:1}.mdc-list-item--disabled .mdc-list-item__primary-text,.mdc-list-item--disabled .mdc-list-item__secondary-text{opacity:var(--mat-list-list-item-disabled-label-text-opacity, 0.3)}.mdc-list-item--disabled.mdc-list-item--with-leading-icon .mdc-list-item__start{color:var(--mat-list-list-item-disabled-leading-icon-color, var(--mat-sys-on-surface));opacity:var(--mat-list-list-item-disabled-leading-icon-opacity, 0.38)}.mdc-list-item--disabled.mdc-list-item--with-trailing-icon .mdc-list-item__end{color:var(--mat-list-list-item-disabled-trailing-icon-color, var(--mat-sys-on-surface));opacity:var(--mat-list-list-item-disabled-trailing-icon-opacity, 0.38)}.mat-mdc-list-item.mat-mdc-list-item-both-leading-and-trailing,[dir=rtl] .mat-mdc-list-item.mat-mdc-list-item-both-leading-and-trailing{padding-left:0;padding-right:0}.mdc-list-item.mdc-list-item--disabled .mdc-list-item__primary-text{color:var(--mat-list-list-item-disabled-label-text-color, var(--mat-sys-on-surface))}.mdc-list-item:hover::before{background-color:var(--mat-list-list-item-hover-state-layer-color, var(--mat-sys-on-surface));opacity:var(--mat-list-list-item-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mdc-list-item.mdc-list-item--disabled::before{background-color:var(--mat-list-list-item-disabled-state-layer-color, var(--mat-sys-on-surface));opacity:var(--mat-list-list-item-disabled-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mdc-list-item:focus::before{background-color:var(--mat-list-list-item-focus-state-layer-color, var(--mat-sys-on-surface));opacity:var(--mat-list-list-item-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mdc-list-item--disabled .mdc-radio,.mdc-list-item--disabled .mdc-checkbox{opacity:var(--mat-list-list-item-disabled-label-text-opacity, 0.3)}.mdc-list-item--with-leading-avatar .mat-mdc-list-item-avatar{border-radius:var(--mat-list-list-item-leading-avatar-shape, var(--mat-sys-corner-full));background-color:var(--mat-list-list-item-leading-avatar-color, var(--mat-sys-primary-container))}.mat-mdc-list-item-icon{font-size:var(--mat-list-list-item-leading-icon-size, 24px)}@media(forced-colors: active){a.mdc-list-item--activated::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}a.mdc-list-item--activated [dir=rtl]::after{right:auto;left:16px}}.mat-mdc-list-base{display:block}.mat-mdc-list-base .mdc-list-item__start,.mat-mdc-list-base .mdc-list-item__end,.mat-mdc-list-base .mdc-list-item__content{pointer-events:auto}.mat-mdc-list-item,.mat-mdc-list-option{width:100%;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-list-item:not(.mat-mdc-list-item-interactive),.mat-mdc-list-option:not(.mat-mdc-list-item-interactive){cursor:default}.mat-mdc-list-item .mat-divider-inset,.mat-mdc-list-option .mat-divider-inset{position:absolute;left:0;right:0;bottom:0}.mat-mdc-list-item .mat-mdc-list-item-avatar~.mat-divider-inset,.mat-mdc-list-option .mat-mdc-list-item-avatar~.mat-divider-inset{margin-left:72px}[dir=rtl] .mat-mdc-list-item .mat-mdc-list-item-avatar~.mat-divider-inset,[dir=rtl] .mat-mdc-list-option .mat-mdc-list-item-avatar~.mat-divider-inset{margin-right:72px}.mat-mdc-list-item-interactive::before{top:0;left:0;right:0;bottom:0;position:absolute;content:"";opacity:0;pointer-events:none;border-radius:inherit}.mat-mdc-list-item>.mat-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-list-item:focus>.mat-focus-indicator::before{content:""}.mat-mdc-list-item.mdc-list-item--with-three-lines .mat-mdc-list-item-line.mdc-list-item__secondary-text{white-space:nowrap;line-height:normal}.mat-mdc-list-item.mdc-list-item--with-three-lines .mat-mdc-list-item-unscoped-content.mdc-list-item__secondary-text{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}mat-action-list button{background:none;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:rgba(0,0,0,0);text-align:start}mat-action-list button::-moz-focus-inner{border:0}.mdc-list-item--with-leading-icon .mdc-list-item__start{margin-inline-start:var(--mat-list-list-item-leading-icon-start-space, 16px);margin-inline-end:var(--mat-list-list-item-leading-icon-end-space, 16px)}.mat-mdc-nav-list .mat-mdc-list-item{border-radius:var(--mat-list-active-indicator-shape, var(--mat-sys-corner-full));--mat-focus-indicator-border-radius: var(--mat-list-active-indicator-shape, var(--mat-sys-corner-full))}.mat-mdc-nav-list .mat-mdc-list-item.mdc-list-item--activated{background-color:var(--mat-list-active-indicator-color, var(--mat-sys-secondary-container))}
`,yue=["unscopedContent"],xue=["text"],wue=[[["","matListItemAvatar",""],["","matListItemIcon",""]],[["","matListItemTitle",""]],[["","matListItemLine",""]],"*",[["","matListItemMeta",""]],[["mat-divider"]]],Mue=["[matListItemAvatar],[matListItemIcon]","[matListItemTitle]","[matListItemLine]","*","[matListItemMeta]","mat-divider"];var Sue=new me("ListOption"),Rue=(()=>{class i{_elementRef=S(vt);constructor(){}static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,selectors:[["","matListItemTitle",""]],hostAttrs:[1,"mat-mdc-list-item-title","mdc-list-item__primary-text"]})}return i})(),Tue=(()=>{class i{_elementRef=S(vt);constructor(){}static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,selectors:[["","matListItemLine",""]],hostAttrs:[1,"mat-mdc-list-item-line","mdc-list-item__secondary-text"]})}return i})(),Cue=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,selectors:[["","matListItemMeta",""]],hostAttrs:[1,"mat-mdc-list-item-meta","mdc-list-item__end"]})}return i})(),j4=(()=>{class i{_listOption=S(Sue,{optional:!0});constructor(){}_isAlignedAtStart(){return!this._listOption||this._listOption?._getTogglePosition()==="after"}static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,hostVars:4,hostBindings:function(n,r){n&2&&sn("mdc-list-item__start",r._isAlignedAtStart())("mdc-list-item__end",!r._isAlignedAtStart())}})}return i})(),Eue=(()=>{class i extends j4{static \u0275fac=(()=>{let t;return function(r){return(t||(t=q(i)))(r||i)}})();static \u0275dir=Ge({type:i,selectors:[["","matListItemAvatar",""]],hostAttrs:[1,"mat-mdc-list-item-avatar"],features:[$]})}return i})(),Due=(()=>{class i extends j4{static \u0275fac=(()=>{let t;return function(r){return(t||(t=q(i)))(r||i)}})();static \u0275dir=Ge({type:i,selectors:[["","matListItemIcon",""]],hostAttrs:[1,"mat-mdc-list-item-icon"],features:[$]})}return i})(),Iue=new me("MAT_LIST_CONFIG"),GF=(()=>{class i{_isNonInteractive=!0;get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=ss(t)}_disableRipple=!1;get disabled(){return this._disabled()}set disabled(t){this._disabled.set(ss(t))}_disabled=Vn(!1);_defaultOptions=S(Iue,{optional:!0});static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,hostVars:1,hostBindings:function(n,r){n&2&&oi("aria-disabled",r.disabled)},inputs:{disableRipple:"disableRipple",disabled:"disabled"}})}return i})(),Aue=(()=>{class i{_elementRef=S(vt);_ngZone=S(pt);_listBase=S(GF,{optional:!0});_platform=S(si);_hostElement;_isButtonElement;_noopAnimations=Lo();_avatars;_icons;set lines(t){this._explicitLines=xl(t,null),this._updateItemLines(!1)}_explicitLines=null;get disableRipple(){return this.disabled||this._disableRipple||this._noopAnimations||!!this._listBase?.disableRipple}set disableRipple(t){this._disableRipple=ss(t)}_disableRipple=!1;get disabled(){return this._disabled()||!!this._listBase?.disabled}set disabled(t){this._disabled.set(ss(t))}_disabled=Vn(!1);_subscriptions=new Rn;_rippleRenderer=null;_hasUnscopedTextContent=!1;rippleConfig;get rippleDisabled(){return this.disableRipple||!!this.rippleConfig.disabled}constructor(){S(Ea).load(Pm);let t=S(Fm,{optional:!0});this.rippleConfig=t||{},this._hostElement=this._elementRef.nativeElement,this._isButtonElement=this._hostElement.nodeName.toLowerCase()==="button",this._listBase&&!this._listBase._isNonInteractive&&this._initInteractiveListItem(),this._isButtonElement&&!this._hostElement.hasAttribute("type")&&this._hostElement.setAttribute("type","button")}ngAfterViewInit(){this._monitorProjectedLinesAndTitle(),this._updateItemLines(!0)}ngOnDestroy(){this._subscriptions.unsubscribe(),this._rippleRenderer!==null&&this._rippleRenderer._removeTriggerEvents()}_hasIconOrAvatar(){return!!(this._avatars.length||this._icons.length)}_initInteractiveListItem(){this._hostElement.classList.add("mat-mdc-list-item-interactive"),this._rippleRenderer=new Uh(this,this._ngZone,this._hostElement,this._platform,S(yn)),this._rippleRenderer.setupTriggerEvents(this._hostElement)}_monitorProjectedLinesAndTitle(){this._ngZone.runOutsideAngular(()=>{this._subscriptions.add(Tc(this._lines.changes,this._titles.changes).subscribe(()=>this._updateItemLines(!1)))})}_updateItemLines(t){if(!this._lines||!this._titles||!this._unscopedContent)return;t&&this._checkDomForUnscopedTextContent();let n=this._explicitLines??this._inferLinesFromContent(),r=this._unscopedContent.nativeElement;if(this._hostElement.classList.toggle("mat-mdc-list-item-single-line",n<=1),this._hostElement.classList.toggle("mdc-list-item--with-one-line",n<=1),this._hostElement.classList.toggle("mdc-list-item--with-two-lines",n===2),this._hostElement.classList.toggle("mdc-list-item--with-three-lines",n===3),this._hasUnscopedTextContent){let o=this._titles.length===0&&n===1;r.classList.toggle("mdc-list-item__primary-text",o),r.classList.toggle("mdc-list-item__secondary-text",!o)}else r.classList.remove("mdc-list-item__primary-text"),r.classList.remove("mdc-list-item__secondary-text")}_inferLinesFromContent(){let t=this._titles.length+this._lines.length;return this._hasUnscopedTextContent&&(t+=1),t}_checkDomForUnscopedTextContent(){this._hasUnscopedTextContent=Array.from(this._unscopedContent.nativeElement.childNodes).filter(t=>t.nodeType!==t.COMMENT_NODE).some(t=>!!(t.textContent&&t.textContent.trim()))}static \u0275fac=function(n){return new(n||i)};static \u0275dir=Ge({type:i,contentQueries:function(n,r,o){if(n&1&&(xi(o,Eue,4),xi(o,Due,4)),n&2){let s;st(s=at())&&(r._avatars=s),st(s=at())&&(r._icons=s)}},hostVars:4,hostBindings:function(n,r){n&2&&(oi("aria-disabled",r.disabled)("disabled",r._isButtonElement&&r.disabled||null),sn("mdc-list-item--disabled",r.disabled))},inputs:{lines:"lines",disableRipple:"disableRipple",disabled:"disabled"}})}return i})();var O4=(()=>{class i extends Aue{_lines;_titles;_meta;_unscopedContent;_itemText;get activated(){return this._activated}set activated(t){this._activated=ss(t)}_activated=!1;_getAriaCurrent(){return this._hostElement.nodeName==="A"&&this._activated?"page":null}_hasBothLeadingAndTrailing(){return this._meta.length!==0&&(this._avatars.length!==0||this._icons.length!==0)}static \u0275fac=(()=>{let t;return function(r){return(t||(t=q(i)))(r||i)}})();static \u0275cmp=O({type:i,selectors:[["mat-list-item"],["a","mat-list-item",""],["button","mat-list-item",""]],contentQueries:function(n,r,o){if(n&1&&(xi(o,Tue,5),xi(o,Rue,5),xi(o,Cue,5)),n&2){let s;st(s=at())&&(r._lines=s),st(s=at())&&(r._titles=s),st(s=at())&&(r._meta=s)}},viewQuery:function(n,r){if(n&1&&(tn(yue,5),tn(xue,5)),n&2){let o;st(o=at())&&(r._unscopedContent=o.first),st(o=at())&&(r._itemText=o.first)}},hostAttrs:[1,"mat-mdc-list-item","mdc-list-item"],hostVars:13,hostBindings:function(n,r){n&2&&(oi("aria-current",r._getAriaCurrent()),sn("mdc-list-item--activated",r.activated)("mdc-list-item--with-leading-avatar",r._avatars.length!==0)("mdc-list-item--with-leading-icon",r._icons.length!==0)("mdc-list-item--with-trailing-meta",r._meta.length!==0)("mat-mdc-list-item-both-leading-and-trailing",r._hasBothLeadingAndTrailing())("_mat-animation-noopable",r._noopAnimations))},inputs:{activated:"activated"},exportAs:["matListItem"],features:[$],ngContentSelectors:Mue,decls:10,vars:0,consts:[["unscopedContent",""],[1,"mdc-list-item__content"],[1,"mat-mdc-list-item-unscoped-content",3,"cdkObserveContent"],[1,"mat-focus-indicator"]],template:function(n,r){if(n&1){let o=en();ie(wue),Q(0),B(1,"span",1),Q(2,1),Q(3,2),B(4,"span",2,0),Ie("cdkObserveContent",function(){return rt(o),ot(r._updateItemLines(!0))}),Q(6,3),X()(),Q(7,4),Q(8,5),ne(9,"div",3)}},dependencies:[aR],encapsulation:2,changeDetection:0})}return i})();var L4=(()=>{class i extends GF{_isNonInteractive=!1;static \u0275fac=(()=>{let t;return function(r){return(t||(t=q(i)))(r||i)}})();static \u0275cmp=O({type:i,selectors:[["mat-nav-list"]],hostAttrs:["role","navigation",1,"mat-mdc-nav-list","mat-mdc-list-base","mdc-list"],exportAs:["matNavList"],features:[K([{provide:GF,useExisting:i}]),$],ngContentSelectors:bue,decls:1,vars:0,template:function(n,r){n&1&&(ie(),Q(0))},styles:[vue],encapsulation:2,changeDetection:0})}return i})();function Pue(i,e){if(i&1&&(B(0,"a",3),Vt(1),X()),i&2){let t=e.$implicit;N("routerLink",t.path),F(),Sf(t.data.title)}}function Fue(i,e){if(i&1){let t=en();B(0,"button",10),Ie("click",function(){rt(t),$t();let r=Ft(2);return ot(r.toggle())}),B(1,"mat-icon",11),Vt(2,"menu"),X()()}}function Nue(i,e){if(i&1){let t=en();B(0,"button",12),Ie("click",function(r){rt(t);let o=$t();return ot(o.editorService.toCodeSandbox(r))}),B(1,"mat-icon"),Vt(2,"crop_din"),X(),Vt(3," CodeSandbox "),X()}}function jue(i,e){if(i&1){let t=en();B(0,"button",12),Ie("click",function(r){rt(t);let o=$t();return ot(o.editorService.toStackblitz(r))}),B(1,"mat-icon"),Vt(2,"bolt"),X(),Vt(3," Stackblitz "),X()}}var k4=(()=>{let e=class e{constructor(){this.breakpointObserver=S(e_),this.editorService=S(Cm),this.routes=Bm,this.isHandset$=this.breakpointObserver.observe(c2.Handset).pipe(tt(n=>n.matches),Ec())}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-navigation-shell"]],decls:22,vars:14,consts:[["drawer",""],[1,"sidenav-container"],["fixedInViewport","",1,"sidenav",3,"mode","opened"],["mat-list-item","",3,"routerLink"],[1,"content"],["color","primary"],["type","button","aria-label","Toggle sidenav","mat-icon-button",""],[1,"toolbar-spacer"],["mat-button","","href","#"],[1,"main-route-content"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click"],["aria-label","Side nav toggle icon"],["mat-button","","href","#",3,"click"]],template:function(r,o){r&1&&(B(0,"mat-sidenav-container",1)(1,"mat-sidenav",2,0),In(3,"async"),In(4,"async"),In(5,"async"),B(6,"mat-toolbar"),Vt(7,"ngx-three"),X(),B(8,"mat-nav-list"),Ki(9,Pue,2,2,"a",3,Qi),X()(),B(11,"mat-sidenav-content",4)(12,"mat-toolbar",5),Vi(13,Fue,3,0,"button",6),In(14,"async"),B(15,"span"),Vt(16,"ngx-three-demo"),X(),ne(17,"span",7),Vi(18,Nue,4,0,"button",8),Vi(19,jue,4,0,"button",8),X(),B(20,"div",9),ne(21,"router-outlet"),X()()()),r&2&&(F(),N("mode",jn(3,6,o.isHandset$)?"over":"side")("opened",jn(4,8,o.isHandset$)===!1),oi("role",jn(5,10,o.isHandset$)?"dialog":"navigation"),F(8),Ji(o.routes),F(4),zi(jn(14,12,o.isHandset$)?13:-1),F(5),zi(o.editorService.urls.length?18:-1),F(),zi(o.editorService.urls.length?19:-1))},dependencies:[F4,HF,N4,L4,O4,PR,gR,IP,zv,tR,bR,Gg],styles:[".sidenav-container[_ngcontent-%COMP%]{height:100%}.sidenav[_ngcontent-%COMP%]{width:200px}.sidenav[_ngcontent-%COMP%]   .mat-toolbar[_ngcontent-%COMP%]{background:inherit}.mat-toolbar.mat-primary[_ngcontent-%COMP%]{position:sticky;top:0;z-index:1}.content[_ngcontent-%COMP%]{height:100vh}.main-route-content[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:last-child{display:block;height:100%}.toolbar-spacer[_ngcontent-%COMP%]{flex:1 1 auto}"],changeDetection:0});let i=e;return i})();var B4=(()=>{let e=class e{constructor(){this.title="ngx-three-demo"}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=O({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(r,o){r&1&&ne(0,"app-navigation-shell")},dependencies:[k4],encapsulation:2,changeDetection:0});let i=e;return i})();o2.production&&void 0;SD(B4,{providers:[$E(),PD(FD(),ND()),n2({fullLibraryLoader:()=>import("./chunk-WWVIK6I5.js")}),EP(Bm)]}).catch(i=>console.error(i));
